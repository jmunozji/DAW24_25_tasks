{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Tareas de DAW 24/25","text":"<p>Es este apartado encontraremos los cheatsheets de cada alumno del m\u00f3dulo.</p>"},{"location":"Ud1/ABM/CABM/","title":"Git Cheatsheet - Andreu Beltran Miralles","text":""},{"location":"Ud1/ABM/CABM/#instalacion-y-configuraciones-globales","title":"Instalaci\u00f3n y configuraciones globales","text":"<ul> <li> <p>Instalar Git: <pre><code>apt-get install git\n</code></pre>   Instala Git en el sistema.</p> </li> <li> <p>Configurar el nombre de usuario global: <pre><code>git config --global user.name \"John Doe\"\n</code></pre>   Configura el nombre de usuario global para los commits.</p> </li> <li> <p>Configurar el email global: <pre><code>git config --global user.email johndoe@example.com\n</code></pre>   Configura el correo electr\u00f3nico global para los commits.</p> </li> <li> <p>Configurar el push simple por defecto: <pre><code>git config --global push.default simple\n</code></pre>   Configura que el <code>git push</code> se realice de manera simplificada.</p> </li> <li> <p>Configurar un archivo <code>.gitignore</code> global: <pre><code>git config --global core.excludesfile $HOME/.gitignore_global\n</code></pre>   Especifica un archivo global <code>.gitignore</code> para excluir ciertos archivos en todos los proyectos.</p> </li> </ul>"},{"location":"Ud1/ABM/CABM/#estado-de-git-e-historial","title":"Estado de Git e historial","text":"<ul> <li> <p>Ver el estado actual del repositorio: <pre><code>git status\n</code></pre>   Muestra el estado de los archivos en el repositorio (cambios, staged, untracked, etc.).</p> </li> <li> <p>Ver el historial de commits: <pre><code>git log\n</code></pre>   Muestra los commits anteriores en el proyecto.</p> </li> <li> <p>Crear un alias para un historial de commits formateado: <pre><code>git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"\n</code></pre>   Crea un alias llamado <code>hist</code> que muestra el historial con formato gr\u00e1fico y m\u00e1s informaci\u00f3n concisa.</p> </li> <li> <p>Usar el alias: <pre><code>git hist\n</code></pre>     Muestra el historial con el formato personalizado.</p> </li> </ul>"},{"location":"Ud1/ABM/CABM/#creacion-y-adicion","title":"Creaci\u00f3n y adici\u00f3n","text":"<ul> <li> <p>Inicializar un repositorio Git: <pre><code>git init\n</code></pre>   Crea un nuevo repositorio de Git en el directorio actual.</p> </li> <li> <p>A\u00f1adir un archivo al \u00e1rea de staging: <pre><code>git add hola.php\n</code></pre>   Mueve el archivo <code>hola.php</code> al \u00e1rea de staging para ser incluido en el pr\u00f3ximo commit.</p> </li> <li> <p>Hacer un commit de los cambios: <pre><code>git commit\n</code></pre>   Crea un commit con los cambios actualmente en el \u00e1rea de staging.</p> </li> </ul>"},{"location":"Ud1/ABM/CABM/#eliminacion","title":"Eliminaci\u00f3n","text":"<ul> <li>Eliminar un archivo y registrarlo en el pr\u00f3ximo commit: <pre><code>git rm hola.php\n</code></pre>   Elimina <code>hola.php</code> del repositorio y lo a\u00f1ade al \u00e1rea de staging.</li> </ul>"},{"location":"Ud1/ABM/CABM/#deshacer-cambios","title":"Deshacer cambios","text":"<ul> <li> <p>Restaurar los cambios de un archivo: <pre><code>git restore hola.php\n</code></pre>   Deshace los cambios locales en <code>hola.php</code>.</p> </li> <li> <p>Eliminar un archivo del \u00e1rea de staging (sin eliminarlo del repositorio): <pre><code>git restore --staged hola.php\n</code></pre>   Retira <code>hola.php</code> del \u00e1rea de staging pero mantiene los cambios locales.</p> </li> <li> <p>Deshacer el \u00faltimo commit sin modificar los archivos: <pre><code>git revert HEAD --no-edit\n</code></pre>   Crea un commit que deshace los cambios realizados en el commit anterior.</p> </li> <li> <p>Restaurar el estado de un commit anterior: <pre><code>git reset --hard v1\n</code></pre>   Restaura el estado del repositorio al commit etiquetado como <code>v1</code>, eliminando cualquier cambio posterior.</p> </li> </ul>"},{"location":"Ud1/ABM/CABM/#etiquetas","title":"Etiquetas","text":"<ul> <li> <p>Crear una etiqueta: <pre><code>git tag v1\n</code></pre>   Crea una etiqueta llamada <code>v1</code> en el commit actual.</p> </li> <li> <p>Eliminar una etiqueta: <pre><code>git tag -d v1\n</code></pre>   Elimina la etiqueta <code>v1</code>.</p> </li> <li> <p>Comparar dos etiquetas: <pre><code>git diff v1-beta v1\n</code></pre>   Muestra las diferencias entre las etiquetas <code>v1-beta</code> y <code>v1</code>.</p> </li> </ul>"},{"location":"Ud1/ABM/CABM/#ramas","title":"Ramas","text":"<ul> <li> <p>Crear una nueva rama: <pre><code>git branch hola\n</code></pre>   Crea una nueva rama llamada <code>hola</code>.</p> </li> <li> <p>Cambiar a una rama: <pre><code>git checkout hola\n</code></pre>   Cambia a la rama <code>hola</code>.</p> </li> <li> <p>Fusionar una rama con la rama actual: <pre><code>git merge master\n</code></pre>   Fusiona los cambios de la rama <code>master</code> en la rama actual.</p> </li> <li> <p>Rebasar la rama actual sobre otra: <pre><code>git rebase master\n</code></pre>   Aplica los commits de la rama actual encima de la rama <code>master</code>.</p> </li> </ul>"},{"location":"Ud1/ABM/CABM/#github","title":"GitHub","text":"<ul> <li> <p>A\u00f1adir un repositorio remoto: <pre><code>git remote add origin git@github.com:sgomez/taller-de-git.git\n</code></pre>   A\u00f1ade un repositorio remoto llamado <code>origin</code>.</p> </li> <li> <p>Renombrar la rama principal a <code>main</code>: <pre><code>git branch -M main\n</code></pre>   Renombra la rama actual a <code>main</code>.</p> </li> <li> <p>Subir cambios al repositorio remoto: <pre><code>git push -u origin main\n</code></pre>   Sube los cambios de la rama <code>main</code> al repositorio remoto <code>origin</code>.</p> </li> <li> <p>Clonar un repositorio: <pre><code>git clone git@github.com:sgomez/taller-de-git.git\n</code></pre>   Descarga una copia del repositorio remoto en el equipo local.</p> </li> <li> <p>Mostrar informaci\u00f3n sobre el repositorio remoto: <pre><code>git remote show origin\n</code></pre>   Muestra detalles sobre el repositorio remoto <code>origin</code>.</p> </li> <li> <p>Obtener datos del repositorio remoto sin fusionar: <pre><code>git fetch\n</code></pre>   Descarga los cambios del repositorio remoto sin aplicarlos a la rama actual.</p> </li> <li> <p>Actualizar la rama actual con los cambios del repositorio remoto: <pre><code>git pull\n</code></pre>   Descarga y fusiona los cambios del repositorio remoto en la rama actual.</p> </li> </ul>"},{"location":"Ud1/ACF/cheatsheet/","title":"GitHub Cheatsheet","text":""},{"location":"Ud1/ACF/cheatsheet/#1-comandos-de-instalacion-y-configuracion","title":"1. Comandos de instalaci\u00f3n y configuraci\u00f3n","text":"Comando Explicaci\u00f3n apt-get install git Comando para instalar github en nuestro equipo Ubuntu o Debian git config --global user.name \"(tu usuario)\" Comando para establecer tu nombre de usuario git config --global user.email (tu email) Comando para establecer tu direcci\u00f3n de correo electr\u00f3nico git config --global push.default simple Comando para configurar el comportamiento predeterminado de Git a la hora de hacer un push a un repositorio remoto"},{"location":"Ud1/ACF/cheatsheet/#2-comandos-de-uso-basico-de-git","title":"2. Comandos de uso b\u00e1sico de Git","text":"Comando Explicaci\u00f3n git status Comando para consultar el estado de los archivos git init Comando para crear un nuevo repositorio git add (nombre del archivo) Comando para a\u00f1adir el archivo al \u00e1rea de staging o Staging Area git commit Comando para confirmar los cambios y pasar el archivo de Staging Area a nuestro repositorio local git config --global core.excludesfile $HOME/.gitignore_global Comando para indicar a git que queremos tener un fichero de gitignore global git log Comando para ver todos los cambios que hemos hecho git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\" Comando para crear un alias de un comando muy largo a uno m\u00e1s corto git checkout (rama) Comando para cambiar de rama git tag (nombre de etiqueta) Comando para etiquetar versiones concretas de un repositorio git switch (rama) Comando para cambiar de rama git diff (etiqueta 1) (etiqueta 2) Comando para ver las diferencias entre dos versiones"},{"location":"Ud1/ACF/cheatsheet/#3-comandos-de-uso-avanzado-de-git","title":"3. Comandos de uso avanzado de Git","text":"Comando Explicaci\u00f3n git restore (archivo) Comando para restaurar archivos o cambios en nuestro repositorio git revert Comando para revertir un commit en espec\u00edfico git reset Comando para revertir un commit pero sin dejar huella en el historial de cambios git mv (archivo) (nueva ubicacion) Comando para mover arhchivos git rm (archivo) Comando para eliminar archivos de nuestro repositorio Git"},{"location":"Ud1/ACF/cheatsheet/#4-comandos-de-ramas-git","title":"4. Comandos de ramas Git","text":"Comando Explicaci\u00f3n git branch (nombre rama) Comando para crear una rama nueva git branch -d (nombre rama) Comando para borrar una rama git merge (nombre de rama) Comando para incorporar los cambios de una rama a otra git rebase Comando para reaplicar commits de una rama sobre otra"},{"location":"Ud1/ACF/cheatsheet/#5-comandos-github","title":"5. Comandos GitHub","text":"Comando Explicaci\u00f3n $ ssh-keygen -t rsa -C \"(Descripci\u00f3n)\" Comando para crear una nueva clave p\u00fablica/privada git remote add origin (Direcci\u00f3n del repositorio remoto) Comando para conectar nuestro repositorio local con un repositorio remoto git push Comando para enviar los commits realizados en nuestro repositorio local a un repositorio remoto git clone (Direcci\u00f3n del repositorio) Comando para clonar un repositorio remoto a nuestro repositorio local git remote Comando para ver la configuraci\u00f3n del respositorio git fetch Comando para descargar los cambios desde un repositorio remoto git pull Comando para describir y aplicar cambios desde un repositorio remoto a nuestra rama local actual git stash save Comando para guardar los cambios temporalmente en la pila git stash pop Comando para sacar los cambios de la pila"},{"location":"Ud1/ACF/cheatsheet/#6-comandos-de-colaboracion-en-github","title":"6. Comandos de colaboraci\u00f3n en GitHub","text":"Comando Explicaci\u00f3n git remote add upstream (direcci\u00f3n del repositorio remoto) Comando para a\u00f1adir un repositorio adicional a nuestro repositorio local git remote show upstream Comando para mostrar el repositorio remoto"},{"location":"Ud1/AEM/CHEATSHEET/","title":"Cheatsheet - Comandos B\u00e1sicos de Administraci\u00f3n en Linux","text":""},{"location":"Ud1/AEM/CHEATSHEET/#1-actualizacion-de-paquetes-con-apt","title":"1. Actualizaci\u00f3n de Paquetes con APT","text":"<ul> <li>Actualizar lista de paquetes disponibles:</li> </ul> <pre><code>sudo apt update\n</code></pre> <ul> <li>Actualizar los paquetes instalados:</li> </ul> <pre><code>sudo apt upgrade\n</code></pre> <ul> <li>Eliminar paquetes innecesarios:</li> </ul> <pre><code>sudo apt autoremove\n</code></pre>"},{"location":"Ud1/AEM/CHEATSHEET/#2-creacion-y-manipulacion-de-archivos-y-directorios","title":"2. Creaci\u00f3n y Manipulaci\u00f3n de Archivos y Directorios","text":"<ul> <li>Ver el directorio actual:</li> </ul> <pre><code>pwd\n</code></pre>"},{"location":"Ud1/AEM/CHEATSHEET/#3-manipulacion-de-permisos","title":"3. Manipulaci\u00f3n de Permisos","text":"<ul> <li>Cambiar permisos de un archivo/directorio:</li> </ul> <pre><code>chmod [permisos] (archivo/directorio)\n</code></pre>"},{"location":"Ud1/AEM/CHEATSHEET/#4-gestion-de-usuarios-y-grupos","title":"4. Gesti\u00f3n de Usuarios y Grupos","text":"<ul> <li>Ver lista de usuarios:</li> </ul> <pre><code>cat /etc/passwd\n</code></pre> <ul> <li>Ver lista de grupos:</li> </ul> <pre><code>cat /etc/group\n</code></pre> <ul> <li>Cambiar el propietario de un archivo/directorio:</li> </ul> <pre><code>chown [usuario]:[grupo] (archivo/directorio)\n</code></pre> <ul> <li>Crear un grupo:</li> </ul> <pre><code>groupadd grupo1\n</code></pre> <ul> <li>Cambiar el grupo de un archivo/directorio:</li> </ul> <pre><code>chgrp [grupo] (archivo/directorio)\n</code></pre> <ul> <li>A\u00f1adir un usuario a un grupo:</li> </ul> <pre><code>usermod -a -G grupo1 usuario1\n</code></pre> <ul> <li>Verificar los grupos a los que pertenece un usuario:</li> </ul> <pre><code>groups usuario1\n</code></pre> <ul> <li>Eliminar un usuario de un grupo:</li> </ul> <pre><code>sudo gpasswd -d usuario1 grupo1\n</code></pre> <ul> <li>Eliminar un grupo:</li> </ul> <pre><code>groupdel grupo1\n</code></pre> <ul> <li>Eliminar un usuario (incluyendo su directorio personal):</li> </ul> <pre><code>sudo userdel -r usuario1\n</code></pre>"},{"location":"Ud1/AEM/CHEATSHEET/#5-gestion-de-procesos-basicos","title":"5. Gesti\u00f3n de Procesos B\u00e1sicos","text":"<ul> <li>Ver procesos de un usuario espec\u00edfico:</li> </ul> <pre><code>ps -u admin\n</code></pre> <ul> <li>Ver procesos de un usuario en formato extendido:</li> </ul> <pre><code>ps -u admin -f\n</code></pre> <ul> <li>Ejecutar un proceso en segundo plano:</li> </ul> <pre><code>yes &gt; /dev/null &amp;\n</code></pre> <ul> <li>Ver procesos ejecut\u00e1ndose en segundo plano:</li> </ul> <pre><code>jobs\n</code></pre> <ul> <li>Traer al primer plano el primer proceso:</li> </ul> <pre><code>fg %1\n</code></pre> <ul> <li>Matar un proceso por su PID:</li> </ul> <pre><code>kill (pid)\n</code></pre> <ul> <li>Ver todos los procesos del sistema:</li> </ul> <pre><code>ps aux\n</code></pre> <ul> <li>Ver todos los procesos del sistema (formato extendido):</li> </ul> <pre><code>ps -ef\n</code></pre> <p>```</p> <p>Aqu\u00ed tienes un cheatsheet en formato Markdown con los comandos de Git que mencionas:</p> <p>```markdown</p>"},{"location":"Ud1/AEM/CHEATSHEET/#cheatsheet-comandos-basicos-de-git","title":"Cheatsheet - Comandos B\u00e1sicos de Git","text":""},{"location":"Ud1/AEM/CHEATSHEET/#1-configuracion-de-usuario","title":"1. Configuraci\u00f3n de Usuario","text":"<ul> <li>Configurar nombre de usuario global: <code>bash   git config --global user.name \"John Doe\"</code></li> <li>Configurar correo electr\u00f3nico global: <code>bash   git config --global user.email johndoe@example.com</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#2-clonar-un-repositorio","title":"2. Clonar un Repositorio","text":"<ul> <li>Clonar un repositorio desde GitHub: <code>bash   git clone git@github.com:xxxxxxx/xxxxxxx.git</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#3-configuracion-de-push","title":"3. Configuraci\u00f3n de Push","text":"<ul> <li>Configurar el push como simple: <code>bash   git config --global push.default simple</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#4-historial-y-alias","title":"4. Historial y Alias","text":"<ul> <li>Ver el historial de commits: <code>bash   git log</code></li> <li>Crear alias para el historial de commits: <code>bash   git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#5-estado-y-staging","title":"5. Estado y Staging","text":"<ul> <li>Ver el estado de los archivos: <code>bash   git status</code></li> <li>Usar el alias para ver el historial (si se ha configurado): <code>bash   git hist</code></li> <li>Agregar un archivo al \u00e1rea de staging: <code>bash   git add hola.php</code></li> <li>Cambiar entre ramas recientes: <code>bash   git switch -</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#6-commit-y-checkout","title":"6. Commit y Checkout","text":"<ul> <li>Hacer un commit con comentario: <code>bash   git commit -am \"Comentario aqu\u00ed\"</code></li> <li>Restaurar un archivo desde el \u00e1rea de staging: <code>bash   git restore --staged hola.php</code></li> <li>Revertir el \u00faltimo commit (sin editar el mensaje): <code>bash   git revert HEAD --no-edit</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#7-reseteo-y-edicion-de-commits","title":"7. Reseteo y Edici\u00f3n de Commits","text":"<ul> <li>Resetear el repositorio a un commit espec\u00edfico: <code>bash   git reset --hard v1  # O tambi\u00e9n usando el hash   git reset --hard hash</code></li> <li>Editar el mensaje del \u00faltimo commit: <code>bash   git commit --amend -m \"Nuevo comentario\"</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#8-ramas","title":"8. Ramas","text":"<ul> <li>Crear una nueva rama: <code>bash   git branch hola</code></li> <li>Fusionar la rama <code>master</code> con la rama actual: <code>bash   git merge master</code></li> <li>Fusionar sin fast-forward: <code>bash   git merge --no-ff</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#9-rebase","title":"9. Rebase","text":"<ul> <li>Continuar un rebase: <code>bash   git rebase --continue</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#10-remotos","title":"10. Remotos","text":"<ul> <li>A\u00f1adir un repositorio remoto: <code>bash   git remote add origin git@github.com:Alexillo98/taller-de-git-clase.git</code></li> <li>Cambiar el nombre de la rama actual a <code>main</code>: <code>bash   git branch -M main</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#11-operaciones-de-sincronizacion","title":"11. Operaciones de Sincronizaci\u00f3n","text":"<ul> <li>Empujar cambios al repositorio remoto: <code>bash   git push   git push origin master   git push --force</code></li> <li>Traer cambios desde el repositorio remoto: <code>bash   git fetch</code></li> <li>Actualizar y hacer pull desde el remoto: <code>bash   git pull   git pull --rebase</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#12-stash-guardar-cambios-temporalmente","title":"12. Stash (Guardar cambios temporalmente)","text":"<ul> <li>Guardar cambios en el stash: <code>bash   git stash save</code></li> <li>Sincronizar con el remoto y aplicar el stash: <code>bash   git pull   git stash pop</code></li> <li>Sincronizar y aplicar stash autom\u00e1ticamente: <code>bash   git pull --autostash</code></li> </ul>"},{"location":"Ud1/AEM/CHEATSHEET/#13-otros-comandos","title":"13. Otros Comandos","text":"<ul> <li>Eliminar un archivo del repositorio: <code>bash   git rm hola.php</code></li> <li>Ver detalles del remoto: <code>bash   git remote show origin</code></li> </ul>"},{"location":"Ud1/ALS/cheatsheet1/","title":"Cheatsheet1","text":"<pre><code>---\ntitle: 'CH1 - Adrian Leonard Stan'\n---\n</code></pre>"},{"location":"Ud1/ALS/cheatsheet1/#git-cheatsheet-completo","title":"\ud83d\udee0\ufe0f Git Cheatsheet Completo","text":""},{"location":"Ud1/ALS/cheatsheet1/#configuracion-inicial","title":"\ud83d\udcc5 Configuraci\u00f3n Inicial","text":""},{"location":"Ud1/ALS/cheatsheet1/#configurar-el-nombre-de-usuario","title":"Configurar el nombre de usuario","text":"<p>git config --global user.name \"Tu Nombre\"</p>"},{"location":"Ud1/ALS/cheatsheet1/#configurar-el-correo-electronico","title":"Configurar el correo electr\u00f3nico","text":"<p>git config --global user.email \"tu.email@example.com\"</p>"},{"location":"Ud1/ALS/cheatsheet1/#ver-la-configuracion-actual","title":"Ver la configuraci\u00f3n actual","text":"<p>git config --list</p> <p>\ud83d\udce6 Comandos B\u00e1sicos</p> <p>Copiar c\u00f3digo</p>"},{"location":"Ud1/ALS/cheatsheet1/#inicializar-un-nuevo-repositorio","title":"Inicializar un nuevo repositorio","text":"<p>git init</p>"},{"location":"Ud1/ALS/cheatsheet1/#clonar-un-repositorio-existente","title":"Clonar un repositorio existente","text":"<p>git clone"},{"location":"Ud1/ALS/cheatsheet1/#ver-el-estado-de-los-archivos","title":"Ver el estado de los archivos","text":"<p>git status</p>"},{"location":"Ud1/ALS/cheatsheet1/#agregar-archivos-al-indice-staging-area","title":"Agregar archivos al \u00edndice (staging area)","text":"<p>git add         # Agregar un archivo espec\u00edfico git add .                # Agregar todos los archivos"},{"location":"Ud1/ALS/cheatsheet1/#hacer-un-commit","title":"Hacer un commit","text":"<p>git commit -m \"Mensaje del commit\"</p>"},{"location":"Ud1/ALS/cheatsheet1/#ver-el-historial-de-commits","title":"Ver el historial de commits","text":"<p>git log \ud83c\udf3f Ramas</p> <p>Copiar c\u00f3digo</p>"},{"location":"Ud1/ALS/cheatsheet1/#crear-una-nueva-rama","title":"Crear una nueva rama","text":"<p>git branch"},{"location":"Ud1/ALS/cheatsheet1/#listar-todas-las-ramas","title":"Listar todas las ramas","text":"<p>git branch</p>"},{"location":"Ud1/ALS/cheatsheet1/#cambiar-a-otra-rama","title":"Cambiar a otra rama","text":"<p>git checkout"},{"location":"Ud1/ALS/cheatsheet1/#crear-y-cambiar-a-una-nueva-rama","title":"Crear y cambiar a una nueva rama","text":"<p>git checkout -b"},{"location":"Ud1/ALS/cheatsheet1/#fusionar-otra-rama-a-la-rama-actual","title":"Fusionar otra rama a la rama actual","text":"<p>git merge"},{"location":"Ud1/ALS/cheatsheet1/#eliminar-una-rama","title":"Eliminar una rama","text":"<p>git branch -d  \ud83d\uddc4\ufe0f Stash <p>Copiar c\u00f3digo</p>"},{"location":"Ud1/ALS/cheatsheet1/#guardar-cambios-no-confirmados","title":"Guardar cambios no confirmados","text":"<p>git stash</p>"},{"location":"Ud1/ALS/cheatsheet1/#guardar-cambios-con-mensaje","title":"Guardar cambios con mensaje","text":"<p>git stash save \"Tu mensaje\"</p>"},{"location":"Ud1/ALS/cheatsheet1/#ver-la-lista-de-stashes","title":"Ver la lista de stashes","text":"<p>git stash list</p>"},{"location":"Ud1/ALS/cheatsheet1/#aplicar-el-ultimo-stash","title":"Aplicar el \u00faltimo stash","text":"<p>git stash apply</p>"},{"location":"Ud1/ALS/cheatsheet1/#aplicar-y-eliminar-el-ultimo-stash","title":"Aplicar y eliminar el \u00faltimo stash","text":"<p>git stash pop</p>"},{"location":"Ud1/ALS/cheatsheet1/#mostrar-cambios-en-el-stash","title":"Mostrar cambios en el stash","text":"<p>git stash show          # Resumen git stash show -p      # Detalle de cambios</p>"},{"location":"Ud1/ALS/cheatsheet1/#eliminar-un-stash-especifico","title":"Eliminar un stash espec\u00edfico","text":"<p>git stash drop stash@{n}</p>"},{"location":"Ud1/ALS/cheatsheet1/#limpiar-todos-los-stashes","title":"Limpiar todos los stashes","text":"<p>git stash clear \ud83d\udcc1 Worktree</p> <p>Copiar c\u00f3digo</p>"},{"location":"Ud1/ALS/cheatsheet1/#agregar-un-nuevo-directorio-de-trabajo","title":"Agregar un nuevo directorio de trabajo","text":"<p>git worktree add"},{"location":"Ud1/ALS/cheatsheet1/#crear-un-nuevo-worktree-con-una-nueva-rama","title":"Crear un nuevo worktree con una nueva rama","text":"<p>git worktree add -b"},{"location":"Ud1/ALS/cheatsheet1/#listar-los-worktrees","title":"Listar los worktrees","text":"<p>git worktree list</p>"},{"location":"Ud1/ALS/cheatsheet1/#eliminar-un-worktree","title":"Eliminar un worktree","text":"<p>git worktree remove  \ud83d\udc64 Blame <p>Copiar c\u00f3digo</p>"},{"location":"Ud1/ALS/cheatsheet1/#mostrar-quien-modifico-cada-linea-de-un-archivo","title":"Mostrar qui\u00e9n modific\u00f3 cada l\u00ednea de un archivo","text":"<p>git blame  \ud83c\udf0d Repositorio Remoto <p>Copiar c\u00f3digo</p>"},{"location":"Ud1/ALS/cheatsheet1/#agregar-un-repositorio-remoto","title":"Agregar un repositorio remoto","text":"<p>git remote add"},{"location":"Ud1/ALS/cheatsheet1/#ver-los-repositorios-remotos","title":"Ver los repositorios remotos","text":"<p>git remote -v</p>"},{"location":"Ud1/ALS/cheatsheet1/#enviar-cambios-al-repositorio-remoto","title":"Enviar cambios al repositorio remoto","text":"<p>git push"},{"location":"Ud1/ALS/cheatsheet1/#obtener-cambios-del-repositorio-remoto","title":"Obtener cambios del repositorio remoto","text":"<p>git pull"},{"location":"Ud1/ALS/cheatsheet1/#ver-la-configuracion-de-remotos","title":"Ver la configuraci\u00f3n de remotos","text":"<p>git remote show  \u2699\ufe0f Otros Comandos \u00datiles <p>Copiar c\u00f3digo</p>"},{"location":"Ud1/ALS/cheatsheet1/#comparar-cambios","title":"Comparar cambios","text":"<p>git diff                # Cambios no a\u00f1adidos git diff --cached       # Cambios en el staging area</p>"},{"location":"Ud1/ALS/cheatsheet1/#revertir-cambios-en-un-archivo","title":"Revertir cambios en un archivo","text":"<p>git checkout --"},{"location":"Ud1/ALS/cheatsheet1/#deshacer-el-ultimo-commit-manteniendo-cambios","title":"Deshacer el \u00faltimo commit (manteniendo cambios)","text":"<p>git reset --soft HEAD~1</p>"},{"location":"Ud1/ALS/cheatsheet1/#deshacer-el-ultimo-commit-perdiendo-cambios","title":"Deshacer el \u00faltimo commit (perdiendo cambios)","text":"<p>git reset --hard HEAD~1 \ud83d\udd04 Resumen de Ramas en Git Flow</p> <p>Copiar c\u00f3digo</p>"},{"location":"Ud1/ALS/cheatsheet1/#inicializar-git-flow","title":"Inicializar Git Flow","text":"<p>git flow init</p>"},{"location":"Ud1/ALS/cheatsheet1/#crear-una-rama-de-funcionalidad","title":"Crear una rama de funcionalidad","text":"<p>git flow feature start"},{"location":"Ud1/ALS/cheatsheet1/#finalizar-una-rama-de-funcionalidad","title":"Finalizar una rama de funcionalidad","text":"<p>git flow feature finish"},{"location":"Ud1/ALS/cheatsheet1/#crear-una-rama-de-lanzamiento","title":"Crear una rama de lanzamiento","text":"<p>git flow release start"},{"location":"Ud1/ALS/cheatsheet1/#finalizar-una-rama-de-lanzamiento","title":"Finalizar una rama de lanzamiento","text":"<p>git flow release finish"},{"location":"Ud1/ALS/cheatsheet1/#crear-una-rama-de-parche","title":"Crear una rama de parche","text":"<p>git flow hotfix start"},{"location":"Ud1/ALS/cheatsheet1/#finalizar-una-rama-de-parche","title":"Finalizar una rama de parche","text":"<p>git flow hotfix finish"},{"location":"Ud1/BSO/BSO/","title":"CH1 - Bryan Oyola","text":""},{"location":"Ud1/BSO/BSO/#indice","title":"\u00cdNDICE","text":"<ul> <li>\u00cdNDICE</li> <li>INSTALACI\u00d3N DE GIT</li> <li>Windows</li> <li>Linux</li> <li>CONFIGURACI\u00d3N DE GIT CON GITHUB</li> <li>Crear un repositorio en GitHub</li> <li>Crear un gitignore de forma global</li> <li>RESUMEN DE COMANDOS PRINCIPALES DE GIT</li> <li>Comandos b\u00e1sicos</li> <li>Comandos avanzados</li> <li>TRABAJANDO CON RAMAS</li> <li>GUARDANDO CAMBIOS EN STASH</li> </ul>"},{"location":"Ud1/BSO/BSO/#instalacion-de-git","title":"INSTALACI\u00d3N DE GIT","text":"<p>La instalaci\u00f3n de Git variar\u00e1 dependiendo del sistema operativo en el cual  busquemos instalarlo.</p>"},{"location":"Ud1/BSO/BSO/#windows","title":"Windows","text":"<p>La forma m\u00e1s sencilla de tener una consola de git utilizable desde Windows es instalando Git desde esta p\u00e1gina web.</p> <p></p> <p>Luego de ello, simplemente nos quedar\u00e1 lanzar el programa git bash, teniendo una terminal de comandos para git completamente funcional adem\u00e1s de comandos de Linux muy \u00fatiles como:</p> <p>-<code>ls (listar archivos y carpetas)</code> -<code>cd (Recorrer los directorios)</code> -<code>mkdir (crear carpetas)</code> -<code>touch (crear ficheros)</code></p>"},{"location":"Ud1/BSO/BSO/#linux","title":"Linux","text":"<p>Para instalar git en Linux, haremos uso del gestor de paqueter\u00eda que nuestro sistema operativo tenga instalado, para ello, lo desglosar\u00e9 en las 3 principales distribuciones que tiene el ecosistema Linux.</p> <ol> <li> <p>Basadas en Debian(Debian,Ubuntu,Linux Mint...)</p> <ul> <li>Actualizar paqueter\u00eda <pre><code>$sudo apt-get update &amp;&amp; sudo apt-get upgrade\n</code></pre></li> <li>Instalar Git <pre><code>$sudo apt-get install git\n</code></pre></li> </ul> </li> <li> <p>Basadas en Red Hat(Red Hat Linux,Fedora,OpenSuse...)</p> <p>Fedora</p> <ul> <li>Actualizar paqueter\u00eda <pre><code>$sudo dnf check-update &amp;&amp; sudo dnf upgrade\n</code></pre></li> <li>Instalar Git <pre><code>$sudo dnf install git\n</code></pre></li> </ul> <p>OpenSuse</p> <ul> <li>Actualizar paqueter\u00eda <pre><code>$sudo zypper refresh &amp;&amp; sudo zypper update\n</code></pre></li> <li>Instalar Git <pre><code>$sudo zypper install git\n</code></pre></li> </ul> </li> <li> <p>Basadas en Arch(Arch Linux,Manjaro,Arco Linux...)</p> <ul> <li>Actualizar paqueter\u00eda <pre><code>$sudo pacman -Syu\n</code></pre></li> <li>Instalar Git <pre><code>$sudo pacman -S git\n</code></pre></li> </ul> </li> </ol>"},{"location":"Ud1/BSO/BSO/#configuracion-de-git-con-github","title":"CONFIGURACI\u00d3N DE GIT CON GITHUB","text":"<p>Ahora que ya tenemos una terminal con git completamente funcional, pasaremos a a\u00f1adir nuestra cuenta de github(Esto lo haremos una vez en cada ordenador que queramos usar).</p> <p>Para ello, lo primero que haremos ser\u00e1 generar una clave ssh en nuestro ordenador, esta clave la utilizaremos para acceder a github de forma segura sin necesidad de estar logeandonos todo el tiempo.</p> <p>para ello, introduciremos este comando:</p> <ul> <li> <p>Si utilizas un ordenador moderno(pr\u00f3tocolo m\u00e1s seguro) <pre><code>ssh-keygen -t ed25519 -C \"your_email@example.com\"\n</code></pre></p> </li> <li> <p>Si utilizas un ordenador m\u00e1s antiguo <pre><code> ssh-keygen -t rsa -b 4096 -C \"your_email@example.com\"\n</code></pre></p> </li> </ul> <p>Esto nos generar\u00e1 dos claves ssh (una p\u00fablica que ser\u00e1 la que usaremos y otra privada que debemos conservar y no mostrar a nadie) en la carpeta ./ssh en nuestro directorio <code>$HOME</code> (Carpeta de usuario de Linux). Algo parecido a lo que generamos cuando queremos conectarnos a un servidor AWS, ser\u00eda casi lo mismo que el archivo .PEM pero para github.</p> <p>Luego accederemos a nuestra cuenta de Github desde un navegador e iremos al apartado Settings-&gt;SSH and GPG Keys-&gt;New SSH Key.</p> <ul> <li>Mediante el comando: <pre><code>$cat ~/.shh/{nombre-del-archivo}.pub \n</code></pre> Copiaremos la clave p\u00fablica ssh y en la secci\u00f3n anterior, la pegaremos y le daremos un nombre para identificar que ordenador es.</li> </ul> <p>Por \u00faltimo, debemos a\u00f1adir nuestro nombre e email de github en la terminal para que as\u00ed podamos ser identificados de forma correcta en los commit que hagamos, adem\u00e1s de cambiar la rama predeterminada de master a main.</p> <ul> <li>Utilizaremos los comandos <pre><code>$git config --global user.name \"Nombre Cuenta Github\"\n$git config --global user.email \"Correo de Github\"\n$git config --global init.defaultBranch main\n</code></pre></li> </ul> <p>Con esto, ya tendremos listo nuestro entorno de trabajo, que usaremos cuando ejecutemos comandos m\u00e1s avanzados y dejemos de trabajar en local.</p>"},{"location":"Ud1/BSO/BSO/#crear-un-repositorio-en-github","title":"Crear un repositorio en GitHub","text":"<ol> <li>Inicias sesi\u00f3n en GitHub.</li> <li>Pulsas sobre el icono y luego en repositorios.</li> <li>Creas un nuevo repositorio pulsando en New.</li> <li>Decides un nombre para el repositorio.</li> <li>Puedes ponerle una descripci\u00f3n.</li> <li>Eliges si quieres que sea p\u00fablico o privado.</li> <li>Puedes a\u00f1adir un README, un gitignore o una Licencia.</li> <li>Por \u00faltimo, ya puedes crear el repositorio.</li> </ol>"},{"location":"Ud1/BSO/BSO/#crear-un-gitignore-de-forma-global","title":"Crear un gitignore de forma global","text":"<p>Un gitignore es un archivo muy \u00fatil para no llenar nuestros repositorios de git de archivos innecesarios. </p> <p>Muchos frameworks o librer\u00edas crean archivos residuales que seguramente no busquemos mantener en nuestro repositorio final del proyecto, para ello, crearemos un gitignore. </p> <p>Podemos crear uno por cada proyecto que tengamos simplemente creandolo en la carpeta ra\u00edz del directorio git o podemos crear uno global si usamos muy a menudo ciertas tecnolog\u00edas.</p> <p>Para ello, utilizaremos: <pre><code>$git config --global core.excludesfile $HOME/.gitignore_global\n</code></pre></p>"},{"location":"Ud1/BSO/BSO/#resumen-de-comandos-principales-de-git","title":"RESUMEN DE COMANDOS PRINCIPALES DE GIT","text":""},{"location":"Ud1/BSO/BSO/#comandos-basicos","title":"Comandos b\u00e1sicos","text":"<ul> <li><code>git init</code>: Inicializa un nuevo repositorio. <pre><code>$mkdir pruebas\n$cd pruebas\n$git init\n\nInicializado repositorio Git vac\u00edo en /home/bryan/Documentos/DAW/pruebas/.git/\n</code></pre></li> <li><code>git status</code>: Consulta el estado de un proyecto. <pre><code>$git status\n\nEn la rama main\nTu rama est\u00e1 actualizada con 'origin/main'.\n\nnada para hacer commit, el \u00e1rbol de trabajo est\u00e1 limpio\n</code></pre></li> <li><code>git log</code>: Consulta el historial de commits en el repositorio actual. <pre><code>$git log\n$git log --oneline\n$git log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\n</code></pre></li> <li><code>git tag</code>: Crea,modifica o elimina \"tags\"(etiquetas) a los commits(instant\u00e1neas) de nuestro proyecto. <pre><code>$git tag\n&lt;Lista todas las etiquetas creadas&gt;\n$git tag &lt;nombre&gt;\n&lt;Crea una etiqueta llama nombre&gt;\n$git tag -d &lt;nombre&gt;\n&lt;Elimina la etiqueta llamada nombre&gt;\n</code></pre></li> <li><code>git add &lt;nombre archivo&gt;</code>: A\u00f1ade los cambios al \u00e1rea de preparaci\u00f3n -&gt;(staging). <pre><code>$touch archivo.txt\n$git add archivo.txt &lt;Esto a\u00f1adir\u00eda archivo.txt al \u00e1rea de staging&gt;\n\n$git add . &lt;Esto a\u00f1adir\u00eda todos los ficheros al \u00e1rea de staging&gt;\n</code></pre></li> <li><code>git commit -m</code>: Crea una instant\u00e1nea de los cambios que hay en stage. <pre><code>$git commit -m \"commit inicial\"\n&lt;Si le quitamos la -m, nos abrir\u00e1 un editor de texto para a\u00f1adir el mensaje&gt;\n$git commit -am \"commit inicial\"\n&lt;Nos har\u00e1 el git add y el git commit a la vez&gt;\n</code></pre></li> <li><code>git diff</code>: Permite ver las diferencias entre distintos estados de tu repositorio, como entre commits, ramas o el estado actual de los archivos. <pre><code>$git diff\n&lt;Muestra la diferencia entre tu \u00e1rea de trabajo y el commit m\u00e1s reciente&gt;\n$git diff &lt;commit&gt;\n&lt;Muestra la diferencia entre tu \u00e1rea de trabajo y el commit especificado&gt;\n$git diff &lt;otra rama&gt;\n&lt;Muestra la diferencia entre tu rama actual y otra rama&gt;\n</code></pre></li> <li><code>git clone &lt;url&gt;</code>: Clona un repositorio existente. <pre><code>$git clone &lt;url_repositorio&gt;\n&lt;La url puede ser la ssh o la http del repositorio, depender\u00e1 de nuestra configuraci\u00f3n anterior, aunque es preferible la ssh&gt;\n</code></pre></li> </ul>"},{"location":"Ud1/BSO/BSO/#comandos-avanzados","title":"Comandos avanzados","text":"<ul> <li><code>git push</code>: Se utiliza para enviar tus cambios locales a un repositorio remoto. <pre><code>$git push origin main\n&lt;git push &lt;remoto&gt; &lt;rama&gt;&gt;\n</code></pre></li> <li><code>git fetch &lt;url&gt;</code>: Actualizar tu repositorio local con los cambios que han ocurrido en el repositorio remoto, este comando solo descarga la informaci\u00f3n sin mezclarla con tu trabajo local. <pre><code>$git fetch origin\n</code></pre></li> <li><code>git merge</code>: Combina una rama con la actual, tambien, combina un fetch con la rama en la que est\u00e1s trabajando. <pre><code>$git merge &lt;rama&gt;\n</code></pre></li> <li><code>git pull</code>: Actualizar tu rama local con los cambios que se han hecho en el repositorio remoto. Combina dos acciones: git fetch (descargar los cambios) y git merge (a\u00f1adir esos cambios en tu rama actual). <pre><code>$git pull origin main\n&lt;git pull &lt;remoto&gt; &lt;rama&gt;&gt;\n</code></pre></li> <li><code>git rebase &lt;rama&gt;</code>: Aplicar cambios de una rama sobre otra sobreescribiendo el historial de las ramas. <pre><code>$git rebase &lt;rama&gt;\n$git rebase --continue\n</code></pre></li> <li><code>git reset --hard &lt;commit-hash&gt;</code>: Resetea el repositorio a un commit espec\u00edfico. <pre><code>$git reset &lt;commit&gt;\n$git reset --hard &lt;commit&gt;\n&lt;Resetea el repositorio a un commit espec\u00edfico&gt;\n</code></pre></li> </ul>"},{"location":"Ud1/BSO/BSO/#trabajando-con-ramas","title":"TRABAJANDO CON RAMAS","text":"<p>Listar Ramas</p> <pre><code>$git branch\n&lt;Muestra las ramas que tienes en tu directorio local&gt;\n$git branch -r\n&lt;Muestra las ramas remotas que tienes&gt;\n</code></pre> <p>Creaci\u00f3n y eliminaci\u00f3n de Ramas</p> <pre><code>$git branch &lt;rama&gt;\n&lt;Crear rama&gt;\n$git branch -d &lt;rama&gt;\n&lt;Eliminar rama&gt;\n</code></pre> <p>Trabajando con Ramas</p> <pre><code>$git checkout &lt;rama&gt;\n&lt;Ir a la rama especificada&gt;\n$git checkout -b &lt;rama&gt;\n&lt;Creas la rama especificada y luego cambias a ella&gt;\n</code></pre> <p>Combinando Ramas</p> <pre><code>$git merge &lt;rama&gt;\n&lt;Combina una rama con la actual&gt;\n$git rebase &lt;rama&gt;\n&lt;Aplicar cambios de una rama sobre otra sobreescribiendo el historial de las ramas&gt;\n</code></pre> <ul> <li>Se puede usar la opci\u00f3n -m para dar un nombre al commit al hacer el merge</li> <li>existen opciones como --ff -&gt; fast-forward (Que intentar\u00e1 no crear un commit nuevo y por lo tanto no dejar historial de ramas) y --no-ff(Que crear\u00e1 un commit nuevo para la fusi\u00f3n).</li> </ul>"},{"location":"Ud1/BSO/BSO/#guardando-cambios-en-stash","title":"GUARDANDO CAMBIOS EN STASH","text":"<p>Muy \u00fatil si quieres mantener un trabajo actual y as\u00ed poder hacer otra tarea diferente y luego de hacer lo anterior, volver a tu trabajo guardado en el stash.</p> <pre><code>$git stash\n&lt;Guardas los cambios en el stash&gt;\n$git pull, $git checkout &lt;otra rama&gt;\n&lt;Empiezas con tu nueva tarea hasta finalizarla mediante un commit por ejemplo&gt;\n$git stash pop\n&lt;Recuperas los cambios que tienes en el stash y prosigues con tu trabajo anterior&gt;\n</code></pre> <ul> <li><code>git pull --autostash</code>: Es la combinaci\u00f3n del primer git stash y git pull, en otras palabras, guarda tu trabajo en el stash y recibe los cambios del pull.</li> </ul>"},{"location":"Ud1/DGD/cheatsheet/","title":"CheatSheet Github DARIUS GABRIEL DOBRE","text":""},{"location":"Ud1/DGD/cheatsheet/#12-configuracion-inicial","title":"1.2 Configuraci\u00f3n Inicial","text":"<pre><code>git config --global user.name \"Tu Nombre\"\ngit config --global user.email \"tu.email@ejemplo.com\"\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#15-uso-basico-de-git","title":"1.5 Uso b\u00e1sico de Git","text":"<p>Inciar un repositorio git y clonar un repositorio</p> <pre><code>git init\ngit clone &lt;url_del_repositorio&gt;\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#trabajar-con-cambios","title":"Trabajar con Cambios","text":"<p>Para consultar el estado de los archivos</p> <pre><code>git status\n</code></pre> <p>Para agregar archivos al staging area, si haces <code>git add .</code> se a\u00f1den todos los archivos sin necesidad de especificar cual quieres a\u00f1adir.</p> <p><pre><code>git add &lt;archivo&gt;\n</code></pre> Para pasar tus archivos a Local Repository</p> <pre><code>git commit -m \"Mensaje de commit\"\n</code></pre> <p>Realiar add y commit en un solo comando</p> <pre><code>git commit -am \"Mensaje de commit\"\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#consultar-logs","title":"Consultar Logs","text":"<p>Para consultar los logs podemos ejecutar los siguientes comandos</p> <pre><code>git log\ngit log --oneline\ngit log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\n</code></pre> <p>Podemos crear un alias para no tener que usar comandos tan largos</p> <pre><code>git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"\n</code></pre> <p>Ahora simplemente con usar <code>git hist</code> nos saldr\u00e1n los logs de una manera m\u00e1s vistosa</p>"},{"location":"Ud1/DGD/cheatsheet/#regresar-a-versiones-anteriores","title":"Regresar a versiones anteriores","text":"<p>Podemos regresar a versiones anterior usando el checkout junto al hash del commit</p> <p>Ejemplo:</p> <p><pre><code>git checkout e19f2c1\n</code></pre> Al volver a esa versi\u00f3n, si queremos estar de vuelta al commit mas reciente:</p> <pre><code>git switch -\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#etiquetar-versiones","title":"Etiquetar versiones","text":"<p>Podemos etiquetar versiones usando el comando <code>tag</code></p> <p>Ejemplo:</p> <pre><code>git tag v1\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#visualizar-cambios","title":"Visualizar cambios","text":"<p>Podemos visualizar los cambios que se han hecho en un archivo usando el comando <code>diff</code></p> <p>Ejemplo:</p> <pre><code>git diff v1-beta v1\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#16-uso-avanzado-de-git","title":"1.6 Uso avanzado de Git","text":""},{"location":"Ud1/DGD/cheatsheet/#deshacer-cambios","title":"Deshacer cambios","text":"<p>Si queremos deshacer los cambios que se han hecho en el archivo <code>README.md</code> podemos usar el comando <code>restore</code></p> <p>Ejemplo:</p> <pre><code>git restore README.md\n</code></pre> <p>Deshacer cambios antes del commit.</p> <p>Si hemos realizado el comando <code>git add &lt;arhivo&gt;</code> y queremos deshacer los cambios antes de realizar el commit, podemos hacerlo de la siguiente manera:</p> <pre><code>git restore --staged &lt;archivo&gt;\n</code></pre> <p>Si en cambio ya hemos realizado el commit y queremos deshacerlo, lo haremos de la siguiente manera:</p> <pre><code>git revert HEAD --no-edit\n</code></pre> <p>Borrar commits de una rama:</p> <pre><code>git reset --hard &lt;commit_id&gt;\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#17-ramas","title":"1.7 Ramas","text":""},{"location":"Ud1/DGD/cheatsheet/#crear-una-rama","title":"Crear una rama","text":"<pre><code>git branch hola\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#cambiar-de-rama","title":"Cambiar de rama","text":"<p><pre><code>git checkout &lt;rama&gt;\n</code></pre> o <pre><code>git checkout -b &lt;nueva_rama&gt;\n</code></pre></p> <p>Con esta \u00faltima, creamos la rama y nos cambiamos a ella</p>"},{"location":"Ud1/DGD/cheatsheet/#fusionar-ramas","title":"Fusionar Ramas","text":"<p>Usaremos este comando cuando queramos fusionar una rama con otra, nos posicionaremos sobre la rama a la que queramos traerle los cambios de otra y ejecutamos el siguiente comando:</p> <pre><code>git merge &lt;rama_a_fusionar&gt;\n</code></pre> <p>Otra manera de fusionar es con el <code>rebase</code> que lo que hace el alterar el orden o la historia de creaci\u00f3n de cambios</p> <pre><code>git rebase &lt;rama_a_fusionar&gt;\n</code></pre>"},{"location":"Ud1/DGD/cheatsheet/#18-github","title":"1.8 GitHub","text":"<p>Para a\u00f1adirte un repositorio remoto a local, lo tendrias que hacer de la siguiente manera:</p> <pre><code>git remote add &lt;nombre&gt; &lt;url&gt;\n</code></pre> <p>Para subir los cambios al repositorio remoto:</p> <pre><code>git push &lt;nombre&gt; &lt;rama&gt;\n</code></pre> <p>Para actualizar los cambios del repositorio remoto al local:</p> <pre><code>git pull &lt;nombre&gt; &lt;rama&gt;\n</code></pre> <p>Si quieres ver solamente si ha habido algun cambio, sin pasarte los cambios puedes hacer lo siguiente:</p> <pre><code>git fetch &lt;nombre&gt;\n</code></pre> <p>Para poder hacer un pull aunque tengas cambios en local que aun no has subido, lo que puedes guardar tus archivos en una especie de pila con el siguiente comando:</p> <p><pre><code>git stash save\n</code></pre> y luego hacer el pull</p> <p><pre><code>git pull\n</code></pre> Y por \u00faltimo sacamos los cambios de la pila:</p> <pre><code>git stash pop\n</code></pre> <p>Podemos realizar todo a la vez con un solo comando:</p> <pre><code>git pull --autostash\n</code></pre>"},{"location":"Ud1/DMP/cheatsheet/","title":"\ud83d\udcdd UD1 - Git Cheatsheet","text":"<p>David Maratrat Pons </p>"},{"location":"Ud1/DMP/cheatsheet/#instalacion-de-git","title":"\ud83d\udcc1 Instalaci\u00f3n de Git","text":"Comando Descripci\u00f3n \ud83d\udc27 Linux <code>apt-get install git</code> Instalaci\u00f3n de git en distribuciones Debian <code>yum install git-core</code> Instalaci\u00f3n de git por instalador binario \ud83e\ude9f  Windows https://gitforwindows.org/ URL de descarga de git \ud83c\udf4f MacOS <code>brew install git</code> Instalaci\u00f3n de git para MacOS"},{"location":"Ud1/DMP/cheatsheet/#configuracion-de-git","title":"\u2699\ufe0f Configuraci\u00f3n de Git","text":"Comando Descripci\u00f3n <code>git config --global user.name \"nombre\"</code> Configurar el nombre de usuario a nivel global <code>git config --global user.email \"example@correo.com\"</code> Configurar el correo electr\u00f3nico a nivel global <code>git config --global push.default simple\"</code> Define estrategia por defecto al hacer git push <code>git config --global core.excludesfile $HOME/.gitignore_global</code> Excluir archivos/directorios dentro del archivo .gitignore_global"},{"location":"Ud1/DMP/cheatsheet/#uso-basico-de-git","title":"\ud83d\uddc3\ufe0f Uso b\u00e1sico de Git","text":"Comando Descripci\u00f3n <code>git init</code> Inicializa el repositorio git en la carpteta actual <code>git status</code> Permite ver el estado de los archivos del repositorio <code>git add .</code> A\u00f1adir todos los archivos al staging area <code>git add \"archivo/carpeta\"</code> A\u00f1ade el archivo/carpeta al staging area <code>git commit -m \"mensaje\"</code> Confirmar los cambios con un mensaje de commit <code>git push origin &lt;rama&gt;</code> Enviar los cambios al repositorio remoto <code>git checkout \"xxxxxxx\"</code> Cambia el HEAD de versi\u00f3n usando el hash acortado <code>git switch -</code> Cambia el HEAD al la \u00faltima versi\u00f3n"},{"location":"Ud1/DMP/cheatsheet/#ramas","title":"\ud83c\udf3f Ramas","text":"Comando Descripci\u00f3n <code>git branch</code> Listar todas las ramas locales <code>git branch \"nombre\"</code> Crea una rama nueva <code>git checkout \"nombre\"</code> Cambiar a una rama espec\u00edfica <code>git checkout -b &lt;nueva-rama&gt;</code> Crear y cambiar a una nueva rama <code>git branch -d &lt;rama&gt;</code> Eliminar una rama local <code>git merge &lt;rama&gt;</code> Fusionar otra rama en la rama actual <code>git merge &lt;rama&gt; --no-ff</code> Fusionar otra rama en la rama actual guardando el historial de cambios <code>git rebase &lt;rama&gt;</code> Aplica los commits de la rama actual sobre otra"},{"location":"Ud1/DMP/cheatsheet/#etiquetado","title":"\ud83c\udff7\ufe0f Etiquetado","text":"Comando Descripci\u00f3n <code>git tag v1</code> Asigna una tiqueta a una versi\u00f3n <code>git tag -d \"nombre_etiqueta\"</code> Elimina una etiqueta"},{"location":"Ud1/DMP/cheatsheet/#restaurado","title":"\u21a9\ufe0f Restaurado","text":"Comando Descripci\u00f3n <code>git restore \"archivo\"</code> Restaura los cambios de un archivo antes de haber hecho un <code>git add</code> <code>git restore --staged \"archivo\"</code> Devuelve el archivo al Working Directory <code>git revert HEAD --no-edit</code> Crea un nuevo commit deshaciendo los cambios realizados en el commit anterior <code>git reset --hard \"xxxxxxx\"</code> Devuelve el HEAD a un commit anterior y borra los cambios posteriores"},{"location":"Ud1/DMP/cheatsheet/#historial-y-versionado","title":"\u23f3 Historial y Versionado","text":"Comando Descripci\u00f3n <code>git config --global alias.hist \"log --pretty=format:'%h %ad \\| %s%d [%an]' --graph --date=short\"</code> Crea un alias para ver los cambios formatados <code>git log</code> Permite ver el historial de commits <code>git log --oneline</code> Permite ver los cambios realizados en una linea <code>git show \"xxxxxxx\"</code> Permite ver los detalles de un commit en espec\u00edfico <code>git remote show origin</code> Podemos ver la configuraci\u00f3n de este repositorio remoto <code>git diff</code> Permite ver los cambios entre commits o ramas"},{"location":"Ud1/DMP/cheatsheet/#remoto","title":"\ud83c\udf10 Remoto","text":"Comando Descripci\u00f3n <code>git clone git@github.com:tu/repositorio.git</code> Clona un repositorio en local del remoto <code>git remote add origin git@github.com:tu/repositorio.git</code> Asocia tu repositorio local con el remoto <code>git branch -M main</code> Cambia el nombre de la rama actual a main (compatibilidad github) <code>git push -u origin main</code> Envia los cambios de main a origin y establece origin/main como rama por defecto para futuros pull/push <code>git merge &lt;origin/main&gt;</code> Fusionar una rama del remoto en la rama local actual <code>git rebase &lt;origin/main&gt;</code> Aplica los commits de una rama del remoto en la rama local actual <code>git rebase --continue</code> Continua con el rebase despu\u00e9s de solucionar un conflicto"},{"location":"Ud1/DMP/cheatsheet/#actualizacion-y-sincronizacion","title":"\ud83d\udd04 Actualizaci\u00f3n y Sincronizaci\u00f3n","text":"Comando Descripci\u00f3n <code>git pull origin &lt;rama&gt;</code> Descargar y fusionar cambios desde el remoto <code>git pull --rebase origin &lt;rama&gt;</code> Descargar y fusionar (mediante rebase) cambios desde el remoto <code>git push origin main</code> Envia los cambios locales de la rama main al repositorio origin <code>git fetch</code> Traer los cambios remotos sin fusionar <code>git merge &lt;rama&gt;</code> Fusionar otra rama en la rama actual"},{"location":"Ud1/DMP/cheatsheet/#git-flow","title":"\ud83d\udd00 Git Flow","text":"Comando Descripci\u00f3n <code>git flow init</code> Inicializa el espacio de trabajo <code>git flow feature start feature_branch</code> Crea una rama de funcionalidad <code>git flow feature stop feature_branch</code> Elimina una rama de funcionalidad <code>git flow release</code> Crea la rama de publicaci\u00f3n de versiones <code>git flow hotfix start hotfix_branch</code> Crea una rama para parchear errores de las releases <code>git flow hotfix finish hotfix_branch</code> Cierra una rama de parchedo de errores de las releases"},{"location":"Ud1/DMP/cheatsheet/#stash","title":"\ud83d\udce5 Stash","text":"Comando Descripci\u00f3n <code>git stash</code> Guardar temporalmente los cambios sin hacer commit <code>git stash save</code> Guarda los cambios sin hacer commit <code>git stash apply</code> Recupera el cambio guardado m\u00e1s reciente <code>git stash pop</code> Recuperar los cambios guardados <code>git stash list</code> Muestra los cambios guardados <code>git stash show</code> Muestra un resumen de los ficheros modificados en la pila <code>git stash branch</code> Permite crear una nueva rama a partir del \u00faltimo stash <code>git stash clear</code> Borra todos los stash de la pila <code>git stash drop</code> Permite borrar un unico stash de la pila"},{"location":"Ud1/DMP/cheatsheet/#worktree","title":"\ud83c\udf33 Worktree","text":"Comando Descripci\u00f3n <code>git worktree add /directorio master</code> Crea un directorio de trabajo temporal con el contenido de master <code>git worktree add -b fix /directorio master</code> Crea la rama fix desde master <code>git worktree list</code> GMuestra el listado de directorios y espacios de trabajo <code>git worktree delete fix</code> Borra un espacio de trabajo"},{"location":"Ud1/DMP/cheatsheet/#blame","title":"\ud83d\udd75\ufe0f Blame","text":"Comando Descripci\u00f3n <code>git blame archivo</code> Permite saber qui\u00e9n fue el \u00faltimo en modificar una l\u00ednea concreta de c\u00f3digo, en qu\u00e9 commit y en qu\u00e9 fecha"},{"location":"Ud1/DMP/cheatsheet/#otras-utilidades","title":"\ud83e\uddf0 Otras Utilidades","text":"Comando Descripci\u00f3n <code>git rm &lt;archivo&gt;</code> Eliminar un archivo del repositorio y del directorio <code>git mv &lt;archivo-nuevo&gt;</code> Renombrar o mover un archivo <code>git rebase &lt;rama&gt;</code> Aplicar commits de una rama sobre otra <code>ssh-keygen -t rsa -C \"Cuenta GitHub\"</code> Crea par de claves para poder usar github con ssh <code>Closes #1</code> Cierra una incid\u00e9ncia desde la descripci\u00f3n de un commit"},{"location":"Ud1/DMP/cheatsheet/#ayuda-y-documentacion","title":"\ud83d\udd0d Ayuda y Documentaci\u00f3n","text":"Comando Descripci\u00f3n <code>git help &lt;comando&gt;</code> Ver la ayuda detallada de un comando espec\u00edfico <code>git --version</code> Ver la versi\u00f3n de Git instalada"},{"location":"Ud1/EGM/cheatsheet/","title":"1 Instalaci\u00f3n y configuraci\u00f3n de Git","text":""},{"location":"Ud1/EGM/cheatsheet/#11-instalacion-de-git","title":"1.1 Instalaci\u00f3n de Git","text":"<p>Para instalar Git en tu sistema operativo, sigue los siguientes pasos:</p> <ol> <li>Primero tienes que actualizar tu sistema operativo :</li> </ol> <pre><code>    $ sudo apt-get update &amp;&amp; upgrade\n</code></pre> <ol> <li>Instalaci\u00f3n en Linux :</li> </ol> <pre><code>    $ apt-get install git\n</code></pre> <ol> <li>Comprueba la versi\u00f3n de git que est\u00e1s usando :</li> </ol> <pre><code>    $ git --version\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#12-configuracion-de-git","title":"1.2 Configuraci\u00f3n de Git","text":"<p>Debes establecer tu nombre de usuario y direcci\u00f3n de correo electr\u00f3nico. Esto es importante porque las confirmaciones de cambios <code>(commits)</code> en Git usan esta informaci\u00f3n.</p> <pre><code>    $ git config --global user.name \"John Doe\"\n    $ git config --global user.email johndoe@example.com\n    $ git config --global push.default simple\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#13-configuracion-de-la-clave-ssh","title":"1.3 Configuraci\u00f3n de la clave SSH","text":""},{"location":"Ud1/EGM/cheatsheet/#2-uso-basico-de-git","title":"2 Uso b\u00e1sico de Git","text":""},{"location":"Ud1/EGM/cheatsheet/#21-estados-de-un-archivo-en-git","title":"2.1 Estados de un archivo en GIT","text":"<p>Un archivo puede estar en alguno de los siguientes estados:</p> <ul> <li>Sin seguimiento (untracked)</li> <li>Modificado (modified)</li> <li>Preparado (staged)</li> <li>Confirmado (commited)</li> </ul> <p>Para consultar el estado de los archivos usamos el comando:</p> <pre><code>    $ git status\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#22-crear-un-proyecto","title":"2.2 Crear un proyecto","text":"<ol> <li>Creamos un directorio donde colocar el c\u00f3digo:</li> </ol> <pre><code>    $ mkdir curso-de-git\n    $ cd curso-de-git\n</code></pre> <ol> <li>Creamos un fichero <code>hola.php</code> que muestre Hola Mundo :</li> </ol> <pre><code>&lt;?php\necho \"Hola Mundo\\n\";\n?&gt;\n</code></pre> <ol> <li>Crear el repositorio :</li> </ol> <pre><code>    $ git init\n    Initialized empty Git repository in /home/admin/curso-de-git/.git/\n</code></pre> <p>El archivo <code>hola.php</code> estar\u00e1 en el Workspace o Working Directory.</p> <pre><code>+-------------+  +-------------+  +-------------+  \n|  Working    |  |   Staging   |  |    Local    | \n|  Directory  |  |     Area    |  |  Repository | \n+------+------+  +------+------+  +------+------+ \n        |                |                | \n    hola.php             |                | \n        |                |                | \n        +                +                +\n</code></pre> <ol> <li>A\u00f1adir la aplicaci\u00f3n :</li> </ol> <pre><code>    $ git add hola.php\n    $ git add . (Para a\u00f1adir todos )\n</code></pre> <ol> <li>Comprobar el estado del proyecto :</li> </ol> <pre><code>    $ git status\n</code></pre> <p>Al ejecutar el <code>git add</code>, el archivo pasar\u00e1 a la \"Staging area\" o \u00e1rea de preparaci\u00f3n.</p> <pre><code>+-------------+  +-------------+  +-------------+  \n|  Working    |  |   Staging   |  |    Local    | \n|  Directory  |  |     Area    |  |  Repository | \n+------+------+  +------+------+  +------+------+ \n        |                |                | \n        |             hola.php            |\n        |                |                | \n        +                +                +\n</code></pre> <ol> <li>Hacer un commit :</li> </ol> <pre><code>    $ git commit -m \"Creaci\u00f3n del proyecto\"\n</code></pre> <p>El archivo pasar\u00e1 al \"Local Ropository\" y se le asignar\u00e1 un <code>hash</code> o c\u00f3digo de inserci\u00f3n.</p> <pre><code>+-------------+  +-------------+  +-------------+  \n|  Workspace  |  |   Staging   |  |    Local    | \n|             |  |     Area    |  |  Repository | \n+------+------+  +------+------+  +------+------+ \n        |                |                | \n        |                |             hola.php (e19f2c1)\n        |                |                | \n        +                +                +\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#221-ignorando-archivos","title":"2.2.1 Ignorando archivos","text":"<p>Para indicarle a git que debe ignorar un archivo, se puede crear un fichero llamado <code>.gitignore</code>, bien en la ra\u00edz del proyecto o en los subdirectorios que queramos.</p> <p>Dicho fichero puede contener patrones, uno en cada l\u00ednea, que especiquen qu\u00e9 archivos deben ignorarse. El formato es el siguiente:</p> <pre><code>    # .gitignore\n    dir1/           # ignora todo lo que contenga el directorio dir1\n    !dir1/info.txt  # El operador ! excluye del ignore a dir1/info.txt (s\u00ed se guardar\u00eda)\n    dir2/*.txt      # ignora todos los archivos txt que hay en el directorio dir2\n    dir3/**/*.txt   # ignora todos los archivos txt que hay en el dir3 y sus subdirectorios\n    *.o             # ignora todos los archivos con extensi\u00f3n .o en todos los directorios\n</code></pre> <p>Los archivos que hemos metido en <code>.gitignore</code>, deben ser aquellos ficheros temporales o de configuraci\u00f3n que se pueden crear durante las fases de compilaci\u00f3n o ejecuci\u00f3n del programa</p>"},{"location":"Ud1/EGM/cheatsheet/#222-ignorando-archivos-globalmente","title":"2.2.2 Ignorando archivos globalmente","text":"<p>Ejemplos de lo que se puede ignorar de forma global son los ficheros temporales del sistema operativo <code>(*~, .nfs*)</code> y los que generan los entornos de desarrollo.</p> <p>Para indicar a git que queremos tener un fichero de gitignore global, tenemos que configurarlo con la siguiente orden:</p> <pre><code>    $ git config --global core.excludesfile $HOME/.gitignore_global\n</code></pre> <p>Ahora podemos crear un archivo llamado <code>.gitignore_global</code> en la ra\u00edz de nuestra cuenta con este contenido:</p> <pre><code># Compiled source #\n###################\n*.com\n*.class\n*.dll\n*.exe\n*.o\n*.so\n\n# Packages #\n############\n# it's better to unpack these files and commit the raw source\n# git has its own built in compression methods\n*.7z\n*.dmg\n*.gz\n*.iso\n*.jar\n*.rar\n*.tar\n*.zip\n\n# Logs and databases #\n######################\n*.log\n*.sql\n*.sqlite\n\n# OS generated files #\n######################\n.DS_Store\n.DS_Store?\n._*\n.Spotlight-V100\n.Trashes\nehthumbs.db\nThumbs.db\n*~\n*.swp\n\n# IDEs               #\n######################\n.idea\n.settings/\n.classpath\n.project\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#23-trabajando-con-el-historial","title":"2.3 Trabajando con el historial","text":""},{"location":"Ud1/EGM/cheatsheet/#231-observando-los-cambios","title":"2.3.1 Observando los cambios","text":"<p>Con la orden <code>$git log</code> podemos ver todos los cambios que hemos hecho al directorio <code>curso-de-git</code>.</p> <pre><code>    $ git log\n    commit fd4da946326fbe8b24e89282ad25a71721bf40f6  (HEAD -&gt; master)\n    Author: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\n    Date:   Sun Jun 16 12:51:01 2013 +0200\n\n        Se a\u00f1ade un comentario al cambio del valor por defecto\n\n    commit 3283e0d306c8d42d55ffcb64e456f10510df8177\n    Author: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\n    Date:   Sun Jun 16 12:50:00 2013 +0200\n\n        Se a\u00f1ade un par\u00e1metro por defecto\n\n    commit efc252e11939351505a426a6e1aa5bb7dc1dd7c0\n    Author: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\n    Date:   Sun Jun 16 12:13:26 2013 +0200\n\n        Parametrizaci\u00f3n del programa\n\n    commit e19f2c1701069d9d1159e9ee21acaa1bbc47d264\n    Author: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\n    Date:   Sun Jun 16 11:55:23 2013 +0200\n\n        Creaci\u00f3n del proyecto\n</code></pre> <p>Para salir escribe <code>q</code>.</p>"},{"location":"Ud1/EGM/cheatsheet/#232-versiones-abreviadas","title":"2.3.2 Versiones abreviadas","text":"<pre><code>    $ git log --oneline\n    $ git log --oneline --max-count=2\n    $ git log --oneline --since='5 minutes ago'\n    $ git log --oneline --until='5 minutes ago'\n    $ git log --oneline --author=sergio   # Cambia sergio por tu nombre de usuario\n    $ git log --oneline --all\n    $ git log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#233-crear-alias","title":"2.3.3 Crear alias","text":"<p>Como estas \u00f3rdenes son demasiado largas, Git nos permite crear alias para crear nuevas \u00f3rdenes parametrizadas. </p> <ol> <li>Para ello podemos configurar nuestro entorno con la orden <code>git config</code> de la siguiente manera :</li> </ol> <pre><code>    $ git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"\n</code></pre> <ol> <li>Ahora basta con ejecutar :</li> </ol> <pre><code>    $ git hist\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#234-recuperando-versiones-anteriores","title":"2.3.4 Recuperando versiones anteriores","text":"<ol> <li>Regresar a un commit anterior :</li> </ol> <p>Cada cambio es etiquetado por un <code>hash</code>, para poder regresar a ese momento del estado del proyecto se usa la orden :</p> <pre><code>    $ git checkout \n</code></pre> <p>Prueba con el <code>hash</code> de tu primer commit:</p> <pre><code>    $ git checkout e19f2c1\n    Note: switching to 'e19f2c1'.\n\n    You are in 'detached HEAD' state. You can look around, make experimental\n    changes and commit them, and you can discard any commits you make in this\n    state without impacting any branches by switching back to a branch.\n\n    If you want to create a new branch to retain commits you create, you may\n    do so (now or later) by using -c with the switch command. Example:\n\n    git switch -c &lt;new-branch-name&gt;\n\n    Or undo this operation with:\n\n    git switch -\n\n    urn off this advice by setting config variable advice.detachedHead to false\n\n    HEAD is now at e19f2c1 Parametrizaci\u00f3n del programa   \n</code></pre> <p>Esto pone el repositorio en un estado <code>\"detached HEAD\"</code>, donde puedes explorar o hacer cambios sin afectar ninguna rama.</p> <p>Los cambios que realices en este estado no se guardar\u00e1n a menos que los comites a una nueva rama:</p> <pre><code>    $ git switch -c &lt;nombre-nueva-rama&gt;\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#235-volver-a-la-ultima-rama","title":"2.3.5 Volver a la \u00faltima rama","text":"<p>Si decides no mantener los cambios hechos en el estado <code>\"detached HEAD\"</code>.</p> <p>Puedes volver a la rama en la que estabas antes con:</p> <pre><code>    $ git switch -\n</code></pre> <p>Los cambios no comiteados en el estado <code>\"detached HEAD\"</code> se perder\u00e1n.</p>"},{"location":"Ud1/EGM/cheatsheet/#236-volver-a-la-rama-master","title":"2.3.6 Volver a la rama master","text":"<p>Para regresar a la rama principal <code>(master o main)</code> usa:</p> <pre><code>    $ git checkout master\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#237-etiquetar-versiones","title":"2.3.7 Etiquetar versiones","text":"<p>Listar todas las etiquetas:</p> <pre><code>    $ git tag\n</code></pre> <p>Para facilitar la navegaci\u00f3n y recuperaci\u00f3n de versiones sin usar hashes, puedes etiquetar un commit con un nombre amigable:</p> <pre><code>    $ git tag &lt;nombre-tag&gt;\n</code></pre> <p>Ejemplo:</p> <pre><code>    $ git tag v1\n</code></pre> <p>Para etiquetar un commit anterior, puedes usar:</p> <pre><code>    $ git checkout v1^\n    $ git tag v1-beta\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#238-ver-cambios-entre-versiones","title":"2.3.8 Ver cambios entre versiones","text":"<p>Puedes comparar los cambios entre dos etiquetas o commits con:</p> <pre><code>    $ git diff &lt;version-antigua&gt; &lt;version-nueva&gt;\n</code></pre> <p>Ejemplo:</p> <pre><code>    $ git diff v1-beta v1\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#239-borrar-etiquetas","title":"2.3.9 Borrar etiquetas","text":"<p>Si necesitas eliminar una etiqueta:</p> <pre><code>    $ git tag -d &lt;nombre-etiqueta&gt;\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#2310-visualizar-el-historial-con-etiquetas","title":"2.3.10 Visualizar el historial con etiquetas","text":"<p>Para ver el historial del proyecto junto con las etiquetas:</p> <pre><code>    $ git hist master --all\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#3-uso-avanzado-de-git","title":"3 Uso avanzado de Git","text":""},{"location":"Ud1/EGM/cheatsheet/#31-deshacer-cambios","title":"3.1  Deshacer cambios","text":""},{"location":"Ud1/EGM/cheatsheet/#311-deshaciendo-cambios-antes-de-la-fase-de-staging","title":"3.1.1 Deshaciendo cambios antes de la fase de staging","text":"<ol> <li>Volvemos a la rama m\u00e1ster y vamos a modificar el comentario que pusimos:</li> </ol> <pre><code>    $ git checkout master\n    Previous HEAD position was 3283e0d... Se a\u00f1ade un par\u00e1metro por defecto\n    Switched to branch 'master'\n</code></pre> <p>Recordamos, la situaci\u00f3n es la siguiente:</p> <pre><code>+-------------+  +-------------+  +-------------+  \n|  Working    |  |   Staging   |  |    Local    | \n|  Directory  |  |     Area    |  |  Repository | \n+------+------+  +------+------+  +------+------+ \n       |                |                |\n       |                |             hola.php (fd4da94) tag: v1 \n       |                |             hola.php (3283e0d) tag: v1-beta  \n       |                |             hola.php (efc252e)\n       |                |             hola.php (e19f2c1) \n       |                |                | \n       +                +                +\n</code></pre> <ol> <li>Modificamos <code>hola.php</code> de la siguiente manera :</li> </ol> <pre><code>&lt;?php\n// Este comentario est\u00e1 mal y hay que borrarlo\n$nombre = isset($argv[1]) ? $argv[1] : \"Mundo\";\n@print \"Hola, {$nombre}\\n\";\n?&gt;\n</code></pre> <ol> <li>Comprobamos el estado :</li> </ol> <pre><code>    $ git status\n    On branch master\n    Changes not staged for commit:\n      (use \"git add &lt;file&gt;...\" to update what will be committed)\n      (use \"git restore &lt;file&gt;...\" to discard changes in working directory)\n\n       modified:   hola.php\n\n    no changes added to commit (use \"git add\" and/or \"git commit -a\")\n</code></pre> <p>Tenemos hola.php en Working Directory y nada en Staging Area.</p> <pre><code>+-------------+  +-------------+  +-------------+  \n|  Working    |  |   Staging   |  |    Local    | \n|  Directory  |  |     Area    |  |  Repository | \n+------+------+  +------+------+  +------+------+ \n       |                |                |\n    hola.php            |                |\n       |                |             hola.php (fd4da94) tag: v1 \n       |                |             hola.php (3283e0d) tag: v1-beta  \n       |                |             hola.php (efc252e)\n       |                |             hola.php (e19f2c1) \n       |                |                | \n       +                +                +\n</code></pre> <ol> <li>El mismo Git nos indica que debemos hacer para a\u00f1adir los cambios o para deshacerlos. </li> </ol> <p>En este caso los desharemos :</p> <pre><code>    $ git restore hola.php\n\n    $ git status\n    On branch master\n    nothing to commit, working tree clean\n\n    $ cat hola.php\n    &lt;?php\n    // El nombre por defecto es Mundo\n    $nombre = isset($argv[1]) ? $argv[1] : \"Mundo\";\n    @print \"Hola, {$nombre}\\n\";\n    ?&gt;\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#312-deshaciendo-cambios-antes-del-commit","title":"3.1.2 Deshaciendo cambios antes del commit","text":"<p>Vamos a hacer lo mismo que la vez anterior, pero esta vez s\u00ed a\u00f1adiremos el cambio al <code>staging</code> (sin hacer <code>commit</code>).</p> <ol> <li>Volvemos a modificar <code>hola.php</code> igual que la anterior ocasi\u00f3n :</li> </ol> <pre><code>&lt;?php\n// Este comentario est\u00e1 mal y hay que borrarlo\n$nombre = isset($argv[1]) ? $argv[1] : \"Mundo\";\n@print \"Hola, {$nombre}\\n\";\n?&gt;\n</code></pre> <ol> <li>Lo a\u00f1adimos al <code>staging</code> :</li> </ol> <p><pre><code>    $ git add hola.php\n\n    $ git status\n    On branch master\n    Changes to be committed:\n      (use \"git restore --staged &lt;file&gt;...\" to unstage)\n\n       modified:   hola.php\n</code></pre> Ahora tenemos una nueva versi\u00f3n de <code>hola.php</code> en Staging Area.</p> <pre><code>+-------------+  +-------------+  +-------------+  \n|  Working    |  |   Staging   |  |    Local    | \n|  Directory  |  |     Area    |  |  Repository | \n+------+------+  +------+------+  +------+------+ \n       |                |                |\n       |             hola.php            |\n       |                |             hola.php (fd4da94) tag: v1 \n       |                |             hola.php (3283e0d) tag: v1-beta  \n       |                |             hola.php (efc252e)\n       |                |             hola.php (e19f2c1) \n       |                |                | \n       +                +                +\n</code></pre> <ol> <li>Sacamos el archivo de la zona de Staging :</li> </ol> <pre><code>    $ git restore --staged hola.php\n\n    $ git status\n    On branch master\n    Changes not staged for commit:\n      (use \"git add &lt;file&gt;...\" to update what will be committed)\n      (use \"git restore &lt;file&gt;...\" to discard changes in working directory)\n\n       modified:   hola.php\n\n    no changes added to commit (use \"git add\" and/or \"git commit -a\")\n</code></pre> <p>Vuelve a estar en Working Directory.</p> <pre><code>+-------------+  +-------------+  +-------------+  \n|  Working    |  |   Staging   |  |    Local    | \n|  Directory  |  |     Area    |  |  Repository | \n+------+------+  +------+------+  +------+------+ \n       |                |                |\n    hola.php            |                |\n       |                |             hola.php (fd4da94) tag: v1 \n       |                |             hola.php (3283e0d) tag: v1-beta  \n       |                |             hola.php (efc252e)\n       |                |             hola.php (e19f2c1) \n       |                |                | \n       +                +                +\n</code></pre> <ol> <li>Restaruramos la \u00faltima versi\u00f3n en Local Repository, eliminando la versi\u00f3n en Working Directory :</li> </ol> <pre><code>  $ git restore hola.php\n</code></pre> <p>Y ya tenemos nuestro repositorio limpio otra vez.</p> <p>Como vemos hay que hacerlo en dos pasos:</p> <ul> <li>Uno para pasar el fichero de Staging Area a Working Directory y limpiar as\u00ed la Staging Area.</li> <li>Otro para descartar los cambios en Working Directory.</li> </ul>"},{"location":"Ud1/EGM/cheatsheet/#313-deshaciendo-commits-no-deseados","title":"3.1.3 Deshaciendo commits no deseados","text":"<p>Si hemos hecho un commit y queremos deshacerlo, podemos usar la orden <code>$ git revert</code> :</p> <p><pre><code>    $ git revert HEAD --no-edit\n    [master 817407b] Revert \"Ups... este commit est\u00e1 mal\"\n    1 file changed, 1 insertion(+), 1 deletion(-)\n</code></pre> Explicaci\u00f3n del comando:</p> <ul> <li>git revert HEAD: Reviertes el \u00faltimo commit (el que apunta HEAD). Esto crea un nuevo commit que deshace los cambios realizados en ese commit.</li> <li>--no-edit: Este par\u00e1metro le indica a Git que use el mensaje de commit por defecto que genera autom\u00e1ticamente (algo como \"Revert 'mensaje original del commit'\") y no abra el editor para modificarlo.</li> </ul> <pre><code>    $ git hist\n    * 817407b 2013-06-16 | Revert \"Ups... este commit est\u00e1 mal\" (HEAD -&gt; master) [Sergio G\u00f3mez]\n    * 5a5d067 2013-06-16 | Ups... este commit est\u00e1 mal [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#314-borrar-commits-de-una-rama","title":"3.1.4 Borrar commits de una rama","text":"<p>Para borrar commits y no dejar huella en el historial, utilizamos <code>$ git reset</code> :</p> <pre><code>    $ git reset --hard &lt;nombre-o-hash-del-commit&gt;\n    $ git reset --hard v1\n    HEAD is now at fd4da94 Se a\u00f1ade un comentario al cambio del valor por defecto\n\n    $ git hist\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (HEAD -&gt; master, tag: v1) [Sergio G\u00f3me\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre> <p>Danger</p> <p>La orden reset es una operaci\u00f3n delicada. Debe evitarse si no se sabe bien lo que se est\u00e1 haciendo, sobre todo cuando se trabaja en repositorios compartidos, porque podr\u00edamos alterar la historia de cambios lo cual puede provocar problemas de sincronizaci\u00f3n.</p>"},{"location":"Ud1/EGM/cheatsheet/#315-modificar-un-commit","title":"3.1.5 Modificar un commit","text":"<p>Si olvidaste a\u00f1adir un cambio a un commit reciente, puedes modificar el \u00faltimo commit.</p> <ol> <li>Volvemos a modificar nuestro archivo :</li> </ol> <pre><code>&lt;?php\n// Autor: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\n// El nombre por defecto es Mundo\n$nombre = isset($argv[1]) ? $argv[1] : \"Mundo\";\n@print \"Hola, {$nombre}\\n\";\n?&gt;\n</code></pre> <ol> <li>Usamos <code>commit --amend</code> que nos permite modificar el \u00faltimo estado confirmado, sustituy\u00e9ndolo por el estado actual :</li> </ol> <pre><code>    $ git add hola.php\n\n    $ git commit --amend -m \"A\u00f1adido el autor del programa y su email\"\n    [master 96a39df] A\u00f1adido el autor del programa y su email\n     1 file changed, 1 insertion(+)\n\n    $ git hist\n    * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email (HEAD -&gt; master) [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre> <p>Danger</p> <p>Nunca modifiques un commit que ya hayas sincronizado con otro repositorio o que hayas recibido de \u00e9l. Estar\u00edas alterando la historia de cambios y provocar\u00edas problemas de sincronizaci\u00f3n.</p>"},{"location":"Ud1/EGM/cheatsheet/#32-moviendo-y-borrando-archivos","title":"3.2  Moviendo y borrando archivos","text":""},{"location":"Ud1/EGM/cheatsheet/#321-mover-un-archivo-a-otro-directorio-con-git","title":"3.2.1 Mover un archivo a otro directorio con git","text":"<p>Para mover archivos usaremos la orden <code>$ git mv</code>:</p> <pre><code>    $ mkdir lib\n\n    $ git mv hola.php lib\n\n    $ git status\n    On branch master\n    Changes to be committed:\n      (use \"git reset HEAD &lt;file&gt;...\" to unstage)\n\n      renamed:    hola.php -&gt; lib/hola.php\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#322-borrar-archivos","title":"3.2.2 Borrar archivos","text":"<ol> <li>Borrar un archivo :</li> </ol> <pre><code>    $ git rm hola.php\n</code></pre> <ol> <li>Guardar los cambios :</li> </ol> <pre><code>    $ git commit -m \"Movido hola.php a lib.\"\n    [master 8c2a509] Movido hola.php a lib.\n     1 file changed, 0 insertions(+), 0 deletions(-)\n     rename hola.php =&gt; lib/hola.php (100%)\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#4-ramas","title":"4 Ramas","text":""},{"location":"Ud1/EGM/cheatsheet/#41-administracion-de-ramas","title":"4.1 Administraci\u00f3n de ramas","text":""},{"location":"Ud1/EGM/cheatsheet/#411-crear-una-nueva-rama","title":"4.1.1 Crear una nueva rama","text":"<p>Es conveniente trabajar en una nueva rama, para no modificar la rama principal y dejarla inestable. </p> <p>Aunque la orden para manejar ramas es <code>$ git branch</code> podemos usar tambi\u00e9n <code>$ git checkout</code>.</p> <ol> <li>Crear una nueva rama :</li> </ol> <pre><code>    $ git branch hola\n</code></pre> <p>Info</p> <p>Si usamos <code>git branch</code> sin ning\u00fan argumento, nos devolver\u00e1 la lista de ramas disponibles.</p> <ol> <li>La creaci\u00f3n de una rama no cambia autom\u00e1ticamente a esa rama, por lo que debemos cambiar con :</li> </ol> <pre><code>  $ git checkout hola\n    Switched to branch 'hola'\n</code></pre> <p>Tip</p> <p>Puedes hacer ambas acciones en un solo paso :      * Con el par\u00e1metro <code>-b</code> de <code>git checkout</code> podemos cambiarnos a una rama que, si no existe, se crea instant\u00e1neamente.</p> <pre><code>    $ git checkout -b hola\n    Switched to a new branch 'hola'\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#412-modificaciones-en-la-rama-secundaria","title":"4.1.2 Modificaciones en la rama secundaria","text":"<ol> <li>A\u00f1adimos un nuevo archivo en el directorio <code>lib</code> llamado <code>HolaMundo.php</code> :</li> </ol> <pre><code>&lt;?php\n\nclass HolaMundo\n{\n   private $nombre;\n\n   function __construct($nombre)\n   {\n      $this-&gt;nombre = $nombre;\n   }\n\n   function __toString()\n   {\n      return sprintf (\"Hola, %s.\\n\", $this-&gt;nombre);\n   }\n}\n?&gt;\n</code></pre> <ol> <li>Modificamos <code>hola.php</code> :</li> </ol> <pre><code>&lt;?php\n// Autor: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\n// El nombre por defecto es Mundo\nrequire('HolaMundo.php');\n\n$nombre = isset($argv[1]) ? $argv[1] : \"Mundo\";\nprint new HolaMundo($nombre);\n?&gt;\n</code></pre> <ol> <li>Hacemos commit de los cambios uno por uno :</li> </ol> <pre><code>    $ git add lib/HolaMundo.php\n    $ git commit -m \"A\u00f1adida la clase HolaMundo\"\n\n    $ git add lib/hola.php\n    $ git commit -m \"hola usa la clase HolaMundo\"\n</code></pre> <ol> <li>Y con la orden <code>git checkout</code> podemos movernos entre ramas :</li> </ol> <pre><code>    $ git checkout master\n    Switched to branch 'master'\n\n    $ git checkout hola\n    Switched to branch 'hola'\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#413-modificaciones-en-la-rama-master","title":"4.1.3 Modificaciones en la rama master","text":"<ol> <li>Cambiamos a la rama <code>master</code> :</li> </ol> <pre><code>    $ git checkout master\n</code></pre> <ol> <li>A\u00f1adimos un archivo <code>README.md</code> :</li> </ol> <pre><code>    $ echo \"# Curso de GIT\" &gt; README.md\n    $ git add README.md\n    $ git commit -m \"A\u00f1adido README.md\"\n</code></pre> <ol> <li>Podemos visualizar todos los cambios en todas las ramas usando :</li> </ol> <pre><code>    $ git hist --all\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#42-fusion-de-ramas-y-resolucion-de-conflictos","title":"4.2 Fusi\u00f3n de ramas y resoluci\u00f3n de conflictos","text":""},{"location":"Ud1/EGM/cheatsheet/#421-mezclar-ramas","title":"4.2.1 Mezclar ramas","text":"<p>Podemos fusionar los cambios de una rama con otra usando <code>$git merge</code>.</p> <p>Por ejemplo, fusionamos los cambios de <code>master</code> en la rama <code>hola</code> :</p> <ol> <li>Cambiamos a la rama <code>hola</code> :</li> </ol> <pre><code>  $ git checkout hola\n    Switched to branch 'hola'\n</code></pre> <ol> <li>Ejecutamos el <code>$git merge nombrerama</code> con el nombre de la rama cuyos cambios queremos incorporar a la actual :</li> </ol> <pre><code> $ git merge master\n    Merge made by the 'ort' strategy.\n     README.md | 3 +++\n     1 file changed, 3 insertions(+)\n     create mode 100644 README.md\n</code></pre> <ol> <li>Comprobamos el historial de cambios :</li> </ol> <pre><code> $ git hist --all\n    *   9c6ac06 2013-06-16 | Merge branch 'master' into hola (HEAD -&gt; hola) [Sergio G\u00f3mez]\n    |\\\n    | * c3e65d0 2013-06-16 | A\u00f1adido README.md [Sergio G\u00f3mez]\n    * | 9862f33 2013-06-16 | hola usa la clase HolaMundo [Sergio G\u00f3mez]\n    * | 6932156 2013-06-16 | A\u00f1adida la clase HolaMundo [Sergio G\u00f3mez]\n    |/\n    * 81c6e93 2013-06-16 | Movido hola.php a lib [Sergio G\u00f3mez]\n    * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre> <p>De esa forma se puede trabajar en una rama secundaria incorporando los cambios de la rama principal o de otra rama.</p>"},{"location":"Ud1/EGM/cheatsheet/#422-resolver-conflictos","title":"4.2.2 Resolver conflictos","text":"<p>Un conflicto es cuando se produce una fusi\u00f3n que Git no es capaz de resolver.</p> <p>Vamos a modificar la rama <code>master</code> para crear uno con la rama <code>hola</code>:</p> <ol> <li>Cambiamos a <code>master</code> :</li> </ol> <pre><code> $ git checkout master\n    Switched to branch 'master'\n</code></pre> <ol> <li>Modificamos nuestro archivo <code>hola.php</code> :</li> </ol> <pre><code>&lt;?php\n// Autor: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\nprint \"Introduce tu nombre:\";\n$nombre = trim(fgets(STDIN));\n@print \"Hola, {$nombre}\\n\";\n?&gt;\n</code></pre> <ol> <li>Guardamos los cambios :</li> </ol> <pre><code>    $ git add lib/hola.php\n\n    $ git commit -m \"Programa interactivo\"\n    [master 9c85275] Programa interactivo\n     1 file changed, 2 insertions(+), 2 deletions(-)\n\n    $ git hist --all\n</code></pre> <ol> <li>Comprobamos el resultado :</li> </ol> <pre><code> $ git hist --all\n    * 8ca56f7 2013-06-16 | Programa interactivo (HEAD -&gt; master) [Sergio G\u00f3mez]\n    | *   9c6ac06 2013-06-16 | Merge branch 'master' into hola (hola) [Sergio G\u00f3mez]\n    | |\\  \n    | |/  \n    |/| \n    * | c3e65d0 2013-06-16 | A\u00f1adido README.md [Sergio G\u00f3mez]\n    | * 9862f33 2013-06-16 | hola usa la clase HolaMundo [Sergio G\u00f3mez]\n    | * 6932156 2013-06-16 | A\u00f1adida la clase HolaMundo [Sergio G\u00f3mez]\n    |/\n    * 81c6e93 2013-06-16 | Movido hola.php a lib [Sergio G\u00f3mez]\n    * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre> <ol> <li>Volvemos a la rama <code>hola</code> : </li> </ol> <pre><code>  $ git checkout hola\n    Switched to branch 'hola'\n</code></pre> <ol> <li>Fusionamos. </li> </ol> <pre><code>  $ git merge master\n    Auto-merging lib/hola.php\n    CONFLICT (content): Merge conflict in lib/hola.php\n    Automatic merge failed; fix conflicts and then commit the result.\n</code></pre> <p>Recuerda que hemos modificado hola.php en la rama <code>master</code> y ahora hay l\u00edneas distintas dentro de ese fichero en cada una de las ramas.</p> <ol> <li>Editamos nuestro archivo <code>lib/hola.php</code> y obtendremos algo similar a esto :</li> </ol> <pre><code>&lt;?php\n// Autor: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\n&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\n// El nombre por defecto es Mundo\nrequire('HolaMundo.php');\n\n$nombre = isset($argv[1]) ? $argv[1] : \"Mundo\";\nprint new HolaMundo($nombre);\n=======\nprint \"Introduce tu nombre:\";\n$nombre = trim(fgets(STDIN));\n@print \"Hola, {$nombre}\\n\";\n&gt;&gt;&gt;&gt;&gt;&gt;&gt; master\n?&gt;\n</code></pre> <ol> <li>Resolvemos el conflicto, dejando el archivo como sigue :</li> </ol> <pre><code>&lt;?php\n// Autor: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\nrequire('HolaMundo.php');\n\nprint \"Introduce tu nombre:\";\n$nombre = trim(fgets(STDIN));\nprint new HolaMundo($nombre);\n?&gt;\n</code></pre> <ol> <li>Confirmamos los cambios :</li> </ol> <pre><code>    $ git add lib/hola.php\n    $ git commit -m \"Solucionado el conflicto al fusionar con la rama master\"\n    [hola a36af04] Solucionado el conflicto al fusionar con la rama master\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#423-rebasing-vs-merging","title":"4.2.3 Rebasing vs Merging","text":""},{"location":"Ud1/EGM/cheatsheet/#4231-rebasing","title":"4.2.3.1 Rebasing","text":"<p>Rebasing es otra t\u00e9cnica para fusionar distinta a merge y usa la orden <code>$git rebase</code> : </p> <pre><code>El rebase Vuelve a aplicar todos los cambios a la rama m\u00e1ster, desde su nodo m\u00e1s reciente.\nEso significa que se modifica el orden o la historia de creaci\u00f3n de los cambios. \nPor eso rebase no debe usarse si el orden es importante o si la rama es compartida.\n</code></pre> <ol> <li>Vamos a dejar nuestro proyecto como estaba antes del fusionado.</li> </ol> <pre><code>    $ git checkout hola\n    Switched to branch 'hola'\n\n    $ git hist\n    *   a36af04 2013-06-16 | Solucionado el conflicto al fusionar con la rama master (HEAD -&gt; hola) [Sergio G\u00f3mez]\n    |\\\n    | * 9c85275 2013-06-16 | Programa interactivo (master) [Sergio G\u00f3mez]\n    * | 9c6ac06 2013-06-16 | Merge branch 'master' into hola [Sergio G\u00f3mez]\n    |\\|\n    | * c3e65d0 2013-06-16 | A\u00f1adido README.md [Sergio G\u00f3mez]\n    * | 9862f33 2013-06-16 | hola usa la clase HolaMundo [Sergio G\u00f3mez]\n    * | 6932156 2013-06-16 | A\u00f1adida la clase HolaMundo [Sergio G\u00f3mez]\n    |/\n    * 81c6e93 2013-06-16 | Movido hola.php a lib [Sergio G\u00f3mez]\n    * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre> <p>Para ello podemos usar la orden <code>git reset</code> que nos permite mover HEAD donde queramos.</p> <pre><code>    $ git reset --hard 9862f33\n    HEAD is now at 9862f33 hola usa la clase HolaMundo\n</code></pre> <ol> <li>El estado despu\u00e9s de deshacer los <code>merge</code>:</li> </ol> <pre><code> $ git hist --all\n    * 9862f33 2013-06-16 | hola usa la clase HolaMundo (HEAD, hola) [Sergio G\u00f3mez]\n    * 6932156 2013-06-16 | A\u00f1adida la clase HolaMundo [Sergio G\u00f3mez]\n    | * 9c85275 2013-06-16 | Programa interactivo (master) [Sergio G\u00f3mez]\n    | * c3e65d0 2013-06-16 | A\u00f1adido README.md [Sergio G\u00f3mez]\n    |/\n    * 81c6e93 2013-06-16 | Movido hola.php a lib [Sergio G\u00f3mez]\n    * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre> <ol> <li>Vamos a hacer un rebase. Continuamos en la rama <code>hola</code> y ejecutamos lo siguiente :</li> </ol> <pre><code> $ git rebase master\n    Auto-merging lib/hola.php\n    CONFLICT (content): Merge conflict in lib/hola.php\n    error: could not apply 9862f33... hola usa la clase HolaMundo\n    hint: Resolve all conflicts manually, mark them as resolved with\n    hint: \"git add/rm &lt;conflicted_files&gt;\", then run \"git rebase --continue\".\n    hint: You can instead skip this commit: run \"git rebase --skip\".\n    hint: To abort and get back to the state before \"git rebase\", run \"git rebase --abort\".\n    Could not apply 9862f33... hola usa la clase HolaMundo\n</code></pre> <ol> <li>Resolvemos el conflicto del archivo <code>hola.php</code> :</li> </ol> <pre><code>&lt;?php\n// Autor: Sergio G\u00f3mez &lt;sergio@uco.es&gt;\nrequire('HolaMundo.php');\n\nprint \"Introduce tu nombre:\";\n$nombre = trim(fgets(STDIN));\nprint new HolaMundo($nombre);\n?&gt;\n</code></pre> <ol> <li>A\u00f1adimos los cambios en <code>staging</code> : </li> </ol> <pre><code>  $ git add lib/hola.php\n    $ git status\n    interactive rebase in progress; onto 269eaca\n    Last commands done (2 commands done):\n        pick 4e0f425 A\u00f1adida clase HolaMundo\n        pick 9862f33 hola usa la clase HolaMundo\n    No commands remaining.\n    You are currently rebasing branch 'hola' on '8ca56f7'.\n        (all conflicts fixed: run \"git rebase --continue\")\n\n    Changes to be committed:\n        (use \"git restore --staged &lt;file&gt;...\" to unstage)\n            modified:   lib/hola.php  \n</code></pre> <ol> <li>En esta ocasi\u00f3n, no tenemos que hacer <code>$git commit</code>, sino continuar con el <code>rebase</code> :</li> </ol> <pre><code> $ git rebase --continue\n    [detached HEAD 9862f33] hola usa la clase HolaMundo\n    1 file changed, 3 insertions(+), 1 deletion(-)\n    Successfully rebased and updated refs/heads/hola.\n</code></pre> <ol> <li>El \u00e1rbol tiene un aspecto distinto y mucho m\u00e1s limpio :</li> </ol> <pre><code> $ git hist --all\n    * 9862f33 2013-06-16 | hola usa la clase HolaMundo (HEAD -&gt; hola) [Sergio G\u00f3mez]\n    * 6932156 2013-06-16 | A\u00f1adida la clase HolaMundo [Sergio G\u00f3mez]\n    * 9c85275 2013-06-16 | Programa interactivo (master) [Sergio G\u00f3mez]\n    * c3e65d0 2013-06-16 | A\u00f1adido README.md [Sergio G\u00f3mez]\n    * 81c6e93 2013-06-16 | Movido hola.php a lib [Sergio G\u00f3mez]\n    * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#43-mezclando-con-la-rama-master","title":"4.3 Mezclando con la rama master","text":"<p>Una vez hemos terminado de implementar los cambios en la rama secundaria, llevamos los cambios a la rama principal.</p> <ol> <li>Cambiamos a la rama <code>master</code> :</li> </ol> <pre><code> $ git checkout master\n    Switched to branch 'master'\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#431-merge-fast-forward","title":"4.3.1 Merge fast-forward","text":"<ol> <li>Usamos <code>git merge</code> de tipo <code>fast-forward</code> para hacer una fusi\u00f3n normal y que no deja rastro :</li> </ol> <pre><code>$ git merge hola\n    Updating c3e65d0..491f1d2\n    Fast-forward\n     lib/HolaMundo.php | 16 ++++++++++++++++\n     lib/hola.php      |  4 +++-\n     2 files changed, 19 insertions(+), 1 deletion(-)\n     create mode 100644 lib/HolaMundo.php\n</code></pre> <ol> <li>Comprobamos el \u00e1rbol :</li> </ol> <pre><code>$ git hist --all\n     * 9862f33 2013-06-16 | hola usa la clase HolaMundo (HEAD -&gt; master, hola) [Sergio G\u00f3mez]\n     * 6932156 2013-06-16 | A\u00f1adida la clase HolaMundo [Sergio G\u00f3mez]\n     * 9c85275 2013-06-16 | Programa interactivo [Sergio G\u00f3mez]\n     * c3e65d0 2013-06-16 | A\u00f1adido README.md [Sergio G\u00f3mez]\n     * 81c6e93 2013-06-16 | Movido hola.php a lib [Sergio G\u00f3mez]\n     * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email [Sergio G\u00f3mez]\n     * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n     * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n     * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n     * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#432-merge-no-fast-forward-no-ff","title":"4.3.2 Merge --no-fast-forward (--no-ff)","text":"<ol> <li>Reseteamos <code>master</code> al estado <code>\"Programa interactivo\"</code> :</li> </ol> <pre><code>$ git reset --hard 9c85275\n</code></pre> <ol> <li>Comprobamos el \u00e1rbol :</li> </ol> <pre><code> $ git hist\n    * 9c85275 2013-06-16 | Programa interactivo (master) [Sergio G\u00f3mez]\n    * c3e65d0 2013-06-16 | A\u00f1adido README.md [Sergio G\u00f3mez]\n    * 81c6e93 2013-06-16 | Movido hola.php a lib [Sergio G\u00f3mez]\n    * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre> <ol> <li>Usamos <code>git merge</code> de tipo <code>--no-fast-forward</code> (<code>--no-ff</code>) para hacer una fusi\u00f3n que deja rastro de las dos ramas :</li> </ol> <pre><code>$ git merge -m \"Aplicando los cambios de la rama hola\" --no-ff hola\n    Merge made by the 'recursive' strategy.\n     lib/HolaMundo.php | 16 ++++++++++++++++\n     lib/hola.php      |  4 +++-\n     2 files changed, 19 insertions(+), 1 deletion(-)\n     create mode 100644 lib/HolaMundo.php\n</code></pre> <ol> <li>Comprobamos el \u00e1rbol :</li> </ol> <pre><code> $ git hist --all\n    *   2eab8ca 2013-06-16 | Aplicando los cambios de la rama hola (HEAD -&gt; master) [Sergio Gomez]\n    *\\\n    | * 9862f33 2013-06-16 | hola usa la clase HolaMundo (hola) [Sergio G\u00f3mez]\n    | * 6932156 2013-06-16 | A\u00f1adida la clase HolaMundo [Sergio G\u00f3mez]\n    |/\n    * 9c85275 2013-06-16 | Programa interactivo (master) [Sergio G\u00f3mez]\n    * c3e65d0 2013-06-16 | A\u00f1adido README.md [Sergio G\u00f3mez]\n    * 81c6e93 2013-06-16 | Movido hola.php a lib [Sergio G\u00f3mez]\n    * 96a39df 2013-06-16 | A\u00f1adido el autor del programa y su email [Sergio G\u00f3mez]\n    * fd4da94 2013-06-16 | Se a\u00f1ade un comentario al cambio del valor por defecto (tag: v1) [Sergio G\u00f3mez]\n    * 3283e0d 2013-06-16 | Se a\u00f1ade un par\u00e1metro por defecto (tag: v1-beta) [Sergio G\u00f3mez]\n    * efc252e 2013-06-16 | Parametrizaci\u00f3n del programa [Sergio G\u00f3mez]\n    * e19f2c1 2013-06-16 | Creaci\u00f3n del proyecto [Sergio G\u00f3mez]\n</code></pre> <p>En la siguiente imagen se puede ver la diferencia:</p> <p></p>"},{"location":"Ud1/EGM/cheatsheet/#5-github","title":"5 Github","text":""},{"location":"Ud1/EGM/cheatsheet/#51-tu-clave-publicaprivada","title":"5.1 Tu clave p\u00fablica/privada","text":"<p>Muchos servidores Git utilizan autenticaci\u00f3n mediante claves SSH. Para generar una nueva clave:</p> <pre><code>$ ssh-keygen -t rsa -C \"Cuenta GitHub\"\n</code></pre> <p>Esta clave se almacenar\u00e1 en tu sistema para permitir la autenticaci\u00f3n con repositorios remotos. Aseg\u00farate de no compartir la clave privada con nadie, ya que esta es tu identificador ante los servidores.</p>"},{"location":"Ud1/EGM/cheatsheet/#52-configuracion","title":"5.2 Configuraci\u00f3n","text":"<p>Agrega tu clave SSH generada anteriormente en GitHub:</p> <ol> <li>Ve a Settings en tu perfil de GitHub.</li> <li>Selecciona SSH and GPG Keys.</li> <li>A\u00f1ade una nueva clave copiando el contenido de <code>~/.ssh/id_rsa.pub</code> y pega en el campo Key.</li> <li>Dale un nombre a la clave en Title y guarda.</li> </ol>"},{"location":"Ud1/EGM/cheatsheet/#53-crear-un-repositorio","title":"5.3 Crear un repositorio","text":"<p>Para crear un repositorio en GitHub:</p> <ol> <li>Haz clic en el signo <code>+</code> en la barra superior y selecciona New repository.</li> <li>Dale un nombre, por ejemplo: <code>taller-de-git</code>.</li> <li>Para sincronizar un repositorio existente en tu equipo:</li> </ol> <pre><code>Copiar c\u00f3digo\n$ git remote add origin git@github.com:usuario/taller-de-git.git\n$ git branch -M main\n$ git push -u origin main\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#54-clonar-un-repositorio","title":"5.4 Clonar un repositorio","text":"<p>Para clonar un repositorio desde GitHub en tu equipo local:</p> <pre><code>$ git clone git@github.com:usuario/taller-de-git.git\n$ cd taller-de-git\n</code></pre> <p>Este comando descarga todos los archivos del repositorio y te permite comenzar a trabajar con ellos en tu equipo.</p>"},{"location":"Ud1/EGM/cheatsheet/#55-ramas-remotas","title":"5.5 Ramas remotas","text":"<p>Podemos ver las ramas remotas para comprobar la sincronizaci\u00f3n de nuestro repositorio local con el remoto. Usa el comando:</p> <pre><code>    $ git remote show origin\n    * remote origin\n      Fetch URL: git@github.com:sgomez/taller-de-git.git\n      Push  URL: git@github.com:sgomez/taller-de-git.git\n      HEAD branch: main\n      Remote branch:\n        main tracked\n      Local ref configured for 'git push':\n        main pushes to main (up to date)\n</code></pre> <p>Te mostrar\u00e1 informaci\u00f3n sobre fetch (para traer cambios) y push (para enviar cambios). La rama principal se suele llamar <code>origin/main</code>.</p>"},{"location":"Ud1/EGM/cheatsheet/#56-enviando-actualizaciones","title":"5.6 Enviando actualizaciones","text":"<p>Cuando realizas cambios en tu repositorio local, aseg\u00farate de enviarlos a GitHub:</p> <pre><code>$ git add archivo\n$ git commit -m \"Descripci\u00f3n del cambio\"\n$ git push\n</code></pre> <p>Si necesitas vincular la rama local con una remota, utiliza:</p> <pre><code>$ git push -u origin main\n</code></pre> <p>Esto facilita futuros push sin tener que especificar el origen.</p>"},{"location":"Ud1/EGM/cheatsheet/#57-recibiendo-actualizaciones","title":"5.7 Recibiendo actualizaciones","text":"<p>Para actualizar tu repositorio local con los \u00faltimos cambios hechos en GitHub:</p> <ol> <li>Trae la informaci\u00f3n de los cambios realizados en GitHub con <code>git fetch</code>, pero no importa directamente los cambios en local.</li> </ol> <pre><code>$ git fetch\n</code></pre> <ol> <li>Incorporar los cambios de la rama remota en la local, usando <code>git merge</code> o <code>git rebase</code>.</li> </ol> <pre><code>$ git merge origin/main\n</code></pre> <p>Tambi\u00e9n puedes combinar ambos pasos con <code>git pull</code> que realiza las dos acciones simult\u00e1neamente :</p> <pre><code>$ git pull\nremote: Enumerating objects: 5, done.\nremote: Counting objects: 100% (5/5), done.\nremote: Compressing objects: 100% (3/3), done.\nremote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0\nUnpacking objects: 100% (3/3), 811 bytes | 811.00 KiB/s, done.\nFrom github.com:sgomez/taller-de-git\n   cbaf831..d8922e4  main     -&gt; origin/main\nUpdating 6e4cda3..bb3dc3e\nFast-forward\n README.md | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#58-problemas-de-sincronizacion","title":"5.8 Problemas de sincronizaci\u00f3n","text":""},{"location":"Ud1/EGM/cheatsheet/#581-no-puedo-hacer-push","title":"5.8.1 No puedo hacer push","text":"<p>Al intentar subir cambios nos podemos encontrar un mensaje como este:</p> <pre><code>$ git push\ngit push\nTo git@github.com:sgomez/taller-de-git.git\n ! [rejected]        main -&gt; main (fetch first)\nerror: failed to push some refs to 'git@github.com:sgomez/taller-de-git.git'\nhint: Updates were rejected because the remote contains work that you do\nhint: not have locally. This is usually caused by another repository pushing\nhint: to the same ref. You may want to first integrate the remote changes\nhint: (e.g., 'git pull ...') before pushing again.\nhint: See the 'Note about fast-forwards' in 'git push --help' for details.\n</code></pre> <p>La causa es que el repositorio remoto tambi\u00e9n se ha actualizado y nosotros a\u00fan no hemos recibido esos cambios. Es decir, ambos repositorios se han actualizado y el remoto tiene preferencia. Hay un conflicto en ciernes y se debe resolver localmente antes de continuar.</p> <ol> <li>Trae los cambios y resuelve las diferencias de los archivos :</li> </ol> <pre><code>$ git fetch\n</code></pre> <ol> <li>Aplicas tus commits por encima de los cambios tra\u00eddos. Si hay conflictos, tendr\u00e1s que resolverlos antes de continuar :</li> </ol> <pre><code>$ git rebase origin/main\n</code></pre> <ol> <li>Una vez resueltos los conflictos, puedes finalizar el rebase con :</li> </ol> <pre><code>$ git rebase --continue\n</code></pre> <ol> <li>Finalmente, cuando el rebase haya terminado y todos los conflictos se hayan resuelto, ya puedes hacer push :</li> </ol> <pre><code>$ git push\n</code></pre> <p>Nota: Si est\u00e1s colaborando con otras personas, merge suele ser una opci\u00f3n m\u00e1s segura, ya que no reescribe la historia. Sin embargo, rebase puede ser \u00fatil si deseas mantener una historia m\u00e1s limpia y f\u00e1cil de seguir.</p>"},{"location":"Ud1/EGM/cheatsheet/#582-no-puedo-hacer-pull","title":"5.8.2 No puedo hacer pull","text":"<p>Cuando intentas hacer pull para traer cambios del repositorio remoto, pero tienes cambios locales sin confirmar en tu espacio de trabajo. Esto puede dar lugar a mensajes de error como los siguientes:</p> <pre><code>$ git pull\nerror: Cannot pull with rebase: You have unstaged changes.\n</code></pre> <p>o</p> <pre><code>$ git pull\nerror: Cannot pull with rebase: Your index contains uncommitted changes.\n</code></pre> <p>Causa del problema: Este error se produce porque Git necesita un espacio de trabajo limpio para poder integrar los cambios remotos. Si tienes cambios locales sin confirmar (modificaciones no guardadas mediante commit), Git no puede garantizar que esos cambios no entren en conflicto con los cambios que est\u00e1 trayendo desde el repositorio remoto.</p> <p>Soluci\u00f3n: Para resolver este problema tienes varias opciones:</p> <ol> <li>Confirmar los cambios locales (commit) :</li> </ol> <p>La opci\u00f3n m\u00e1s sencilla es confirmar tus cambios locales para que Git pueda hacer pull sin problemas:</p> <pre><code>$ git add .\n$ git commit -m \"Descripci\u00f3n de los cambios locales\"\n$ git pull\n</code></pre> <p>Esto guardar\u00e1 tus cambios en un nuevo commit, permitiendo que Git traiga los cambios remotos y luego los mezcle con los tuyos.</p> <ol> <li>Guardar los cambios locales temporalmente con stash :</li> </ol> <p>Si no deseas hacer un commit porque tus cambios no est\u00e1n listos, puedes usar stash para guardar temporalmente los cambios y as\u00ed dejar tu espacio de trabajo limpio para poder hacer el pull:</p> <pre><code>$ git stash save \"Cambios temporales\"\n$ git pull\n$ git stash pop\n</code></pre> <ul> <li><code>$git stash save</code> guarda los cambios actuales en una especie de pila temporal llamada stash.</li> <li><code>$git pull</code> trae los cambios remotos.</li> <li><code>$git stash pop</code> restaura los cambios que hab\u00edas guardado en el stash.</li> </ul> <p>En caso de que haya conflictos despu\u00e9s de hacer <code>stash pop</code>, deber\u00e1s resolverlos manualmente como en cualquier otra operaci\u00f3n de merge.</p> <ol> <li>Combinar stash con pull autom\u00e1ticamente :</li> </ol> <p>Git tambi\u00e9n permite combinar estas acciones de forma autom\u00e1tica. Puedes usar la opci\u00f3n <code>--autostash</code> para hacer <code>pull</code> y <code>stash</code> en un solo paso:</p> <pre><code>$ git pull --autostash\n</code></pre> <p>Esta opci\u00f3n guarda tus cambios en el stash, realiza el <code>pull</code> y luego aplica los cambios nuevamente desde el stash. Es una forma r\u00e1pida de realizar ambas acciones cuando est\u00e1s trabajando con cambios sin confirmar.</p>"},{"location":"Ud1/EGM/cheatsheet/#6-flujo-de-trabajo-en-github","title":"6 Flujo de trabajo en GitHub","text":""},{"location":"Ud1/EGM/cheatsheet/#61-paso-0-abrir-una-incidencia-issue","title":"6.1 Paso 0. Abrir una incidencia (issue)","text":"<p>El trabajo suele empezar con una incidencia o issue. Para ello, se usa la secci\u00f3n de Issues en GitHub. Una issue es b\u00e1sicamente una solicitud para resolver un problema o a\u00f1adir una nueva caracter\u00edstica. Al abrir una issue, se le asigna un t\u00edtulo, una descripci\u00f3n (escrita en Markdown), y opcionalmente etiquetas, hitos, responsables, etc.</p> <p>Ejemplo: Crear una issue titulada \"Crear archivo de autores\" para crear un archivo <code>AUTHORS.md</code> que contenga la lista de desarrolladores del proyecto.</p>"},{"location":"Ud1/EGM/cheatsheet/#62-paso-1-crear-una-rama","title":"6.2 Paso 1. Crear una rama","text":"<p>Crear una rama es el primer paso para empezar a implementar los cambios relacionados con la issue. Para cada nueva caracter\u00edstica o correcci\u00f3n de errores, se debe crear una rama separada. El nombre de la rama debe seguir un formato consistente, por ejemplo:</p> <pre><code>$ git checkout -b feature-1/create-changelog\n</code></pre> <p>Despu\u00e9s de crear la rama, se sube al repositorio remoto con:</p> <pre><code>$ git push -u origin feature-1/create-changelog\n</code></pre> <p>Esto crea una nueva rama en el repositorio remoto y permite crear un Pull Request (PR) desde GitHub.</p>"},{"location":"Ud1/EGM/cheatsheet/#63-paso-2-crear-commits","title":"6.3 Paso 2. Crear commits","text":"<p>Trabaja en los cambios que necesitas y crea commits para documentar el progreso:</p> <pre><code>$ git add AUTHORS.md\n$ git commit -m \"A\u00f1adido fichero de autores\"\n</code></pre> <p>Cada vez que hagas un cambio importante, confirma con <code>commit</code> y luego sube la rama con <code>push</code>:</p> <pre><code>$ git push\n</code></pre> <p>Los commits aparecer\u00e1n en el Pull Request abierto en GitHub para revisi\u00f3n.</p>"},{"location":"Ud1/EGM/cheatsheet/#64-paso-3-discutir","title":"6.4 Paso 3. Discutir","text":"<p>En GitHub, otros desarrolladores pueden revisar y discutir el Pull Request. Esto ayuda a garantizar la calidad del c\u00f3digo y facilita la colaboraci\u00f3n. Puedes etiquetar a revisores o asignar personas para la revisi\u00f3n del PR.</p> <p>Pull Requests tambi\u00e9n permiten comentarios en l\u00ednea sobre fragmentos de c\u00f3digo espec\u00edficos, lo que facilita una discusi\u00f3n detallada.</p>"},{"location":"Ud1/EGM/cheatsheet/#65-paso-4-desplegar","title":"6.5 Paso 4. Desplegar","text":"<p>Una vez que se ha revisado el Pull Request y todos est\u00e1n de acuerdo, es momento de integrarlo en la rama principal. GitHub ofrece tres formas para hacer el merge de una rama:</p> <p></p>"},{"location":"Ud1/EGM/cheatsheet/#651-crear-un-merge-commit","title":"6.5.1 Crear un merge commit","text":"<p>Este m\u00e9todo fusiona la rama en la rama principal (<code>main</code>) sin eliminar la historia de los commits individuales:</p> <pre><code>$ git checkout main\n$ git merge --no-ff feature-1/create-changelog\n$ git push\n</code></pre> <p>Este enfoque mantiene el historial de todos los cambios realizados en la rama.</p> <p>Info: GitHub siempre desactiva el fast forward.</p>"},{"location":"Ud1/EGM/cheatsheet/#652-crear-un-rebase-y-merge","title":"6.5.2 Crear un rebase y merge","text":"<p>Rebase garantiza que los cambios de la rama se apliquen sobre los \u00faltimos cambios de <code>main</code>, creando una historia de commits m\u00e1s lineal:</p> <pre><code>$ git rebase main\n$ git checkout main\n$ git merge --no-ff feature-1/create-changelog\n$ git push\n</code></pre> <p>Este m\u00e9todo reordena los commits para que parezca que la caracter\u00edstica se desarroll\u00f3 al final de los cambios ya en <code>main</code>.</p>"},{"location":"Ud1/EGM/cheatsheet/#653-crear-un-squash-commit-y-un-merge","title":"6.5.3 Crear un squash commit y un merge","text":"<p>El m\u00e9todo de squash and merge combina todos los commits de la rama en un solo commit en la rama principal:</p> <pre><code>$ git checkout main\n$ git merge --squash feature-1/create-changelog\n$ git push\n</code></pre> <p>Este enfoque es \u00fatil para mantener el historial de <code>main</code> m\u00e1s limpio, ya que todos los cambios se registran como un \u00fanico commit, lo cual es ideal cuando la rama incluye muchos commits peque\u00f1os.</p> <p>Vamos a seleccionar este \u00faltimo (squash and merge) y le damos al bot\u00f3n para activarlo. Nos saldr\u00e1 una caja para que podamos crear una descripci\u00f3n del commit y le damos a confirmar.</p> <p></p> <p>Ya hemos terminado y nos aparecer\u00e1 una opci\u00f3n para borrar la rama, lo m\u00e1s recomendado para no tener ramas obsoletas.</p> <p>Las consecuencias de esta acci\u00f3n son las siguientes:</p> <ol> <li>El PR aparecer\u00e1 como estado merged y en la lista de PR como cerrado.</li> <li>El issue que abrimos se habr\u00e1 cerrado autom\u00e1ticamente.</li> <li>En el listado de commits aparecer\u00e1 solo uno con un enlace al PR (en vez de los dos commits que hicimos).</li> </ol>"},{"location":"Ud1/EGM/cheatsheet/#66-paso-5-sincronizar","title":"6.6 Paso 5. Sincronizar","text":"<p>Hemos cambiado el repositorio en GitHub, pero nuestra rama <code>main</code> local no contiene los mismos cambios que el de <code>origin</code>. As\u00ed que nos toca sincronizar y borrar la rama obsoleta:</p> <pre><code>$ git checkout main\n$ git pull --rebase --autostash\n$ git branch -D feature-1/create-changelog\n</code></pre> <p>Info: \u00bfPor qu\u00e9 squash and merge y no un merge o rebase? De nuevo depende de los gustos de cada equipo de desarrollo. Las caracter\u00edsticas de squash es que elimina (relativamente) rastros de errores intermedios mientras se implementaba la rama, deja menos commits en la rama main y nos enlaza al PR donde se implementaron los cambios.</p> <p>Para algunas personas estas caracter\u00edsticas son unas ventajas, para otras no. Lo mejor es experimentar cada opci\u00f3n y que cada uno decida c\u00f3mo quiere trabajar.</p>"},{"location":"Ud1/EGM/cheatsheet/#7-colaboracion-en-github","title":"7 Colaboraci\u00f3n en GitHub","text":""},{"location":"Ud1/EGM/cheatsheet/#71-clonar-un-repositorio","title":"7.1 Clonar un repositorio","text":"<p>Para colaborar en un proyecto existente, primero es necesario clonar el repositorio a nuestro espacio de trabajo local. Primero vamos a la web del proyecto y hacemos un \"fork\" para tener una copia propia. Luego, clonamos nuestro fork localmente:</p> <pre><code>$ git clone git@github.com:miusuario/miniblog.git\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#711-sincronizar-con-el-repositorio-original","title":"7.1.1 Sincronizar con el repositorio original","text":"<p>Cuando hacemos un \"fork\" de un proyecto, se crea una copia que no se actualiza con los cambios del proyecto original de manera autom\u00e1tica. Para mantener nuestro fork actualizado, es necesario agregar el repositorio original como remoto:</p> <pre><code>$ git remote add upstream git@github.com:sgomez/miniblog.git\n</code></pre> <p>Luego, para incorporar cambios del repositorio original, usamos:</p> <pre><code>$ git fetch upstream\n$ git merge upstream/master\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#712-creando-nuevas-funcionalidades","title":"7.1.2 Creando nuevas funcionalidades","text":"<p>Para crear una nueva funcionalidad o arreglar un error, primero creamos una nueva rama:</p> <pre><code>$ git checkout -b add-license\n</code></pre> <p>Luego, a\u00f1adimos el c\u00f3digo necesario y lo confirmamos con un commit:</p> <pre><code>$ echo \"LICENCIA MIT\" &gt; LICENSE\n$ git add LICENSE\n$ git commit -m \"A\u00f1adido archivo de licencia de uso\"\n</code></pre> <p>Finalmente, enviamos los cambios a nuestro repositorio en GitHub:</p> <pre><code>$ git push --set-upstream origin add-license\n</code></pre> <p>En GitHub, podemos crear un \"Pull Request\" para sugerir los cambios al repositorio original.</p>"},{"location":"Ud1/EGM/cheatsheet/#713-todo-esto-es-algo-complicado","title":"7.1.3 Todo esto es algo complicado...","text":"<p>El trabajo en Git puede parecer complejo al principio, especialmente al manejar ramas y colaborar con repositorios remotos. La clave est\u00e1 en entender cada nivel de complejidad antes de avanzar al siguiente, desde los comandos b\u00e1sicos como <code>add</code>, <code>commit</code> y <code>checkout</code>, hasta los m\u00e1s avanzados como <code>merge</code>, <code>rebase</code> y <code>push</code>.</p>"},{"location":"Ud1/EGM/cheatsheet/#72-ultimo-paso-documentacion","title":"7.2 \u00daltimo paso, documentaci\u00f3n.","text":"<p>La documentaci\u00f3n es esencial para que otros colaboradores entiendan el proyecto. Esto se puede hacer mediante un archivo <code>README.md</code>, una wiki o incluso una p\u00e1gina web para el proyecto.</p>"},{"location":"Ud1/EGM/cheatsheet/#8-otros-comandos-de-git","title":"8 Otros comandos de Git","text":""},{"location":"Ud1/EGM/cheatsheet/#81-git-stash-reserva","title":"8.1 Git stash (reserva)","text":"<p>La orden <code>git stash</code> nos permite salvar moment\u00e1neamente el espacio de trabajo cuando tenemos que cambiar de rama o preparar la rama actual para sincronizar cambios.</p> <p>Las operaciones m\u00e1s importantes que podemos hacer con <code>git stash</code> son:</p>"},{"location":"Ud1/EGM/cheatsheet/#811-git-stash-save","title":"8.1.1 git stash save","text":"<p>Es equivalente a poner solo <code>git stash</code> pero nos permite realizar m\u00e1s acciones como:</p> <pre><code>git stash save \"Tu mensaje\"\ngit stash save -u\n</code></pre> <p>El par\u00e1metro <code>-u</code> permite que se almacenen tambi\u00e9n los ficheros sin seguimiento previo (untracked en ingl\u00e9s, aquellos ficheros que no se han metido nunca en el repositorio).</p>"},{"location":"Ud1/EGM/cheatsheet/#812-git-stash-list","title":"8.1.2 git stash list","text":"<p>Permite mostrar la pila del stash.</p> <pre><code>$ git stash list\nstash@{0}: On master: Stash con mensaje\nstash@{1}: WIP on master: 4ab21df First commit\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#813-git-stash-apply","title":"8.1.3 git stash apply","text":"<p>Esta orden coge el stash que est\u00e1 arriba en la pila y lo aplica al espacio de trabajo actual. En este caso siempre es <code>stash@{0}</code>. El stash permanece en la pila.</p> <p>Se puede indicar como par\u00e1metro un stash en concreto.</p>"},{"location":"Ud1/EGM/cheatsheet/#814-git-stash-pop","title":"8.1.4 git stash pop","text":"<p>Funciona igual que <code>git apply</code> con la diferencia de que el stash s\u00ed se borra de la pila.</p>"},{"location":"Ud1/EGM/cheatsheet/#815-git-stash-show","title":"8.1.5 git stash show","text":"<p>Muestra un resumen de los ficheros que se han modificado en ese stash.</p> <pre><code>$ git stash show\nA.txt | 1 +\nB.txt | 3 +++\n2 file changed, 4 insertions(+)\n</code></pre> <p>Para ver los cambios podemos usar el par\u00e1metro <code>-p</code></p> <pre><code>$ git stash show -p\n--- a/A.txt\n+++ b/A.txt\n@@ -45,6 +45,7 @@ nav:\n+ This is a change\n</code></pre> <p>Por defecto siempre muestra la cabeza de la pila. Igual que en casos anteriores podemos indicar un stash en concreto.</p> <pre><code>$ git stash show stash@{1}\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#816-git-stash-branch","title":"8.1.6 git stash branch","text":"<p>Permite crear una nueva rama a partir del \u00faltimo stash. Adem\u00e1s, el mismo es borrado de la pila. Se puede especificar uno en concreto si lo queremos, como en el resto de comandos.</p> <pre><code>git stash branch nombre-de-nueva-rama stash@{1}\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#817-git-stash-clear","title":"8.1.7 git stash clear","text":"<p>Este comando borra todos los stash de la pila. Es destructiva y no se puede deshacer.</p>"},{"location":"Ud1/EGM/cheatsheet/#818-git-stash-drop","title":"8.1.8 git stash drop","text":"<p>Permite borrar un stash en concreto (o el \u00faltimo si no se indica ninguno). Como con <code>clear</code>, borrarlo implica que no se puede recuperar.</p>"},{"location":"Ud1/EGM/cheatsheet/#82-git-worktree","title":"8.2 Git worktree","text":"<p>Uno de los problemas m\u00e1s habituales es tener que tocar una rama distinta a la que tenemos actualmente. Eso implica que si estamos en medio de un trabajo tendr\u00edamos que hacer un commit o un stash, lo cual a veces es bastante molesto.</p> <p>Con <code>git worktree</code> podemos crear un directorio de trabajo que contenga otra rama distinta, de forma temporal. No supone otro clon del repositorio porque ambos usan el mismo.</p>"},{"location":"Ud1/EGM/cheatsheet/#821-git-worktree-add","title":"8.2.1 git worktree add","text":"<p>Esta funci\u00f3n es la que crea el espacio de trabajo temporal. Imaginemos que estamos en una rama llamada <code>develop</code>:</p> <pre><code>$ git worktree add ../project-master master\n$ git worktree add -b fix ../project-fix master\n</code></pre> <p>La primera orden crea un directorio llamado <code>project-master</code> que contiene el estado de <code>master</code>. La segunda, que contiene el par\u00e1metro <code>-b</code> equivale a crear una nueva rama llamada <code>fix</code>, que se crea desde <code>master</code> (suponemos que no existe <code>fix</code>).</p>"},{"location":"Ud1/EGM/cheatsheet/#822-git-worktree-list","title":"8.2.2 git worktree list","text":"<p>Muestra el listado de directorios y espacios de trabajo.</p> <pre><code>$ git worktree list\n/home/sergio/taller-de-git  3b63b4b [master]\n/home/sergio/fix           3b63b4b [fix]\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#823-git-worktree-remove","title":"8.2.3 git worktree remove","text":"<p>Borra un espacio de trabajo. Hay que indicar el nombre entre corchetes que aparece en el listado.</p> <pre><code>$ git worktree delete fix\n</code></pre>"},{"location":"Ud1/EGM/cheatsheet/#824-git-worktree-prune","title":"8.2.4 git worktree prune","text":"<p>Una cuesti\u00f3n importante es que las ramas que est\u00e9n desplegadas en otro espacio de trabajo se encuentran bloqueadas y no se pueden desbloquear en otro distinto.</p> <p>Esto significa que si estamos trabajando en la rama <code>developer</code> y creamos otro <code>worktree</code> en otro directorio de la rama <code>master</code>, no podemos pasar a <code>master</code>. No es posible tener la misma rama en varios espacios de trabajo.</p> <p>Si se ha borrado el directorio a mano (en vez de usando <code>remove</code>), eso no implica que el bloqueo desparezca. Con esta orden podemos hacer que Git compruebe que los espacios de trabajo secundarios siguen existiendo y se elimine el bloqueo.</p>"},{"location":"Ud1/EGM/cheatsheet/#83-git-blame","title":"8.3 Git blame","text":"<p>Lo ideal en un equipo de desarrollo es que el c\u00f3digo pase por todas las manos para as\u00ed mejorar su calidad.</p> <p>Con <code>git blame</code> podemos saber qui\u00e9n fue el \u00faltimo en modificar una l\u00ednea concreta de c\u00f3digo, en qu\u00e9 commit y en qu\u00e9 fecha lo hizo.</p> <pre><code>$ git blame ejemplo.php\n33cdd02c (Sergio G\u00f3mez 2020-01-20 16:58:52 +0100  8)   name: \"material\"\n33cdd02c (Sergio G\u00f3mez 2020-01-20 16:58:52 +0100  9)   language: \"es\"\n</code></pre>"},{"location":"Ud1/EV/cheatsheet1/","title":"CH1 - Eduard Varga","text":"<p><code>git config --global user.name \"John Doe\"</code> -&gt; establecer nombre de usuario  <code>git config --global user.email johndoe@example.com</code> -&gt; establecer direcci\u00f3n de correo electr\u00f3nico</p> <p><code>git status</code> -&gt; consultar el estado de los archivos  <code>git init</code> -&gt; crear un nuevo repositorio  <code>nano [nombre_archivo]</code> -&gt; crear archivo y entrar en \u00e9l  <code>git add [nombre_archivo]</code> -&gt; a\u00f1adir el archivo al \u00e1rea de preparaci\u00f3n  <code>git commit -m \"[texto]\"</code> -&gt; el archivo pasa a local repository y se le asigna un c\u00f3digo de inserci\u00f3n  <code>git commit -a -m \"[texto]\"</code> -&gt; hace el add y despu\u00e9s el commit</p> <p><code>git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"</code> -&gt; crear el alias hist con la configuraci\u00f3n establecida  <code>git hist --all</code> -&gt; listar los cambios en todas las ramas</p> <p><code>git checkout [hash]</code> -&gt; regresar al momento del estado del proyecto que se indica  <code>git checkout [rama]</code> -&gt; moverse a la rama  <code>git checkout -b [nombre]</code> -&gt; crear rama y acceder a ella  <code>git switch -</code> -&gt; volver a la rama anterior  <code>git branch</code> -&gt; listar las ramas que hay  <code>git branch [nombre]</code> -&gt; crear rama  <code>git tag [nombre]</code> -&gt; etiquetar versiones en la historia del repositorio  <code>git tag -d [nombre_etiqueta]</code> -&gt; borrar etiqueta</p> <p><code>git merge [nombre_rama]</code> -&gt; fusionar ramas  <code>git rebase [nombre_rama]</code> -&gt; fusionar ramas  <code>git rebase --continue</code> -&gt; continuar el rebase  <code>git merge --no-ff [nombre_rama]</code> -&gt; fusionar sin hacer fast-forward</p> <p><code>git restore [nombre_archivo]</code> -&gt; restaurar archivo  <code>git reset --hard [hash]</code> -&gt; mover el HEAD al hash indicado</p> <p><code>ssh-keygen -t rsa -C \"Cuenta GitHub\"</code> -&gt; crear una nueva clave Meterse en las claves de GitHub y al crear la clave, en el apartado key volcar lo que hay en el archivo <code>~/.ssh/id_rsa.pub</code></p> <p><code>git clone [url_repositorio]</code> (ej: <code>git@github.com:sgomez/taller-de-git.git</code>) -&gt; clonar el repositorio  <code>git remote add [nombre_repositorio_remoto] [url_repositorio_remoto]</code> -&gt; a\u00f1adir conexi\u00f3n remota  <code>git remote show [nombre_repositorio_remoto]</code> -&gt; ver configuraci\u00f3n del repositorio remoto  <code>git fetch</code> -&gt; traer la informaci\u00f3n desde el servidor remoto  <code>git pull</code> -&gt; hace un fetch y un merge a la vez (traer de GitHub y meterlo en nuestro local)  <code>git pull --autostash --rebase</code> -&gt; ejecutar si no funciona el git pull  <code>git push</code> -&gt; enviar cambios al repositorio remoto  <code>git push -u [repositorio] [rama]</code> (ej: origin main) -&gt; enviar los cambios de la rama del repositorio local al repositorio remoto</p> <p><code>git mv [archivo] [directorio]</code> -&gt; mover el archivo al directorio <code>cat [nombre_archivo]</code> -&gt; ver contenido de un archivo</p>"},{"location":"Ud1/MCG/CMCG/","title":"CheatSheet de Git - mauricio","text":""},{"location":"Ud1/MCG/CMCG/#setup-inicial","title":"Setup inicial","text":"<p>Antes de poder utilizar git, necesitamos git. En la amplia mayor\u00eda de sistemas GNU/Linux usaremos este comando:</p> <p><code>sudo apt-get install git <pre><code>Por \u00faltimo, necesitaremos especificar un **nombre** y un **correo electr\u00f3nico**.\n</code></pre> git config --global user.name \"nombre\" git config --global user.email abc@email.com <pre><code>## Manejo de repos.\nPara crear un repositorio local y consultar su estado usaremos:\n</code></pre> git init git status <pre><code>Podemos a\u00f1adir y borrar archivos o cambios al/del repo con: \n</code></pre> git add  git rm <pre><code>Antes de subir ning\u00fan cambio deber\u00edamos primero revisar si hay cambios, y si hay, bajarlos si asi lo queremos.\n</code></pre> git fetch git pull <pre><code>Para confirmar los cambios y subirlos:\n</code></pre> git commit -m \"comentario\" git push <pre><code>&gt; Con el argumento \"-m\" especificamos un comentario para el commit.\n\nSi quisieramos descartar los cambios hechos a un archivo y/o del commit m\u00e1s reciente estas son las instrucciones para hacerlo:\n</code></pre> git restore archivo.bin git revert HEAD --no-edit <pre><code>Podemos a\u00f1adir etiquetas al estado actual usando:\n</code></pre> git tag nombre <pre><code>Si quisieramos ver las diferencias entre commits, archivos e incluso ramas podemos usar el siguiente comando:\n</code></pre> git diff \"a\" \"b\" <pre><code>&gt;Por defecto este comando, compara los cambios del \u00faltimo commit con los actuales. Tambien podemos hacer uso de tags a la hora de comparar.\n***\n### Historial de cambios.\nPara poder ver el historico de todas nuestras ediciones a lo largo del tiempo usar\u00edamos el siguiente comando:\n</code></pre> git log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short <pre><code>Como este comando es brutalmente largo, podemos facilitarnos la vida creando un alias:\n\n ```\ngit config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"\n ```\n\nDe esta forma solo hace falta que escribamos ***git hist*** para poder ver todos los cambios de forma bonita.\n***\nSi quisieramos volver a un estado anterior, basta con ejecutar la siguiente orden:\n</code></pre> git checkout \"hash\" <pre><code>&gt; Mucho ojo, pues \"hash\" debe remplazarse con el c\u00f3digo numerico correspondiente al commit que quisieramos restablecer. Se puede ver en el historico anterior.\n\n\nTambien cabe a\u00f1adir que si no hacemos un `git switch -` para volver al commit m\u00e1s reciente o cambiamos de rama, podemos liarla pard\u00edsima. Y hablando de ramas.\n\n## Manejo de ramas.\n\nPara crear una nueva rama de desarrollo en nuestro repositorio y situarnos dentro de ella usaremos los siguientes comandos:\n</code></pre> git branch nombreRama git checkout nombreRama <pre><code>Para fusionar los cambios de una rama a la otra usaremos: \n</code></pre> git merge MAIN <pre><code>Tambien podemos hacer un *rebase*, que nos permite cambiar la base de los commits hechos en la rama.\n</code></pre> git rebase MAIN <pre><code>&gt;Mucho ojo, pues con las dos instruci\u00f3nes anteriores le decimos a git que queremos aplicar los cambios de la rama actual en la que estamos trabajando a la rama main.\n&gt; Repito, rama actual ----&gt; MAIN.\n\n## GitHub o repos en linea.\nPara poder clonar un repositorio existente ya sea en Github o derivados podemos hacerlo con el siguiente comando.\n</code></pre> git clone \"url\" <pre><code>Si quisieramos sincronizar un repositorio local a uno en linea utilizariamos la siguiente instrucci\u00f3n:\n</code></pre> git remote add origin \"ssh\" <pre><code>***\nMientras trabajamos en local junto a un repo en linea, no es raro que a la hora de hacer commits haya problemas, especialmente porque hay que verificar que no estamos sobreescribiendo el trabajo de nadie.\n\nPara guardar nuestro trabajo local temporalmente podemos hacer:\n</code></pre> git stash save <pre><code>Nos bajamos los \u00faltimos cambios con los comando anteriormente vistos y restauramos nuestra sesi\u00f3n con: \n</code></pre> git stash pop</code></p>"},{"location":"Ud1/MIP/cheatsheet1/","title":"Cheatsheet git Marc Ib\u00e1\u00f1ez","text":""},{"location":"Ud1/MIP/cheatsheet1/#uso-basico-de-git","title":"Uso b\u00e1sico de git","text":""},{"location":"Ud1/MIP/cheatsheet1/#instalacion-de-github","title":"Instalaci\u00f3n de github","text":"<pre><code>$ apt-get install git\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#definir-identidad","title":"Definir identidad","text":"<pre><code>$ git config --global user.name \"John Doe\"\n$ git config --global user.email johndoe@example.com\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#ver-estado","title":"Ver estado","text":"<pre><code>$ git status\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#crear-un-proyecto","title":"Crear un proyecto","text":"<pre><code>$ mkdir curso-de-git\n$ cd curso-de-git\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#crear-repositorio","title":"Crear repositorio","text":"<pre><code>$ git init\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#anadir-y-commitear-los-cambios","title":"A\u00f1adir y commitear los cambios","text":"<pre><code>$ git commit -am \"Nombre del commit\"\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#ignorar-archivos-globalmente","title":"Ignorar archivos globalmente","text":"<pre><code>$ git config --global core.excludesfile $HOME/.gitignore_global\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#ver-historial","title":"Ver historial","text":"<pre><code>$ git log\n\n$ git log --oneline\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#crear-alias-para-ver-el-historial","title":"Crear alias para ver el historial","text":"<pre><code>$ git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#ver-historial-una-vez-hecho-el-alias","title":"Ver historial una vez hecho el alias","text":"<pre><code>$ git hist\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#recuperar-versiones","title":"Recuperar versiones","text":"<pre><code>$ git checkout 0000001\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#para-volver","title":"Para volver","text":"<pre><code>$ git switch -\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#volver-a-ultima-version-de-la-rama","title":"Volver a ultima versi\u00f3n de la rama","text":"<pre><code>$ git checkout master\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#etiquetar-versiones","title":"Etiquetar versiones","text":""},{"location":"Ud1/MIP/cheatsheet1/#ver-etiquetas","title":"Ver etiquetas","text":"<pre><code>$ git tag\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#etiquetar-version-actual","title":"Etiquetar versi\u00f3n actual","text":"<pre><code>$ git tag v1\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#etiquetar-version-inmediatamente-anterior","title":"Etiquetar versi\u00f3n inmediatamente anterior","text":"<pre><code>$ git checkout v1^\n$ git tag v1-beta\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#borrar-etiqueta","title":"Borrar etiqueta","text":"<pre><code>$ git tag -d nombre_etiqueta\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#uso-avanzado-de-git","title":"Uso avanzado de git","text":""},{"location":"Ud1/MIP/cheatsheet1/#deshacer-cambios","title":"Deshacer cambios","text":""},{"location":"Ud1/MIP/cheatsheet1/#despues-de-commit","title":"Despu\u00e9s de commit","text":"<pre><code>$ git restore hola.php\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#antes-de-commit","title":"Antes de commit","text":"<pre><code>$ git restore --staged hola.php\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#deshacer-commits-indeseados","title":"Deshacer commits indeseados","text":"<pre><code>$ git revert HEAD --no-edit\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#borrar-commits-de-una-rama","title":"Borrar commits de una rama","text":"<pre><code>$ git reset --hard v1\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#modificar-un-commit","title":"Modificar un commit","text":"<pre><code>$ git add hola.php\n$ git commit --amend -m \"A\u00f1adido el autor del programa y su email\"\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#mover-archivo-a-otro-directorio","title":"Mover archivo a otro directorio","text":"<pre><code>$ mkdir lib\n$ git mv hola.php lib\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#ramas","title":"Ramas","text":""},{"location":"Ud1/MIP/cheatsheet1/#crear-rama","title":"Crear rama","text":"<pre><code>$ git branch nuevarama\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#moverse-entre-ramas","title":"Moverse entre ramas","text":"<pre><code>$ git checkout nuevarama\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#mezclar-ramas","title":"Mezclar ramas","text":""},{"location":"Ud1/MIP/cheatsheet1/#hacemos-modificacion-en-rama-master","title":"Hacemos modificaci\u00f3n en rama master","text":"<pre><code>$ git checkout master\n$ git add README.md\n$ git commit -m \"A\u00f1adido README.md a master\"\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#cambiamos-a-rama-nuevarama-y-hacemos-la-mezcla","title":"Cambiamos a rama nuevarama y hacemos la mezcla","text":"<pre><code>$ git checkout nuevarama\n$ git merge master\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#resolver-conflictos","title":"Resolver conflictos","text":""},{"location":"Ud1/MIP/cheatsheet1/#modificamos-el-archivo-holaphp-estando-en-rama-master-guardamos-los-cambios-y-hacemos-commit-y-una-vez-estamos-en-la-rama-nuevarama-hacemos-merge","title":"Modificamos el archivo hola.php estando en rama master, guardamos los cambios y hacemos commit, y una vez estamos en la rama nuevarama hacemos merge:","text":"<pre><code>$ git merge master\nAuto-merging lib/hola.php\nCONFLICT (content): Merge conflict in lib/hola.php\nAutomatic merge failed; fix conflicts and then commit the result.\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#ahora-debemos-editar-el-documento-para-resolver-los-conflictos-y-una-vez-resuelto-hacemos","title":"Ahora debemos editar el documento para resolver los conflictos y una vez resuelto hacemos:","text":"<pre><code>$git add lib/hola.php\n$ git commit -m \"Solucionado el conflicto al fusionar con la rama master\"\n[nuevarama a36af04] Solucionado el conflicto al fusionar con la rama master\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#github","title":"Github","text":""},{"location":"Ud1/MIP/cheatsheet1/#sincronizar-un-repositorio-ya-creado","title":"Sincronizar un repositorio ya creado","text":"<pre><code>$ git remote add origin git@github.com:sgomez/taller-de-git.git\n$ git branch -M main\n$ git push -u origin main\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#clonar-un-repositorio","title":"Clonar un repositorio","text":"<pre><code>$ git clone git@github.com:sgomez/taller-de-git.git\n$ cd taller-de-git\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#ramas-remotas","title":"Ramas remotas","text":"<pre><code>$ git remote show origin\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#enviar-actualizaciones","title":"Enviar actualizaciones","text":"<pre><code>$ git push\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#recibir-actualizaciones","title":"Recibir actualizaciones","text":"<pre><code>$ git fetch\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#importar-cambios-de-la-rama-remota-a-la-local","title":"Importar cambios de la rama remota a la local","text":"<pre><code>$ git merge origin/main\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#existe-una-funcion-que-nos-ayuda-a-hacer-fetch-y-merge-de-forma-simultanea","title":"Existe una funcion que nos ayuda a hacer fetch y merge de forma simultanea:","text":"<pre><code>$ git pull\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#problemas-de-sincronizacion","title":"Problemas de sincronizaci\u00f3n","text":""},{"location":"Ud1/MIP/cheatsheet1/#no-puedo-hacer-push","title":"No puedo hacer push:","text":"<pre><code>$ git fetch\n$ git rebase\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#o-tambien","title":"O tambi\u00e9n:","text":"<pre><code>$ git pull --rebase\n</code></pre>"},{"location":"Ud1/MIP/cheatsheet1/#no-puedo-hacer-pull","title":"No puedo hacer pull:","text":"<pre><code>$ git stash save # Guardamos los cambios en la pila\n$ git pull # Sincronizamos con el repositorio remoto, -r para hacer rebase puede ser requerido\n$ git stash pop # Sacamos los cambios de la pila\n</code></pre>"},{"location":"Ud1/MMC/cheatsheet1/","title":"Cheatsheet 1 de Marcel Ma\u00f1as","text":""},{"location":"Ud1/MMC/cheatsheet1/#ayuda","title":"Ayuda","text":"<p>Por si en alg\u00fan momento necesitas ayuda</p> <pre><code>$ git help &lt;verb&gt;\n$ git &lt;verb&gt; --help            Ej: $ git help config\n$ man git &lt;verb&gt;;\n</code></pre>"},{"location":"Ud1/MMC/cheatsheet1/#instalacion-y-configuracion-de-git","title":"Instalaci\u00f3n y configuraci\u00f3n de Git","text":"<ul> <li> <p>Instalar en distribuciones de Debian:</p> <pre><code>$ sudo apt-get install git\n</code></pre> </li> <li> <p>Configuraci\u00f3n:</p> <pre><code>$git config --global user.name \"Tu_nombre\"\n$git config --global user.email \"tu_email@aqu\u00ed.algo\"\n$git config --global push.default simple\n</code></pre> </li> <li> <p>Comprobar versi\u00f3n de Git:</p> <pre><code>$ git --version\n</code></pre> </li> <li> <p>Actualizar Git:</p> <pre><code>$ sudo apt update\n$ sudo apt upgrade git\n</code></pre> </li> </ul>"},{"location":"Ud1/MMC/cheatsheet1/#creacion-de-proyecto","title":"Creaci\u00f3n de proyecto","text":"<ul> <li> <p>Ver el estado del repositorio:</p> <pre><code>$ git status\n</code></pre> </li> <li> <p>Crear repositorio una vez ya creado el directorio y el archivo:</p> <pre><code>$ git init\nInitialized empty Git repository in /home/admin/nombre_del_directorio/.git/\n</code></pre> </li> </ul>"},{"location":"Ud1/MMC/cheatsheet1/#github","title":"GitHub","text":"<ul> <li> <p>Para crear las claves p\u00fablicas/privadas:</p> <pre><code>$ ssh-keygen -t rsa -C \"Cuenta GitHub\"\n</code></pre> </li> <li> <p>Para conectar Git con un repositorio existente GitHub:</p> <pre><code>$ git remote add origin c\u00f3digo_ssh_del_repositorio_GitHub\n</code></pre> <ul> <li> <p>Para cambiar el nombre a una rama:</p> <pre><code>$ git branch -M main\n</code></pre> </li> <li> <p>Para subir la info al repositorio remoto y decir que esa es la rama de seguimiento:</p> <pre><code>$ git push -u origin main\n</code></pre> </li> </ul> </li> <li> <p>Para clonar un repositorio existente:</p> <pre><code>$ git clone c\u00f3digo_ssh_GitHub\n</code></pre> </li> <li> <p>Para ver la configuraci\u00f3n del repositorio remoto:</p> <pre><code>$ git remote show origin\n</code></pre> </li> <li> <p>Traer la informaci\u00f3n de los cambios en GitHub al local:</p> <pre><code>$ git fetch\n</code></pre> <ul> <li> <p>Luego tendr\u00edas que a\u00f1adirlo a tu rama con:</p> <pre><code>$ git merge origin/main\n</code></pre> </li> </ul> </li> <li> <p>Traer la informaci\u00f3n de los cambios en GitHub al local y a\u00f1adirlos a tu rama:</p> <pre><code>$ git pull\n</code></pre> <ul> <li> <p>Un pull mas agresivo:</p> <pre><code>$ git pull --rebase\n</code></pre> </li> </ul> </li> <li> <p>Guardar cambios de forma temporal:</p> <pre><code>$ git stash save # Guardamos los cambios en la pila\n</code></pre> </li> <li> <p>Sacar los cambios temporales que tengamos guardados:</p> <pre><code>$ git stash pop # Sacamos los cambios de la pila\n</code></pre> </li> <li> <p>Para utilizar stash save y stash pop, adem\u00e1s de un pull:</p> <pre><code>$ git pull --autostash\n</code></pre> </li> </ul>"},{"location":"Ud1/MMC/cheatsheet1/#manejo-en-el-repositorio-git","title":"Manejo en el repositorio Git","text":"<ul> <li> <p>A\u00f1adir el archivo al repositorio:</p> <pre><code>$ git add hola.php\n</code></pre> <ul> <li> <p>Si quieres a\u00f1adir varios de golpe:</p> <pre><code>$ git add .\n</code></pre> </li> </ul> </li> <li> <p>Guardar los archivo a\u00f1adido al repositorio:</p> <pre><code>$git commit -m \"Comentario descriptivo del guardado\"\n</code></pre> <ul> <li> <p>Commit directo:</p> <pre><code>$git commit -a -m \"A\u00f1adido el autor del programa\"\n</code></pre> </li> </ul> </li> <li> <p>Comprobar el hist\u00f3rico:</p> <pre><code>$ git log\n</code></pre> <ul> <li> <p>Mostrar abreviado:</p> <pre><code>$ git log --oneline\n</code></pre> </li> <li> <p>Mostrar HEAD y master:</p> <pre><code>$ git log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\n</code></pre> <ul> <li> <p>Si queremos adem\u00e1s, ver los cambios en todas las ramas:</p> <pre><code>$ git alias_que_hayamos_puesto --all\n</code></pre> </li> </ul> </li> </ul> </li> <li> <p>Crear alias para evitar largos comandos:</p> <pre><code>git config --global alias.el_nombre_que_quieras \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"\n</code></pre> </li> <li> <p>Recuperar versiones anteriores:</p> <pre><code>$ git checkout identificador_del_commit\n</code></pre> </li> <li> <p>Etiquetar versiones:</p> <pre><code>$ git tag nombre_de_la_etiqueta\n</code></pre> <ul> <li> <p>Si quieres ver todas la etiquetas:</p> <pre><code>$ git tag\n</code></pre> </li> <li> <p>Si quieres borrar alguna etiquetas:</p> <pre><code>$ git tag -d nombre_etiqueta\n</code></pre> </li> </ul> </li> <li> <p>Para comparar versiones:</p> <pre><code>$ git diff nombre_version1 nombre_version2\n</code></pre> </li> <li> <p>Para deshacer cambios antes del add:</p> <pre><code>$ git restore nombre_archivo\n</code></pre> <ul> <li> <p>Para deshacer antes del commit:</p> <pre><code>$ git restore --staged nombre_archivo\n</code></pre> </li> </ul> </li> <li> <p>Deshacer el \u00faltimo commit:</p> <pre><code>$ git revert HEAD --no-edit\n</code></pre> </li> <li> <p>Borrar commits de una rama:</p> <pre><code>$ git reset --hard version_commit\n</code></pre> </li> <li> <p>Mover archivos:</p> <pre><code>$ git mv nombre_archivo lugar_a_mover\n</code></pre> </li> <li> <p>Borrar archivos:</p> <pre><code>$ git rm nombre-archivo\n</code></pre> </li> </ul>"},{"location":"Ud1/MMC/cheatsheet1/#ramas","title":"Ramas","text":"<ul> <li> <p>Crear rama:</p> <pre><code>$ git branch nombre_rama\n</code></pre> </li> <li> <p>Cambiar de rama:</p> <pre><code>$ git checkout nombre_rama\n</code></pre> <ul> <li> <p>Crear y cambiar a una rama:</p> <pre><code>$ git checkout nombre_rama\n</code></pre> </li> </ul> </li> <li> <p>Incorporar cambios de una rama a otra:</p> <pre><code>$ git checkout nombre_rama_donde_quieres_los_cambios\n$ git merge nombre_rama_que_tiene_los_cambios\n</code></pre> </li> <li> <p>Para mover el HEAD donde queramos (\u201drevertir\u201d commits):</p> <pre><code>$ git reset --hard hash_del_commit\n</code></pre> </li> <li> <p>Fusionar ramas dejando solo 1 rama:</p> <pre><code>$ git checkout nombre_rama_que_tiene_los_cambios\n$ git rebase nombre_rama_donde_quieres_los_cambios\n</code></pre> </li> </ul>"},{"location":"Ud1/MMC/cheatsheet1/#ignorando-archivos-globalmente","title":"Ignorando archivos globalmente","text":"<ul> <li> <p>Para crear un archivo global para Git y que ignore ciertos archivos al hacer el manejo en el repositorio:</p> <pre><code>$ git config --global core.excludesfile $HOME/.gitignore_global\n</code></pre> <p>Creamos el archivo <code>.gitignore_global</code> en la ra\u00edz y a\u00f1adimos: </p> <pre><code># Compiled source #\n###################\n*.com\n*.class\n*.dll\n*.exe\n*.o\n*.so\n\n# Packages #\n############\n# it's better to unpack these files and commit the raw source\n# git has its own built in compression methods\n*.7z\n*.dmg\n*.gz\n*.iso\n*.jar\n*.rar\n*.tar\n*.zip\n\n# Logs and databases #\n######################\n*.log\n*.sql\n*.sqlite\n\n# OS generated files #\n######################\n.DS_Store\n.DS_Store?\n._*\n.Spotlight-V100\n.Trashes\nehthumbs.db\nThumbs.db\n*~\n*.swp\n\n# IDEs               #\n######################\n.idea\n.settings/\n.classpath\n.project\n</code></pre> </li> </ul>"},{"location":"Ud1/PPE/CPPE/","title":"Cheatsheet UD1 - Despliegue de Aplicaciones","text":"<p>Este documento resume los comandos esenciales de Git y GitHub utilizados en la l\u00ednea de comandos Linux, principalmente para la Unidad 1 del curso de Despliegue de Aplicaciones.</p>"},{"location":"Ud1/PPE/CPPE/#instalacion-de-git","title":"Instalaci\u00f3n de Git","text":""},{"location":"Ud1/PPE/CPPE/#ubuntudebian","title":"Ubuntu/Debian","text":"<pre><code>$ sudo apt update\n$ sudo apt upgrade\n$ sudo apt install git\n</code></pre> <ul> <li>Actualiza la lista de paquetes, actualiza los paquetes instalados y luego instala Git.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#fedora","title":"Fedora","text":"<pre><code>$ sudo yum install git\n</code></pre> <ul> <li>Instala Git en distribuciones Fedora.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#configuracion-inicial","title":"Configuraci\u00f3n Inicial","text":""},{"location":"Ud1/PPE/CPPE/#configuracion-del-usuario","title":"Configuraci\u00f3n del Usuario","text":"<pre><code>$ git config --global user.name \"Tu Nombre\"\n$ git config --global user.email usuario@example.com\n</code></pre> <ul> <li>Configura tu nombre y correo electr\u00f3nico para que Git los asocie con tus commits.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#configuracion-de-push-y-branch","title":"Configuraci\u00f3n de Push y Branch","text":"<pre><code>$ git config --global push.default simple\n$ git config --global init.defaultBranch main\n</code></pre> <ul> <li>Define el comportamiento por defecto del comando git push y establece la rama principal como main.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#configuracion-de-exclusiones","title":"Configuraci\u00f3n de Exclusiones","text":"<pre><code>$ git config --global core.excludesfile $HOME/.gitignore_global\n</code></pre> <ul> <li>Establece un archivo .gitignore global para excluir archivos espec\u00edficos en todos tus proyectos.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#comandos-basicos","title":"Comandos B\u00e1sicos","text":""},{"location":"Ud1/PPE/CPPE/#estado-y-preparacion","title":"Estado y Preparaci\u00f3n","text":"<pre><code>$ git status\n</code></pre> <ul> <li>Muestra el estado del repositorio.</li> </ul> <pre><code>$ git init\n</code></pre> <ul> <li>Inicializa un nuevo repositorio Git.</li> </ul> <pre><code>$ git add &lt;file-name&gt;\n$ git add .\n</code></pre> <ul> <li>A\u00f1ade archivos al \u00e1rea de preparaci\u00f3n.</li> </ul> <pre><code>$ git commit -m \"Creaci\u00f3n del proyecto\"\n$ git commit -am \"Creaci\u00f3n del proyecto\"\n</code></pre> <ul> <li>Crea un commit con los cambios a\u00f1adidos al area de preparaci\u00f3n</li> </ul>"},{"location":"Ud1/PPE/CPPE/#historial-de-cambios","title":"Historial de Cambios","text":"<pre><code>$ git log\n$ git log --oneline\n$ git log --oneline --max-count=2\n$ git log --oneline --since='5 minutes ago'\n$ git log --oneline --until='5 minutes ago'\n$ git log --oneline --author=usuario\n$ git log --oneline --all\n$ git log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\n</code></pre> <ul> <li>Revisa el historial de commits con diferentes formatos y filtros.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#alias-utiles","title":"Alias \u00datiles","text":"<pre><code>$ git config --global alias.br branch\n$ git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\"\n</code></pre> <ul> <li>Crea alias para acceder f\u00e1cilmente a comandos recurrentes como branch y log con formato largo.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#manejo-de-etiquetas","title":"Manejo de Etiquetas","text":"<pre><code>$ git tag\n$ git tag &lt;version-name&gt;\n$ git tag -d &lt;tag-name&gt;\n</code></pre> <ul> <li>Lista, crea o elimina etiquetas (tags) a las versiones del proyecto.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#mostrar-diferencias","title":"Mostrar diferencias","text":"<pre><code>$ git diff\n$ git diff --staged\n</code></pre> <ul> <li>Muestra las diferencias entre el directorio de trabajo y el \u00e1rea de preparaci\u00f3n.</li> </ul> <pre><code>$ git diff &lt;branch-name&gt;\n$ git diff &lt;current-tag&gt; &lt;diff-tag&gt;\n</code></pre> <ul> <li>Muestra las diferencias entre el dictorio de trabajo y una rama, o entre dos etiquetas.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#comandos-avanzados","title":"Comandos Avanzados","text":"<pre><code>$ git cherry-pick &lt;commit-hash&gt;\n</code></pre> <ul> <li>Aplica los cambios de un commit espec\u00edfico en la rama actual.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#restaurar-cambios","title":"Restaurar Cambios","text":"<pre><code>$ git add &lt;file-name&gt;\n$ git restore --staged &lt;file-name&gt;\n</code></pre> <ul> <li>Restaura archivos del \u00e1rea de preparaci\u00f3n.</li> </ul> <pre><code>$ git restore &lt;file-name&gt;\n</code></pre> <ul> <li>Restaura archivos del directorio de trabajo.</li> </ul> <pre><code>$ git commit -am \"Commit mal\"\n$ git revert HEAD --no-edit\n</code></pre> <ul> <li>Revierte el \u00faltimo commit realizado.</li> </ul> <pre><code>$ git reset --hard &lt;branch-tag&gt;\n</code></pre> <ul> <li>Resetea el repositorio al estado de una rama o etiqueta espec\u00edfica.</li> </ul> <pre><code>$ git commit --amend -m \"A\u00f1adido el autor del programa y su email\"\n</code></pre> <ul> <li>Modifica el contenido del \u00faltimo commit.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#mover-y-eliminar-archivos","title":"Mover y Eliminar Archivos","text":"<pre><code>$ git mv &lt;old-file&gt; &lt;new-file&gt;\n$ git rm &lt;file-name&gt;\n</code></pre> <ul> <li>Mueve o elimina archivos en el repositorio.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#comandos-de-ramas","title":"Comandos de Ramas","text":""},{"location":"Ud1/PPE/CPPE/#gestion-de-ramas","title":"Gesti\u00f3n de Ramas","text":"<pre><code>$ git branch\n$ git branch -r\n</code></pre> <ul> <li>Listar las ramas locales, y las remotas.</li> </ul> <pre><code>$ git branch &lt;branch-name&gt;\n$ git branch -d &lt;branch-name&gt;\n</code></pre> <ul> <li>Crear y eliminar una rama.</li> </ul> <pre><code>$ git checkout &lt;branch-name&gt;\n$ git checkout -b &lt;branch-name&gt;\n</code></pre> <ul> <li>Cambiar a una rama espec\u00edfica, o crea y cambia a una nueva rama</li> </ul> <pre><code>$ git switch -\n$ git switch -c &lt;new-branch-name&gt;\n</code></pre> <ul> <li>Cambia a la rama anterior, o crea y cambia a una nueva rama.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#fusionar-ramas","title":"Fusionar Ramas","text":"<pre><code>$ git merge &lt;branch-name&gt;\n$ git merge -m \"Nombre commit\" --no-ff &lt;branch-name&gt;\n</code></pre> <ul> <li>Fusiona una rama en la actual. Usa --no-ff para conservar el historial de la rama fusionada.</li> </ul> <pre><code>$ git rebase &lt;branch-name&gt;\n$ git rebase --continue\n</code></pre> <ul> <li>Integra cambios de una rama en otra reescribiendo el historial.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#comandos-para-trabajar-en-remoto","title":"Comandos para Trabajar en Remoto","text":""},{"location":"Ud1/PPE/CPPE/#generar-clave-ssh","title":"Generar Clave SSH","text":"<pre><code>$ ssh-keygen -t rsa -C \"Cuenta GitHub\"\n</code></pre> <ul> <li>Genera una clave SSH para autenticarse en GitHub.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#clonar-repositorio","title":"Clonar Repositorio","text":"<pre><code>$ git clone git@github.com:github-user/repository-name.git\n$ cd repository-name/\n</code></pre> <ul> <li>Clona un repositorio de GitHub y navega al directorio del mismo.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#configuracion-remota","title":"Configuraci\u00f3n Remota","text":"<pre><code>$ git remote add origin git@github.com:github-user/repository-name.git\n$ git branch -M main\n$ git push -u origin main\n</code></pre> <ul> <li>A\u00f1ade un repositorio remoto, cambia el nombre de la rama principal y env\u00eda los cambios al Hub.</li> </ul> <pre><code>$ git remote show origin\n</code></pre> <ul> <li>Muestra informaci\u00f3n sobre el repositorio remoto.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#sincronizacion-con-remoto","title":"Sincronizaci\u00f3n con Remoto","text":"<pre><code>$ git fetch\n$ git remote update\n</code></pre> <ul> <li>Descarga objetos y referencias desde el repositorio remoto.</li> </ul> <pre><code>$ git push\n$ git pull\n</code></pre> <ul> <li>Env\u00eda y recibe de cambios desde el repositorio remoto.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#caja-de-cambios","title":"Caja de cambios","text":"<pre><code>$ git stash save\n$ git pull\n$ git stash pop\n</code></pre> <ul> <li>Guarda cambios no confirmados en el stash, recibe la nueva informaci\u00f3n y aplica los cambios guardados en el stash.</li> </ul> <pre><code>$ git stash list\n</code></pre> <ul> <li>Listar los cambios guardados en el stash.</li> </ul> <pre><code>$ git stash drop\n</code></pre> <ul> <li>Eliminar los cambios guardados en el stash.</li> </ul> <pre><code>$ git pull --autostash\n$ git pull --autostash --rebase\n</code></pre> <ul> <li>Recibe de cambios del remoto y guarda autom\u00e1ticamente los cambios no confirmados en el stash.</li> </ul>"},{"location":"Ud1/PPE/CPPE/#gestion-de-ramas-remotas","title":"Gesti\u00f3n de ramas remotas","text":"<pre><code>$ git push --set-upstream origin &lt;branch-name&gt;\n</code></pre> <ul> <li>Empuja una rama y establece la rama en el directorio remoto.</li> </ul> <pre><code>$ git merge --squash &lt;branch-name&gt;\n</code></pre> <ul> <li>Fusiona los commits de una rama en un solo commit.</li> </ul> <pre><code>$ git push origin --delete add-license\n</code></pre> <ul> <li>Env\u00edar los cambios y eliminar la rama remota.</li> </ul>"},{"location":"Ud1/RPE/cheatsheet1/","title":"Cheatsheet de comandos Git","text":""},{"location":"Ud1/RPE/cheatsheet1/#instalacion","title":"Instalaci\u00f3n","text":"<p>Para instalar git tendremos que tener el sistema y los directorios actualizados. Para ello utilizaremos el comando:</p> <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\n</code></pre> <p>Una vez actualizado, para instalar git ejecutaremos el siguiente comando:</p> <pre><code>apt-get install git\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#configuracion","title":"Configuraci\u00f3n","text":""},{"location":"Ud1/RPE/cheatsheet1/#identidad","title":"Identidad","text":"<p>Si queremos configurar un nombre de usuario, utilizaremos la siguiente orden:</p> <pre><code>git config --global user.name \"[nombre del usuario]\"\n</code></pre> <p>Si lo que queremos es establecer el email del usuario, usaremos:</p> <pre><code>git config --global user.email [email del usuario]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#recomendaciones","title":"Recomendaciones","text":"<p>Se recomienda configurar el push por defecto a simple con el comando:</p> <pre><code>git config --global push.default simple\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#crear-y-gestionar-un-proyecto","title":"Crear y gestionar un proyecto","text":"<p>El comando para crear un repositorio en el directorio actual es:</p> <pre><code>git init\n</code></pre> <p>Para a\u00f1adir el archivo deseado al repositorio o agregar los cambios del mismo al \u00e1rea de preparaci\u00f3n, usaremos el comando:</p> <pre><code>git add [nombre del archivo]\n</code></pre> <p>Para comprobar el estado de los archivos en el repositorio utilizaremos:</p> <pre><code>git status\n</code></pre> <p>El comando utilizado para guardar los cambios en el repositorio es (se recomienda poner la opci\u00f3n -m ya que as\u00ed puedes especificar el mensaje directamente en la orden):</p> <pre><code>git commit -m \"[mensaje]\"\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#alias","title":"Alias","text":"<p>Para crear un alias, usaremos:</p> <pre><code>git config --global alias.[nombre del alias] \"ordenes del alias\"\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#utilizar-el-historial","title":"Utilizar el historial","text":"<p>Para poder observar los cambios que hemos hecho, m\u00e1s espec\u00edficamente los commits, ejecutaremos el comando (para salir, pulsar <code>q</code>):</p> <pre><code>git log\n</code></pre> <p>Para verlo de una forma m\u00e1s abreviada, usaremos:</p> <pre><code>git log --oneline\n</code></pre> <p>Si lo que queremos es regresar a alguna versi\u00f3n anterior, utilizaremos el comando:</p> <pre><code>git checkout [commit id]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#etiquetas","title":"Etiquetas","text":"<p>Para etiquetar versiones del repositorio, ejecutaremos la orden:</p> <pre><code>git tag [nombre etiqueta]\n</code></pre> <p>Si queremos borrar una etiqueta creada, utilizaremos:</p> <pre><code>git tag -d [nombre_etiqueta]\n</code></pre> <p>El comando utilizado para ver los cambios entre dos commits es:</p> <pre><code>git diff [commit1] [commit2]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#deshacer-cambios","title":"Deshacer cambios","text":"<p>Si queremos deshacer los cambios que hemos a\u00f1adido al Staging Area, usaremos el comando:</p> <pre><code>git restore --staged [archivo]\n</code></pre> <p>Para volver a la \u00faltima versi\u00f3n del archivo, utilizaremos:</p> <pre><code>git restore [archivo]\n</code></pre> <p>En el caso que queramos deshacer un commit, ejecutaremos:</p> <pre><code>git revert HEAD --no-edit\n</code></pre> <p>El comando utilizado para deshacer un commit sin dejar rastro de ello ser\u00e1:</p> <pre><code>git reset --hard [commit1]\n</code></pre> <p>Si lo que queremos es modificar el \u00faltimo commit, el comando a utilizar es:</p> <pre><code>git commit --amend -m [Mensaje nuevo]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#mover-archivos","title":"Mover archivos","text":"<p>Para mover archivos, usaremos el comando:</p> <pre><code>git mv [archivo] [nueva localizaci\u00f3n]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#eliminar-archivos","title":"Eliminar archivos","text":"<p>Si queremos eliminar un archivo de git, es:</p> <pre><code>git rm [archivo]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#ramas","title":"Ramas","text":"<p>El comando utilizado para listar todas las ramas es:</p> <pre><code>git branch\n</code></pre> <p>Para crear una rama sin entrar en ella, utilizaremos:</p> <pre><code>git branch [nombre rama]\n</code></pre> <p>Una vez creada, para cambiar a esa rama ejecutaremos:</p> <pre><code>git checkout [nombre rama]\n</code></pre> <p>Si queremos hacer las dos a la vez, usaremos:</p> <pre><code>git checkout -b [nombre rama]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#fusion-de-ramas","title":"Fusi\u00f3n de ramas","text":"<p>El comando utilizado para fusionar ramas es (se fusionar\u00e1n la rama seleccionada con la actual):</p> <pre><code>git merge [nombre rama con la que nos queremos fusionar]\n</code></pre> <p>Si queremos que quede un registro de la fusi\u00f3n, tendremos que utilizar:</p> <pre><code>git merge -m \"[mensaje]\" --no-ff [nombre de la rama]\n</code></pre> <p>Si no queremos mantener el historial de ambas ramas, utilizaremos el comando:</p> <pre><code>git rebase [nombre rama con la que nos queremos fusionar]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#configuracion-ssh","title":"Configuraci\u00f3n SSH","text":"<p>Para crear una clave ssh, utilizaremos el comando:</p> <pre><code>ssh-keygen -t rsa -C \"[nombre]\"\n</code></pre> <p>Para vincular a un repositorio de GitHub ya existente, usaremos:</p> <pre><code>git remote add origin git@github.com:[usuario]/[nombre-repositorio.git]\n</code></pre> <p>Si queremos cambiar el nombre de la rama principal, utilizaremos:</p> <pre><code>git branch -M [nombre]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#subir-el-proyecto-a-github","title":"Subir el proyecto a GitHub","text":"<p>El siguiente comando env\u00eda los cambios locales al repositorio de GitHub (la opci\u00f3n -u establece una relaci\u00f3n entre la rama main local y remota):</p> <pre><code>git push -u [repositorio] [rama destino]\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#clonar-un-repositorio-de-github","title":"Clonar un repositorio de GitHub","text":"<p>Para clonar un repositorio, usaremos el comando:</p> <pre><code>git clone git@github.com:[usuario]/[nombre-repositorio.git]\n</code></pre> <p>Si queremos ver la configuraci\u00f3n del repositorio remoto, utilizaremos:</p> <pre><code>git remote show [nombre del remoto]\n</code></pre> <p>Usaremos este comando para traer la informaci\u00f3n de los cambios, pero no los cambios del servidor en s\u00ed:</p> <pre><code>git fetch\n</code></pre> <p>Para traer los cambios, necesitaremos el comando:</p> <pre><code>git merge [nombre del remoto]/[rama remota]\n</code></pre> <p>Tambi\u00e9n est\u00e1 la opci\u00f3n de combinar las dos acciones con el comando:</p> <pre><code>git pull\n</code></pre> <p>Si queremos que sea rebase, ejecutaremos lo siguiente (ya que por defecto hace un merge):</p> <pre><code>git pull --rebase\n</code></pre> <p>Para guardar los cambios no confirmados temporalmente, usaremos:</p> <pre><code>git stash save\n</code></pre> <p>Si queremos restaurar los cambios guardados en el stash, ejecutaremos:</p> <pre><code>git stash pop\n</code></pre> <p>Hay un comando que hace los tres comandos a la vez:</p> <pre><code>git pull --autostash\n</code></pre>"},{"location":"Ud1/RPE/cheatsheet1/#colaboracion-en-github","title":"Colaboraci\u00f3n en GitHub","text":"<p>Para crear la rama remota que hace referencia al repositorio original, se utiliza el siguiente comando:</p> <pre><code>git remote add upstream [enlace github]\n</code></pre> <p>Si queremos enviar una rama al repositorio origin, tendremos que ejecutar:</p> <pre><code>git push --set-upstream origin [nombre de nuestra rama]\n</code></pre> <p>```</p>"},{"location":"Ud1/RRLL/cheatsheet/","title":"Cheatsheet GIT de Rommel","text":""},{"location":"Ud1/RRLL/cheatsheet/#configurar-git","title":"Configurar GIT","text":""},{"location":"Ud1/RRLL/cheatsheet/#configurar-nombre","title":"Configurar nombre","text":"<pre><code>git config --global user.name \"nombre\"\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#configurar-email","title":"Configurar email","text":"<pre><code>git config --global user.email \"email\"\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#uso-basico-de-git","title":"Uso b\u00e1sico de git","text":""},{"location":"Ud1/RRLL/cheatsheet/#inicializar-un-repositorio-git","title":"Inicializar un repositorio Git","text":"<pre><code>git init\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#comandos-basicos-de-git","title":"Comandos b\u00e1sicos de Git","text":""},{"location":"Ud1/RRLL/cheatsheet/#consultar-el-estado-de-un-proyecto","title":"Consultar el estado de un proyecto","text":"<pre><code>git status\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#anadir-el-archivo-o-sus-cambios-al-area-de-preparacion-staging-area","title":"A\u00f1adir el archivo o sus cambios al \u00e1rea de preparaci\u00f3n (staging area)","text":"<pre><code>git add nombre_del_archivo\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#anadir-los-archivos-de-forma-recursiva-al-area-de-preparacion-staging-area","title":"A\u00f1adir los archivos de forma recursiva al \u00e1rea de preparaci\u00f3n (staging area)","text":"<pre><code>git add .\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#confirmar-los-cambios","title":"Confirmar los cambios","text":"<pre><code>git commit -m \"mensaje del commit\"\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#git-ignore-global","title":"Git ignore global","text":"<p>Primero debes configurar el archivo .gitignore_global, una vez lo tenegas dependiendo de donde est\u00e9 ubicado el archivo, $HOME puede ser sustituido.</p>"},{"location":"Ud1/RRLL/cheatsheet/#aplicar-el-archivo-gitignore_global","title":"Aplicar el archivo .gitignore_global","text":"<pre><code>git config --global core.excludesfile $HOME/.gitignore_global\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#historial-de-los-commits","title":"Historial de los commits","text":"<pre><code>git log\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#crear-un-alias","title":"Crear un alias","text":"<pre><code>git config --global alias.nombre_del_alias \"Orden que realiza\"\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#volver-a-un-commit-anterior","title":"Volver a un commit anterior","text":"<pre><code>git checkout hash_commit\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#guardar-los-cambios-en-una-nueva-rama","title":"Guardar los cambios en una nueva rama","text":"<p>Antes hay que realizar un git add y un git commit como hemos visto previamente</p> <pre><code>git switch -c nombre_rama\n</code></pre> <pre><code>git checkout -b nueva_rama\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#volver-a-la-rama-anterior","title":"Volver a la rama anterior","text":"<pre><code>git switch -\n</code></pre> <pre><code>git checkout master\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#volver-el-estado-del-proyecto-al-commit-deseado","title":"Volver el estado del proyecto al commit deseado","text":"<pre><code>git reset hash_commit\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#variaciones","title":"Variaciones","text":""},{"location":"Ud1/RRLL/cheatsheet/#soft","title":"Soft","text":"<p>Al aplicar esta opcion los cambios de los commits se mantienen en la \u00e1rea de preparaci\u00f3n (staging area) y los cambios realizados en el working directory siguen intactos.</p> <pre><code>git reset --soft hash_commit\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#mixed","title":"Mixed","text":"<p>Al aplicar esta opcion los cambios de los commits se quitan del \u00e1rea de preparaci\u00f3n (staging area) y los cambios realizados en el working directory siguen intactos, es el que se aplica por defecto.</p> <pre><code>git reset --mixed hash_commit\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#hard","title":"Hard","text":"<p>Al aplicar esta opcion los cambios de los commits se quitan del \u00e1rea de preparaci\u00f3n (staging area) y los cambios realizados en el working directory tambi\u00e9n se pierden.</p> <pre><code>git reset --hard hash_commit\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#etiquetas","title":"Etiquetas","text":""},{"location":"Ud1/RRLL/cheatsheet/#anadir-etiqueta","title":"A\u00f1adir etiqueta","text":"<pre><code>git tag nombre_etiqueta\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#ver-etiquetas-existentes","title":"Ver etiquetas existentes","text":"<pre><code>git tag\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#borrar-etiqueta","title":"Borrar etiqueta","text":"<pre><code>git tag -d nombre_etiqueta\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#visualizar-cambios","title":"Visualizar cambios","text":""},{"location":"Ud1/RRLL/cheatsheet/#cambios-entre-el-ultimo-commit-y-el-area-de-trabajo-working-directory","title":"Cambios entre el \u00faltimo commit y el \u00e1rea de trabajo (working directory)","text":"<pre><code>git diff\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#cambios-entre-un-commit-y-el-work-direcotry","title":"Cambios entre un commit y el work direcotry","text":"<pre><code>git diff hash_commit\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#cambios-entre-dos-commits","title":"Cambios entre dos commits","text":"<pre><code>git diff hash_commit has_commit\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#uso-avanzado-de-git","title":"Uso avanzado de Git","text":""},{"location":"Ud1/RRLL/cheatsheet/#desacer-cambios","title":"Desacer cambios","text":""},{"location":"Ud1/RRLL/cheatsheet/#deshaciendo-cambios-antes-de-la-fase-de-staging","title":"Deshaciendo cambios antes de la fase de staging","text":"<pre><code>git restore nombre_archivo\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#deshaciendo-cambios-antes-del-commit","title":"Deshaciendo cambios antes del commit","text":"<pre><code>git restore --staged nombre_archivo\n</code></pre> <pre><code>git restore nombre_archivo\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#deshacer-commits","title":"Deshacer commits","text":"<pre><code>git revert hash_commit --no-edit\n</code></pre> <p>Si quieres revertir al \u00faltimo comit donde head est\u00e1 apuntando</p> <pre><code>git revert HEAD --no-edit\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#modificar-un-commit","title":"Modificar un commit","text":"<pre><code>git commit --amend -m \"mensaje del commit\"\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#renombrar-y-mover-archivos","title":"Renombrar y mover archivos","text":""},{"location":"Ud1/RRLL/cheatsheet/#renombrar","title":"Renombrar","text":"<pre><code>git mv nombre_archivo nuevo_nombre\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#mover","title":"Mover","text":"<pre><code>git mv nombre_archivo carpeta\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#ramas","title":"Ramas","text":""},{"location":"Ud1/RRLL/cheatsheet/#crear-una-nueva-rama","title":"Crear una nueva rama","text":"<pre><code>git branch nombre_rama\n</code></pre> <p>Si queremos crear la rama y situarnos en ella directamente podemos usar cualquiera de estos dos comandos.</p> <pre><code>git switch -c nombre_rama\n</code></pre> <pre><code>git checkout -b nombre_rama\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#ver-nuestras-ramas","title":"Ver nuestras ramas","text":"<pre><code>git branch\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#cambiar-de-ramas","title":"Cambiar de ramas","text":"<pre><code>git switch nombre_rama\n</code></pre> <pre><code>git checkout nombre_rama\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#fusion-de-ramas","title":"Fusi\u00f3n de ramas","text":"<pre><code>git merge nombre_rama\n</code></pre> <pre><code>git rebase nombre_rama\n</code></pre> <p>Los dos comandos sirven para fusionar ramas, la principal diferencia es que merge mantiene el historial completo de ambas ramas y se a\u00f1ade un nuevo commit que representa la fusi\u00f3n y rebase convierte el historial en una \u00fanica linea sin bifurcaciones, no crea un commit de fusi\u00f3n.</p>"},{"location":"Ud1/RRLL/cheatsheet/#fast-forward-y-squash","title":"fast-forward y Squash","text":"<pre><code>git merge --no-ff nombre_rama \n</code></pre> <p>Por defecto es fast-forward, esto lo que signifca es que no deja rastro de la fusi\u00f3n, por ello es recomendable usar el parametro --no-ff para que quede constancia de que una rama se ha fusionado con otra.</p> <pre><code>git merge --squash nombre_rama \n</code></pre> <p>B\u00e1sicamente lo que hace es combinar todos los commits de la rama fusionada en un solo commit. Despu\u00e9s de eso tenemos que hacer un commit manualmente.</p> <p></p>"},{"location":"Ud1/RRLL/cheatsheet/#github","title":"GitHub","text":""},{"location":"Ud1/RRLL/cheatsheet/#crear-clave-publicaprivada","title":"Crear clave P\u00fablica/Privada","text":"<pre><code>ssh-keygen -t rsa -C \"Cuenta GitHub\"\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#anadir-ssh-a-github","title":"A\u00f1adir SSH a GitHub","text":"<p>Copias el contenido de tu clave p\u00fablica y lo a\u00f1ades en GitHub.</p> <pre><code>cat ~/.ssh/id_rsa.pub\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#crear-el-repositorio-remoto","title":"Crear el repositorio remoto","text":"<p>Previamente tienes que tener creado el repositorio en GitHub.</p> <pre><code>git remote add origin enlace_repositorio_GitHub\n</code></pre> <p>Si queires modificar la URL usa este comando</p> <pre><code>git remote set-url origin enlace_repositorio_GitHub\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#ver-la-configuracion-de-nuestro-repositorio-remoto","title":"Ver la configuraci\u00f3n de nuestro repositorio remoto","text":"<pre><code>git remote show origin\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#clonar-un-repositorio-de-github","title":"Clonar un repositorio de GitHub","text":"<pre><code>git clone enlace_repositorio_GitHub\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#subir-archivos-a-github","title":"Subir archivos a GitHub","text":"<pre><code>git push origin master\n</code></pre> <p>Si usas el comando de abajo gracias al parametro -u vinculamos nuestra rama local con una rama remota, de tal manera que no tengamos que estar siempre indic\u00e1ndolo cuando hagamos un pull o push</p> <pre><code>git push -u origin master\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#actualizar-nuestro-repositorio-local","title":"Actualizar nuestro repositorio local","text":"<p>Hay dos formas de realizarlo.</p>"},{"location":"Ud1/RRLL/cheatsheet/#fetch-y-mergerebase","title":"Fetch y merge/rebase","text":"<pre><code>git fetch\n</code></pre> <pre><code>git merge origin/master\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#pull","title":"Pull","text":"<pre><code>git pull \n</code></pre> <p>Por defecto git pull lo que hace es un git merge, si queremos hacer git rebase deberemos especificarlos con el par\u00e1metro -r o --rebase.</p> <pre><code>git pull --rebase \n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#guardar-los-cambios-no-confirmados-temporalmente","title":"Guardar los cambios no confirmados temporalmente","text":"<p>Esto generalmente es usado para solucionar conflictos que surgen cuando queremos hacer un git pull y no nos deja debido a que tenemos archivos son confirmar en local.</p> <ul> <li>Guardar los archivos sin confirmar.</li> </ul> <pre><code>git stash save\n</code></pre> <ul> <li>Hacemos un push.</li> </ul> <pre><code>git stash save\n</code></pre> <ul> <li>Recuperamos los archivos sin confirmar.</li> </ul> <pre><code>git stash pop\n</code></pre> <p>Git te permite hacer esto con un solo comando.</p> <pre><code>git pull --autostash\n</code></pre> <p>Y si quieres que adem\u00e1s te haga un rebase, le a\u00f1adimos lo que hemos visto anteriormente.</p> <pre><code>git pull --autostash --rebase\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#ramas-en-github","title":"Ramas en GitHub","text":""},{"location":"Ud1/RRLL/cheatsheet/#subir-una-nueva-rama-a-github","title":"Subir una nueva rama a GitHub","text":"<ul> <li>Creamos la rama en local</li> </ul> <pre><code>git branch nombre_rama\n</code></pre> <ul> <li>Hacemos un push de la rama</li> </ul> <pre><code>git push origin nombre_rama\n</code></pre>"},{"location":"Ud1/RRLL/cheatsheet/#borrar-una-rama-en-github","title":"Borrar una rama en GitHub","text":"<pre><code>git push origin -d nombre_rama\n</code></pre>"},{"location":"Ud1/RSN/cheatsheet1/","title":"Cheatsheet git","text":""},{"location":"Ud1/RSN/cheatsheet1/#uso-basico-de-git","title":"Uso b\u00e1sico de Git","text":"<ul> <li> <p>git status -&gt; Saber el estado de los archivos(d\u00f3nde se encuentran)</p> </li> <li> <p>git init -&gt; Inicializar git(\u00fanicamente se debe realizar una vez)</p> </li> <li> <p>git add -&gt; A\u00f1adir a Staging area</p> </li> <li> <p>git commit -m \"Nombre del commit\" -&gt; Pasar al repositorio local</p> </li> <li> <p>.gitignore -&gt; Archivo que se crea para ignorar archivos</p> </li> <li> <p>git config --global core.excludesfile $HOME/.gitignore_global -&gt; Fichero gitignore global</p> </li> <li> <p>git log -&gt; Observar todos los cambios realizados anteriormente</p> </li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#git-log","title":"Git log","text":"<ol> <li> <p>git log --online --max-count=2 -&gt; Muestra m\u00e1ximo 2 lineas</p> </li> <li> <p>git log --oneline --since='5 minutes ago' -&gt; Muestra a partir de 5 min</p> </li> <li> <p>git log --oneline --until='5 minutes ago' -&gt; Muestra hasta 5 min.</p> </li> <li> <p>git log --oneline --author=rauls -&gt; Muestra los del autor</p> </li> <li> <p>git log --oneline --all -&gt; Muestra todos</p> </li> <li> <p>git log --online -&gt; Muestra \u00fanicamente una l\u00ednea</p> </li> <li> <p>git log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short -&gt; Nos permite ver d\u00f3nde estan master y HEAD y m\u00e1s</p> </li> </ol>"},{"location":"Ud1/RSN/cheatsheet1/#crear-alias","title":"Crear alias","text":"<ul> <li> <p>git config --global alias.hist \"log --pretty=format:'%h %ad | %s%d [%an]' --graph --date=short\" -&gt; Nos perimte crear un alias para comandos</p> </li> <li> <p>git hist -&gt; Se ejecuta el alias</p> </li> <li> <p>git hist master --all -&gt; Muestra todo el historial</p> </li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#checkout","title":"Checkout","text":"<ul> <li> <p>git checkout \"hash\" -&gt; Se utiliza para regresar al estado del proyecto</p> </li> <li> <p>git switch - -&gt; Vuelve al estado final</p> </li> <li> <p>git checkout \"tag\"^ -&gt; Nos lleva al ancestro</p> </li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#tag","title":"Tag","text":"<ul> <li> <p>git tag -&gt; Crea una etiqueta concreta</p> </li> <li> <p>git tag -d \"etiqueta\" -&gt; Borra la etiqueta</p> </li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#ver-cambios","title":"Ver cambios","text":"<ul> <li>git diff \"nombre etiqueta\"-\"nombre etiqueta\" -&gt; Ver cambios que se han realizado</li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#deshacer-cambios","title":"Deshacer cambios","text":"<ul> <li>git restore \"nombre archivo\" -&gt; Deshacer cambios</li> </ul> <p>-git restore --staged \"nombre archivo\" -&gt; Sacar del \u00e1rea de staging</p>"},{"location":"Ud1/RSN/cheatsheet1/#deshacer-commits","title":"Deshacer commits","text":"<ul> <li>git revert HEAD --no-edit -&gt; Revertir \u00faltimo commit que apunta a HEAD</li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#borar-commits-de-una-rama","title":"Borar commits de una rama","text":"<ul> <li>git reset --hard \"nombre\" -&gt; Eliminar commit</li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#modificar-commit","title":"Modificar commit","text":"<ul> <li>git commit --amend -m \"Descripcion\"-&gt; Permite modificar el \u00faltimo estado confirmado</li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#mover-y-borrar-archivos","title":"Mover y borrar archivos","text":"<ul> <li>git mv \"Nombre\" \"Carpeta\"-&gt; Mover a la carpeta</li> <li>git rm \"Nombre\" -&gt; Eliminar archivo </li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#ramas","title":"Ramas","text":"<ul> <li> <p>git branch \"Nombre\" -&gt; Crear rama</p> </li> <li> <p>git checkout \"Nombre\" -&gt; Moverse a la rama</p> </li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#fusion-de-ramas","title":"Fusion de ramas","text":"<ul> <li> <p>git merge \"Nombre\" -&gt; Se ejecuta en la rama cuyos cambios queremos incorprar a la actual</p> </li> <li> <p>git rebase \"Nombre rama\" -&gt; Es otra forma de fusionar</p> </li> </ul> <p>(Se recomienda el uso de --no-ff, para dejar rastro de fusi\u00f3n)</p>"},{"location":"Ud1/RSN/cheatsheet1/#github","title":"Github","text":""},{"location":"Ud1/RSN/cheatsheet1/#creacion-de-clave-ssh","title":"Creaci\u00f3n de clave ssh","text":"<ul> <li>ssh-keygen -t rsa -C \"Cuenta GitHub\" -&gt; Crea una clave ssh</li> </ul>"},{"location":"Ud1/RSN/cheatsheet1/#comandos-para-repositorio-en-la-nube","title":"Comandos para repositorio en la nube","text":"<ul> <li> <p>git remote add origin \"Enlace ssh github\" -&gt; A\u00f1ade un repositorio remoto</p> </li> <li> <p>git branch -M main -&gt; Se utiliza para renombrar a una rama</p> </li> <li> <p>git push -u origin main -&gt; Envia los cambios de locala la nube</p> </li> <li> <p>git clone \"Enlace github\" -&gt; Clona el repositorio en local</p> </li> <li> <p>git fetch -&gt; Trae informaci\u00f3n del remoto</p> </li> <li> <p>git pull -&gt; Descarga el contenido del remoto y lo fusiona con la rama local</p> </li> <li> <p>git stash save -&gt; Se guardan los cambios en la pila</p> </li> <li> <p>git stash pop -&gt; Se sacan los cambios de la pila</p> </li> </ul>"},{"location":"Ud1/VATC/cheatsheet/","title":"\ud83c\udf1f UD1 - Cheatsheet","text":"<p>\u270d\ufe0f Victor Alexandru Teleanu Covaci</p>"},{"location":"Ud1/VATC/cheatsheet/#instalacion-de-git","title":"\ud83d\ude80 Instalaci\u00f3n de Git","text":"\ud83d\udcbb Sistema Operativo / \ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n \ud83d\udc27 Linux <code>yum install git-core</code> Instalar Git en Linux (instalador binario) <code>apt-get install git</code> Instalar Git en distribuci\u00f3n basada en Debian \ud83e\ude9f Windows \ud83d\udd17 Git para Windows Descargar Git para Windows \ud83c\udf4f MacOS <code>brew install git</code> Instalar Git en MacOS"},{"location":"Ud1/VATC/cheatsheet/#recomendaciones","title":"\ud83d\udd0d Recomendaciones","text":"<ul> <li>Con <code>git version</code> puedes comprobar la versi\u00f3n instalada de Git.</li> <li>Con <code>git help &lt;comando&gt;</code> podemos ver ayuda detallada sobre el comando deseado.</li> </ul>"},{"location":"Ud1/VATC/cheatsheet/#configuracion-git","title":"\u2699\ufe0f Configuraci\u00f3n Git","text":""},{"location":"Ud1/VATC/cheatsheet/#tu-identidad","title":"\ud83e\uddd1\u200d\ud83d\udcbb Tu identidad","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git config --global user.name \"John Doe\"</code> Establece tu nombre de usuario global <code>git config --global user.email johndoe@example.com</code> Establece tu correo electr\u00f3nico global <code>git config --global push.default simple</code> Env\u00eda solo la rama actual al repositorio remoto <code>git config --global core.excludesfile $HOME/.gitignore_global</code> Configura un fichero gitignore global"},{"location":"Ud1/VATC/cheatsheet/#uso-basico-de-git","title":"\ud83d\udcda Uso b\u00e1sico de Git","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git init</code> Crea un nuevo repositorio <code>git status</code> Consulta el estado de los archivos del proyecto <code>git add archivo.txt</code> Almacena el archivo en el repositorio; pasa a la \"Staging area\" <code>git add .</code> A\u00f1ade todos los archivos y directorios al proyecto <code>git commit -m \"mensaje del commit\"</code> Guarda los cambios en el repositorio con un mensaje de commit <code>git push origin &lt;rama&gt;</code> Env\u00eda los cambios de la rama local al repositorio remoto <code>git switch &lt;rama&gt;</code> Cambia a la rama especificada"},{"location":"Ud1/VATC/cheatsheet/#estados-de-un-archivo-en-git","title":"\ud83d\udcc1 Estados de un archivo en Git","text":"<ul> <li>Sin seguimiento (untracked): Archivos no rastreados por Git.</li> <li>Modificado (modified): Archivos con cambios desde el \u00faltimo commit.</li> <li>Preparado (staged): Archivos listos para ser confirmados.</li> <li>Confirmado (committed): Archivos guardados en el historial del repositorio.</li> </ul>"},{"location":"Ud1/VATC/cheatsheet/#historial","title":"\ud83d\udcdc Historial","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git log</code> Muestra todos los cambios realizados <code>git log --oneline</code> Muestra el historial en una sola l\u00ednea <code>git config --global alias.hist \"log --pretty=format:'%h %ad / %s%d [%an]' --graph --date=short\"</code> Crea un alias para ver el historial de forma personalizada <code>git hist</code> Ejecuta el alias creado <code>git diff \"v1\" \"v2\"</code> Muestra los cambios entre versiones"},{"location":"Ud1/VATC/cheatsheet/#versionado","title":"\ud83d\udce6 Versionado","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git tag</code> Muestra todas las etiquetas existentes <code>git tag v1</code> Etiqueta una versi\u00f3n espec\u00edfica <code>git tag -d nombre_etiqueta</code> Borra la etiqueta especificada"},{"location":"Ud1/VATC/cheatsheet/#deshacer-cambios","title":"\ud83d\udee0\ufe0f Deshacer cambios","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git restore archivo.txt</code> Revierte los cambios a la \u00faltima versi\u00f3n que se encuentra en el \u00faltimo commit <code>git restore --staged archivo.txt</code> Mueve el archivo del Staging Area al Working Directory <code>git revert HEAD --no-edit</code> Crea un nuevo commit que deshace los cambios realizados en el commit actual <code>git reset --hard v1</code> Revierte un commit sin dejar rastro en el historial"},{"location":"Ud1/VATC/cheatsheet/#ramas","title":"\ud83c\udf3f Ramas","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git branch</code> Lista todas las ramas <code>git branch nombre_rama</code> Crea una nueva rama <code>git checkout nombre_rama</code> Cambia a una rama espec\u00edfica <code>git checkout -b &lt;nombre_rama&gt;</code> Crea y cambia a una nueva rama <code>git merge &lt;rama&gt;</code> Incorpora los cambios de una rama a la actual sin dejar rastro de fusi\u00f3n <code>git merge &lt;rama&gt; --no-ff</code> Incorpora cambios de una rama a la actual dejando rastro de fusi\u00f3n <code>git rebase &lt;rama&gt;</code> Aplica los commits de una rama a otra"},{"location":"Ud1/VATC/cheatsheet/#github","title":"\ud83c\udf10 GitHub","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git clone git@github.com:usuario/repositorio.git</code> Clona un repositorio remoto en local <code>git remote</code> Muestra la configuraci\u00f3n del repositorio remoto <code>git fetch</code> Trae la informaci\u00f3n del servidor remoto <code>git pull &lt;remoto&gt; &lt;rama&gt;</code> Actualiza el repositorio local con los cambios del remoto <code>git pull --rebase &lt;remoto&gt; &lt;rama&gt;</code> Actualiza el repositorio local con rebase desde el remoto"},{"location":"Ud1/VATC/cheatsheet/#git-flow","title":"\ud83c\udf00 Git Flow","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git flow init</code> Inicializa el espacio de trabajo <code>git flow feature</code> Crea y trabaja con ramas de funcionalidades <code>git flow release</code> Crea y trabaja con ramas de versiones <code>git flow hotfix</code> Crea y trabaja con ramas de parches"},{"location":"Ud1/VATC/cheatsheet/#git-stash","title":"\ud83d\udce6 Git Stash","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git stash</code> Guarda temporalmente los cambios en el espacio de trabajo <code>git stash save</code> Permite guardar con un mensaje espec\u00edfico <code>git stash list</code> Muestra la lista de elementos guardados en stash <code>git stash apply</code> Aplica el stash m\u00e1s reciente en el espacio de trabajo <code>git stash pop</code> Aplica y elimina el stash m\u00e1s reciente <code>git stash show</code> Muestra un resumen de los archivos modificados en ese stash <code>git stash branch</code> Crea una nueva rama desde el \u00faltimo stash <code>git stash clear</code> Elimina todos los elementos guardados en stash (acci\u00f3n destructiva) <code>git stash drop</code> Elimina un stash espec\u00edfico o el m\u00e1s reciente si no se indica ninguno"},{"location":"Ud1/VATC/cheatsheet/#git-worktree","title":"\ud83c\udf33 Git Worktree","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git worktree add /directorio master</code> Crea un directorio con el estado de la rama master <code>git worktree list</code> Muestra la lista de directorios y espacios de trabajo <code>git worktree delete fix</code> Elimina un espacio de trabajo"},{"location":"Ud1/VATC/cheatsheet/#git-blame","title":"\ud83d\udd0d Git Blame","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>git blame archivo.txt</code> Muestra qui\u00e9n modific\u00f3 una l\u00ednea espec\u00edfica de c\u00f3digo, en qu\u00e9 commit y cu\u00e1ndo"},{"location":"Ud2/Ch2_ABM/","title":"\ud83d\udea2 Cheatsheet Docker","text":""},{"location":"Ud2/Ch2_ABM/#comandos-basicos","title":"\ud83d\udd27 Comandos B\u00e1sicos","text":"<pre><code>docker --version            # Verificar la versi\u00f3n de Docker\ndocker run hello-world      # Ejecutar un contenedor de prueba para verificar la configuraci\u00f3n de Docker\nusermod -aG docker [usuario]   # A\u00f1adir un usuario al grupo Docker (para no usar sudo)\n</code></pre>"},{"location":"Ud2/Ch2_ABM/#instalacion-de-docker-compose","title":"\ud83d\udee0 Instalaci\u00f3n de Docker Compose","text":"<pre><code>apt install docker-compose  # Instalar Docker Compose\n</code></pre>"},{"location":"Ud2/Ch2_ABM/#gestion-de-contenedores","title":"\ud83d\udce6 Gesti\u00f3n de Contenedores","text":"<pre><code>docker exec -d [contenedor] touch /tmp/example  # Ejecutar un comando dentro de un contenedor en ejecuci\u00f3n\ndocker attach [contenedor]                     # Adjuntar a un contenedor en vivo\ndocker logs -f --since=5s [contenedor]         # Ver los logs del contenedor en tiempo real\ndocker stop $(docker ps -q)                    # Detener todos los contenedores en ejecuci\u00f3n\ndocker rm [nombre_o_id_contenedor]             # Eliminar un contenedor espec\u00edfico\ndocker commit -a \"Nombre\" -m \"Registro de cambios\" [contenedor] [usuario/imagen:etiqueta]  # Guardar un contenedor como una nueva imagen\n</code></pre>"},{"location":"Ud2/Ch2_ABM/#gestion-de-imagenes","title":"\ud83d\uddbc Gesti\u00f3n de Im\u00e1genes","text":"<pre><code>docker pull alpine:latest                     # Descargar una imagen desde Docker Hub\ndocker history nginx                          # Ver el historial de capas de la imagen\ndocker rmi ubuntu:18.04                       # Eliminar una imagen espec\u00edfica\ndocker images                                 # Listar todas las im\u00e1genes de Docker\ndocker tag [imagen:etiqueta] [nueva_imagen:latest]  # A\u00f1adir una nueva etiqueta a una imagen existente\ndocker save -o backup_image.tar [imagen]      # Guardar una imagen en un archivo\ndocker load -i backup_image.tar               # Cargar una imagen desde un archivo\n</code></pre>"},{"location":"Ud2/Ch2_ABM/#flujo-de-trabajo-en-docker-hub","title":"\ud83c\udf10 Flujo de Trabajo en Docker Hub","text":"<pre><code>docker login                                  # Iniciar sesi\u00f3n en Docker Hub\ndocker push [usuario/repositorio:etiqueta]    # Subir una imagen a Docker Hub\n</code></pre>"},{"location":"Ud2/Ch2_ABM/#gestion-de-volumenes-de-docker","title":"\ud83d\udcbe Gesti\u00f3n de Vol\u00famenes de Docker","text":"<pre><code>docker volume create [nombre_volumen]         # Crear un volumen de Docker\ndocker volume ls                              # Listar todos los vol\u00famenes\ndocker volume inspect [nombre_volumen]        # Ver detalles de un volumen\ndocker volume rm [nombre_volumen]             # Eliminar un volumen espec\u00edfico\n</code></pre>"},{"location":"Ud2/Ch2_ABM/#uso-de-docker-compose","title":"\u2699 Uso de Docker Compose","text":"<pre><code>docker-compose up -d                          # Iniciar contenedores en segundo plano\ndocker-compose stop                           # Detener los servicios en ejecuci\u00f3n\ndocker-compose down                           # Detener y eliminar contenedores, redes, vol\u00famenes\n</code></pre>"},{"location":"Ud2/Ch2_ABM/#limpieza-del-sistema","title":"\ud83e\uddf9 Limpieza del Sistema","text":"<pre><code>docker system prune                           # Limpiar contenedores, im\u00e1genes, vol\u00famenes y redes no utilizados\ndocker system prune -a                        # Limpiar agresivamente todos los contenedores detenidos e im\u00e1genes no utilizadas\n</code></pre>"},{"location":"Ud2/Ch2_ABM/#miscelanea","title":"\ud83d\udcdd Miscel\u00e1nea","text":"<pre><code>docker ps                                     # Listar todos los contenedores en ejecuci\u00f3n\n</code></pre>"},{"location":"Ud2/Ch2_ACF/","title":"\ud83d\udc33 Docker Cheatsheet","text":""},{"location":"Ud2/Ch2_ACF/#1-comandos-de-instalacion-y-comprobacion","title":"1. \ud83d\udee0\ufe0f Comandos de instalaci\u00f3n y comprobaci\u00f3n","text":"Comando Explicaci\u00f3n <code>apt-get install docker-compose</code> \ud83d\udda5\ufe0f Comando para instalar Docker Compose en Ubuntu o Debian <code>docker --version</code> \ud83d\udd0d Ver la versi\u00f3n de Docker instalada <code>docker run hello-world</code> \ud83d\ude80 Comprobar el funcionamiento de Docker <code>usermod -aG docker $USER</code> \ud83d\udc64 A\u00f1adir usuario al grupo Docker"},{"location":"Ud2/Ch2_ACF/#2-principales-acciones-con-docker","title":"2. \ud83d\ude80 Principales acciones con Docker","text":"Comando Explicaci\u00f3n <code>docker exec -d (contenedor) touch /tmp/prueba</code> \ud83d\udd27 Ejecutar un comando dentro de un contenedor <code>docker attach (contenedor)</code> \ud83d\udcce Adjuntar a un contenedor en ejecuci\u00f3n <code>docker logs -f --until=2s (contenedor)</code> \ud83d\udcdc Ver registros del contenedor <code>docker ps</code> \ud83d\udccb Listar contenedores en ejecuci\u00f3n <code>docker start (contenedor)</code> \u25b6\ufe0f Iniciar un contenedor <code>docker stop (contenedor)</code> \u23f9\ufe0f Parar un contenedor <code>docker rm (contenedor)</code> \ud83d\uddd1\ufe0f Borrar un contenedor <code>docker system prune -a</code> \ud83e\uddf9 Eliminar todos los contenedores no utilizados <code>docker network create (nombre-red)</code> \ud83c\udf10 Crear red compartida entre contenedores"},{"location":"Ud2/Ch2_ACF/#3-comandos-de-imagenes","title":"3. \ud83d\uddbc\ufe0f Comandos de Im\u00e1genes","text":"Comando Explicaci\u00f3n <code>docker images</code> \ud83d\udcc2 Ver im\u00e1genes almacenadas <code>docker search (imagen)</code> \ud83d\udd0e Buscar informaci\u00f3n sobre una imagen <code>docker pull (imagen)</code> \u2b07\ufe0f Descargar una imagen localmente <code>docker history (imagen)</code> \ud83d\udcdc Ver historial de una imagen <code>docker rmi (imagen)</code> \ud83d\uddd1\ufe0f Eliminar una imagen almacenada <code>docker tag</code> \ud83c\udff7\ufe0f Etiquetar una imagen <code>docker save</code> \ud83d\udcbe Guardar una copia de una imagen <code>docker load</code> \ud83d\udce5 Importar archivo para crear una imagen <code>docker commit -m \u201ccomentario\u201d IDCONTENEDOR usuario/imagen:version</code> \ud83d\udcf8 Crear una imagen de un contenedor existente <code>docker build -t ubuntunano ./</code> \ud83d\udee0\ufe0f Crear una imagen desde un Dockerfile"},{"location":"Ud2/Ch2_ACF/#4-comandos-de-volumenes","title":"4. \ud83d\udcc2 Comandos de Vol\u00famenes","text":"Comando Explicaci\u00f3n <code>docker volume create (nombre-volumen)</code> \ud83c\udd95 Crear un volumen <code>docker volume ls</code> \ud83d\udccb Listar vol\u00famenes <code>docker volume inspect (nombre-volumen)</code> \ud83d\udd0d Ver metadatos de un volumen <code>docker volume rm (nombre-volumen)</code> \ud83d\uddd1\ufe0f Borrar un volumen"},{"location":"Ud2/Ch2_ACF/#5-comandos-docker-compose","title":"5. \ud83e\udde9 Comandos Docker Compose","text":"Comando Explicaci\u00f3n <code>docker-compose up -d</code> \ud83d\ude80 Iniciar contenedores en segundo plano"},{"location":"Ud2/Ch2_AEM/","title":"Docker y Docker Compose Cheatsheet","text":""},{"location":"Ud2/Ch2_AEM/#comandos-docker-basicos","title":"Comandos Docker b\u00e1sicos","text":"<ul> <li> <p>Listar contenedores en ejecuci\u00f3n: <pre><code>docker ps\n</code></pre></p> </li> <li> <p>Listar todas las im\u00e1genes: <pre><code>docker images\n</code></pre></p> </li> <li> <p>Listar una imagen concreta (ejemplo: busybox): <pre><code>docker images busybox\n</code></pre></p> </li> <li> <p>Filtrar im\u00e1genes por referencia (<code>*04</code>): <pre><code>docker images -f=reference=\"u*:*04\"\n</code></pre></p> </li> <li> <p>Descargar una imagen espec\u00edfica de Docker Hub (ejemplo: <code>ubuntu:14.04</code>): <pre><code>docker pull ubuntu:14.04\n</code></pre></p> </li> <li> <p>Buscar im\u00e1genes en Docker Hub que empiecen con \"ubuntu\": <pre><code>docker search ubuntu\n</code></pre></p> </li> <li> <p>Buscar im\u00e1genes en Docker Hub con l\u00edmite de resultados (ejemplo: 100): <pre><code>docker search --limit=100 ubuntu\n</code></pre></p> </li> <li> <p>Ver el historial de una imagen (lo que se ha hecho para crearla, ejemplo: <code>nginx:latest</code>): <pre><code>docker history nginx:latest\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_AEM/#manejo-de-imagenes-y-contenedores","title":"Manejo de im\u00e1genes y contenedores","text":"<ul> <li> <p>Eliminar una imagen espec\u00edfica (ejemplo: <code>ubuntu:14.04</code>): <pre><code>docker rmi ubuntu:14.04\n</code></pre></p> </li> <li> <p>Detener todos los contenedores (pasando solo los IDs): <pre><code>docker stop $(docker ps -a -q)\n</code></pre></p> </li> <li> <p>Eliminar todos los contenedores detenidos: <pre><code>docker rm $(docker ps -a -q)\n</code></pre></p> </li> <li> <p>Eliminar todo lo creado en Docker (im\u00e1genes, contenedores, etc.): <pre><code>docker system prune -a\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_AEM/#crear-y-gestionar-contenedores","title":"Crear y gestionar contenedores","text":"<ul> <li> <p>Ejecutar un contenedor interactivo (ejemplo: <code>alpine</code>): <pre><code>docker run -it --name=alpine alpine /bin/sh\n</code></pre></p> </li> <li> <p>Guardar cambios en un contenedor como una nueva imagen: <pre><code>docker commit -a \"AlexM\" -m \"Alpine upgraded\" alpine alexillo98/alpinemod:2024\n</code></pre></p> </li> <li> <p>Ejecutar un contenedor con una imagen modificada: <pre><code>docker run -it alexillo98/alpinemod:2024\n</code></pre></p> </li> <li> <p>Guardar una imagen en un archivo <code>.tar</code>: <pre><code>docker save -o copiaAlpineMod.tar alexillo98/alpinemod\n</code></pre></p> </li> <li> <p>Cargar una imagen desde un archivo <code>.tar</code>: <pre><code>docker load -i copiaAlpineMod.tar\n</code></pre></p> </li> <li> <p>Construir una imagen desde un Dockerfile en el directorio actual: <pre><code>docker build -t ubuntunano .\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_AEM/#manejo-de-volumenes","title":"Manejo de vol\u00famenes","text":"<ul> <li> <p>Crear un volumen (ejemplo: <code>wordpress-db</code>): <pre><code>docker volume create wordpress-db\n</code></pre></p> </li> <li> <p>Inspeccionar un volumen (ejemplo: <code>wordpress-db</code>): <pre><code>docker volume inspect wordpress-db\n</code></pre></p> </li> <li> <p>Eliminar un volumen (ejemplo: <code>wordpress-db</code>): <pre><code>docker volume rm wordpress-db\n</code></pre></p> </li> <li> <p>Listar todos los vol\u00famenes: <pre><code>docker volume ls\n</code></pre></p> </li> <li> <p>Eliminar todas las im\u00e1genes (pasando solo los IDs): <pre><code>docker rmi $(docker images -q)\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_AEM/#comandos-docker-compose","title":"Comandos Docker Compose","text":"<ul> <li> <p>Listar contenedores gestionados por Docker Compose: <pre><code>docker-compose ps\n</code></pre></p> </li> <li> <p>Levantar servicios en segundo plano: <pre><code>docker-compose up -d\n</code></pre></p> </li> <li> <p>Detener todos los servicios: <pre><code>docker-compose stop\n</code></pre></p> </li> <li> <p>Detener y eliminar todos los servicios, incluyendo vol\u00famenes: <pre><code>docker-compose down -v\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_ALS/","title":"\ud83d\udc33 Docker Cheatsheet","text":"<p>Una gu\u00eda r\u00e1pida para dominar los comandos esenciales de Docker.  </p>"},{"location":"Ud2/Ch2_ALS/#1-configurar-docker-sin-privilegios-de-root","title":"\ud83d\udd27 1. Configurar Docker sin privilegios de root","text":"<p>Habilita Docker para tu usuario: <pre><code>sudo usermod -aG docker $USER\n</code></pre></p> <p> </p>"},{"location":"Ud2/Ch2_ALS/#2-comandos-para-contenedores","title":"\ud83d\udea2 2. Comandos para Contenedores","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker ps</code> Listar contenedores en ejecuci\u00f3n. <code>docker stop &lt;contenedor&gt;</code> Detener un contenedor en ejecuci\u00f3n. <code>docker start &lt;contenedor&gt;</code> Iniciar un contenedor detenido. <code>docker inspect &lt;contenedor&gt;</code> Ver detalles de un contenedor. <code>docker run</code> Crear y ejecutar un contenedor. <code>docker rm &lt;contenedor&gt;</code> Eliminar un contenedor. <code>docker container prune</code> Eliminar contenedores detenidos."},{"location":"Ud2/Ch2_ALS/#ejemplos-practicos","title":"\ud83c\udf1f Ejemplos Pr\u00e1cticos","text":"<ul> <li> <p>Crear un contenedor interactivo <pre><code>docker run -it ubuntu bash\n</code></pre></p> </li> <li> <p>Ejecutar un contenedor en segundo plano <pre><code>docker run -d nginx\n</code></pre></p> </li> <li> <p>Ejecutar un comando en un contenedor activo <pre><code>docker exec -it &lt;contenedor&gt; bash\n</code></pre></p> </li> <li> <p>Detener todos los contenedores activos <pre><code>docker stop $(docker ps -q -a)\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_ALS/#3-comandos-para-imagenes","title":"\ud83d\udcf7 3. Comandos para Im\u00e1genes","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker images</code> Listar im\u00e1genes locales. <code>docker pull &lt;imagen&gt;</code> Descargar imagen desde Docker Hub. <code>docker build -t &lt;imagen&gt; &lt;ruta&gt;</code> Crear imagen desde un Dockerfile. <code>docker push &lt;imagen&gt;</code> Subir imagen a Docker Hub. <code>docker rmi &lt;imagen&gt;</code> Borrar una imagen. <code>docker history &lt;imagen&gt;</code> Ver historial de la imagen. <code>docker inspect &lt;imagen&gt;</code> Ver detalles de una imagen."},{"location":"Ud2/Ch2_ALS/#ejemplos-practicos_1","title":"\ud83c\udf1f Ejemplos Pr\u00e1cticos","text":"<ul> <li> <p>Eliminar todas las im\u00e1genes locales <pre><code>docker rmi $(docker images -q)\n</code></pre></p> </li> <li> <p>Crear una imagen desde un contenedor <pre><code>docker commit &lt;contenedor&gt; &lt;imagen&gt;\n</code></pre></p> </li> <li> <p>Exportar una imagen a un archivo <pre><code>docker save -o backup.tar &lt;imagen&gt;\n</code></pre></p> </li> <li> <p>Importar una imagen desde un archivo <pre><code>docker load -i backup.tar\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_ALS/#4-comandos-para-volumenes","title":"\ud83d\uddc4\ufe0f 4. Comandos para Vol\u00famenes","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker volume create &lt;volumen&gt;</code> Crear un volumen nuevo. <code>docker volume ls</code> Listar todos los vol\u00famenes. <code>docker volume inspect &lt;volumen&gt;</code> Ver detalles de un volumen. <code>docker run -v &lt;volumen&gt;:&lt;ruta&gt;</code> Montar un volumen en un contenedor. <code>docker volume prune</code> Eliminar vol\u00famenes no utilizados. <code>docker volume rm &lt;volumen&gt;</code> Eliminar un volumen."},{"location":"Ud2/Ch2_ALS/#ejemplos-practicos_2","title":"\ud83c\udf1f Ejemplos Pr\u00e1cticos","text":"<ul> <li> <p>Crear un volumen nuevo <pre><code>docker volume create mi_volumen\n</code></pre></p> </li> <li> <p>Montar un volumen en un contenedor <pre><code>docker run -d -v mi_volumen:/data nginx\n</code></pre></p> </li> <li> <p>Eliminar todos los vol\u00famenes no usados <pre><code>docker volume prune\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_ALS/#5-otras-opciones-utiles","title":"\u2699\ufe0f 5. Otras Opciones \u00datiles","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker-compose up -d</code> Iniciar servicios con <code>docker-compose</code>. <code>docker network</code> Administrar redes de contenedores. <code>docker system prune</code> Eliminar recursos no utilizados. <code>docker-compose stop</code> Detener los servicios activos. <code>docker-compose down</code> Detener y eliminar contenedores y redes. <code>docker-compose down -v</code> Eliminar vol\u00famenes junto con los servicios."},{"location":"Ud2/Ch2_ALS/#tips-adicionales","title":"\ud83c\udfaf Tips Adicionales","text":"<ul> <li> <p>Mostrar el uso de disco: <pre><code>docker system df\n</code></pre></p> </li> <li> <p>Limpiar todo Docker (con cuidado): <pre><code>docker system prune -a\n</code></pre></p> </li> <li> <p>Reiniciar el daemon de Docker: <pre><code>sudo systemctl restart docker\n</code></pre></p> </li> <li> <p>Ver logs de un contenedor: <pre><code>docker logs &lt;contenedor&gt;\n</code></pre></p> </li> </ul>"},{"location":"Ud2/Ch2_BO/","title":"\ud83d\udea2 Unidad 2 - Docker Cheatsheet","text":""},{"location":"Ud2/Ch2_BO/#instalacion-de-docker","title":"\ud83d\udc0b Instalaci\u00f3n de docker","text":""},{"location":"Ud2/Ch2_BO/#instalacion-basica","title":"Instalaci\u00f3n b\u00e1sica","text":"<pre><code>$sudo apt install docker #Instala docker\n\n$sudo apt install docker-compose #Instala docker compose\n</code></pre>"},{"location":"Ud2/Ch2_BO/#post-instalacion","title":"Post-Instalaci\u00f3n","text":"<pre><code>$sudo usermod -aG docker $USER #A\u00f1ade tu usuario al grupo docker\n\n$sudo systemctl start docker #Inicia el servicio de docker\n\n$sudo systemctl enable docker #Habilita el servicio de docker al iniciar siempre el pc\n</code></pre>"},{"location":"Ud2/Ch2_BO/#comandos-informativos","title":"\u2753 Comandos inform\u00e1tivos","text":"<pre><code>$docker --version #Muestra la versi\u00f3n de docker\n\n$docker images #Muestra todas las im\u00e1genes descargadas\n\n$docker ps #Muestra todos los contenedores en ejecuci\u00f3n\n\n$docker ps -a #Muestra un historial de contenedores ejecutados\n</code></pre>"},{"location":"Ud2/Ch2_BO/#comandos-para-gestionar-imagenes","title":"\ud83d\udcbf Comandos para gestionar im\u00e1genes","text":"<pre><code>$docker search &lt;imagen&gt; #Busca una im\u00e1gen en dockerhub\n\n$docker pull &lt;imagen&gt; #Descarga una im\u00e1gen desde dockerhub\n\n$docker tag &lt;imagen&gt; &lt;nombre:tag&gt; #Etiqueta una im\u00e1gen\n\n$docker history &lt;imagen&gt; #Muestra el historial de c\u00f3mo se cre\u00f3 la im\u00e1gen\n</code></pre>"},{"location":"Ud2/Ch2_BO/#comandos-para-gestionar-contenedores","title":"\ud83d\udcbc Comandos para gestionar contenedores","text":"<pre><code>$docker inspect &lt;id-contenedor&gt; #Muestra informaci\u00f3n del contenedor\n\n$docker start &lt;id-contenedor&gt; #Inicia un contenedor creado con antelaci\u00f3n\n\n$docker stop &lt;id-contenedor&gt; #Detiene un contenedor\n\n$docker rename &lt;id-contenedor&gt; &lt;nombre&gt; #Renombra el contenedor\n\n$docker run &lt;id-contenedor&gt; #Inicia el contenedor y si no tiene la im\u00e1gen, la descarga\n\n$docker exec -d &lt;id-contenedor&gt; touch hola.php #Ejecuta un comando dentro de un contenedor ya iniciado, ejemplo con touch\n\n$docker attach &lt;id-contenedor&gt; #Permite adjuntarse a un contenedor en ejecuci\u00f3n y ver su salida\n\n$docker logs &lt;id-contenedor&gt; #Permite ver los logs \"registros\" del contenedor\n</code></pre>"},{"location":"Ud2/Ch2_BO/#comandos-para-gestionar-volumenes","title":"\ud83d\udcc2 Comandos para gestionar volumenes","text":"<pre><code>$docker volume create &lt;nombre&gt; #Crea un volumen con cierto nombre\n\n$docker volume inspect &lt;nombre&gt; #Muestra informaci\u00f3n del volumen\n\n$docker volume ls #Lista todos los volumenes\n</code></pre>"},{"location":"Ud2/Ch2_BO/#comandos-para-gestionar-la-limpieza-en-docker","title":"\ud83d\udec0 Comandos para gestionar la limpieza en docker","text":"<pre><code>$docker rmi &lt;imagen&gt; #Borra una im\u00e1gen descargada\n\n$docker rm &lt;id-contenedor&gt; #Elimina un contenedor si est\u00e1 detenido\n\n$docker volume rm &lt;nombre&gt; #Elimina un volumen\n\n$docker stop $(docker ps -q) #Detiene todos los contenedores en ejecuci\u00f3n\n\n$docker image prune #Elimina todas las im\u00e1genes no etiquetadas\n\n$docker image prune -a #Elimina todas las im\u00e1genes, incluyendo las etiquetadas\n\n$docker container prune #Elimina todos los contenedores detenidos\n\n$docker volume prune #Elimina todos los volumenes sin utilizar no asociados a un contenedor\n\n$docker network prune #Elimina todas las redes sin utilizar no asociadas a un contenedor\n\n$docker system prune -a #Elimina TODO a la vez\n</code></pre>"},{"location":"Ud2/Ch2_BO/#docker-compose-y-dockerfile","title":"\ud83d\udcd0 Docker Compose y Dockerfile","text":"<pre><code>$docker build -t nombre:tag . #Contruye una im\u00e1gen d\u00e1ndole un nombre a partir de un Dockerfile\n\n$docker-compose ps #Lista los contenedores en ejecuci\u00f3n por compose\n\n$docker-compose ps -a #Lista todos contenedores de compose\n\n$docker-compose up #Inicia el docker compose en primer plano\n\n$docker-compose up -d #Inicia el docker compose en segundo plano\n\n$docker-compose stop #Detiene el docker compose\n\n$docker-compose down #Detiene y elimina los contenedores, redes y volumenes definidos en el yml\n\n$docker-compose down -v #Hace lo mismo que el anterior pero tambi\u00e9n elimina los volumenes asociados a los contenedores\n</code></pre>"},{"location":"Ud2/Ch2_BO/#copias-de-seguridad","title":"\ud83d\udcbe Copias de seguridad","text":"<pre><code>$docker save -o backup.tar &lt;imagen:tag&gt; #Guarda una copia de una im\u00e1gen en formato .tar\n\n$docker load -i backup.tar #Carga la copia a partir de un archivo tar\n\n$docker commit -a \"nombre\" -m \"descripci\u00f3n\" &lt;id-contenedor&gt; &lt;user/imagen:tag&gt; #Permite crear una nueva im\u00e1gen a partir de un contenedor\n</code></pre>"},{"location":"Ud2/Ch2_DGD/","title":"Cheatsheet 2 Docker Darius Gabriel Dobre","text":"<p>Administrar DOCKER sin privilegios</p> <pre><code>sudo usermod -aG docker $USER\n</code></pre>"},{"location":"Ud2/Ch2_DGD/#comandos-para-imagenes","title":"\ud83c\udf9e\ufe0f Comandos para im\u00e1genes","text":"Comando Descripci\u00f3n <code>docker images</code> Ver im\u00e1genes locales. <code>docker pull &lt;imagen&gt;</code> Descargar imagen desde Docker Hub. <code>docker push &lt;nombre_imagen&gt;</code> Subir imagen a Docker Hub. <code>docker build -t &lt;nombre_imagen&gt; &lt;ruta_dockerfile&gt;</code> Construir imagen a partir de Dockerfile. <code>docker rmi &lt;nombre_imagen&gt;</code> Borrar imagen. <code>docker history &lt;nombre_imagen&gt;</code> Ver historial de la imagen. <code>docker inspect &lt;nombre_imagen&gt;</code> Ver detalle de la imagen."},{"location":"Ud2/Ch2_DGD/#ejemplos-para-imagenes","title":"Ejemplos para im\u00e1genes","text":"<ul> <li>Borrar todas las im\u00e1genes:</li> </ul> <p>```bash docker rmi $(docker images -q) <pre><code>- Crear imagen a partir de contenedor\n\n ```bash\ndocker commit servernginx nginx\n</code></pre></p> <ul> <li>Exportar imagen</li> </ul> <p>```bash docker save -o copiaseguridad.tar darius/ubuntunano <pre><code>- Importar imagen\n\n```bash\ndocker load -i copiaseguridad.tar\n</code></pre></p>"},{"location":"Ud2/Ch2_DGD/#comandos-para-contenedores","title":"\ud83d\udea2 Comandos para contenedores","text":"Comando Descripci\u00f3n <code>docker ps</code> Mostrar contenedores en ejecuci\u00f3n. <code>docker start &lt;nombre_contenedor&gt;</code> Iniciar contenedor. <code>docker stop &lt;nombre_contenedor&gt;</code> Detener contenedor en ejecuci\u00f3n. <code>docker rm &lt;nombre_contenedor&gt;</code> Borrar contenedor. <code>docker inspect &lt;nombre_contenedor&gt;</code> Ver detalles del contenedor. <code>docker run</code> Crear y ejecutar un contenedor. <code>docker container prune</code> Eliminar contenedores detenidos"},{"location":"Ud2/Ch2_DGD/#ejemplos-para-contenedores","title":"Ejemplos para contenedores","text":"<ul> <li>Crear un contenedor interactivo:</li> </ul> <pre><code>docker run -it ubuntu bash\n</code></pre> <ul> <li>Contenedor en segundo plano:</li> </ul> <pre><code>docker run -d nginx\n</code></pre> <ul> <li>Ejecutar comandos en contenedor en ejecucion:</li> </ul> <pre><code>docker exec -it ubuntu bash\n</code></pre> <ul> <li>Detener todos los contenedores en ejecucion:</li> </ul> <pre><code>docker stop $(docker ps -q)\n</code></pre>"},{"location":"Ud2/Ch2_DGD/#comandos-para-volumenes","title":"\ud83d\uddc4\ufe0f Comandos para Vol\u00famenes","text":"Comando Descripci\u00f3n <code>docker volume create &lt;nombre_volumen&gt;</code> Crear un nuevo volumen. <code>docker volume ls</code> Listar todos los vol\u00famenes. <code>docker volume inspect &lt;nombre_volumen&gt;</code> Ver detalles de un volumen espec\u00edfico. <code>docker volume rm &lt;nombre_volumen&gt;</code> Borrar un volumen. <code>docker volume prune</code> Eliminar todos los vol\u00famenes no utilizados. <code>docker run -v &lt;nombre_volumen&gt;:&lt;ruta_en_contenedor&gt; &lt;imagen&gt;</code> Montar un volumen en un contenedor."},{"location":"Ud2/Ch2_DGD/#ejemplos-para-volumenes","title":"Ejemplos para Vol\u00famenes","text":"<ul> <li>Crear un volumen:</li> </ul> <pre><code>docker volume create mi_volumen\n</code></pre> <ul> <li>Montar un volumen en un contenedor:</li> </ul> <pre><code>docker run -d -v mi_volumen:/data nginx\n</code></pre> <ul> <li>Inspeccionar un volumen:</li> </ul> <pre><code>docker volume inspect mi_volumen\n</code></pre> <ul> <li>Borrar un volumen:</li> </ul> <pre><code>docker volume rm mi_volumen\n</code></pre> <ul> <li>Eliminar todos los vol\u00famenes no utilizados:</li> </ul> <pre><code>docker volume prune\n</code></pre>"},{"location":"Ud2/Ch2_DGD/#otras-opciones","title":"\u2699\ufe0f Otras opciones","text":"Comando Descripci\u00f3n <code>docker network</code> Comandos para administrar redes de contenedores. <code>docker system prune</code> Elimina recursos no utilizados de Docker. <code>docker-compose up -d</code> Arrancar aplicacion con Compose. <code>docker-compose down</code> Detener y eliminar contenedores. <code>docker-compose stop</code> Detener contenedores. <code>docker-compose down -v</code> Borra tambien vol\u00famenes."},{"location":"Ud2/Ch2_DMP/","title":"\ud83d\udcdd UD2 - Docker Cheatsheet","text":"<p>David Maratrat Pons</p>"},{"location":"Ud2/Ch2_DMP/#instalacion-de-docker","title":"\ud83d\udc33 Instalaci\u00f3n de Docker","text":"Comando Descripci\u00f3n \ud83d\udc27 Linux <code>sudo apt-get remove docker docker-engine docker.io containerd runc</code> Elimina las versiones antiguas de docker para que no interfieran <code>sudo apt-get update</code> Actualiza el \u00edndice de paquetes <code>sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common</code> Instala paquetes necesarios para poder usar repositorios con HTTPS <code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg \\| sudo apt-key add -</code> Descarga la clave GPG de Docker CE y la a\u00f1adimos <code>sudo apt-key fingerprint 0EBFCD88</code> Comprueba que se ha a\u00f1adido la clave <code>sudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"</code> A\u00f1ades el repositorio de docker a nuestros repositorios <code>sudo apt-get update</code> Actualiza repositorios <code>sudo apt-get install docker-ce docker-ce-cli containerd.io</code> Instala Docker <code>sudo usermod -aG docker $USER</code> A\u00f1ade el usuario actual al grupo docker para no usar sudo \ud83e\ude9f  Windows &amp; \ud83c\udf4f MacOS https://docs.docker.com/get-started/get-docker/ URL de descarga de Docker"},{"location":"Ud2/Ch2_DMP/#comandos-basicos","title":"\ud83d\udcc1 Comandos b\u00e1sicos","text":"Comando Descripci\u00f3n <code>docker version</code> Permite ver la versi\u00f3n de docker instalada <code>docker ps</code> Muestra una lista de los contenedores en ejecuci\u00f3n <code>docker ps -a</code> Muestra una lista de todos los contenedores dentro del sistema"},{"location":"Ud2/Ch2_DMP/#contenedores","title":"\ud83d\udce6 Contenedores","text":"Comando Descripci\u00f3n <code>docker run &lt;imagen&gt;</code> Crea y arranca un contenedor desde una imagen <code>docker run -it &lt;imagen&gt;</code> Crea y arranca un contenedor desde una imagen con una consola interactiva <code>docker start &lt;id&gt;</code> Arranca un contenedor ya creado <code>docker stop &lt;id&gt;</code> Para un contenedor en ejecuci\u00f3n <code>docker restart &lt;id&gt;</code> Reinicia un contenedor en ejecuci\u00f3n <code>docker inspect &lt;id&gt;</code> Muestra informaci\u00f3n del contenedor <code>docker exec &lt;id&gt;</code> Permite ejecutar un comando dentro de un contenedor en ejecuci\u00f3n <code>docker cp &lt;path&gt; &lt;path&gt;</code> Permite copiar ficheros/directorios de la m\u00e1quina anfitri\u00f3n al contenedor y viceversa <code>docker attach</code> Conecta la consola al proceso en ejecuci\u00f3n de un contenedor <code>docker logs &lt;id&gt;</code> Muestra los registros de salida de un contenedor <code>docker rename &lt;id&gt; &lt;nuevo_nombre&gt;</code> Permite cambiar el nombre asociado a un contenedor <code>docker rm &lt;id&gt;</code> Elimina un contenedor detenido"},{"location":"Ud2/Ch2_DMP/#imagenes","title":"\ud83d\uddbc\ufe0f Im\u00e1genes","text":"Comando Descripci\u00f3n <code>docker pull &lt;imagen&gt;</code> Descarga una imagen desde Docker Hub <code>docker build -t &lt;nombre&gt;</code> Construye una imagen a partir de un Dockerfile <code>docker history &lt;imagen&gt;</code> Muestra el historial de una imagen <code>docker images</code> Muestra todas las im\u00e1genes locales <code>docker rmi &lt;imagen&gt;</code> Elimina una imagen local <code>docker tag &lt;imagen&gt; &lt;nombre:etiqueta&gt;</code> Etiqueta una imagen para que sea m\u00e1s f\u00e1cil de identificar <code>docker save -o &lt;archivo&gt; &lt;imagen&gt;</code> Guarda una imagen como un archivo tar <code>docker load -i &lt;archivo&gt;</code> Carga una imagen desde un archivo tar"},{"location":"Ud2/Ch2_DMP/#volumenes","title":"\ud83d\udce6 Vol\u00famenes","text":"Comando Descripci\u00f3n <code>docker volume create &lt;name&gt;</code> Crea un volumen <code>docker volume ls</code> Lista todos los vol\u00famenes disponibles <code>docker volume inspect &lt;name&gt;</code> Muestra informaci\u00f3n detallada de un volumen <code>docker volume rm &lt;name&gt;</code> Elimina un volumen <code>docker volume prune</code> Elimina todos los vol\u00famenes que no estan en uso por ning\u00fan contenedor <code>docker run -v &lt;volumen&gt;:&lt;path&gt;</code> Monta un volumen en un contenedor durante su ejecuci\u00f3n"},{"location":"Ud2/Ch2_DMP/#compose","title":"\ud83d\udcdc Compose","text":"Comando Descripci\u00f3n <code>docker-compose up</code> Arranca todos los servicios definidos en el archivo <code>docker-compose.yml</code> <code>docker-compose down</code> Detiene y elimina los contenedores de <code>docker-compose.yml</code> <code>docker-compose build</code> Construye o reconstruye los servicios <code>docker-compose logs</code> Muestra los registros de salida de los servicios <code>docker-compose ps</code> Lista los contenedores administrados por Compose <code>docker-compose exec &lt;service&gt; &lt;command&gt;</code> Ejecuta un comando en un servicio en ejecuci\u00f3n"},{"location":"Ud2/Ch2_DMP/#docker-hub","title":"\ud83c\udf10 Docker HUB","text":"Comando Descripci\u00f3n <code>docker pull &lt;imagen&gt;</code> Descarga una imagen desde Docker Hub <code>docker push &lt;imagen&gt;</code> Sube una imagen local a Docker Hub <code>docker search &lt;filtro&gt;</code> Busca im\u00e1genes en Docker Hub utilizando un filtro <code>docker login</code> Inicia sesi\u00f3n en Docker Hub para poder subir im\u00e1genes <code>docker logout</code> Cierra sesi\u00f3n en Docker Hub"},{"location":"Ud2/Ch2_DMP/#otros","title":"\ud83d\udd27 Otros","text":"Comando Descripci\u00f3n <code>sudo systemctl enable/start/stop/disable/restart docker.service</code> Permite habilitar/iniciar/parar/deshabilitar/reiniciar el servicio de docker <code>sudo systemctl enable/start/stop/disable/restart container.service</code> Permite habilitar/iniciar/parar/deshabilitar/reiniciar el servicio de container <code>docker network ls</code> Lista las redes creadas en Docker <code>docker network create &lt;name&gt;</code> Crea una red entre contenedores <code>docker stats</code> Muestra los recursos en tiempo real de los contenedores en ejecuci\u00f3n <code>docker system prune</code> Limpia contenedores, redes y vol\u00famenes no utilizados"},{"location":"Ud2/Ch2_DMP/#desinstalacion-de-docker-linux","title":"\u274c Desinstalaci\u00f3n de Docker (Linux)","text":"Comando Descripci\u00f3n <code>sudo apt-get purge docker-ce docker-ce-cli containerd.io</code> Elimina docker del sistema <code>sudo rm -rf /var/lib/docker</code> Borra el directorio de Docker"},{"location":"Ud2/Ch2_EGM/","title":"Unidad 2 - Docker Cheatsheet","text":""},{"location":"Ud2/Ch2_EGM/#instalacion-de-docker","title":"\ud83d\udc0b Instalaci\u00f3n de docker","text":""},{"location":"Ud2/Ch2_EGM/#pasos-para-la-instalacion-basica","title":"Pasos para la Instalaci\u00f3n B\u00e1sica","text":"<pre><code># Actualizaci\u00f3n del sistema\n$sudo apt-get update\n\n# Instalaci\u00f3n de dependencias necesarias para los repositorios HTTPS\n$sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common\n\n# Instalaci\u00f3n de Docker y Docker Compose\n$sudo apt install docker\n$sudo apt install docker-compose\n\n# Eliminaci\u00f3n de versiones antiguas de Docker (si existen) para evitar conflictos\n$sudo apt-get remove docker docker-engine docker.io containerd runc\n</code></pre>"},{"location":"Ud2/Ch2_EGM/#configuracion-posterior-a-la-instalacion","title":"Configuraci\u00f3n Posterior a la Instalaci\u00f3n","text":"<pre><code># A\u00f1adir el usuario actual al grupo de Docker para gestionar contenedores sin sudo\n$sudo usermod -aG docker $USER\n\n# Activar y habilitar el servicio Docker para iniciar autom\u00e1ticamente\n$sudo systemctl start docker\n$sudo systemctl enable docker\n</code></pre>"},{"location":"Ud2/Ch2_EGM/#comandos-para-informacion-del-sistema","title":"\u2753 Comandos para informaci\u00f3n del sistema","text":"<pre><code># Versi\u00f3n de Docker\n$docker --version\n\n# Ver todas las im\u00e1genes descargadas\n$docker images\n\n# Listar los contenedores en ejecuci\u00f3n\n$docker ps\n\n# Listar el historial de contenedores\n$docker ps -a\n</code></pre>"},{"location":"Ud2/Ch2_EGM/#comandos-para-gestionar-imagenes","title":"\ud83d\udcbf Comandos para gestionar im\u00e1genes","text":"<pre><code># Buscar una imagen en Docker Hub\n$docker search &lt;imagen&gt;\n\n# Descargar una imagen espec\u00edfica\n$docker pull &lt;imagen&gt;\n\n# Etiquetar una imagen para organizar versiones\n$docker tag &lt;imagen&gt; &lt;nombre:tag&gt;\n\n# Revisar el historial de construcci\u00f3n de una imagen\n$docker history &lt;imagen&gt;\n</code></pre>"},{"location":"Ud2/Ch2_EGM/#comandos-para-gestionar-contenedores","title":"\ud83d\udcbc Comandos para gestionar contenedores","text":"<pre><code># Obtener informaci\u00f3n detallada sobre un contenedor espec\u00edfico\n$docker inspect &lt;id-contenedor&gt;\n\n# Iniciar y detener contenedores\n$docker start &lt;id-contenedor&gt;\n$docker stop &lt;id-contenedor&gt;\n\n# Cambiar el nombre de un contenedor\n$docker rename &lt;id-contenedor&gt; &lt;nombre&gt;\n\n# Crear y ejecutar un contenedor (descargando la imagen si no est\u00e1 disponible)\n$docker run &lt;id-contenedor&gt;\n\n# Ejecutar comandos dentro de un contenedor en ejecuci\u00f3n\n$docker exec -d &lt;id-contenedor&gt; touch hola.php\n\n# Adjuntarse a un contenedor y ver su salida en tiempo real\n$docker attach &lt;id-contenedor&gt;\n\n# Acceder a los registros del contenedor\n$docker logs &lt;id-contenedor&gt;\n</code></pre>"},{"location":"Ud2/Ch2_EGM/#comandos-para-gestionar-volumenes","title":"\ud83d\udcc2 Comandos para gestionar volumenes","text":"<pre><code># Crear un volumen para almacenamiento persistente\n$docker volume create &lt;nombre&gt;\n\n# Obtener informaci\u00f3n sobre un volumen espec\u00edfico\n$docker volume inspect &lt;nombre&gt;\n\n# Listar todos los vol\u00famenes\n$docker volume ls\n</code></pre>"},{"location":"Ud2/Ch2_EGM/#comandos-para-gestionar-la-limpieza-en-docker","title":"\ud83d\udec0 Comandos para gestionar la limpieza en docker","text":"<pre><code>#Borra una im\u00e1gen descargada\n$docker rmi &lt;imagen&gt; \n\n#Elimina un contenedor si est\u00e1 detenido\n$docker rm &lt;id-contenedor&gt; \n\n#Elimina un volumen\n$docker volume rm &lt;nombre&gt;\n\n#Detiene todos los contenedores en ejecuci\u00f3n\n$docker stop $(docker ps -q) \n\n#Elimina todas las im\u00e1genes no etiquetadas\n$docker image prune \n\n#Elimina todas las im\u00e1genes, incluyendo las etiquetadas\n$docker image prune -a \n\n#Elimina todos los contenedores detenidos\n$docker container prune \n\n#Elimina todos los volumenes sin utilizar no asociados a un contenedor\n$docker volume prune\n\n#Elimina todas las redes sin utilizar no asociadas a un contenedor\n$docker network prune\n\n#Elimina TODO a la vez\n$docker system prune -a \n</code></pre>"},{"location":"Ud2/Ch2_EGM/#docker-compose-y-dockerfile","title":"\ud83d\udcd0 Docker Compose y Dockerfile","text":"<pre><code># Construir una imagen desde un Dockerfile en el directorio actual\n$docker build -t nombre:tag .\n\n# Listar los contenedores gestionados por Docker Compose\n$docker-compose ps\n$docker-compose ps -a\n\n# Iniciar y detener Docker Compose\n$docker-compose up\n$docker-compose up -d  # Ejecutar en segundo plano\n$docker-compose stop\n$docker-compose down  # Eliminar contenedores, redes y vol\u00famenes definidos\n$docker-compose down -v  # Incluir vol\u00famenes en la limpieza\n</code></pre>"},{"location":"Ud2/Ch2_EGM/#copias-de-seguridad","title":"\ud83d\udcbe Copias de seguridad","text":"<pre><code># Guardar y cargar im\u00e1genes como archivos de respaldo\n\n# Crear una copia de seguridad en formato .tar\n$docker save -o backup.tar &lt;imagen:tag&gt;\n\n# Cargar una imagen desde un archivo .tar\n$docker load -i backup.tar\n\n# Crear una imagen nueva a partir de un contenedor en ejecuci\u00f3n\n$docker commit -a \"nombre\" -m \"descripci\u00f3n\" &lt;id-contenedor&gt; &lt;user/imagen:tag&gt;\n</code></pre>"},{"location":"Ud2/Ch2_EGM/#desinstalacion-de-docker-linux","title":"\u274c Desinstalaci\u00f3n de Docker (Linux)","text":"<pre><code>$sudo apt-get purge docker-ce docker-ce-cli containerd.io  #Elimina docker del sistema\n\n$sudo rm -rf /var/lib/docker #Borra el directorio de Docker\n</code></pre>"},{"location":"Ud2/Ch2_EV/","title":"Ch2 EV","text":""},{"location":"Ud2/Ch2_EV/#instalacion","title":"Instalaci\u00f3n","text":"<ul> <li><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade</code></li> <li>Ubuntu </li> <li>Debian</li> <li>Comprobar que se ha instalado correctamente : <code>sudo docker version</code></li> </ul>"},{"location":"Ud2/Ch2_EV/#post-instalacion","title":"Post instalaci\u00f3n","text":"<ul> <li>Permitir administrar Docker a un usuario sin privilegios : <code>sudo usermod -aG docker $USER</code></li> <li>Instalar Docker Compose : <code>sudo apt install docker-compose</code></li> <li>Iniciar un contenedor de ejemplo : <code>sudo docker run hello-world</code></li> </ul>"},{"location":"Ud2/Ch2_EV/#contenedores","title":"Contenedores","text":"<ul> <li>Crear un contenedor y lanzar una terminal : <code>docker run -it --name=ubuntu_pruebas ubuntu /bin/bash</code></li> <li>Listar contenedores en ejecuci\u00f3n : <code>docker ps</code></li> <li>Listar los contenedores del sistema, tanto parados como en ejecuci\u00f3n : <code>docker ps -a</code></li> <li>Arrancar un contenedor ya creado : <code>docker start &lt;identificador/nombre&gt;</code></li> <li>Parar un contenedor ya creado : <code>docker stop &lt;identificador/nombre&gt;</code></li> <li>Parar todos los contenedores : <code>docker stop $(docker ps -a -q)</code></li> <li>Mostrar detalles de la configuraci\u00f3n de un contenedor : <code>docker inspect &lt;identificador/nombre&gt;</code></li> <li>Ejecutar un comando dentro de un contenedor en ejecuci\u00f3n : <code>docker exec [opciones] &lt;identificador/nombre&gt; comando [argumentos]</code></li> <li>Copiar ficheros y directorios del anfitri\u00f3n a un contenedor o viceversa : <code>docker cp &lt;ruta_local&gt; &lt;nombre_contenedor&gt;:&lt;ruta_destino&gt;</code></li> <li>Conectar un terminal a la entrada y salida de un contenedor en ejecuci\u00f3n : <code>docker attach &lt;nombre&gt;</code></li> <li>Ver los registros de salida de un contenedor en ejecuci\u00f3n : <code>docker logs</code></li> <li>Borrar un contenedor parado : <code>docker rm &lt;identificador/nombre&gt;</code></li> <li>Borrar todos los contenedores parados : <code>docker rm $(docker ps -a -q)</code></li> </ul>"},{"location":"Ud2/Ch2_EV/#imagenes","title":"Im\u00e1genes","text":"<ul> <li>Obtener informaci\u00f3n de las im\u00e1genes almacenadas localmente : <code>docker images</code></li> <li>Obtener informaci\u00f3n de im\u00e1genes que podemos descargar en el registro : <code>docker search</code></li> <li>Almacenar im\u00e1genes localmente desde el registro sin necesidad de crear un contenedor : <code>docker pull &lt;imagen:tag&gt;</code></li> <li>Observar el historial de una imagen creada : <code>docker history &lt;imagen&gt;</code></li> <li>Eliminar im\u00e1genes almacenadas localmente : <code>docker rmi &lt;imagen:tag&gt;</code></li> <li>Eliminar todas las im\u00e1genes locales que no estan siendo usadas por un contenedor : <code>docker rmi $(docker images -q)</code></li> <li>Eliminar todas las im\u00e1genes y contenedores parados : <code>docker system prune -a</code></li> <li>Crear una nueva imagen a partir de un contenedor existente : <code>docker commit -a &lt;autor&gt; -m &lt;comentario&gt; &lt;id/nombre-contenedor&gt; usuario/imagen:&lt;version&gt;</code></li> <li>A\u00f1adir una nueva etiqueta a una imagen : <code>docker tag usuario/imagen:tag usuario/imagen:tag-nuevo</code></li> <li>Borrar una etiqueta : <code>docker rmi usuario/imagen:tag</code>. La imagen se mantendr\u00e1 mientras tenga otra etiqueta.</li> <li>Hacer una copia de una imagen de nuestro servidor local : <code>docker save &gt; usuario/imagen archivo-de-copia</code></li> <li>Importar el fichero para crear una imagen en nuestra m\u00e1quina : <code>docker load &lt; archivo</code></li> <li>Dockerfile : <code>from</code><code>imagen</code> <code>run</code><code>apt update &amp;&amp; apt install -y nano</code> <code>cmd</code><code>/bin/bash</code></li> <li>Ejecutar lo que marca el Dockerfile : <code>docker build -t ubuntunano ./</code></li> <li>Indicar los puertos por defecto expuestos que tendr\u00e1 un contenedor basado en esta imagen : <code>EXPOSE &lt;puertos&gt;</code></li> </ul>"},{"location":"Ud2/Ch2_EV/#subir-una-imagen-a-un-repositorio-docker-hub","title":"Subir una imagen a un repositorio (Docker Hub)","text":"<ul> <li>Loguearse mediante consola al repostitorio : <code>docker login</code></li> <li>Hacer un commit local de la imagen : <code>docker commit -a &lt;autor&gt; -m &lt;comentario&gt; &lt;id/nombre-contenedor&gt; usuario/imagen:&lt;version&gt;</code></li> <li>Subirlo usando \"docker push\" : <code>docker push usuario/imagen</code></li> </ul>"},{"location":"Ud2/Ch2_EV/#volumenes","title":"Vol\u00famenes","text":"<ul> <li>Crear volumen : <code>docker volume create &lt;nombre&gt;</code></li> <li>Visualizar los vol\u00famenes disponibles : <code>docker volume ls</code></li> <li>Ver los metadatos de un volumen : <code>docker volume inspect &lt;nombre&gt;</code></li> <li>Borrar un volumen : <code>docker volume rm &lt;nombre&gt;</code></li> </ul>"},{"location":"Ud2/Ch2_EV/#integrar-contenedores-y-volumenes","title":"Integrar contenedores y vol\u00famenes","text":"<ul> <li>Crear una base de datos usando un volumen para guardar los datos : <code>docker run -d --name &lt;nombre&gt; \\     --mount source=&lt;volumen&gt;,target=/var/lib/mysql \\     -e MYSQL_ROOT_PASSWORD=secret \\     -e MYSQL_DATABASE=&lt;nombre-database&gt; \\     -e MYSQL_USER=manager \\     -e MYSQL_PASSWORD=secret \\     &lt;imagen&gt;</code></li> <li>Otro ejemplo : <code>docker run -d --name wordpress \\     --link wordpress-db:mysql \\     --mount type=bind,source=\"$(pwd)\"/target,target=/var/www/html \\     -e WORDPRESS_DB_USER=manager \\     -e WORDPRESS_DB_PASSWORD=secret \\     -p 8080:80 \\     wordpress:4.9.8</code><ul> <li>--link wordpress-db:mysql: indica que este contenedor se vincula con otro llamado \"wordpress-db\", y permite que este contenedor lo referencie utilizando el alias \"mysql\"</li> <li>-d para lanzar en 2\u00ba plano</li> <li>--mount para enlazar un directorio en el contenedor con un directorio en la m\u00e1quina anfitri\u00f3n</li> <li>-e para definir par\u00e1metros en el contenedor</li> <li>-p 8080:80 para enlazar el puerto 8080 en el anfitri\u00f3n con el 80 en el contenedor.</li> </ul> </li> </ul>"},{"location":"Ud2/Ch2_EV/#docker-compose","title":"Docker Compose","text":"<ul> <li>Crear fichero de configuraci\u00f3n <code>docker-compose.yaml</code></li> <li>Iniciar servicios : <code>docker-compose up -d</code></li> <li>Ver contenedores : <code>docker-compose ps</code></li> <li>Detener servicios : <code>docker-compose stop</code></li> <li>Borrar servicios : <code>docker-compose down</code></li> <li>Borrar tambi\u00e9n los vol\u00famenes : <code>docker-compose down -v</code></li> </ul>"},{"location":"Ud2/Ch2_EV/#trucos","title":"Trucos","text":"<ul> <li>Borrar objetos que no est\u00e1n en uso : <code>docker system prune</code></li> <li>Borrar vol\u00famenes que no est\u00e1n asociados a ning\u00fan contenedor : <code>docker volume rm $(docker volume ls -q -f \"dangling=true\")</code></li> <li>Borrar contenedores que han terminado su ejecuci\u00f3n : <code>docker rm $(docker ps -q -f \"status=exited\")</code></li> <li>Borrar im\u00e1genes que no est\u00e1n etiquetadas : <code>docker rmi $(docker images -q -f \"dangling=true\")</code></li> <li>Hacer una copia de seguridad : <code>docker run --rm -v /tmp:/backup \\     --volumes-from &lt;container-name&gt; \\     busybox tar -cvf /backup/backup.tar &lt;path-to-data&gt;</code></li> <li>Restaurar : <code>docker run --rm -v /tmp:/backup \\     --volumes-from &lt;container-name&gt;      busybox tar -xvf /backup/backup.tar &lt;path-to-data&gt;</code></li> </ul>"},{"location":"Ud2/Ch2_MCG/","title":"Cheatsheet de Docker","text":""},{"location":"Ud2/Ch2_MCG/#instalacion-puesta-en-marcha","title":"Instalaci\u00f3n / Puesta en marcha","text":""},{"location":"Ud2/Ch2_MCG/#actualizacion-del-sistema","title":"Actualizaci\u00f3n del sistema","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#verificar-la-version-de-docker","title":"Verificar la versi\u00f3n de Docker","text":"<pre><code>sudo docker version\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#agregar-el-usuario-al-grupo-de-docker","title":"Agregar el usuario al grupo de Docker","text":"<pre><code>sudo usermod -aG docker $USER\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#funcionamiento-basico","title":"Funcionamiento b\u00e1sico","text":""},{"location":"Ud2/Ch2_MCG/#sintaxis-del-comando-run","title":"Sintaxis del comando \"run\"","text":"<pre><code>docker run -it --name=$nombreDocker $nombreImagen /bin/bash\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#ver-logs-de-un-contenedor","title":"Ver logs de un contenedor","text":"<pre><code>docker logs -f $nombreDocker\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#correr-contenedor-mostrando-una-ip","title":"Correr contenedor mostrando una IP","text":"<pre><code>docker run -d -p 8080:80 $nombreDocker\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#manejo-de-volumenes","title":"Manejo de volumenes","text":""},{"location":"Ud2/Ch2_MCG/#crear-un-volumen","title":"Crear un volumen","text":"<pre><code>docker volume create\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#inspeccionar-un-volumen","title":"Inspeccionar un volumen","text":"<pre><code>docker volume inspect $nombreVolumen\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#eliminar-un-volumen","title":"Eliminar un volumen","text":"<pre><code>docker volume rm $nombreVolumen\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#levantar-servicios-con-docker-compose","title":"Levantar servicios con Docker Compose","text":"<pre><code>docker-compose up -d\n</code></pre>"},{"location":"Ud2/Ch2_MCG/#trucos","title":"Trucos","text":""},{"location":"Ud2/Ch2_MCG/#limpiar-el-sistema-de-docker","title":"Limpiar el sistema de Docker","text":"<pre><code>docker system prune\n</code></pre>"},{"location":"Ud2/Ch2_MIP/","title":"Docker Cheatsheet","text":""},{"location":"Ud2/Ch2_MIP/#instalacion-y-configuracion-basica","title":"Instalaci\u00f3n y Configuraci\u00f3n B\u00e1sica","text":"<pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo docker version\nsudo usermod -aG docker $USER\nsudo apt install docker-compose\n</code></pre>"},{"location":"Ud2/Ch2_MIP/#comandos-basicos-de-docker","title":"Comandos B\u00e1sicos de Docker","text":"Comando Descripci\u00f3n <code>docker run -it --name=ubuntu_pruebas ubuntu /bin/bash</code> Crea y accede a un contenedor interactivo. <code>docker exec -d ubuntu_pruebas touch /tmp/prueba</code> Ejecuta un comando en un contenedor existente. <code>docker exec -it ubuntu_pruebas bash</code> Accede a un contenedor en ejecuci\u00f3n. <code>docker exec -it -e VAR=1 ubuntu_pruebas bash</code> Ejecuta en contenedor con variable de entorno."},{"location":"Ud2/Ch2_MIP/#logs-y-visualizacion","title":"Logs y Visualizaci\u00f3n","text":"Comando Descripci\u00f3n <code>docker run -d --name=muchotexto busybox sh -c \"while true; do $(echo date) ; sleep 1; done\"</code> Ejecuta comando en bucle dentro del contenedor. <code>docker attach muchotexto</code> Adjunta a un contenedor en ejecuci\u00f3n. <code>docker logs -f --until=2s muchotexto</code> Visualiza logs recientes del contenedor."},{"location":"Ud2/Ch2_MIP/#manejo-de-volumenes","title":"Manejo de Vol\u00famenes","text":"Comando Descripci\u00f3n <code>docker volume create wordpress-db</code> Crea un volumen Docker. <code>docker volume ls</code> Lista vol\u00famenes existentes. <code>docker volume inspect wordpress-db</code> Inspecciona un volumen espec\u00edfico. <code>docker volume rm wordpress-db</code> Elimina un volumen. <code>docker run -d -it --name appcontainer -v /home/sergi/target:/app nginx:latest</code> Crea contenedor con volumen \u201cbinding mount\u201d. <code>docker run -d -it --name appcontainer -v micontenedor:/app nginx:latest</code> Crea contenedor con volumen Docker. <code>docker run -d -it --tmpfs /app nginx</code> Crea un contenedor con volumen tmpfs. <code>docker run --rm --volumes-from contenedor1 -v /home/sergi/backup:/backup ubuntu bash -c \"cd /datos &amp;&amp; tar cvf /backup/copiaseguridad.tar .\"</code> Backup de vol\u00famenes."},{"location":"Ud2/Ch2_MIP/#docker-compose-para-wordpress","title":"Docker Compose para WordPress","text":"<ol> <li> <p>Crear el directorio de trabajo:    <pre><code>mkdir -p ~/Sites/wordpress/target &amp;&amp; cd ~/Sites/wordpress\n</code></pre></p> </li> <li> <p>Crear <code>docker-compose.yaml</code> en <code>~/Sites/wordpress</code>:    <pre><code>version: '3'\nservices:\n  db:\n    image: mariadb:10.3.9\n    volumes:\n      - data:/var/lib/mysql\n    environment:\n      - MYSQL_ROOT_PASSWORD=secret\n      - MYSQL_DATABASE=wordpress\n      - MYSQL_USER=manager\n      - MYSQL_PASSWORD=secret\n  web:\n    image: wordpress:4.9.8\n    depends_on:\n      - db\n    volumes:\n      - ./target:/var/www/html\n    environment:\n      - WORDPRESS_DB_USER=manager\n      - WORDPRESS_DB_PASSWORD=secret\n      - WORDPRESS_DB_HOST=db\n    ports:\n      - 8080:80\nvolumes:\n  data:\n</code></pre></p> </li> <li> <p>Comandos b\u00e1sicos de Docker Compose:    <pre><code>docker-compose up -d\ndocker-compose ps\ndocker-compose stop\ndocker-compose down\ndocker-compose down -v\n</code></pre></p> </li> </ol>"},{"location":"Ud2/Ch2_MIP/#docker-compose-para-portainer","title":"Docker Compose para Portainer","text":"<ol> <li> <p>Crear el directorio de trabajo:    <pre><code>mkdir -p ~/Sites/portainer &amp;&amp; cd ~/Sites/portainer\n</code></pre></p> </li> <li> <p>Crear <code>docker-compose.yaml</code> en <code>~/Sites/portainer</code>:    <pre><code>version: '2'\nservices:\n  portainer:\n    image: portainer/portainer\n    command: -H unix:///var/run/docker.sock\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - portainer_data:/data\n    ports:\n      - 9000:9000\nvolumes:\n  portainer_data:\n</code></pre></p> </li> <li> <p>Iniciar Portainer:    <pre><code>docker-compose up -d\n</code></pre></p> </li> </ol>"},{"location":"Ud2/Ch2_MIP/#limpieza-del-sistema","title":"Limpieza del Sistema","text":"Comando Descripci\u00f3n <code>docker system prune</code> Elimina contenedores, vol\u00famenes y redes no utilizados. <code>docker volume rm $(docker volume ls -q -f \"dangling=true\")</code> Elimina vol\u00famenes no utilizados. <code>docker rm $(docker ps -q -f \"status=exited\")</code> Elimina contenedores detenidos. <code>docker rmi $(docker images -q -f \"dangling=true\")</code> Elimina im\u00e1genes no etiquetadas."},{"location":"Ud2/Ch2_MIP/#backup-y-restauracion-de-volumenes","title":"Backup y Restauraci\u00f3n de Vol\u00famenes","text":"Comando Descripci\u00f3n <code>docker run --rm -v /tmp:/backup --volumes-from &lt;container-name&gt; busybox tar -cvf /backup/backup.tar &lt;path-to-data&gt;</code> Backup de datos en contenedor. <code>docker run --rm -v /tmp:/backup --volumes-from &lt;container-name&gt; busybox tar -xvf /backup/backup.tar &lt;path-to-data&gt;</code> Restaurar datos en contenedor."},{"location":"Ud2/Ch2_MIP/#docker-compose-para-wordpress_1","title":"Docker Compose para WordPress","text":"<ol> <li> <p>Crear el directorio de trabajo:    <pre><code>mkdir -p ~/Sites/wordpress/target &amp;&amp; cd ~/Sites/wordpress\n</code></pre></p> </li> <li> <p>Crear <code>docker-compose.yaml</code> en <code>~/Sites/wordpress</code>:    <pre><code>version: '3'\nservices:\n  db:\n    image: mariadb:10.3.9\n    volumes:\n      - data:/var/lib/mysql\n    environment:\n      - MYSQL_ROOT_PASSWORD=secret\n      - MYSQL_DATABASE=wordpress\n      - MYSQL_USER=manager\n      - MYSQL_PASSWORD=secret\n  web:\n    image: wordpress:4.9.8\n    depends_on:\n      - db\n    volumes:\n      - ./target:/var/www/html\n    environment:\n      - WORDPRESS_DB_USER=manager\n      - WORDPRESS_DB_PASSWORD=secret\n      - WORDPRESS_DB_HOST=db\n    ports:\n      - 8080:80\nvolumes:\n  data:\n</code></pre></p> </li> <li> <p>Comandos b\u00e1sicos de Docker Compose:    <pre><code>docker-compose up -d\ndocker-compose ps\ndocker-compose stop\ndocker-compose down\ndocker-compose down -v\n</code></pre></p> </li> </ol>"},{"location":"Ud2/Ch2_MIP/#docker-compose-para-portainer_1","title":"Docker Compose para Portainer","text":"<ol> <li> <p>Crear el directorio de trabajo:    <pre><code>mkdir -p ~/Sites/portainer &amp;&amp; cd ~/Sites/portainer\n</code></pre></p> </li> <li> <p>Crear <code>docker-compose.yaml</code> en <code>~/Sites/portainer</code>:    <pre><code>version: '2'\nservices:\n  portainer:\n    image: portainer/portainer\n    command: -H unix:///var/run/docker.sock\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - portainer_data:/data\n    ports:\n      - 9000:9000\nvolumes:\n  portainer_data:\n</code></pre></p> </li> <li> <p>Iniciar Portainer:    <pre><code>docker-compose up -d\n</code></pre></p> </li> </ol>"},{"location":"Ud2/Ch2_MIP/#limpieza-del-sistema_1","title":"Limpieza del Sistema","text":"Comando Descripci\u00f3n <code>docker system prune</code> Elimina contenedores, vol\u00famenes y redes no utilizados. <code>docker volume rm $(docker volume ls -q -f \"dangling=true\")</code> Elimina vol\u00famenes no utilizados. <code>docker rm $(docker ps -q -f \"status=exited\")</code> Elimina contenedores detenidos. <code>docker rmi $(docker images -q -f \"dangling=true\")</code> Elimina im\u00e1genes no etiquetadas."},{"location":"Ud2/Ch2_MIP/#backup-y-restauracion-de-volumenes_1","title":"Backup y Restauraci\u00f3n de Vol\u00famenes","text":"Comando Descripci\u00f3n <code>docker run --rm -v /tmp:/backup --volumes-from &lt;container-name&gt; busybox tar -cvf /backup/backup.tar &lt;path-to-data&gt;</code> Backup de datos en contenedor. <code>docker run --rm -v /tmp:/backup --volumes-from &lt;container-name&gt; busybox tar -xvf /backup/backup.tar &lt;path-to-data&gt;</code> Restaurar datos en contenedor."},{"location":"Ud2/Ch2_MMC/","title":"CheatSheet Docker MMC","text":"<p>Tipo: Apuntes Estado: No empezado Tema: Despliegue</p>"},{"location":"Ud2/Ch2_MMC/#post-instalacion","title":"Post Instalaci\u00f3n \u2699\ufe0f","text":"sudo usermod -aG docker $USER A\u00f1ade tu usuario al grupo de docker. sudo apt install docker-compose Instalaci\u00f3n de Docker Compose"},{"location":"Ud2/Ch2_MMC/#comandos-basicos","title":"Comandos B\u00e1sicos \ud83d\udddd\ufe0f","text":"docker run  Crea y arranca un controlador docker ps Listado de contenedores en ejecuci\u00f3n docker ps -a Listado de todos los contenedores docker start  Inicia un contenedor docker stop  Detiene de manera ordenada un contenedor docker restart  Reinicia un contenedor docker rename contenedor1 contenedor2 Cambiar el nombre asociado a un contenedor. docker rm  Elimina un contenedor (solo se puede borrar si est\u00e1 parado) docker rm $(docker ps -a -q) Elimina todos los contenedores"},{"location":"Ud2/Ch2_MMC/#consultar-informacion","title":"Consultar informaci\u00f3n \ud83d\udd0d","text":"docker inspect  Proporciona diversos detalles de la configuraci\u00f3n de un contenedor docker logs  [OPCIONES]  Consultar la informaci\u00f3n de la salida est\u00e1ndar y de error"},{"location":"Ud2/Ch2_MMC/#movimientos-en-contenedores","title":"Movimientos en contenedores \ud83e\udea9","text":"docker exec  [OPCIONES]  COMANDO [ARGUMENTOS] Permite ejecutar un comando dentro de un contenedor docker cp idcontainer:/tmp/prueba ./ Permite copiar ficheros y directorios del anfitriona un contenedor o viceversa. docker attach  [OPCIONES]  Enlazar la entrada o salida est\u00e1ndar del terminal a un contenedor"},{"location":"Ud2/Ch2_MMC/#trato-de-imagenes","title":"Trato de im\u00e1genes \ud83d\udcfa","text":"docker images Listado de im\u00e1genes almacenadas docker search  Obtener informaci\u00f3n de im\u00e1genes descargables docker pull  Obtener im\u00e1genes sin ponerlo en un contenedor docker history  Hist\u00f3rico de una imagen descargada docker rmi  Elimina la imagen localmente docker rmi $(docker images -q) Elimina todas las im\u00e1genes locales docker system prune -a Elimina todas las im\u00e1genes y contenedores docker commit -a \"autor\" -m \"comentario\"  usuario/imagen:[version] Crear una propia imagen docker tag  usuario/imagen:[version] A\u00f1adir una etiqueta a una imagen docker save -o copiaSeguridad.tar sergi/ubuntumod Copia de seguridad, exportar docker load -i copiaSeguridad.tar Importar una imagen exportada previamente docker import http://ejemplo.com/mi-imagen.tar Crea una nueva imagen a partir del enlace"},{"location":"Ud2/Ch2_MMC/#dockerhub","title":"DockerHub \ud83d\udc33","text":"docker login Loguearnos al repositorio remoto docker push Subir im\u00e1genes al repositorio remoto"},{"location":"Ud2/Ch2_MMC/#dockerfile","title":"DockerFile \ud83d\udcc4","text":"docker build -t ubuntunano ./ Crea una imagen a partir de un DockerFile"},{"location":"Ud2/Ch2_MMC/#comandos-dentro-del-dockerfile","title":"Comandos dentro del DockerFile \ud83d\udcdd","text":"FROM ubuntu:latest Define la imagen base desde la cual construir la imagen RUN apt update Ejecuta el comando escrito CMD /bin/bash Define un comando predeterminado que se ejecutar\u00e1 cuando el contenedor inicie EXPOSE 80 443 8080 Expone los puertos determinados ADD ./mifichero.zip /var/www/html Copia el archivo y lo descomprime si es un archivo comprimido. COPY ./mifichero.zip /var/www/html Copia el archivo pero sin descomprimirlo ENTRYPOINT [\"cat\"] Define el comando que siempre se ejecutar\u00e1 al iniciar el contenedor USER sergi Establece un usuario como el usuario predeterminado WORKDIR /root Define el directorio de trabajo predeterminado ENV v1=\u201dvalor1\u201d v2=\u201dvalor2\u201d Define variables de entorno con sus variables ARG version=1.0 <p>| Define variables de construcci\u00f3n | | VOLUME /data | Crea un volumen donde se almacenan datos persistentes | | LABEL maintainer=\"tu_email@example.com\" | A\u00f1ade metadatos a la imagen | | HEALTHCHECK CMD curl --fail http://localhost || exit 1 | Define un comando para verificar la salud del contenedor |</p>"},{"location":"Ud2/Ch2_MMC/#volumen","title":"Volumen \ud83d\udd0a","text":"docker volume create  Crear volumen docker volume ls Listar vol\u00famenes docker volume inspect  Ver metadatos del volumen docker volume rm  Borrar volumen docker run -d --name wordpress-db \\ --mount source=vol-wordpress-db,target=/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=secret \\ -e MYSQL_DATABASE=wordpress \\ -e MYSQL_USER=manager \\ -e MYSQL_PASSWORD=secret \\ mariadb:10.3.9 Ejemplo de crear un contenedor con un volumen espec\u00edfico"},{"location":"Ud2/Ch2_MMC/#docker-compose","title":"Docker Compose \ud83d\udcda","text":"docker-compose up -d Iniciar los servicios definidos en un archivo docker-compose.yml en segundo plano docker-compose ps Listar los contenedores docker-compose stop Detener servicios docker-compose down Borrar servicios pero no vol\u00famenes docker-compose down -v Borrar tanto contenedores como vol\u00famenes"},{"location":"Ud2/Ch2_PPE/","title":"Cheatsheet UD2 - Contenedores (Docker)","text":"<p>Este documento resume los comandos para la creaci\u00f3n y gesti\u00f3n de contenedores Docker en sistemas Ubuntu, correspondientes a la Unidad 2 del curso de Despliegue de Aplicaciones.</p>"},{"location":"Ud2/Ch2_PPE/#instalacion-de-docker-paso-a-paso-linux","title":"\ud83d\udda5\ufe0f Instalaci\u00f3n de Docker paso a paso (Linux)","text":"<p>La instalaci\u00f3n varia dependiendo de la distribuci\u00f3n. A continuaci\u00f3n, se presenta solo la instalaci\u00f3n en sistemas Ubuntu, aunque se puede consultar la documentaci\u00f3n oficial para instalar en otras versiones.</p>"},{"location":"Ud2/Ch2_PPE/#configurar-el-repositorio-apt","title":"\ud83d\udce6 Configurar el repositorio apt","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt update &amp;&amp; sudo apt upgrade</code> Actualiza la lista y los paquetes instalados a la \u00faltima versi\u00f3n disponible. <code>sudo apt-get install ca-certificates curl</code> Instala dependencias de docker. <code>sudo install -m 0755 -d /etc/apt/keyrings</code> Crea el directorio para almacenar la clave GPG con los permisos necesarios. <code>sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc</code> Descarga la clave GPG de Docker <code>sudo chmod a+r /etc/apt/keyrings/docker.asc</code> Asigna permisos de lectura a la clave GPG. <code>sudo apt update</code> Actualiza la lista de paquetes para incluir el repositorio de Docker."},{"location":"Ud2/Ch2_PPE/#instalar-docker","title":"\ud83d\udc33 Instalar Docker","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</code> Instala los paquetes necesarios para crear contenedores Docker. <code>sudo docker version</code> Ver la versi\u00f3n de docker instalada en nuestro equipo. <code>sudo docker run hello-world</code> Ejecuta un contenedor de prueba para verificar que Docker se ha instalado correctamente. <p>\ud83d\udca1 Tip: Una vez hemos terminado con la instalaci\u00f3n de Docker y hayamos comprobado que funciona correctamente, podemos ejecutar el comando <code>sudo usermod -aG docker $USER</code>. De este modo, estamos permitiendo que nuestro usuario activo pueda ejecutar sentencias de docker sin necesidad de utilizar sudo.</p>"},{"location":"Ud2/Ch2_PPE/#acciones-principales","title":"\ud83d\udda5\ufe0f Acciones Principales","text":""},{"location":"Ud2/Ch2_PPE/#docker-run","title":"\ud83c\udfc3 Docker Run","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker run -it --name=cont1 ubuntu /bin/bash</code> Crea y ejecuta un contenedor interactivo con Ubuntu y abre una sesi\u00f3n de <code>bash</code>. <code>docker run -d -p 1200:80 apache2</code> Ejecuta un contenedor en segundo plano y mapea el puerto <code>1200</code> del anfitri\u00f3n al <code>80</code> del contenedor. <code>docker run -it -e MENSAJE=HOLA ubuntu:14.04 bash</code> Crea y ejecuta un contenedor interactivo con la variable de entorno MENSAJE."},{"location":"Ud2/Ch2_PPE/#docker-ps","title":"\ud83d\udccb Docker Ps","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker ps</code> Lista los contenedores en ejecuci\u00f3n. <code>docker ps -a</code> Lista todos los contenedores, incluyendo los detenidos."},{"location":"Ud2/Ch2_PPE/#docker-startstoprestart","title":"\ud83d\udd04 Docker Start/Stop/Restart","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker start contenedor</code> Inicia un contenedor detenido. <code>docker start -ai contenedor</code> Inicia un contenedor, enlazando el comando a la entrada y salida del terminal del anfitri\u00f3n. <code>docker stop contenedor</code> Detiene un contenedor en ejecuci\u00f3n. <code>docker stop $(docker ps -a -q)</code> Detiene todos los contenedores en ejecuci\u00f3n. <code>docker restart contenedor</code> Reinicia un contenedor en ejecuci\u00f3n."},{"location":"Ud2/Ch2_PPE/#docker-exec","title":"\ud83c\udf10 Docker Exec","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker exec -d ubuntu touch /tmp/prueba.txt</code> Ejecuta el comando <code>touch</code> dentro del contenedor en segundo plano. <code>docker exec -it -e VAR=1 ubuntu_pruebas bash</code> Ejecuta una sesi\u00f3n interactiva de <code>bash</code> en el contenedor con una variable de entorno."},{"location":"Ud2/Ch2_PPE/#docker-attach","title":"\ud83d\udd17 Docker Attach","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker attach contenedor</code> Conecta el terminal del equipo anfitri\u00f3n al del contenedor en ejecuci\u00f3n."},{"location":"Ud2/Ch2_PPE/#docker-logs","title":"\ud83d\udcdc Docker Logs","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker logs contenedor</code> Muestra los registros generados por el contenedor desde su inicio. <code>docker logs -f contenedor</code> Sigue los registros del contenedor en tiempo real. <code>docker logs -n 10 contenedor</code> Muestra las 10 \u00faltimas l\u00edneas de los registros generado por el contenedor."},{"location":"Ud2/Ch2_PPE/#docker-cp","title":"\ud83d\udcc2 Docker CP","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker cp contenedor:/tmp/prueba ./</code> Copia el fichero <code>/tmp/prueba</code> del contenedor al directorio actual del anfitri\u00f3n. <code>docker cp ./miFichero contenedor:/tmp</code> Copia el fichero <code>miFichero</code> del directorio actual del anfitri\u00f3n a la carpeta <code>/tmp</code> del contenedor."},{"location":"Ud2/Ch2_PPE/#docker-rm","title":"\ud83d\uddd1\ufe0f Docker RM","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker rm contenedor</code> Elimina el contenedor (necesita estar detenido previamente). <code>docker rm $(docker ps -a -q)</code> Elimina todos los contenedores detenidos."},{"location":"Ud2/Ch2_PPE/#gestion-de-imagenes","title":"\ud83d\udda5\ufe0f Gesti\u00f3n de Im\u00e1genes","text":""},{"location":"Ud2/Ch2_PPE/#secuencias-basicas","title":"\ud83d\udee0\ufe0f Secuencias B\u00e1sicas","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker images</code> Lista todas las im\u00e1genes disponibles en el sistema. <code>docker search ubuntu</code> Busca im\u00e1genes de Docker Hub que coincidan con el t\u00e9rmino <code>ubuntu</code>. <code>docker pull ubuntu</code> Descarga la imagen <code>ubuntu</code> desde Docker Hub. <code>docker history ubuntu</code> Muestra el historial de capas de la imagen <code>ubuntu</code>. <code>docker rmi ubuntu:14.04</code> Elimina la imagen <code>ubuntu:14.04</code> del sistema (<code>14:04</code> indica la versi\u00f3n de la imagen). <code>docker rmi $(docker images -q)</code> Elimina todas las im\u00e1genes Docker del sistema."},{"location":"Ud2/Ch2_PPE/#creacion-de-imagenes","title":"\ud83c\udfd7\ufe0f Creaci\u00f3n de Im\u00e1genes","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker commit -m \"comentario\" IDCONTENEDOR usuario/imagen:version</code> Crea una nueva imagen a partir de un contenedor en ejecuci\u00f3n. <code>docker save -o copiaSeguridad.tar imagenA</code> Guarda una imagen Docker en un archivo comprimido como copia de seguridad. <code>docker load -i copiaSeguridad.tar</code> Carga una imagen Docker desde un archivo comprimido <code>tar</code>."},{"location":"Ud2/Ch2_PPE/#docker-hub","title":"\ud83c\udf10 Docker Hub","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker login</code> Inicia sesi\u00f3n en Docker Hub. <code>docker push usuario/imagen:version</code> Sube una imagen al repositorio de Docker Hub."},{"location":"Ud2/Ch2_PPE/#dockerfile","title":"\ud83d\udcc4 Dockerfile","text":"<p>El <code>Dockerfile</code> es un archivo de texto que contiene todas las instrucciones necesarias para construir una imagen Docker. Algunos comandos b\u00e1sicos son:</p> <pre><code># Usar una imagen base oficial de Node.js\nFROM node:14\n\n# Establecer el directorio de trabajo en el contenedor\nWORKDIR /app\n\n# Copiar el archivo package.json y package-lock.json al directorio de trabajo\nCOPY package*.json ./\n\n# Instalar las dependencias del proyecto\nRUN npm install\n\n# Copiar el resto de los archivos de la aplicaci\u00f3n al directorio de trabajo\nCOPY . .\n\n# Exponer el puerto en el que la aplicaci\u00f3n escuchar\u00e1\nEXPOSE 3000\n\n# Comando para ejecutar la aplicaci\u00f3n\nCMD [\"node\", \"app.js\"]\n</code></pre> <p>\ud83d\udca1 Tip: Para ejecutar el fichero y construir la imagen, se utiliza el comando <code>docker build -t imagen .</code>, siendo <code>.</code> el directorio donde se encuentra el Dockerfile.</p>"},{"location":"Ud2/Ch2_PPE/#volumenes","title":"\ud83d\udda5\ufe0f Vol\u00famenes","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker volume create volumen</code> Crea un nuevo volumen. <code>docker volume ls</code> Lista todos los vol\u00famenes Docker disponibles en el sistema. <code>docker volume inspect volumen</code> Inspecciona el volumen para ver sus detalles. <code>docker volume rm volumen</code> Elimina el volumen. <code>docker system prune -a</code> Elimina todos los contenedores, im\u00e1genes y vol\u00famenes no utilizados. <code>docker run -d -it --name appcontainer -v volumen:/app nginx:latest</code> Ejecuta un contenedor con Nginx en segundo plano y monta el volumen <code>volumen</code> en <code>/app</code>."},{"location":"Ud2/Ch2_PPE/#integracion-con-contenedores","title":"\ud83c\udf10 Integraci\u00f3n con contenedores","text":"<p>Estos comandos muestran c\u00f3mo integrar vol\u00famenes con contenedores Docker:</p> <p><pre><code>docker run -d --name wordpress-db \\\n    --mount source=vol-wordpress-db,target=/var/lib/mysql \\\n    -e MYSQL_ROOT_PASSWORD=secret \\\n    -e MYSQL_DATABASE=wordpress \\\n    -e MYSQL_USER=manager \\\n    -e MYSQL_PASSWORD=secret \\\n    mariadb:10.3.9\n</code></pre> - Crea y ejecuta un contenedor BBDD utilizando un volumen existente</p> <pre><code>docker run -d --name wordpress \\\n    --link wordpress-db:mysql \\\n    --mount type=bind,source=\"$(pwd)\"/target,target=/var/www/html \\\n    -e WORDPRESS_DB_USER=manager \\\n    -e WORDPRESS_DB_PASSWORD=secret \\\n    -p 8080:80 \\\n    wordpress:4.9.8\n</code></pre> <ul> <li>Crea y ejecuta un contenedor WordPress, conectandolo al contenedor anterior y montando un directorio del host</li> </ul>"},{"location":"Ud2/Ch2_PPE/#docker-compose","title":"\ud83d\udda5\ufe0f Docker Compose","text":""},{"location":"Ud2/Ch2_PPE/#ejemplo-basico-de-fichero-docker-composeyaml","title":"\ud83d\udcc4 Ejemplo b\u00e1sico de fichero docker-compose.yaml","text":"<pre><code>version: '3'\nservices:\n  web:\n    image: nginx:latest\n    ports:\n      - \"8080:80\"\n  db:\n    image: mariadb:10.3.9\n    environment:\n      MYSQL_ROOT_PASSWORD: secret\n      MYSQL_DATABASE: exampledb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: password\n</code></pre>"},{"location":"Ud2/Ch2_PPE/#principales-comandos","title":"\ud83d\udee0\ufe0f Principales comandos","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Acci\u00f3n <code>docker-compose up -d</code> Inicia todos los servicios definidos en el archivo <code>docker-compose.yaml</code> en segundo plano. <code>docker-compose down</code> Detiene y elimina todos los contenedores, redes y vol\u00famenes creados por <code>docker-compose up</code>. <code>docker-compose build</code> Construye o reconstruye los servicios definidos en el archivo <code>docker-compose.yaml</code>. <code>docker-compose pull</code> Descarga las im\u00e1genes de los servicios definidos en el archivo <code>docker-compose.yaml</code>. <code>docker-compose ps</code> Lista los contenedores en ejecuci\u00f3n definidos en el archivo <code>docker-compose.yaml</code>."},{"location":"Ud2/Ch2_RPE/","title":"Cheatsheet Contenedores Docker \ud83d\udc0b","text":""},{"location":"Ud2/Ch2_RPE/#1-instalacion","title":"1. Instalaci\u00f3n \ud83d\udd27","text":""},{"location":"Ud2/Ch2_RPE/#instalacion-en-linux","title":"Instalaci\u00f3n en Linux","text":"\ud83d\udee0\ufe0f Paso \ud83d\udcdc Comando \ud83d\udce5 Incluir el repositorio <code>sudo apt update</code> \u27a1\ufe0f Instalar dependencias <code>sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common</code> \ud83d\udd11 Descargar clave GPG e incluirla <code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg / sudo apt-key add -</code> \u2795 A\u00f1adir el repositorio <code>sudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"</code> \ud83d\udc0b Instalar Docker Engine CE <code>sudo apt-get install docker-ce docker-ce-cli containerd.io</code> \ud83d\udc0b Instalar Docker Compose <code>sudo apt install docker-compose</code> \ud83d\udc64 Uso sin privilegios <code>sudo usermod -aG docker $USER</code> \ud83d\uddd1\ufe0f Desinstalar Docker <code>sudo apt-get purge docker-ce docker-ce-cli containerd.io</code>"},{"location":"Ud2/Ch2_RPE/#2-imagenes","title":"2. Im\u00e1genes \ud83d\uddbc\ufe0f","text":"Acci\u00f3n Comando \ud83d\udcdc Listar im\u00e1genes <code>docker images</code> \ud83d\udce5 Descargar imagen <code>docker pull &lt;nombre_imagen&gt;</code> \ud83d\uddd1\ufe0f Eliminar imagen <code>docker rmi &lt;nombre_imagen&gt;</code> \ud83c\udfd7\ufe0f Crear imagen <code>docker build -t &lt;nombre_imagen&gt;:&lt;tag&gt; &lt;directorio_dockerfile&gt;</code>"},{"location":"Ud2/Ch2_RPE/#3-contenedores","title":"3. Contenedores \ud83d\udce6","text":"Acci\u00f3n Comando \u25b6\ufe0f Ejecutar contenedor nuevo <code>docker run &lt;nombre_imagen&gt;</code> \u25b6\ufe0f Ejecutar en segundo plano <code>docker run -d &lt;nombre_imagen&gt;</code> \ud83d\udda5\ufe0f Modo interactivo <code>docker run -it &lt;nombre_imagen&gt;</code> \ud83d\udd0c Asignar puerto <code>docker run -p &lt;puerto_local&gt;:&lt;puerto_contenedor&gt; &lt;nombre_imagen&gt;</code> \ud83d\udcdc Listar contenedores activos <code>docker ps</code> \ud83d\udcdc Listar todos los contenedores <code>docker ps -a</code> \ud83d\udd75\ufe0f Inspeccionar contenedor <code>docker inspect &lt;id_contenedor&gt;</code> \ud83d\udcdd Mostrar logs <code>docker logs &lt;id_contenedor&gt;</code> \ud83d\udd04 Iniciar contenedor detenido <code>docker start &lt;nombre_contenedor&gt;</code> \u23f9\ufe0f Detener contenedor <code>docker stop &lt;nombre_contenedor&gt;</code> \ud83d\uddd1\ufe0f Eliminar contenedor <code>docker rm &lt;id_contenedor&gt;</code> \u2328\ufe0f Ejecutar comando en contenedor <code>docker exec -it &lt;nombre_contenedor&gt; &lt;comando&gt;</code> \ud83d\udd04 Reiniciar contenedor <code>docker restart &lt;nombre_contenedor&gt;</code>"},{"location":"Ud2/Ch2_RPE/#4-volumenes","title":"4. Vol\u00famenes \ud83d\udcc2","text":"Acci\u00f3n Comando \u2795 Crear volumen <code>docker volume create &lt;nombre_volumen&gt;</code> \ud83d\udcc2 Montar volumen <code>docker run -v &lt;nombre_volumen&gt;:&lt;directorio_contenedor&gt; &lt;nombre_imagen&gt;</code> \ud83d\udcdc Listar vol\u00famenes <code>docker volume ls</code> \ud83d\udd0d Inspeccionar volumen <code>docker volume inspect &lt;nombre_volumen&gt;</code> \ud83d\uddd1\ufe0f Eliminar volumen <code>docker volume rm &lt;nombre_volumen&gt;</code>"},{"location":"Ud2/Ch2_RPE/#5-redes-en-docker","title":"5. Redes en Docker \ud83c\udf10","text":"Acci\u00f3n Comando \ud83d\udcdc Listar redes <code>docker network ls</code> \u2795 Crear red <code>docker network create &lt;nombre_red&gt;</code> \ud83d\uddd1\ufe0f Eliminar red <code>docker network rm &lt;nombre_red&gt;</code> \ud83d\udd0c Conectar contenedor a red <code>docker run --network &lt;nombre_red&gt; &lt;nombre_imagen&gt;</code>"},{"location":"Ud2/Ch2_RPE/#6-docker-compose","title":"6. Docker Compose \ud83d\udccb","text":"Acci\u00f3n Comando \u25b6\ufe0f Iniciar servicios <code>docker-compose up</code> \u25b6\ufe0f Iniciar en segundo plano <code>docker-compose up -d</code> \ud83d\udd04 Reconstruir y reiniciar servicios <code>docker-compose up --build</code> \u23f9\ufe0f Detener servicios <code>docker-compose stop</code> \ud83d\uddd1\ufe0f Eliminar servicios <code>docker-compose down</code> \ud83d\uddd1\ufe0f Eliminar servicios y vol\u00famenes <code>docker-compose down -v</code> \ud83d\udcdc Ver logs de servicios <code>docker-compose logs</code>"},{"location":"Ud2/Ch2_RPE/#7-limpieza","title":"7. Limpieza \ud83e\uddf9","text":"Acci\u00f3n Comando \ud83d\uddd1\ufe0f Eliminar objetos sin uso <code>docker system prune</code> \ud83d\uddd1\ufe0f Eliminar contenedores parados <code>docker container prune</code> \ud83d\uddd1\ufe0f Eliminar im\u00e1genes no usadas <code>docker image prune</code> \ud83d\uddd1\ufe0f Eliminar vol\u00famenes no usados <code>docker volume prune</code>"},{"location":"Ud2/Ch2_RRLL/","title":"Cheatsheet DOCKER de Rommel","text":""},{"location":"Ud2/Ch2_RRLL/#instalacion","title":"Instalaci\u00f3n","text":"<p>Actualizar los paquetes existentes:</p> <pre><code>    sudo apt update\n    sudo apt upgrade\n</code></pre> <p>Instalar paquetes necesarios para Docker:</p> <pre><code>    sudo apt install apt-transport-https ca-certificates curl software-properties-common\n</code></pre> <p>Agregar la clave GPG de Docker:</p> <pre><code>    curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\n</code></pre> <p>Agregar el repositorio de Docker:</p> <pre><code>    echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n</code></pre> <p>Actualizar de nuevo el \u00edndice de paquetes e instalar Docker:</p> <pre><code>    sudo apt update\n    sudo apt install docker-ce docker-ce-cli containerd.io\n</code></pre> <p>Verificar que Docker se haya instalado correctamente:</p> <pre><code>    sudo docker --version\n</code></pre>"},{"location":"Ud2/Ch2_RRLL/#contenedores","title":"Contenedores","text":""},{"location":"Ud2/Ch2_RRLL/#docker-run","title":"Docker run","text":"<pre><code>    docker run -it --name=mi_contenedor ubuntu /bin/bash\n</code></pre> <p>Crea un contenedor interactivo y inicia la terminar <code>bash</code> al ser ejecutado.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-pa","title":"Docker pa","text":"<pre><code>    docker ps\n</code></pre> <p>Muestra los contenedores que est\u00e1n en ejecuci\u00f3n.</p> <pre><code>    docker ps -a\n</code></pre> <p>Muestra los contenedores que est\u00e1n en ejecuci\u00f3n y los que no (detenidos).</p>"},{"location":"Ud2/Ch2_RRLL/#docker-start","title":"Docker start","text":"<pre><code>    docker start contenedor\n</code></pre> <p>Inicia un contenedor</p> <pre><code>    docker start -ai contenedor\n</code></pre> <p>Inicia un contenedor y nos permite ver e interactuar con su salida y entrada.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-stop","title":"Docker stop","text":"<pre><code>    docker stop contenedor\n</code></pre> <p>Detiene el contenedor.</p> <pre><code>    docker stop $(docker ps -a -q)\n</code></pre> <p>Detiene todos los contenedores.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-restart","title":"Docker restart","text":"<pre><code>    docker restart contenedor\n</code></pre> <p>Reinicia el contenedor.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-exec","title":"Docker exec","text":"<pre><code>    docker exec ubuntu /bin/bash\n</code></pre> <p>Ejecuta el comando que pongas en el contenedor, aqu\u00ed inicia un bash en un contenedor ubuntu, el contenedor tiene que estar iniciado.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-attach","title":"Docker attach","text":"<pre><code>    docker attach contenedor\n</code></pre> <p>Conecta el terminal del host con el del contenedor.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-logs","title":"Docker logs","text":"<pre><code>    docker logs contenedor\n</code></pre> <p>Muestra los registros generados por el contenedor.</p> <pre><code>    docker logs -f contenedor\n</code></pre> <p>Muestra los registros generados por el contenedor en tiempo real.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-cp","title":"Docker cp","text":"<pre><code>    docker cp contenedor:ruta/archivo ruta/destino/host\n</code></pre> <p>Copia un archivo del contenedor al host.</p> <pre><code>    docker cp ruta/archivo/host contenedor:ruta/destino/contenedor\n</code></pre> <p>Copia un archivo del host al contenedor.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-rm","title":"Docker rm","text":"<pre><code>    docker rm contenedor\n</code></pre> <p>Elimina el contenedor, tiene que estar parado para eliminarlo.</p> <pre><code>    docker rm $(docker ps -a -q)\n</code></pre> <p>Elimina todos los contenedores detenidos.</p>"},{"location":"Ud2/Ch2_RRLL/#imagenes","title":"Im\u00e1genes","text":""},{"location":"Ud2/Ch2_RRLL/#docker-images","title":"Docker images","text":"<pre><code>    docker images\n</code></pre> <p>Lista todas las im\u00e1genes</p>"},{"location":"Ud2/Ch2_RRLL/#docker-search","title":"Docker search","text":"<pre><code>    docker search nombre_imagen\n</code></pre> <p>Busca todas las im\u00e1genes en <code>Docker hub</code> que coincidan con el nombre que de imagen que hemos puesto.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-pull","title":"Docker pull","text":"<pre><code>    docker pull nombre_imagen\n</code></pre> <p>Descarga la imagen que hemos especificado.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-history","title":"Docker history","text":"<pre><code>    docker history nombre_imagen\n</code></pre> <p>Muestra el historial de la imagen, es decir, todas las capas que la componen.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-rmi","title":"Docker rmi","text":"<pre><code>    docker rmi nombre_imagen\n</code></pre> <p>Elimina la imagen especificada.</p> <pre><code>    docker rmi $(docker images -q)\n</code></pre> <p>Elimina todas las im\u00e1genes.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-commit","title":"Docker commit","text":"<pre><code>    docker commit -m \"comentario\" IDCONTENEDOR usuario/imagen:version\n</code></pre> <p>Crea una imagen a partir de un contenedor.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-save","title":"Docker save","text":"<pre><code>    docker save -o copiaSeguridad.tar nombre_imagen\n</code></pre> <p>Guarda una imagen en una archivo comprimido.</p>"},{"location":"Ud2/Ch2_RRLL/#docker-load","title":"Docker load","text":"<pre><code>    docker save -i copiaSeguridad.tar\n</code></pre> <p>Carga una imagen comprimida en un archivo <code>.tar</code>.</p>"},{"location":"Ud2/Ch2_RRLL/#dockerhub","title":"Dockerhub","text":""},{"location":"Ud2/Ch2_RRLL/#inicio-sesion","title":"Inicio sesi\u00f3n","text":"<pre><code>    docker login\n</code></pre> <p>Inicia sesion en <code>Docker Hub</code>.</p>"},{"location":"Ud2/Ch2_RRLL/#subir-imagen","title":"Subir imagen","text":"<pre><code>    docker push usuario/imagen:[version]\n</code></pre> <p>Sube la imagen a <code>Docker hub</code></p>"},{"location":"Ud2/Ch2_RRLL/#dockerfile","title":"Dockerfile","text":""},{"location":"Ud2/Ch2_RRLL/#archivo-dockerfile","title":"Archivo Dockerfile","text":"<pre><code>    FROM nombre_imagen # Definir la imagen que vamos a usar\n\n    WORKDIR /app # Establece el directorio de trabajo\n\n    COPY &lt;origen&gt; &lt;destino&gt;  # Copia archivos del host al contenedor\n\n    ADD &lt;origen&gt; &lt;destino&gt;  # Copia archivos y los descomprime si es necesario\n\n    RUN apt-get update &amp;&amp; apt-get install -y &lt;paquete&gt;  # Ejecuta un comando durante la construcci\u00f3n\n\n    CMD [\"executable\", \"param1\", \"param2\"]  # Comando por defecto al iniciar el contenedor\n\n    ENTRYPOINT [\"executable\", \"param1\"]  # Comando fijo que siempre se ejecuta al iniciar el contenedor\n\n    EXPOSE 8080  # Expone el puerto 8080\n\n    ENV VARIABLE=value  # Establece una variable de entorno\n\n    VOLUME [\"/data\"]  # Crea un volumen en /data\n</code></pre>"},{"location":"Ud2/Ch2_RRLL/#docker-build","title":"docker build","text":"<pre><code>    docker build -t imagen .\n</code></pre>"},{"location":"Ud2/Ch2_RRLL/#volumenes","title":"Volumenes","text":""},{"location":"Ud2/Ch2_RRLL/#crear-volumenes","title":"Crear volumenes","text":"<pre><code>    docker volume create nombre_volumen\n</code></pre> <p>Crea un volumen.</p>"},{"location":"Ud2/Ch2_RRLL/#listar-volumenes","title":"Listar volumenes","text":"<pre><code>    docker volume ls\n</code></pre> <p>Lista todos los volumenes.</p>"},{"location":"Ud2/Ch2_RRLL/#inspeccionar-volumen","title":"Inspeccionar volumen","text":"<pre><code>    docker volume inspect nombre_volumen\n</code></pre> <p>Inspecciona el volumen.</p>"},{"location":"Ud2/Ch2_RRLL/#eliminar-volumen","title":"Eliminar volumen","text":"<pre><code>    docker volume rm nombre_volumen\n</code></pre> <p>Eliminar volumen.</p>"},{"location":"Ud2/Ch2_RRLL/#eliminar-volumenes-imagenes-y-contenedores-no-usados","title":"Eliminar vol\u00famenes, im\u00e1genes y contenedores no usados","text":"<pre><code>    docker system prune -a\n</code></pre> <p>Elimina todos los vol\u00famenes, im\u00e1genes y contenedores no usados.</p>"},{"location":"Ud2/Ch2_RRLL/#integrar-con-contenedores","title":"Integrar con contenedores","text":"<p>Para integrar un volumen a un contenedor hacemos lo siguiente:</p> <pre><code>    docker run -d --name wordpress-db \\\n    --mount type=volume,source=vol-wordpress-db,target=/var/lib/mysql \\  # integraci\u00f3n del volumen\n    -e MYSQL_ROOT_PASSWORD=secret \\\n    -e MYSQL_DATABASE=wordpress \\\n    -e MYSQL_USER=manager \\\n    -e MYSQL_PASSWORD=secret \\\n    mariadb:10.3.9\n</code></pre> <p>Para montar una carpeta hacemos lo mismo cambiando el <code>type</code> por <code>bind</code>:</p> <pre><code>    docker run -d --name wordpress-db \\\n    --mount type=bind,source=/ruta/en/host,target=/var/lib/mysql \\ # integraci\u00f3n de la carpeta\n    -e MYSQL_ROOT_PASSWORD=secret \\\n    -e MYSQL_DATABASE=wordpress \\\n    -e MYSQL_USER=manager \\\n    -e MYSQL_PASSWORD=secret \\\n    mariadb:10.3.9\n</code></pre>"},{"location":"Ud2/Ch2_RRLL/#docker-compose","title":"Docker-Compose","text":""},{"location":"Ud2/Ch2_RRLL/#archivo-docker-composeyaml","title":"Archivo docker-compose.yaml","text":"<pre><code>version: '3.8'  # Define la versi\u00f3n de Docker Compose\n\nservices:\n  apache:\n    image: debian:latest  # Usamos la imagen oficial de Debian\n    container_name: apache2  # Nombre del contenedor\n    build:\n      context: .  # Utilizamos el Dockerfile en el directorio actual para construir la imagen\n    volumes:\n      - ./html:/var/www/html  # Montamos la carpeta local 'html' al directorio /var/www/html dentro del contenedor\n    ports:\n      - \"8080:80\"  # Mapeamos el puerto 8080 del host al puerto 80 del contenedor\n    command: bash -c \"apt update &amp;&amp; apt install -y apache2 &amp;&amp; apache2ctl -D FOREGROUND\"  # Instalamos Apache2 y lo arrancamos\n</code></pre>"},{"location":"Ud2/Ch2_RRLL/#comandos-principales","title":"Comandos principales","text":"<p>Iniciar los servicios del <code>docker-compose</code>:</p> <pre><code>    docker-compose up\n</code></pre> <p>Iniciar los servicios en segundo plano:</p> <pre><code>    docker-compose up\n</code></pre> <p>Detener y eliminar los servicios del <code>docker-compose</code>:</p> <pre><code>    docker-compose down\n</code></pre> <p>Para construir los servicios del <code>docker-compose</code>:</p> <pre><code>    docker-compose build\n</code></pre> <p>Para mostrar los contenedores gestionados por <code>docker-compose</code>:</p> <pre><code>    docker-compose ps\n</code></pre> <p>Para descargar los im\u00e1genes de los servicios definidos en el <code>docker-compose</code>:</p> <pre><code>    docker-compose pull\n</code></pre>"},{"location":"Ud2/Ch2_RSN/","title":"CHEATSHEET COMANDOS DOCKER","text":""},{"location":"Ud2/Ch2_RSN/#instalacion","title":"Instalaci\u00f3n","text":"<ul> <li>sudo docker version -&gt; Se utiliza para comprobar la versi\u00f3n de docker y verificar su instalaci\u00f3n.</li> <li>sudo usermod -aG $USER -&gt; Permite utilizar docker sin la necesidad de sudo.</li> <li>sudo apt install docker-compose -&gt; Instala la versi\u00f3n compose de docker.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#principales-acciones-de-docker","title":"Principales acciones de Docker","text":""},{"location":"Ud2/Ch2_RSN/#docker-run","title":"Docker run","text":"<ul> <li>docker run -it --name=cont1 ubuntu /bin/bash -&gt; Crea un contenedor con la imagen Ubuntu, le establece el nombre cont1 y lo lanza en modo terminal.</li> <li>docker run -d -p 1200:80 nginx -&gt; Crea una imagen de nginx y lo lanza aen \"background\", exponiendo el puerto 80 del contenedor en el puerto 1200 del anfitri\u00f3n.</li> <li>docker run -it -e MENSAJE=HOLA ubuntu:14.04 bash -&gt; Crea la imagen Ubuntu con la versi\u00f3n 14.04 y establece la variable de entorno como \"MENSAJE\".</li> </ul>"},{"location":"Ud2/Ch2_RSN/#docker-ps","title":"Docker ps","text":"<ul> <li>docker ps -&gt; Muestra la informaci\u00f3n de los contenedores en ejecuci\u00f3n.</li> <li>docker ps -a -&gt; Muestra la informaci\u00f3n de todos los contenedores, los parados y en ejecuci\u00f3n.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#docker-startstoprestart","title":"Docker Start/Stop/Restart","text":"<ul> <li>docker start \"id\" -&gt; Arranca el contenedor</li> <li>docker start -ai \"id\" -&gt; Arranca el contenedor, ejecutando el arranque a la entrada y salida est\u00e1ndar de la terminal.</li> <li>docker stop \"id\" -&gt; Se utiliza para detener un contenedor en ejecuci\u00f3n.</li> <li>docker restart \"id\" -&gt; Reinicia el contenedor que se encuentra en ejecuci\u00f3n.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#docker-exec","title":"Docker exec","text":"<ul> <li>docker exec -it -e FICHERO=prueba cont bash -&gt; Lanza en el contenedor \u201ccont\u201d (que debe estar arrancado) el comando \u201cbash\u201d, estableciendo la variable de entorno  \u201cFICHERO\u201d y enlazando la ejecuci\u00f3n de forma interactiva a la entrada y salida est\u00e1ndar del anfitri\u00f3n.</li> <li>docker exec -d cont touch /tmp/prueba -&gt; Lanza en el contenedor \u201ccont\u201d (que debe estar arrancado) el comando \u201ctouch /tmp/prueba\u201d. Este comando se ejecuta en segundo plano, generando el fichero \u201c/tmp/prueba\u201d.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#docker-attach","title":"Docker attach","text":"<ul> <li>docker attach idcontainer -&gt; Enlaza nuestra terminal la entrada/salida de nuestra al proceso en segundo plano del contenedor \u201cidcontainer\u201d.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#docker-logs","title":"Docker logs","text":"<ul> <li>docker logs -n 10 idcontainer -&gt; Muestra las 10 \u00faltimas l\u00edneas de la salida estandar producida por el proceso en ejecuci\u00f3n en el contendor.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#docker-cp","title":"Docker cp","text":"<ul> <li>docker cp idcontainer:/tmp/prueba ./ -&gt; Copia el fichero \u201c/tmp/prueba\u201d del contenedor \u201cidcontainer\u201d al directorio actual del anfitri\u00f3n.</li> <li>docker cp ./miFichero idcontainer:/tmp -&gt; Copia el fichero \u201cmiFichero\u201d del directorio actual del anfitri\u00f3n a la carpeta \u201c/tmp\u201d del contenedor.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#imagenes-docker","title":"Im\u00e1genes Docker","text":""},{"location":"Ud2/Ch2_RSN/#gestion-de-imagenes","title":"Gesti\u00f3n de im\u00e1genes","text":"<ul> <li>docker images -&gt; Informaci\u00f3n de las im\u00e1genes locales disponibles</li> <li>docker search ubuntu -&gt; Busca la imagen \u201cubuntu\u201d en el repositorio remoto (por defecto Docker Hub).Busca la imagen \u201cubuntu\u201d en el repositorio remoto  (por defecto Docker Hub).</li> <li>docker pull alpine -&gt; Descarga localmente imagen \u201calpine\u201d.</li> <li>docker history alpine -&gt; Muestra la historia de creaci\u00f3n de la imagen \u201calpine\u201d.</li> <li>docker rmi ubuntu:14.04 -&gt; Elimina localmente la imagen \u201cubuntu\u201d con tag \u201c14.04\u201d.</li> <li>docker rmi $(docker images -q) -&gt; Borra toda imagen local que no est\u00e9 siendo usada por un contenedor.</li> <li>docker rm IDCONTENEDO -&gt;  Borra un contenedor con IDCONTENEDOR.</li> <li>docker stop $(docker ps -a -q) -&gt; Para todos los contenedores del sistema.</li> <li>docker rm $docker ps -a -q) -&gt; Borra todos los contenedores parados del sistema.</li> <li>docker system prune -a -&gt; Borra todas las im\u00e1genes y contenedores parados del sistema.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#creacion-de-imagenes-a-partir-de-contenedores","title":"Creaci\u00f3n de im\u00e1genes a partir de contenedores","text":"<ul> <li>docker commit -m \u201ccomentario\u201d IDCONTENEDOR usuario/imagen:version -&gt; Hace commit de un contenedor existente a una imagen local.</li> <li>docker save -o copiaSeguridad.tar imagenA -&gt; Guarda una copia de seguridad de una imagen en fichero \u201c.tar\u201d.</li> <li>docker load -i copiaSeguridad.tar -&gt; Restaura una copia de seguridad de una imagen en fichero \u201c.tar\u201d.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#docker-hub","title":"Docker hub","text":"<ul> <li>docker login -&gt; Permite introducir credenciales del registro (por defecto \u201cDocker Hub\u201d).</li> <li>docker push usuario/imagen:version -&gt; Permite subir al repositorio una imagen mediante \u201cpush\u201d.</li> </ul>"},{"location":"Ud2/Ch2_RSN/#volumenes-docker","title":"Vol\u00famenes Docker","text":"<ul> <li>docker volume create wordpress-db -&gt; Crea el volumen wordpress-db</li> <li>docker volume ls -&gt; Lista todos los vol\u00famenes</li> <li>docker volume inspect wordpress-db -&gt; Visualiza el vol\u00famen especificado</li> <li>docker volume rm wordpress-db -&gt; Borra todo le vol\u00famen</li> </ul>"},{"location":"Ud2/Ch2_RSN/#docker-compose","title":"Docker Compose","text":"<ul> <li>docker-compose up -d -&gt; Arranca la aplicaci\u00f3n compose</li> <li>docker-compose stop -&gt; Detiene los servicios</li> <li>docker-compose down -&gt; Se borra el servicio</li> <li>docker-compose down -v -&gt; Se borra el servicio y el vol\u00famen</li> <li>docker-compose build/pull -&gt; Construye/descarga las im\u00e1genes de contenedores seg\u00fan la configuraci\u00f3n de \u201cdocker-compose.yml\u201d.</li> <li>docker-compose ps -&gt; Muestra informaci\u00f3n de los contenedores seg\u00fan la configuraci\u00f3n de \u201cdocker-compose.yml\u201d.</li> <li>docker-compose up -d --scale web=3 -&gt; Similar a \u201cdocker-compose up -d\u201d solo que adem\u00e1s, el servicio definido como \u201cweb\u201d en el fichero \u201cdocker-compose.yml\u201d lo escala creando 3 copias y realizando balanceo autom\u00e1tico si se realiza una petici\u00f3n al host llamado como el servicio \u201cweb\u201d.</li> </ul>"},{"location":"Ud2/Ch2_VATC/","title":"\ud83c\udf1f UD2 - Cheatsheet","text":"<p>\u270d\ufe0f Victor Alexandru Teleanu Covaci</p>"},{"location":"Ud2/Ch2_VATC/#instalacion-y-configuracion-de-docker","title":"\ud83d\ude80 Instalaci\u00f3n y Configuraci\u00f3n de Docker","text":""},{"location":"Ud2/Ch2_VATC/#instalacion-en-diferentes-sistemas-operativos","title":"\ud83d\udd27 Instalaci\u00f3n en diferentes sistemas operativos","text":"\ud83d\udcbb Sistema Operativo / \ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n \ud83d\udc27 Linux (Debian/Ubuntu) <code>sudo apt-get update &amp;&amp; sudo apt-get upgrade</code> Actualizar paquetes antes de instalar Docker <code>sudo apt install docker-ce</code> Instalar Docker Community Edition en Debian/Ubuntu \ud83e\ude9f Windows \ud83d\udd17 Instrucciones para Windows Instalaci\u00f3n de Docker Desktop para Windows \ud83c\udf4f MacOS \ud83d\udd17 Instrucciones para MacOS Instalaci\u00f3n de Docker Desktop para MacOS"},{"location":"Ud2/Ch2_VATC/#comprobacion-de-instalacion-y-prueba","title":"\ud83d\udd0d Comprobaci\u00f3n de instalaci\u00f3n y prueba","text":"<ul> <li>Con <code>sudo docker version</code> podemos verificar la instalaci\u00f3n.</li> <li>Para probar, ejecutamos <code>sudo docker run hello-world</code>. Esto ejecutar\u00e1 un contenedor a partir de la imagen \"hello-world\".</li> </ul>"},{"location":"Ud2/Ch2_VATC/#configuracion-basica-de-docker","title":"\u2699\ufe0f Configuraci\u00f3n B\u00e1sica de Docker","text":""},{"location":"Ud2/Ch2_VATC/#configurar-usuario-sin-sudo","title":"\ud83e\uddd1\u200d\ud83d\udcbb Configurar usuario sin sudo","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>sudo usermod -aG docker $USER</code> A\u00f1ade el usuario al grupo \"docker\""},{"location":"Ud2/Ch2_VATC/#configuracion-de-docker-compose","title":"\ud83e\udde9 Configuraci\u00f3n de Docker Compose","text":"<ul> <li>Con <code>sudo apt install docker-compose</code> instalamos Docker Compose en Debian/Ubuntu.</li> <li>Con <code>docker-compose --version</code> verificamos la versi\u00f3n instalada.</li> </ul>"},{"location":"Ud2/Ch2_VATC/#comandos-basicos-de-docker","title":"\ud83d\udcda Comandos B\u00e1sicos de Docker","text":""},{"location":"Ud2/Ch2_VATC/#creacion-y-gestion-de-contenedores","title":"\ud83d\ude80 Creaci\u00f3n y gesti\u00f3n de contenedores","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker run</code> Crea y arranca un contenedor <code>docker run -it --name=mi_contenedor ubuntu /bin/bash</code> Crear y acceder a un contenedor con Ubuntu <code>docker exec -it mi_contenedor bash</code> Ejecutar un comando en un contenedor en ejecuci\u00f3n <code>docker stop mi_contenedor</code> Detiene un contenedor <code>docker start mi_contenedor</code> Inicia un contenedor detenido <code>docker restart mi_contenedor</code> Reinicia un contenedor <code>docker rm mi_contenedor</code> Elimina un contenedor detenido"},{"location":"Ud2/Ch2_VATC/#gestion-de-imagenes","title":"\ud83d\udcc2 Gesti\u00f3n de Im\u00e1genes","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker images</code> Muestra todas las im\u00e1genes disponibles <code>docker rmi nombre_imagen</code> Elimina una imagen de Docker <code>docker pull nombre_imagen</code> Descarga una imagen del repositorio de Docker <code>docker build -t nombre_imagen .</code> Crea una imagen a partir de un Dockerfile <code>docker tag imagen nombre:etiqueta</code> Etiqueta una imagen para identificarla m\u00e1s f\u00e1cil ### \ud83d\udcd1 Informaci\u00f3n \ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker ps</code> Muestra los contenedores en ejecuci\u00f3n <code>docker ps -a</code> Muestra todos los contenedores, en ejecuci\u00f3n o no <code>docker inspect nombre</code> Detalla la configuraci\u00f3n del contenedor <code>docker logs nombre_contenedor</code> Muestra los logs de un contenedor en ejecuci\u00f3n"},{"location":"Ud2/Ch2_VATC/#gestion-de-volumenes","title":"\ud83d\udce6 Gesti\u00f3n de Vol\u00famenes","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker volume create nombre_volumen</code> Crea un volumen <code>docker volume ls</code> Lista todos los vol\u00famenes existentes <code>docker volume rm nombre_volumen</code> Elimina un volumen si no est\u00e1 en uso <code>docker volume inspect nombre_volumen</code> Muestra informaci\u00f3n detallada sobre un volumen <code>docker volume prune</code> Elimina todos los vol\u00famenes no utilizados"},{"location":"Ud2/Ch2_VATC/#redes-en-docker","title":"\ud83c\udf10 Redes en Docker","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker network create nombre_red</code> Crea una red personalizada <code>docker network ls</code> Lista todas las redes <code>docker network inspect nombre_red</code> Muestra detalles de la red especificada <code>docker network connect nombre_red contenedor</code> Conecta un contenedor a una red <code>docker network disconnect nombre_red contenedor</code> Desconecta un contenedor de una red"},{"location":"Ud2/Ch2_VATC/#docker-compose","title":"\ud83e\uddd1\u200d\ud83d\udcbb Docker Compose","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker-compose up -d</code> Arranca la aplicaci\u00f3n con Docker Compose <code>docker-compose down</code> Borra servicios <code>docker-compose ps</code> Muestra informaci\u00f3n de los contenedores <code>docker-compose logs -f</code> Muestra los registros <code>docker-compose stop</code> Detiene el servicio <code>docker-compose start</code> Inicia el servicio <code>docker-compose restart</code> Reinicia los servicios <p>Estos comandos dependen de los servicios que est\u00e9n definidos en \"docker-compose.yaml\"</p>"},{"location":"Ud2/Ch2_VATC/#mantenimiento-y-limpieza","title":"\ud83d\udee0\ufe0f Mantenimiento y Limpieza","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker system prune</code> Borra contenedores, im\u00e1genes y redes sin uso <code>docker volume rm $(docker volume ls -q -f \"dangling=true\")</code> Elimina vol\u00famenes no asociados a ning\u00fan contenedor <code>docker rm $(docker ps -q -f \"status=exited\")</code> Borra contenedores que han finalizado su ejecuci\u00f3n <code>docker rmi $(docker images -q -f \"dangling=true\")</code> Borra im\u00e1genes no etiquetadas y sin uso"},{"location":"Ud2/Ch2_VATC/#copias-de-seguridad","title":"\ud83d\udcc2 Copias de Seguridad","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>docker run --rm -v /tmp:/backup --volumes-from contenedor busybox tar -cvf /backup/backup.tar /data</code> Realiza un backup de los datos de un contenedor <code>docker run --rm -v /tmp:/backup --volumes-from contenedor busybox tar -xvf /backup/backup.tar /data</code> Restaura un backup de los datos al contenedor"},{"location":"Ud3/Ch3_ABM/","title":"\ud83c\udf10 Cheatsheet de Servidores Web: Apache y Nginx","text":""},{"location":"Ud3/Ch3_ABM/#instalacion-y-configuracion-basica","title":"\ud83d\ude80 Instalaci\u00f3n y Configuraci\u00f3n B\u00e1sica","text":""},{"location":"Ud3/Ch3_ABM/#apache","title":"Apache","text":"<p>\ud83d\udee0\ufe0f Instalar <pre><code>sudo apt update\nsudo apt install apache2\n</code></pre></p> <p>\ud83d\udd27 Habilitar y Verificar Servicio <pre><code>sudo systemctl enable apache2\nsudo systemctl start apache2\nsudo systemctl status apache2\n</code></pre></p>"},{"location":"Ud3/Ch3_ABM/#nginx","title":"Nginx","text":"<p>\ud83d\udee0\ufe0f Instalar <pre><code>sudo apt update\nsudo apt install nginx\n</code></pre></p> <p>\ud83d\udd27 Habilitar y Verificar Servicio <pre><code>sudo systemctl enable nginx\nsudo systemctl start nginx\nsudo systemctl status nginx\n</code></pre></p>"},{"location":"Ud3/Ch3_ABM/#creacion-de-sitios-virtuales","title":"\ud83c\udfd7\ufe0f Creaci\u00f3n de Sitios Virtuales","text":""},{"location":"Ud3/Ch3_ABM/#apache_1","title":"Apache","text":"<ol> <li> <p>\ud83d\udcc4 Crear archivo de configuraci\u00f3n: <pre><code>sudo nano /etc/apache2/sites-available/mi_sitio.conf\n</code></pre>    \u270d\ufe0f Contenido del archivo: <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName mi-sitio.com\n    DocumentRoot /var/www/mi_sitio\n&lt;/VirtualHost&gt;\n</code></pre></p> </li> <li> <p>\u2705 Activar y Reiniciar: <pre><code>sudo a2ensite mi_sitio.conf\nsudo systemctl reload apache2\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ABM/#nginx_1","title":"Nginx","text":"<ol> <li> <p>\ud83d\udcc4 Crear archivo de configuraci\u00f3n: <pre><code>sudo nano /etc/nginx/sites-available/mi_sitio\n</code></pre>    \u270d\ufe0f Contenido del archivo: <pre><code>server {\n    listen 80;\n    server_name mi-sitio.com;\n    root /var/www/mi_sitio;\n    index index.html;\n}\n</code></pre></p> </li> <li> <p>\u2705 Activar y Reiniciar: <pre><code>sudo ln -s /etc/nginx/sites-available/mi_sitio /etc/nginx/sites-enabled/\nsudo systemctl reload nginx\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ABM/#autenticacion-basica","title":"\ud83d\udd10 Autenticaci\u00f3n B\u00e1sica","text":""},{"location":"Ud3/Ch3_ABM/#apache_2","title":"Apache","text":"<ol> <li> <p>\ud83d\udce6 Instalar herramientas: <pre><code>sudo apt install apache2-utils\n</code></pre></p> </li> <li> <p>\ud83d\udd11 Crear archivo de contrase\u00f1as: <pre><code>sudo htpasswd -c /etc/apache2/.htpasswd usuario\n</code></pre></p> </li> <li> <p>\u2699\ufe0f Configurar autenticaci\u00f3n: <pre><code>&lt;Directory /var/www/mi_sitio&gt;\n    AuthType Basic\n    AuthName \"Acceso restringido\"\n    AuthUserFile /etc/apache2/.htpasswd\n    Require valid-user\n&lt;/Directory&gt;\n</code></pre></p> </li> <li> <p>\u2705 Reiniciar servicio: <pre><code>sudo systemctl reload apache2\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ABM/#nginx_2","title":"Nginx","text":"<ol> <li> <p>\ud83d\udd11 Crear archivo de contrase\u00f1as: <pre><code>sudo apt install apache2-utils\nsudo htpasswd -c /etc/nginx/.htpasswd usuario\n</code></pre></p> </li> <li> <p>\u2699\ufe0f Configurar autenticaci\u00f3n: <pre><code>location / {\n    auth_basic \"Acceso restringido\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n}\n</code></pre></p> </li> <li> <p>\u2705 Reiniciar servicio: <pre><code>sudo systemctl reload nginx\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ABM/#habilitar-https","title":"\ud83d\udd12 Habilitar HTTPS","text":""},{"location":"Ud3/Ch3_ABM/#apache_3","title":"Apache","text":"<ol> <li> <p>\u26a1 Activar m\u00f3dulo SSL: <pre><code>sudo a2enmod ssl\n</code></pre></p> </li> <li> <p>\ud83d\udcdc Crear certificado autofirmado: <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/ssl/private/mi_sitio.key -out /etc/ssl/certs/mi_sitio.crt\n</code></pre></p> </li> <li> <p>\u2699\ufe0f Configurar Virtual Host con HTTPS: <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName mi-sitio.com\n    DocumentRoot /var/www/mi_sitio\n    SSLEngine on\n    SSLCertificateFile /etc/ssl/certs/mi_sitio.crt\n    SSLCertificateKeyFile /etc/ssl/private/mi_sitio.key\n&lt;/VirtualHost&gt;\n</code></pre></p> </li> <li> <p>\u2705 Reiniciar servicio: <pre><code>sudo systemctl reload apache2\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ABM/#nginx_3","title":"Nginx","text":"<ol> <li> <p>\ud83d\udcdc Crear certificado autofirmado: <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/nginx/mi_sitio.key -out /etc/nginx/mi_sitio.crt\n</code></pre></p> </li> <li> <p>\u2699\ufe0f Configurar servidor HTTPS: <pre><code>server {\n    listen 443 ssl;\n    server_name mi-sitio.com;\n    ssl_certificate /etc/nginx/mi_sitio.crt;\n    ssl_certificate_key /etc/nginx/mi_sitio.key;\n    root /var/www/mi_sitio;\n    index index.html;\n}\n</code></pre></p> </li> <li> <p>\u2705 Reiniciar servicio: <pre><code>sudo systemctl reload nginx\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ABM/#pila-lamp","title":"\ud83d\udda5\ufe0f Pila LAMP","text":"<ol> <li> <p>\ud83d\udee0\ufe0f Instalar paquetes esenciales: <pre><code>sudo apt update\nsudo apt install apache2 mysql-server php libapache2-mod-php php-mysql\n</code></pre></p> </li> <li> <p>\u2705 Verificar versiones: <pre><code>apache2 -v\nmysql --version\nphp -v\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ABM/#pila-lamp-con-docker","title":"\ud83d\udc33 Pila LAMP con Docker","text":"<ol> <li> <p>\ud83d\udcc4 Crear archivo <code>docker-compose.yml</code>: <pre><code>version: '3.8'\nservices:\n  web:\n    image: php:apache\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./mi_sitio:/var/www/html\n  db:\n    image: mysql:latest\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: mi_base\n      MYSQL_USER: user\n      MYSQL_PASSWORD: userpass\n</code></pre></p> </li> <li> <p>\u25b6\ufe0f Iniciar contenedores: <pre><code>docker-compose up -d\n</code></pre></p> </li> <li> <p>\ud83c\udf10 Acceso al sitio web:    Visita: http://localhost:8080</p> </li> </ol>"},{"location":"Ud3/Ch3_ACF/","title":"\ud83c\udf10 Nginx y Apache Cheatsheet","text":""},{"location":"Ud3/Ch3_ACF/#1-comandos-de-instalacion-y-comprobacion-de-estado","title":"1. \ud83d\udee0\ufe0f Comandos de instalaci\u00f3n y comprobaci\u00f3n de estado","text":"Comando Explicaci\u00f3n <code>apt-install nginx</code> \ud83d\udda5\ufe0f Comando para instalar Nginx <code>apt-install apache2</code> \ud83d\udda5\ufe0f Comando para instalar Apache <code>system status nginx</code> \ud83d\udea6 Comprobar el estado de nginx <code>sudo systemctl restart nginx</code> \ud83d\udd04 Reiniciar el servicio de nginx"},{"location":"Ud3/Ch3_ACF/#2-sitios-virtuales","title":"2. \ud83d\ude80 Sitios virtuales","text":"Comando Explicaci\u00f3n <code>sudo chown -R www-data:www-data /var/www/html</code> \ud83d\udd27 Cambiar el propietario del directorio <code>sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/</code> \ud83c\udf00 Creaci\u00f3n de archivo simb\u00f3lico <code>google-chrome --host-resolver-rules=\"MAP midominio.com 123.45.67.89, MAP otrodominio.com 98.76.54.32\" --ignore-certificate-errors</code> \ud83c\udf0d Si no tienes permisos en tu m\u00e1quina host puedes lanzar chrome pas\u00e1ndole las DNS <p>\ud83d\udcdd Ejemplo de archivo de configuraci\u00f3n del bloque server en nginx: <pre><code>server {\n    listen 80;\n    server_name example.com;\n    root /var/www/example;\n    location / {\n        index index.html;\n    }\n    error_log /var/log/nginx/error.log;\n    access_log /var/log/nginx/access.log;\n}\n</code></pre> \ud83d\udcdd Ejemplo de archivo de configuraci\u00f3n en Apache2 <pre><code>&lt;VirtualHost *:80&gt;\n        ServerName sitiovirtual\n        DocumentRoot /var/www/sitiovirtual\n        &lt;Directory /var/www/sitiovirtual&gt;\n                AllowOverride All\n                Require all granted\n        &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre></p>"},{"location":"Ud3/Ch3_ACF/#3-autenticacion","title":"3. \ud83d\udd12 Autenticaci\u00f3n","text":"Comando Explicaci\u00f3n <code>sudo apt install apache2-utils</code> \ud83d\udee0\ufe0f Instala utilidades para poder usar htpasswd para crear contrase\u00f1as <code>sudo htpasswd -c /etc/nginx/.htpasswd profe</code> \ud83d\udd11 Creaci\u00f3n de archivo oculto y incluye el primer usuario y contrase\u00f1a para profe <p>\ud83d\udcdd Ejemplo de archivo de configuraci\u00f3n con autenticaci\u00f3n en nginx: <pre><code>server {\n        listen 80;\n        listen [::]:80;\n        root /var/www/sitio1;\n        index index.html index.htm index.nginx-debian.html;\n        server_name sitio1;\n        location / {\n            auth_basic  \"\u00c1rea restringida\";\n            auth_basic_user_file    /etc/nginx/.htpasswd;\n            try_files $uri $uri/ =404;\n        }\n}\n</code></pre> \ud83d\udcdd Ejemplo de archivo de configuraci\u00f3n con autenticaci\u00f3n en apache2: <pre><code>&lt;VirtualHost *:80&gt;\n        ServerName sitio1\n        DocumentRoot /var/www/sitio1\n        &lt;Directory /var/www/sitio1&gt;\n                AllowOverride All\n                Require all granted\n        &lt;/Directory&gt;\n        &lt;Directory /var/www/sitio1/intranet&gt;\n                AuthType Basic\n                AuthName \"Intranet\"\n                AuthBasicProvider file\n                AuthUserFile /etc/apache2/.htpasswd\n                Require valid-user\n        &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre></p>"},{"location":"Ud3/Ch3_ACF/#4-activacion-https","title":"4. \ud83d\udcc2 Activaci\u00f3n HTTPS","text":"Comando Explicaci\u00f3n <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt</code> \ud83d\udd10 Crear certificado y claves <p>\ud83d\udcdd Ejemplo de configuraci\u00f3n SSL en nginx: <pre><code>  listen 443 ssl;\n  ssl_certificate /etc/nginx/ssl/server.crt;\n  ssl_certificate_key     /etc/nginx/ssl/server.key;\n  ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384';\n  ssl_protocols TLSv1.2 TLSv1.3;\n  access_log /var/log/nginx/https_access.log;\n</code></pre> \ud83d\udcdd Ejemplo de redirecci\u00f3n forzosa en nginx: <pre><code>server {\n        listen 80;\n        server_name sitio1;\n        access_log /var/log/nginx/http_access.log;\n        return 301 https://sitio1$request_uri;\n}\n</code></pre> \ud83d\udcdd Ejemplo de configuraci\u00f3n SSL en apache2: <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName sitio1\n    DocumentRoot /var/www/sitio1\n\n    #Activa SSL\n    SSLEngine on\n    # Especifica la ruta a tu certificado SSL y clave privada\n    SSLCertificateFile /etc/apache2/ssl/server.crt\n    SSLCertificateKeyFile /etc/apache2/ssl/server.key\n\n    &lt;Directory /var/www/sitio1&gt;\n            AllowOverride All\n            Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> \ud83d\udcdd Ejemplo de redirecci\u00f3n forzosa en apache2: <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitio1\n    Redirect permanent / https://sitio1/\n&lt;/VirtualHost&gt;\n</code></pre></p>"},{"location":"Ud3/Ch3_ACF/#5-instalacion-pila-lamp","title":"5.\u2699\ufe0f Instalaci\u00f3n pila LAMP","text":"Comando Explicaci\u00f3n <code>sudo apt install mariadb-server</code> \ud83d\udee2\ufe0f Instalaci\u00f3n de MariaDB <code>sudo mysql_secure_installation</code> \ud83d\udd12 Configuraci\u00f3n de MariaDB <code>sudo apt-get install php libapache2-mod-php php-mysql</code> \ud83d\udcbb Instalaci\u00f3n de Php <code>sudo apt-get install phpmyadmin</code> \ud83d\udcca Instalaci\u00f3n de phpMyAdmin"},{"location":"Ud3/Ch3_AEM/","title":"1. Instalaci\u00f3n de Nginx en EC2 Debian AWS ### Instalar Nginx","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\n\nsudo apt install nginx\n\n``` ### **Comprobar Nginx**\n\n```bash\n\nsystemctl status nginx\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#modificar-pagina-de-bienvenida","title":"Modificar p\u00e1gina de bienvenida","text":"<ol> <li>Edita el archivo de muestra:</li> </ol> <pre><code>sudo nano /var/www/html/index.nginx-debian.html\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#2-instalacion-de-apache-en-ec2-debian-aws","title":"2. Instalaci\u00f3n de Apache en EC2 Debian AWS","text":""},{"location":"Ud3/Ch3_AEM/#crear-ec2","title":"Crear EC2","text":"<ul> <li> <p>Nombre: <code>servidorApache</code></p> </li> <li> <p>Usa el mismo Grupo de seguridad: <code>ServidorWeb</code>.</p> </li> </ul>"},{"location":"Ud3/Ch3_AEM/#instalar-apache","title":"Instalar Apache","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\n\nsudo apt install apache2\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#verificar-funcionamiento","title":"Verificar funcionamiento","text":"<ol> <li>Comprueba el servicio:</li> </ol> <pre><code>systemctl status apache2\n</code></pre> <ol> <li>Modifica la p\u00e1gina por defecto en su directorio correspondiente.</li> </ol>"},{"location":"Ud3/Ch3_AEM/#3-nginx-en-docker","title":"3. Nginx en Docker","text":""},{"location":"Ud3/Ch3_AEM/#dockerfile-para-nginx","title":"Dockerfile para Nginx","text":"<pre><code>FROM debian:latest\n\nMAINTAINER Alex Musat &lt;musateduardalexandru@gmail.com&gt;\n\nRUN apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install -y nginx &amp;&amp; \\\n\nrm -rf /var/lib/apt/lists/*\n\nEXPOSE 80 CMD [\"nginx\", \"-g\", \"daemon off;\"] ```\n\n### **Comandos Docker** 1. **Construir la imagen:** ```bash docker build -t servernginx . ``` 2. **Crear y ejecutar el contenedor:**\n\n```bash\n\ndocker run --name=miservernginx -d -p 80:80 servernginx\n</code></pre> <ol> <li>Detener y eliminar contenedor:</li> </ol> <pre><code>docker stop miservernginx\n\ndocker rm miservernginx\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#montar-volumen-persistente","title":"Montar volumen persistente","text":"<ol> <li>Crea un directorio local:</li> </ol> <pre><code>mkdir -p ~/web\n</code></pre> <ol> <li> <p>Agrega un archivo <code>index.html</code> en <code>~/web</code> con el contenido que desees.</p> </li> <li> <p>Ejecuta el contenedor con volumen:</p> </li> </ol> <pre><code>docker run -d --name=miservernginx \\\n\n--mount type=bind,source=/home/tu_usuario/web,target=/var/www/html \\\n\n-p 80:80 \\\n\nservernginx\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#4-nginx-usando-la-imagen-oficial-de-docker","title":"4. Nginx usando la imagen oficial de Docker","text":"<ol> <li>Usa la imagen oficial:</li> </ol> <pre><code>docker run -d --name=miservernginx2 \\\n\n-v /home/tu_usuario/web:/usr/share/nginx/html:ro \\\n\n-p 80:80 \\\n\nnginx:latest\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#5-dockerizar-apache","title":"5. Dockerizar Apache","text":"<ol> <li>Dockerfile para Apache:</li> </ol> <pre><code>FROM debian:latest\n\nRUN apt update &amp;&amp; apt install -y apache2\n\nCMD [\"apache2ctl\", \"-D\", \"FOREGROUND\"]\n\nEXPOSE 80\n</code></pre> <ol> <li>Construir y ejecutar contenedor:</li> </ol> <pre><code>docker build -t serverapache .\n\ndocker run -d --name=miserverapache -p 80:80 serverapache\n</code></pre> <ol> <li>Montar directorio local:</li> </ol> <pre><code>docker run -d --name=miserverapache \\\n\n--mount type=bind,source=/home/tu_usuario/web,target=/var/www/html \\\n\n-p 80:80 \\\n\nserverapache\n</code></pre> <ol> <li>Usar la imagen oficial de Apache:</li> </ol> <pre><code>docker run -d --name=miserverapache2 \\\n\n-v /home/tu_usuario/web:/usr/local/apache2/htdocs:ro \\\n\n-p 80:80 \\\n\nhttpd:latest\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#configuracion-de-nginx","title":"Configuraci\u00f3n de Nginx","text":""},{"location":"Ud3/Ch3_AEM/#1-cambiar-propietario-y-permisos","title":"1. Cambiar propietario y permisos","text":"<pre><code>sudo chown -R www-data:www-data /var/www/html\n\nsudo chmod 644 /var/www/html/index.html\n\nsudo chmod 755 /var/www/html\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#2-crear-un-sitio-virtual","title":"2. Crear un sitio virtual","text":"<ol> <li>Crear usuario y grupo:</li> </ol> <pre><code>sudo useradd -m usuario1\n\nsudo usermod -g www-data usuario1\n\nsudo passwd usuario1\n</code></pre> <ol> <li>Crear espacio para el sitio:</li> </ol> <pre><code>sudo mkdir -p /var/www/sitio1\n\nsudo chown usuario1:www-data /var/www/sitio1\n\nsudo chmod 755 /var/www/sitio1\n</code></pre> <ol> <li>Crear contenido de la p\u00e1gina:</li> </ol> <pre><code>su usuario1\n\nnano /var/www/sitio1/index.html\n</code></pre> <ol> <li>Archivo de configuraci\u00f3n de Nginx:</li> </ol> <pre><code>sudo nano /etc/nginx/sites-available/sitio1\n</code></pre> <p>Contenido del archivo:</p> <pre><code>server {\n\nlisten 80;\n\nroot /var/www/sitio1;\n\nindex index.html;\n\nserver_name sitio1;\n\nlocation / {\n\ntry_files $uri $uri/ =404;\n\n}\n\n}\n</code></pre> <ol> <li>Crear enlace simb\u00f3lico y reiniciar:</li> </ol> <pre><code>sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/\n\nsudo systemctl restart nginx\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#3-probar-el-sitio","title":"3. Probar el sitio","text":"<ul> <li>Editar <code>/etc/hosts</code> (Linux) o <code>C:\\Windows\\System32\\drivers\\etc\\hosts</code> (Windows):</li> </ul> <pre><code>IP_PUBLICA_SERVIDOR sitio1\n</code></pre> <ul> <li>Acceder a <code>http://sitio1</code> desde el navegador.</li> </ul>"},{"location":"Ud3/Ch3_AEM/#configuracion-de-apache2","title":"Configuraci\u00f3n de Apache2","text":""},{"location":"Ud3/Ch3_AEM/#1-crear-un-sitio-virtual","title":"1. Crear un sitio virtual","text":"<ol> <li>Crear archivo de configuraci\u00f3n:</li> </ol> <pre><code>sudo nano /etc/apache2/sites-available/sitio1.conf\n</code></pre> <p>Contenido del archivo:</p> <pre><code>&lt;VirtualHost *:80&gt;\n\nServerName sitio1\n\nDocumentRoot /var/www/sitio1\n\n&lt;Directory /var/www/sitio1&gt;\n\nAllowOverride All\n\nRequire all granted\n\n&lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre> <ol> <li>Habilitar el sitio:</li> </ol> <pre><code>sudo a2ensite sitio1\n\nsudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#configuracion-en-docker","title":"Configuraci\u00f3n en Docker","text":""},{"location":"Ud3/Ch3_AEM/#1-estructura-de-directorios","title":"1. Estructura de directorios","text":"<pre><code>~\n\n\u251c\u2500\u2500 sitiosvirtuales/\n\n\u2502 \u251c\u2500\u2500 html/index.html\n\n\u2502 \u2514\u2500\u2500 sitio1/index.html\n\n\u2514\u2500\u2500 nginxvirtual/\n\n\u251c\u2500\u2500 Dockerfile\n\n\u251c\u2500\u2500 docker-compose.yaml\n\n\u251c\u2500\u2500 entrypoint.sh\n\n\u2514\u2500\u2500 sites-available/\n\n\u251c\u2500\u2500 default\n\n\u2514\u2500\u2500 sitio1\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#2-archivos-necesarios","title":"2. Archivos necesarios","text":"<ul> <li>Dockerfile:</li> </ul> <pre><code>FROM debian:latest\n\nRUN apt update &amp;&amp; apt install -y nginx\n\nCOPY entrypoint.sh /entrypoint.sh\n\nRUN chmod +x /entrypoint.sh\n\nEXPOSE 80\n\nENTRYPOINT [\"/entrypoint.sh\"]\n</code></pre> <ul> <li>docker-compose.yaml:</li> </ul> <pre><code>services:\n\nnginx:\n\nbuild: .\n\nvolumes:\n\n- ../sitiosvirtuales:/var/www\n\n- ./sites-available:/etc/nginx/sites-available\n\nports:\n\n- 80:80\n</code></pre> <ul> <li>entrypoint. sh:</li> </ul> <pre><code>#!/bin/bash\n\nrm -f /etc/nginx/sites-enabled/*\n\nfor file in /etc/nginx/sites-available/*; do\n\nln -s \"$file\" /etc/nginx/sites-enabled/ || true\n\ndone\n\nnginx -g \"daemon off;\"\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#3-levantar-el-servicio","title":"3. Levantar el servicio","text":"<pre><code>docker-compose up -d\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#4-probar-y-detener","title":"4. Probar y detener","text":"<ul> <li>Detener el servicio:</li> </ul> <pre><code>docker-compose down\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#autenticacion-en-nginx","title":"Autenticaci\u00f3n en Nginx","text":""},{"location":"Ud3/Ch3_AEM/#1-preparacion-del-entorno","title":"1. Preparaci\u00f3n del entorno","text":"<ol> <li> <p>Requisitos previos:</p> </li> <li> <p>Completa y verifica la pr\u00e1ctica de sitios virtuales en Nginx.</p> </li> <li> <p>Crea la estructura:</p> </li> </ol> <pre><code>su usuario1\n\nmkdir /var/www/sitio1/intranet\n\ncp /var/www/sitio1/index.html /var/www/sitio1/intranet\n\nnano /var/www/sitio1/intranet/index.html\n</code></pre> <ol> <li> <p>Aseg\u00farate de poder acceder:</p> </li> <li> <p>Modifica <code>/etc/hosts</code> o usa:</p> </li> </ol> <pre><code>google-chrome --host-resolver-rules=\"MAP sitio1 IPSERVER\" --ignore-certificate-error\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#2-creacion-del-archivo-de-contrasenas","title":"2. Creaci\u00f3n del archivo de contrase\u00f1as","text":"<ol> <li>Instalar herramienta <code>htpasswd</code>:</li> </ol> <pre><code>sudo apt install apache2-utils\n</code></pre> <ol> <li>Crear archivo <code>.htpasswd</code>:</li> </ol> <pre><code>sudo htpasswd -c /etc/nginx/.htpasswd profe\n</code></pre> <ul> <li> <p>Introduce \"profe\" como contrase\u00f1a.</p> </li> <li> <p>A\u00f1adir m\u00e1s usuarios:</p> </li> </ul> <pre><code>sudo htpasswd /etc/nginx/.htpasswd &lt;usuario&gt;\n</code></pre> <ul> <li> <p>Crea usuarios con tu nombre y apellido.</p> </li> <li> <p>Verifica:</p> </li> </ul> <pre><code>cat /etc/nginx/.htpasswd\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#3-configuracion-de-autenticacion-basica","title":"3. Configuraci\u00f3n de autenticaci\u00f3n b\u00e1sica","text":"<ol> <li>Editar configuraci\u00f3n de <code>sitio1</code>:</li> </ol> <pre><code>sudo nano /etc/nginx/sites-available/sitio1\n</code></pre> <ul> <li>A\u00f1adir en el bloque <code>location /</code>:</li> </ul> <pre><code>auth_basic \"\u00c1rea restringida\";\n\nauth_basic_user_file /etc/nginx/.htpasswd;\n</code></pre> <ol> <li>Reiniciar Nginx:</li> </ol> <pre><code>sudo systemctl restart nginx\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#4-autenticacion-parcial","title":"4. Autenticaci\u00f3n parcial","text":"<ol> <li> <p>Aplica autenticaci\u00f3n solo a <code>/intranet</code>:</p> </li> <li> <p>Modifica el archivo de configuraci\u00f3n:</p> </li> </ol> <pre><code>location /intranet {\n\nauth_basic \"\u00c1rea restringida\";\n\nauth_basic_user_file /etc/nginx/.htpasswd;\n\n}\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#5-restriccion-por-ip","title":"5. Restricci\u00f3n por IP","text":"<ol> <li>Bloquear acceso a IP espec\u00edfica:</li> </ol> <pre><code>location /intranet {\n\nallow 192.168.1.1/24;\n\ndeny 192.168.1.2;\n\ndeny all;\n\nauth_basic \"\u00c1rea restringida\";\n\nauth_basic_user_file /etc/nginx/.htpasswd;\n\n}\n</code></pre> <ol> <li> <p>Combinar restricciones con <code>satisfy</code>:</p> </li> <li> <p>Requiere autenticaci\u00f3n y IP v\u00e1lida:</p> </li> </ol> <pre><code>satisfy all;\n</code></pre> <ul> <li>Requiere autenticaci\u00f3n o IP v\u00e1lida:</li> </ul> <pre><code>satisfy any;\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#6-verificacion","title":"6. Verificaci\u00f3n","text":"<ul> <li>Realiza pruebas en ventanas privadas y revisa logs:</li> </ul> <pre><code>tail -n 10 /var/log/nginx/access.log\n\ntail -n 10 /var/log/nginx/error.log\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#autenticacion-en-apache2","title":"Autenticaci\u00f3n en Apache2","text":""},{"location":"Ud3/Ch3_AEM/#1-creacion-del-archivo-de-contrasenas","title":"1. Creaci\u00f3n del archivo de contrase\u00f1as","text":"<ol> <li>Crear archivo <code>.htpasswd</code>:</li> </ol> <pre><code>sudo htpasswd -c /etc/apache2/.htpasswd profe\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#2-configuracion-de-autenticacion-basica","title":"2. Configuraci\u00f3n de autenticaci\u00f3n b\u00e1sica","text":"<ol> <li>Editar configuraci\u00f3n del sitio:</li> </ol> <pre><code>sudo nano /etc/apache2/sites-available/sitio1.conf\n</code></pre> <ul> <li>A\u00f1ade el bloque:</li> </ul> <pre><code>&lt;Directory /var/www/sitio1/intranet&gt;\n\nAuthType Basic\n\nAuthName \"Intranet\"\n\nAuthBasicProvider file\n\nAuthUserFile /etc/apache2/.htpasswd\n\nRequire valid-user\n\n&lt;/Directory&gt;\n</code></pre> <ol> <li>Reiniciar Apache:</li> </ol> <pre><code>sudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#3-activacion-de-modulos-en-apache2","title":"3. Activaci\u00f3n de m\u00f3dulos en Apache2","text":"<ol> <li>Verificar m\u00f3dulos disponibles y activados:</li> </ol> <pre><code>ls -la /etc/apache2/mods-available/\n\nls -la /etc/apache2/mods-enabled/\n</code></pre> <ol> <li>Activar m\u00f3dulos requeridos:</li> </ol> <pre><code>a2enmod auth_basic\n\na2enmod authn_file\n\na2enmod authz_user\n\nsudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#1-configuracion-https-en-nginx","title":"1. Configuraci\u00f3n HTTPS en Nginx","text":""},{"location":"Ud3/Ch3_AEM/#a-creacion-de-certificado-autofirmado","title":"A. Creaci\u00f3n de Certificado Autofirmado","text":"<ol> <li>Crear directorio para certificados:</li> </ol> <pre><code>sudo mkdir /etc/nginx/ssl\n</code></pre> <ol> <li>Generar certificado autofirmado:</li> </ol> <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt\n</code></pre> <ol> <li>Verifica la creaci\u00f3n:</li> </ol> <pre><code>ls -l /etc/nginx/ssl\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#b-configuracion-de-https-en-el-sitio-virtual","title":"B. Configuraci\u00f3n de HTTPS en el sitio virtual","text":"<ol> <li>Editar el archivo de configuraci\u00f3n:</li> </ol> <pre><code>sudo nano /etc/nginx/sites-available/sitio1\n</code></pre> <ol> <li>Modificar el bloque <code>server</code>:</li> </ol> <pre><code>server {\n\nlisten 443 ssl;\n\nssl_certificate /etc/nginx/ssl/server.crt;\n\nssl_certificate_key /etc/nginx/ssl/server.key;\n\nssl_protocols TLSv1.2 TLSv1.3;\n\nssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384';\n\naccess_log /var/log/nginx/https_access.log;\n\n}\n</code></pre> <ol> <li>Reiniciar Nginx:</li> </ol> <pre><code>sudo systemctl restart nginx\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#c-redireccion-forzada-de-http-a-https","title":"C. Redirecci\u00f3n Forzada de HTTP a HTTPS","text":"<ol> <li>A\u00f1adir un nuevo bloque <code>server</code>:</li> </ol> <pre><code>server {\n\nlisten 80;\n\nserver_name sitio1;\n\naccess_log /var/log/nginx/http_access.log;\n\nreturn 301 https://sitio1$request_uri;\n\n}\n</code></pre> <ol> <li> <p>Eliminar cualquier referencia a <code>listen 80</code> del bloque <code>server</code> principal.</p> </li> <li> <p>Reiniciar Nginx:</p> </li> </ol> <pre><code>sudo systemctl restart nginx\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#d-comprobaciones","title":"D. Comprobaciones","text":"<ol> <li>Accede a:</li> </ol> <pre><code>https://sitio1\n</code></pre> <p>A\u00f1ade una excepci\u00f3n al navegador si aparece una advertencia de certificado.</p> <ol> <li>Verifica la redirecci\u00f3n:</li> </ol> <pre><code>http://sitio1\n</code></pre> <p>Deber\u00edas ser redirigido autom\u00e1ticamente a HTTPS.</p> <ol> <li> <p>Logs:</p> </li> <li> <p><code>http_access.log</code>: Peticiones redirigidas.</p> </li> <li> <p><code>https_access.log</code>: Peticiones HTTPS exitosas.</p> </li> </ol>"},{"location":"Ud3/Ch3_AEM/#2-configuracion-https-en-apache2","title":"2. Configuraci\u00f3n HTTPS en Apache2","text":""},{"location":"Ud3/Ch3_AEM/#a-activar-modulo-ssl","title":"A. Activar m\u00f3dulo SSL","text":"<ol> <li>Comprobar si est\u00e1 activo:</li> </ol> <pre><code>ls -la /etc/apache2/mods-enabled/ssl*\n</code></pre> <ol> <li>Activar si no lo est\u00e1:</li> </ol> <pre><code>sudo a2enmod ssl\n\nsudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#b-generar-certificado-autofirmado","title":"B. Generar Certificado Autofirmado","text":"<ol> <li>Crear directorio para certificados:</li> </ol> <pre><code>sudo mkdir /etc/apache2/ssl\n</code></pre> <ol> <li>Generar certificado:</li> </ol> <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/apache2/ssl/server.key -out /etc/apache2/ssl/server.crt\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#c-configuracion-https-en-el-sitio-virtual","title":"C. Configuraci\u00f3n HTTPS en el sitio virtual","text":"<ol> <li>Editar el archivo del sitio virtual:</li> </ol> <pre><code>sudo nano /etc/apache2/sites-available/sitio1.conf\n</code></pre> <ol> <li>A\u00f1adir el bloque:</li> </ol> <pre><code>&lt;VirtualHost *:443&gt;\n\nServerName sitio1\n\nDocumentRoot /var/www/sitio1\n\nSSLEngine on\n\nSSLCertificateFile /etc/apache2/ssl/server.crt\n\nSSLCertificateKeyFile /etc/apache2/ssl/server.key\n\n&lt;Directory /var/www/sitio1&gt;\n\nAllowOverride All\n\nRequire all granted\n\n&lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre> <ol> <li>Reiniciar Apache:</li> </ol> <pre><code>sudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_AEM/#d-redireccion-forzada-de-http-a-https","title":"D. Redirecci\u00f3n Forzada de HTTP a HTTPS","text":"<ol> <li>A\u00f1adir bloque adicional: <code>&lt;VirtualHost *:80&gt; ServerName sitio1 Redirect permanent / https://sitio1/ &lt;/VirtualHost&gt;</code> 2. Reiniciar Apache: <code>bash sudo systemctl restart apache2</code> ---</li> </ol>"},{"location":"Ud3/Ch3_AEM/#e-comprobaciones","title":"E. Comprobaciones","text":"<ol> <li> <p>Accede a: <code>https://sitio1</code> A\u00f1ade una excepci\u00f3n al navegador si es necesario. --- ### Errores Comunes</p> </li> <li> <p>Error: <code>ERR_SSL_PROTOCOL_ERROR</code> en Nginx</p> </li> <li> <p>Verifica que el bloque <code>server</code> para HTTPS incluye: <code>nginx listen 443 ssl; ssl_certificate /etc/nginx/ssl/server.crt; ssl_certificate_key /etc/nginx/ssl/server.key;</code> - Confirma que los certificados existen y son accesibles:</p> </li> </ol> <p><code>bash ls -l /etc/nginx/ssl</code></p> <ol> <li>Apache responde en HTTP por defecto - Aseg\u00farate de que el sitio virtual HTTPS est\u00e1 habilitado: <code>bash sudo a2ensite sitio1 sudo systemctl restart apache2</code> --- ## Cheat Sheet: Instalaci\u00f3n de la Pila LAMP en Debian</li> </ol>"},{"location":"Ud3/Ch3_AEM/#instalacion-de-apache","title":"Instalaci\u00f3n de Apache","text":"<ol> <li>Instalar Apache:</li> </ol> <p><code>bash sudo apt install apache2</code></p> <ol> <li>Verificar que Apache est\u00e1 funcionando:</li> </ol> <p><code>bash sudo systemctl status apache2</code></p> <ol> <li>Si no est\u00e1 activo, habilitar y arrancar:</li> </ol> <p><code>bash sudo systemctl enable apache2 sudo systemctl start apache2</code></p> <ol> <li> <p>Probar Apache:</p> </li> <li> <p>Abre un navegador y accede a <code>http://IP_P\u00fablica</code>. ---</p> </li> </ol>"},{"location":"Ud3/Ch3_AEM/#instalacion-de-mariadb-gestor-de-bases-de-datos","title":"Instalaci\u00f3n de MariaDB (Gestor de Bases de Datos)","text":"<ol> <li>Instalar MariaDB:</li> </ol> <p><code>bash sudo apt install mariadb-server</code></p> <ol> <li>Verificar que MariaDB est\u00e1 funcionando:</li> </ol> <p><code>bash sudo systemctl status mysql</code></p> <ol> <li> <p>Configurar la instalaci\u00f3n de MariaDB: <code>bash sudo mysql_secure_installation</code> - Cambiar la contrase\u00f1a del root a <code>ieselcaminas</code>.</p> </li> <li> <p>Acceder a MariaDB:</p> </li> </ol> <p><code>bash mysql -u root -p</code></p> <ul> <li>Ingresar la contrase\u00f1a cuando se te pida.</li> </ul>"},{"location":"Ud3/Ch3_AEM/#instalacion-de-php","title":"Instalaci\u00f3n de PHP","text":"<ol> <li>Instalar PHP y los paquetes necesarios:</li> </ol> <p><code>bash sudo apt-get install php libapache2-mod-php php-mysql</code></p> <ol> <li>Reiniciar Apache para que reconozca PHP:</li> </ol> <p><code>bash sudo systemctl restart apache2</code></p> <ol> <li>Crear archivo de prueba PHP:</li> </ol> <p><code>bash sudo nano /var/www/html/info.php</code></p> <ul> <li>A\u00f1adir el siguiente c\u00f3digo:</li> </ul> <p><code>php &lt;?php phpinfo(); ?&gt;</code></p> <ol> <li> <p>Probar PHP:</p> </li> <li> <p>Acceder a <code>http://IP_P\u00fablica/info.php</code> desde tu navegador.</p> </li> </ol>"},{"location":"Ud3/Ch3_AEM/#instalacion-de-phpmyadmin-interfaz-grafica-de-base-de-datos","title":"Instalaci\u00f3n de phpMyAdmin (Interfaz Gr\u00e1fica de Base de Datos)","text":"<ol> <li>Instalar phpMyAdmin:</li> </ol> <pre><code>sudo apt-get install phpmyadmin\n</code></pre> <ol> <li> <p>Configurar phpMyAdmin:</p> </li> <li> <p>Seleccionar <code>apache2</code> como el servidor web.</p> </li> <li> <p>Configurar con <code>dbconfig-common</code> y usar la contrase\u00f1a <code>ieselcaminas</code> para root.</p> </li> <li> <p>Acceder a phpMyAdmin:</p> </li> <li> <p>Abrir el navegador y acceder a <code>http://IP_P\u00fablica/phpmyadmin</code>.</p> </li> <li> <p>Iniciar sesi\u00f3n con <code>root</code> y la contrase\u00f1a <code>ieselcaminas</code>.</p> </li> <li> <p>Si phpMyAdmin no es accesible, crear un enlace simb\u00f3lico:</p> </li> </ol> <pre><code>sudo ln -s /usr/share/phpmyadmin/ /var/www/html/phpmyadmin\n</code></pre>"},{"location":"Ud3/Ch3_ALS/","title":"\ud83c\udf10 Cheatsheet de Servidores Web: Apache y Nginx","text":"<p>Autor: Adrian Leonard Stan</p>"},{"location":"Ud3/Ch3_ALS/#instalacion-y-configuracion-basica","title":"\ud83d\ude80 Instalaci\u00f3n y Configuraci\u00f3n B\u00e1sica","text":""},{"location":"Ud3/Ch3_ALS/#apache","title":"Apache","text":"<p>\ud83d\udee0\ufe0f Instalar <pre><code>sudo apt update &amp;&amp; sudo apt upgrade\nsudo apt install apache2\n</code></pre></p> <p>\ud83d\udd27 Habilitar y Verificar Servicio <pre><code>sudo systemctl enable apache2\nsudo systemctl start apache2\nsudo systemctl status apache2\n</code></pre></p>"},{"location":"Ud3/Ch3_ALS/#nginx","title":"Nginx","text":"<p>\ud83d\udee0\ufe0f Instalar <pre><code>sudo apt update &amp;&amp; sudo apt upgrade\nsudo apt-get install nginx\n</code></pre></p> <p>\ud83d\udd27 Habilitar y Verificar Servicio <pre><code>sudo systemctl enable nginx\nsudo systemctl start nginx\nsudo systemctl status nginx\n</code></pre></p>"},{"location":"Ud3/Ch3_ALS/#creacion-de-sitios-virtuales","title":"\ud83c\udfd7\ufe0f Creaci\u00f3n de Sitios Virtuales","text":""},{"location":"Ud3/Ch3_ALS/#apache_1","title":"Apache","text":"<ol> <li> <p>\ud83d\udcc4 Crear archivo de configuraci\u00f3n: <pre><code>sudo nano /etc/apache2/sites-available/mi_sitio.conf\n</code></pre>    \u270d\ufe0f Contenido del archivo: <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName mi-sitio.com\n    DocumentRoot /var/www/mi_sitio\n    &lt;Directory /var/www/mi_sitio&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre></p> </li> <li> <p>\u2705 Activar y Reiniciar: <pre><code>sudo a2ensite mi_sitio.conf\nsudo systemctl reload apache2\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ALS/#nginx_1","title":"Nginx","text":"<ol> <li> <p>\ud83d\udcc4 Crear archivo de configuraci\u00f3n: <pre><code>sudo nano /etc/nginx/sites-available/mi_sitio\n</code></pre>    \u270d\ufe0f Contenido del archivo: <pre><code>server {\n    listen 80;\n    server_name mi-sitio.com;\n    root /var/www/mi_sitio;\n    index index.html;\n}\n</code></pre></p> </li> <li> <p>\u2705 Activar y Reiniciar: <pre><code>sudo ln -s /etc/nginx/sites-available/mi_sitio /etc/nginx/sites-enabled/\nsudo systemctl reload nginx\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ALS/#autenticacion-basica","title":"\ud83d\udd10 Autenticaci\u00f3n B\u00e1sica","text":""},{"location":"Ud3/Ch3_ALS/#apache_2","title":"Apache","text":"<ol> <li> <p>\ud83d\udce6 Instalar herramientas: <pre><code>sudo apt install apache2-utils\n</code></pre></p> </li> <li> <p>\ud83d\udd11 Crear archivo de contrase\u00f1as: <pre><code>sudo htpasswd -c /etc/apache2/.htpasswd usuario\n</code></pre></p> </li> <li> <p>\u2699\ufe0f Configurar autenticaci\u00f3n: <pre><code>&lt;Directory /var/www/mi_sitio&gt;\n    AuthType Basic\n    AuthName \"Acceso restringido\"\n    AuthUserFile /etc/apache2/.htpasswd\n    Require valid-user\n&lt;/Directory&gt;\n</code></pre></p> </li> <li> <p>\u2705 Reiniciar servicio: <pre><code>sudo systemctl reload apache2\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ALS/#nginx_2","title":"Nginx","text":"<ol> <li> <p>\ud83d\udd11 Crear archivo de contrase\u00f1as: <pre><code>sudo apt install apache2-utils\nsudo htpasswd -c /etc/nginx/.htpasswd usuario\n</code></pre></p> </li> <li> <p>\u2699\ufe0f Configurar autenticaci\u00f3n: <pre><code>location / {\n    auth_basic \"Acceso restringido\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n}\n</code></pre></p> </li> <li> <p>\u2705 Reiniciar servicio: <pre><code>sudo systemctl reload nginx\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ALS/#habilitar-https","title":"\ud83d\udd12 Habilitar HTTPS","text":""},{"location":"Ud3/Ch3_ALS/#apache_3","title":"Apache","text":"<ol> <li> <p>\u26a1 Activar m\u00f3dulo SSL: <pre><code>sudo a2enmod ssl\n</code></pre></p> </li> <li> <p>\ud83d\udcdc Crear certificado autofirmado: <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/mi_sitio.key -out /etc/ssl/certs/mi_sitio.crt\n</code></pre></p> </li> <li> <p>\u2699\ufe0f Configurar Virtual Host con HTTPS: <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName mi-sitio.com\n    DocumentRoot /var/www/mi_sitio\n    SSLEngine on\n    SSLCertificateFile /etc/ssl/certs/mi_sitio.crt\n    SSLCertificateKeyFile /etc/ssl/private/mi_sitio.key\n&lt;/VirtualHost&gt;\n</code></pre></p> </li> <li> <p>\u2705 Reiniciar servicio: <pre><code>sudo systemctl reload apache2\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ALS/#nginx_3","title":"Nginx","text":"<ol> <li> <p>\ud83d\udcdc Crear certificado autofirmado: <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/mi_sitio.key -out /etc/nginx/mi_sitio.crt\n</code></pre></p> </li> <li> <p>\u2699\ufe0f Configurar servidor HTTPS: <pre><code>server {\n    listen 443 ssl;\n    server_name mi-sitio.com;\n    ssl_certificate /etc/nginx/mi_sitio.crt;\n    ssl_certificate_key /etc/nginx/mi_sitio.key;\n    root /var/www/mi_sitio;\n    index index.html;\n}\n</code></pre></p> </li> <li> <p>\u2705 Reiniciar servicio: <pre><code>sudo systemctl reload nginx\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_ALS/#pila-lamp-con-docker","title":"\ud83d\udc33 Pila LAMP con Docker","text":"<ol> <li> <p>\ud83d\udcc4 Crear archivo <code>docker-compose.yml</code>: <pre><code>version: '3.8'\nservices:\n  web:\n    image: php:apache\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./mi_sitio:/var/www/html\n  db:\n    image: mysql:latest\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpass\n      MYSQL_DATABASE: db\n      MYSQL_USER: user\n      MYSQL_PASSWORD: userpass\n</code></pre></p> </li> <li> <p>\u25b6\ufe0f Iniciar contenedores: <pre><code>docker-compose up -d\n</code></pre></p> </li> <li> <p>\ud83c\udf10 Acceso al sitio web: http://localhost:8080</p> </li> </ol>"},{"location":"Ud3/Ch3_ALS/#recursos-utiles","title":"\ud83d\udcc4 Recursos \u00datiles","text":"<ul> <li>\ud83d\udcdd Logs:  </li> <li>Apache: <code>/var/log/apache2</code></li> <li>Nginx: <code>/var/log/nginx</code></li> <li>\ud83d\udcc2 Directorios principales:  </li> <li>Apache: <code>/etc/apache2/sites-available</code></li> <li>Nginx: <code>/etc/nginx/sites-available</code></li> </ul>"},{"location":"Ud3/Ch3_BSO/","title":"Cheatshet 3 - Servidores Web y de Aplicaciones","text":""},{"location":"Ud3/Ch3_BSO/#indice","title":"\u00cdndice","text":"<ul> <li>Apache2</li> <li>Instalaci\u00f3n de Apache</li> <li>Habilitar Apache como predeterminado al iniciar la m\u00e1quina</li> <li>Directorios esenciales de Apache</li> <li>Crear web de ejemplo y asignarle permisos</li> <li>Configuraci\u00f3n del sitio web</li> <li>Autenticaci\u00f3n</li> <li>Habilitar HTTPS</li> <li>Nginx</li> <li>Instalaci\u00f3n de Nginx</li> <li>Habilitar Nginx como predeterminado al iniciar la m\u00e1quina</li> <li>Directorios esenciales de Nginx</li> <li>Crear web de ejemplo y asignarle permisos</li> <li>Configuraci\u00f3n del sitio web</li> <li>Autenticaci\u00f3n b\u00e1sica</li> <li>Autenticaci\u00f3n por IP</li> <li>Habilitar HTTPS</li> <li>Pila LAMP</li> <li>Instalaci\u00f3n de Pila LAMP</li> <li>Instalaci\u00f3n de Apache, PHP y MariaDB</li> <li>Configuraci\u00f3n de la base de datos MariaDB</li> <li>Verificaci\u00f3n de PHP</li> <li>Instalaci\u00f3n de phpMyAdmin</li> <li>Pila LAMP en Docker Compose</li> <li>Dockerfile para Nginx</li> <li>Archivo docker-compose.yml</li> </ul>"},{"location":"Ud3/Ch3_BSO/#apache2","title":"Apache2","text":""},{"location":"Ud3/Ch3_BSO/#instalacion-de-apache","title":"Instalaci\u00f3n de Apache","text":""},{"location":"Ud3/Ch3_BSO/#en-una-maquina-ubuntu-o-debian-como-las-que-usamos-en-aws","title":"En una m\u00e1quina Ubuntu o Debian (como las que usamos en AWS)","text":"<pre><code>sudo apt update #En AWS no necesitas sudo\nsudo apt install apache2\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#habilitar-apache-como-predeterminado-al-iniciar-la-maquina","title":"Habilitar Apache como predeterminado al iniciar la m\u00e1quina","text":"<pre><code>sudo systemctl start apache2 #Inicia el servicio\nsudo systemctl status apache2 #Comprueba el servicio\nsudo systemctl enable apache2 #Habilita el servicio al iniciar el PC\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#directorios-esenciales-de-apache","title":"Directorios esenciales de Apache","text":"<ul> <li><code>/etc/apache2</code> Directorio de configuraci\u00f3n de Apache2</li> <li><code>/var/log/apache2</code> Directorio donde se guardan los registros de Apache2</li> <li><code>/var/www/html</code> Directorio donde se alojan los contenidos de nuestra web</li> <li><code>/etc/apache2/sites-available</code> Configuraci\u00f3n de sitios web</li> <li><code>/etc/apache2/sites-enabled</code> Directorio donde se alojan las webs que tenemos habilitadas</li> </ul>"},{"location":"Ud3/Ch3_BSO/#crear-web-de-ejemplo-y-asignarle-permisos","title":"Crear web de ejemplo y asignarle permisos","text":"<pre><code>sudo mkdir /var/www/ejemplo #Esta ser\u00eda nuestra ruta principal de la web 'localhost/ejemplo'\nsudo touch /var/www/ejemplo/index.html #HTML que contiene el indice de esta web\n\nsudo chown -R $USER:www-data /var/www/ejemplo #Asignamos el usuario y el grupo www-data de forma recursiva a la ruta principal\nsudo chmod 755 /var/www/ejemplo #Asignamos los permisos correctos en este caso 7(rwx) y 5(rx)\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#configuracion-del-sitio-web","title":"Configuraci\u00f3n del sitio web","text":"<pre><code>sudo nano /etc/apache2/sites-available/ejemplo.conf #Creamos el archivo de configuraci\u00f3n de la web ejemplo\n</code></pre> <p>Archivo de configuraci\u00f3n</p> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName ejemplo.com\n    ServerAlias www.ejemplo.com\n    DocumentRoot /var/www/ejemplo\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n</code></pre> <p>Activar el sitio web</p> <pre><code>sudo a2ensite ejemplo.conf\nsudo systemctl reload apache2\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#autentificacion","title":"Autentificaci\u00f3n","text":"<pre><code>sudo apt install apache2-utils #Instalaci\u00f3n de programas necesarios\n</code></pre> <pre><code>htpasswd -c /etc/apache2/.htpasswd user #Creaci\u00f3n de usuario y contrase\u00f1a\n</code></pre> <pre><code>sudo mkdir /var/www/ejemplo/areaprivada #Creamos una carpeta donde alojaremos el sitio restringido\n</code></pre> <pre><code>&lt;Directory /var/www/ejemplo/areaprivada&gt;\n    AuthType Basic\n    AuthName \"\u00c1rea Privada\"\n    AuthBasicProvider file\n    AuthUserFile /etc/apache2/.htpasswd\n    Require valid-user\n&lt;/Directory&gt;\n</code></pre> <pre><code>sudo systemctl reload apache2 #Reiniciamos apache\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#habilitar-https","title":"Habilitar HTTPS","text":"<pre><code>sudo apt install openssl #Instalamos openSSL\nsudo a2enmod ssl #Habilitamos el SSL\n</code></pre> <pre><code>#Crear certificado\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/ssl/private/ejemplo.key -out /etc/ssl/certs/ejemplo.crt\n</code></pre> <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName ejemplo.com\n    DocumentRoot /var/www/ejemplo\n    SSLEngine on\n    SSLCertificateFile /etc/ssl/certs/ejemplo.crt\n    SSLCertificateKeyFile /etc/ssl/private/ejemplo.key\n&lt;/VirtualHost&gt;\n</code></pre> <pre><code>sudo systemctl reload apache2 #Volveremos a reiniciar apache\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#nginx","title":"Nginx","text":""},{"location":"Ud3/Ch3_BSO/#instalacion-de-nginx","title":"Instalaci\u00f3n de Nginx","text":""},{"location":"Ud3/Ch3_BSO/#en-una-maquina-ubuntu-o-debian-como-las-que-usamos-en-aws_1","title":"En una m\u00e1quina Ubuntu o Debian (como las que usamos en AWS)","text":"<pre><code>sudo apt update #En AWS no necesitas sudo\nsudo apt install nginx\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#habilitar-nginx-como-predeterminado-al-iniciar-la-maquina","title":"Habilitar Nginx como predeterminado al iniciar la m\u00e1quina","text":"<pre><code>sudo systemctl start nginx #Inicia el servicio\nsudo systemctl status nginx #Comprueba el servicio\nsudo systemctl enable nginx #Habilita el servicio al iniciar el PC\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#directorios-esenciales-de-nginx","title":"Directorios esenciales de Nginx","text":"<ul> <li><code>/etc/nginx</code> Directorio de configuraci\u00f3n de Nginx</li> <li><code>/var/log/nginx</code> Directorio donde se guardan los registros de Nginx</li> <li><code>/var/www/html</code> Directorio donde se alojan los contenidos de nuestra web</li> <li><code>/etc/nginx/sites-available</code> Configuraci\u00f3n de sitios web</li> <li><code>/etc/nginx/sites-enabled</code> Directorio donde se alojan las webs que tenemos habilitadas</li> </ul>"},{"location":"Ud3/Ch3_BSO/#crear-web-de-ejemplo-y-asignarle-permisos_1","title":"Crear web de ejemplo y asignarle permisos","text":"<pre><code>sudo mkdir /var/www/ejemplo #Esta ser\u00eda nuestra ruta principal de la web 'localhost/ejemplo'\nsudo touch /var/www/ejemplo/index.html #HTML que contiene el indice de esta web\n\nsudo chown -R $USER:www-data /var/www/ejemplo #Asignamos el usuario y el grupo www-data de forma recursiva a la ruta principal\nsudo chmod 755 /var/www/ejemplo #Asignamos los permisos correctos en este caso 7(rwx) y 5(rx)\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#configuracion-del-sitio-web_1","title":"Configuraci\u00f3n del sitio web","text":"<pre><code>sudo nano /etc/nginx/sites-available/ejemplo.conf #Creamos el archivo de configuraci\u00f3n de la web ejemplo\n</code></pre> <p>Archivo de configuraci\u00f3n</p> <pre><code>server {\n        listen 80;\n        listen [::]:80;\n        root /var/www/ejemplo;\n        index index.html index.htm index.nginx-debian.html;\n        server_name ejemplo.com;\n        location / {\n            try_files $uri $uri/ =404;\n        }\n    }\n</code></pre> <p>Activar el sitio web</p> <pre><code>sudo ln -s /etc/nginx/sites-available/ejemplo /etc/nginx/sites-enabled/\nsudo systemctl reload nginx\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#autentificacion_1","title":"Autentificaci\u00f3n","text":"<pre><code>sudo apt install apache2-utils #Instalaci\u00f3n de programas necesarios\n</code></pre> <pre><code>htpasswd -c /etc/nginx/.htpasswd user #Creaci\u00f3n de usuario y contrase\u00f1a\n</code></pre> <pre><code>sudo mkdir /var/www/ejemplo/areaprivada #Creamos una carpeta donde alojaremos el sitio restringido\n</code></pre> <pre><code>server{\n    #Configuraci\u00f3n anterior\n    location /areaprivada/ {\n        auth_basic \"Restricted\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        root /var/www/ejemplo;\n    }\n}\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#autentificacion-por-ip","title":"Autentificaci\u00f3n por IP","text":"<pre><code>server{\n    #Configuraci\u00f3n anterior\n    location /areaprivada/ {\n\n        satisfy all; #Todas las reglas deben cumplirse(any -&gt; Cualquiera de ellas)\n        deny  172.1.10.6; #Bloquea el acceso a esta IP\n        allow 172.1.10.15; #Permite el acceso a estas 2 IPs\n        allow 172.1.3.14;\n        deny  all; #Bloquea las dem\u00e1s IP's que no se hayan permitido, si se pone m\u00e1s arriba, se ignorar\u00e1 lo de abajo.\n\n        auth_basic \"Restricted\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        root /var/www/ejemplo;\n    }\n}\n</code></pre> <p>El orden de <code>allow</code> y <code>deny</code> es muy importante en Nginx, ya que se eval\u00faan en el mismo orden en que aparecen.</p> <pre><code>sudo systemctl reload nginx #Reiniciamos Nginx\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#habilitar-https_1","title":"Habilitar HTTPS","text":"<pre><code>sudo apt install openssl #Instalamos openSSL\n</code></pre> <pre><code>#Crear certificado\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/ejemplo.key -out /etc/nginx/ssl/ejemplo.crt\n</code></pre> <pre><code>server {\n    listen 443 ssl;\n    server_name ejemplo.com;\n    ssl_certificate /etc/nginx/ssl/ejemplo.crt;\n    ssl_certificate_key /etc/nginx/ssl/ejemplo.key;\n    root /var/www/ejemplo;\n    index index.html;\n}\n</code></pre> <pre><code>sudo systemctl reload nginx #Volveremos a reiniciar nginx\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#pila-lamp","title":"Pila LAMP","text":""},{"location":"Ud3/Ch3_BSO/#instalacion","title":"Instalaci\u00f3n","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade\nsudo apt install apache2 php libapache2-mod-php php-mysql mariadb-server\nsudo systemctl restart apache2 #Reiniciamos Apache para aplique los cambios\nsudo systemctl status mysql #Comprobamos el status de mariadb\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#configuracion-de-la-base-de-datos-mariadb","title":"Configuraci\u00f3n de la base de datos MariaDB","text":"<pre><code>sudo mysql_secure_installation #Configuraremos mariadb\n</code></pre>"},{"location":"Ud3/Ch3_BSO/#configuracion-de-php","title":"Configuraci\u00f3n de PHP","text":"<p>Comprobaremos que php se ejecuta correctamente con este peque\u00f1o archivo</p> <pre><code>sudo nano /var/www/html/info.php\n</code></pre> <pre><code>&lt;?php\nphpinfo();\n?&gt;\n</code></pre> <p>Deberiamos ver la informaci\u00f3n de php al dirigirnos aqu\u00ed</p> <p><code>http://IPservidorDebian/info.php</code></p>"},{"location":"Ud3/Ch3_BSO/#instalacion-de-phpmyadmin","title":"Instalaci\u00f3n de phpMyAdmin","text":"<pre><code>sudo apt-get install phpmyadmin #Nos ejecutar\u00e1 un instalador y elegimos apache2\n</code></pre> <p>Deberiamos poder entrar a nuestro phpMyAdmin desde aqu\u00ed</p> <p><code>http://IPservidorDebian/phpmyadmin</code></p>"},{"location":"Ud3/Ch3_BSO/#pila-lamp-en-docker-compose","title":"Pila LAMP en docker-compose","text":"<p>Dockerfile nginx</p> <pre><code>FROM nginx:latest #Descarga la im\u00e1gen de nginx\nCOPY ./default.conf /etc/nginx/conf.d/default.conf #Copia los archivos de configuraci\u00f3n\nCOPY ./index.php /var/www/html/index.php #Copia el archivo de conexi\u00f3n a la base de datos de PHP\n</code></pre> <p>docker-compose.yml</p> <pre><code>services:\n    nginx:\n        build: ./nginx/ #Construimos el Dockerfile\n        container_name: nginx-container\n        ports:\n        - 80:80 #Especificamos puertos del host y del docker\n        volumes:\n        - app-data:/var/www/html/ #linkeamos el volumen app-data de abajo con /var/www/html -&gt; Que contiene nuestra web\n    php:\n        build: ./php/\n        container_name: php-container\n        expose:\n        - 9000\n        volumes:\n        - app-data:/var/www/html/\n    mysql:\n        image: mysql:5.7\n        container_name: mysql-container\n        volumes:\n        - mysql-data:/var/lib/mysql\n        environment:\n        MYSQL_ROOT_PASSWORD: secret\n        MYSQL_DATABASE: mydb\n        MYSQL_USER: myuser\n        MYSQL_PASSWORD: password\nvolumes:\n    app-data:\n    mysql-data:\n</code></pre> <ul> <li><code>docker-compose up -d</code> crea y ejecuta todos los contenedores de docker-compose en segundo plano</li> <li><code>docker-compose down</code> cierra todos los contenedores de docker-compose</li> <li><code>docker-compose ps</code> muestra todos los contenedores en ejecuci\u00f3n de docker-compose</li> </ul>"},{"location":"Ud3/Ch3_DGD/","title":"CONFIGURACION SERVIDORES WEB","text":""},{"location":"Ud3/Ch3_DGD/#nginx","title":"NGINX","text":""},{"location":"Ud3/Ch3_DGD/#instalacion-de-nginx","title":"\ud83d\udcdd Instalaci\u00f3n de Nginx","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade\nsudo apt-get install nginx\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#directorios-de-configuracion","title":"\ud83d\udcc1 Directorios de configuraci\u00f3n","text":"Directorio Descripci\u00f3n /etc/nginx Configuraci\u00f3n de Nginx /etc/nginx/sites-available Configuraci\u00f3n de sitios web /etc/nginx/sites-enabled Sitios web habilitados /var/www/html Contenido de los sitios web /var/log/nginx Registros de Nginx"},{"location":"Ud3/Ch3_DGD/#crear-el-directorio-de-la-web-y-el-indexhtml","title":"\ud83d\udcaa Crear el directorio de la web y el index.html","text":"<pre><code>sudo mkdir /var/www/sitio1\nsudo touch /var/www/sitio1/index.html\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-de-permisos","title":"\u2699\ufe0f Configuraci\u00f3n de permisos","text":"<pre><code>sudo chown -R www-data:www-data /var/www/sitio1\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#crear-el-archivo-de-configuracion","title":"\ud83d\udcaa Crear el archivo de configuraci\u00f3n","text":"<pre><code>cd /etc/nginx/sites-available\n</code></pre> <pre><code>sudo nano sitio1\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-del-sitio-web","title":"Configuraci\u00f3n del sitio web","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n    root /var/www/sitio1;\n    index index.html index.htm index.nginx-debian.html;\n    server_name sitio1;\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#habilitar-el-sitio-web","title":"Habilitar el sitio web","text":"<pre><code>cd /etc/nginx/sites-enabled\nsudo ln -s /etc/nginx/sites-available/sitio1 sitio1\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#reiniciar-nginx","title":"Reiniciar Nginx","text":"<pre><code>sudo systemctl restart nginx\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#autenticacion-de-usuarios-con-nginx","title":"\u2705 Autenticaci\u00f3n de usuarios con Nginx","text":"<pre><code>sudo apt install apache2-utils\n</code></pre> <pre><code>htpasswd -c /etc/nginx/.htpasswd usuario\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-de-autenticacion-en-nginx","title":"\ud83d\udca1 Configuraci\u00f3n de autenticaci\u00f3n en Nginx","text":"<pre><code>sudo mkdir /var/www/sitio1/secret\n</code></pre> <pre><code>server {\n    listen 80;\n    listen [::]:80;\n    root /var/www/sitio1;\n    index index.html index.htm index.nginx-debian.html;\n    server_name sitio1;\n    location / {\n        try_files $uri $uri/ =404;\n    }\n+   location /secret {\n+       auth_basic \"Restricted\";\n+       auth_basic_user_file /etc/nginx/.htpasswd;\n+       root /var/www/sitio1;\n+   }\n}\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#autenticacion-por-ip-con-nginx","title":"\u2705 Autenticaci\u00f3n por IP con Nginx","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n    root /var/www/sitio1;\n    index index.html index.htm index.nginx-debian.html;\n    server_name sitio1;\n    location / {\n        try_files $uri $uri/ =404;\n    }\n    location /secret {\n+       satisfy any;\n+       allow 192.168.1.0/24;\n+       deny all;\n        auth_basic \"Restricted\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        root /var/www/sitio1;\n    }\n}\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#activacion-de-https","title":"Activaci\u00f3n de https","text":""},{"location":"Ud3/Ch3_DGD/#creacion-del-certificado","title":"\ud83d\udca1 Creacion del certificado","text":"<pre><code>sudo mkdir /etc/nginx/ssl\n</code></pre> <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key -out /etc/nginx/ssl/nginx.crt\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-del-sitio-para-https","title":"Configuracion del sitio para https","text":"<pre><code>server {\n-    listen 80;\n-    listen [::]:80;\n+    listen 443 ssl;\n+    ssl_certificate /etc/nginx/ssl/nginx.crt;\n+    ssl_certificate_key /etc/nginx/ssl/nginx.key;\n+    ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384';\n+    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    root /var/www/sitio1;\n    index index.html index.htm index.nginx-debian.html;\n    server_name sitio1;\n    location / {\n        try_files $uri $uri/ =404;\n    }\n    location /secret {\n        satisfy any;\n        allow 192.168.1.0/24;\n        deny all;\n        auth_basic \"Restricted\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        root /var/www/sitio1;\n    }\n}\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#redireccion-de-https","title":"Redireccion de https","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n    server_name sitio1;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#apache2","title":"APACHE2","text":""},{"location":"Ud3/Ch3_DGD/#instalacion-de-apache2","title":"\ud83d\udcdd Instalaci\u00f3n de Apache2","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade\nsudo apt install apache2\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#directorios-de-configuracion_1","title":"\ud83d\udcc1 Directorios de configuraci\u00f3n","text":"Directorio Descripci\u00f3n /etc/apache2 Configuraci\u00f3n de Apache2 /etc/apache2/sites-available Configuraci\u00f3n de sitios web /etc/apache2/sites-enabled Sitios web habilitados /var/www/html Contenido de los sitios web /var/log/apache2 Registros de Apache2"},{"location":"Ud3/Ch3_DGD/#crear-el-directorio-de-la-web-y-el-indexhtml_1","title":"\ud83d\udcaa Crear el directorio de la web y el index.html","text":"<pre><code>sudo mkdir /var/www/sitio1\nsudo touch /var/www/sitio1/index.html\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-de-permisos_1","title":"\u2699\ufe0f Configuraci\u00f3n de permisos","text":"<pre><code>sudo chown -R www-data:www-data /var/www/sitio1\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#crear-el-archivo-de-configuracion_1","title":"\ud83d\udcaa Crear el archivo de configuraci\u00f3n","text":"<pre><code>cd /etc/apache2/sites-available\n</code></pre> <pre><code>sudo nano sitio1.conf\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-del-sitio-web_1","title":"Configuraci\u00f3n del sitio web","text":"<pre><code>&lt;VirtualHost *:80&gt;\n    DocumentRoot /var/www/sitio1\n    ServerName sitio1\n    &lt;Directory /var/www/sitio1&gt;\n        Options Indexes FollowSymLinks\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n    ErrorLog ${APACHE_LOG_DIR}/sitio1_error.log\n    CustomLog ${APACHE_LOG_DIR}/sitio1_access.log combined\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#habilitar-el-sitio-web_1","title":"Habilitar el sitio web","text":"<pre><code>sudo a2ensite sitio1.conf\nsudo systemctl reload apache2\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#autenticacion-de-usuarios-con-apache2","title":"\u2705 Autenticaci\u00f3n de usuarios con Apache2","text":"<pre><code>sudo apt install apache2-utils\n</code></pre> <pre><code>htpasswd -c /etc/apache2/.htpasswd usuario\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-de-autenticacion-en-apache2","title":"\ud83d\udca1 Configuraci\u00f3n de autenticaci\u00f3n en Apache2","text":"<pre><code>sudo mkdir /var/www/sitio1/secret\n</code></pre> <pre><code>&lt;Directory /var/www/sitio1/secret&gt;\n+   AuthType Basic\n+   AuthName \"Restricted Access\"\n+   AuthUserFile /etc/apache2/.htpasswd\n+   Require valid-user\n&lt;/Directory&gt;\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#reiniciar-apache2","title":"Reiniciar Apache2","text":"<pre><code>sudo systemctl reload apache2\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#autenticacion-por-ip-con-apache2","title":"\u2705 Autenticaci\u00f3n por IP con Apache2","text":"<pre><code>&lt;Directory /var/www/sitio1/secret&gt;\n    AuthType Basic\n    AuthName \"Restricted Access\"\n    AuthUserFile /etc/apache2/.htpasswd\n    Require valid-user\n+   Require ip 192.168.1.0/24\n+   Require all denied\n&lt;/Directory&gt;\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#activacion-de-https_1","title":"Activaci\u00f3n de HTTPS","text":""},{"location":"Ud3/Ch3_DGD/#creacion-del-certificado_1","title":"\ud83d\udca1 Creaci\u00f3n del certificado","text":"<pre><code>sudo mkdir /etc/apache2/ssl\n</code></pre> <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/apache2/ssl/apache.key -out /etc/apache2/ssl/apache.crt\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-del-sitio-para-https_1","title":"Configuraci\u00f3n del sitio para HTTPS","text":"<pre><code>&lt;VirtualHost *:443&gt;\n+   SSLEngine on\n+   SSLCertificateFile /etc/apache2/ssl/apache.crt\n+   SSLCertificateKeyFile /etc/apache2/ssl/apache.key\n    DocumentRoot /var/www/sitio1\n    ServerName sitio1\n    &lt;Directory /var/www/sitio1&gt;\n        Options Indexes FollowSymLinks\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n    ErrorLog ${APACHE_LOG_DIR}/sitio1_ssl_error.log\n    CustomLog ${APACHE_LOG_DIR}/sitio1_ssl_access.log combined\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#redireccion-de-http-a-https","title":"Redirecci\u00f3n de HTTP a HTTPS","text":"<pre><code>&lt;VirtualHost *:80&gt;\n+   Redirect \"/\" \"https://sitio1/\"\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#habilitar-modulos-necesarios-y-reiniciar-apache2","title":"Habilitar m\u00f3dulos necesarios y reiniciar Apache2","text":"<pre><code>sudo a2enmod ssl\nsudo a2enmod rewrite\nsudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#instalacion-pila-lamp","title":"Instalaci\u00f3n Pila LAMP","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade\n\nsudo apt install apache2 php libapache2-mod-php php-mysql\n\nsudo apt install mariadb-server\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#configuracion-de-mariadb","title":"Configuraci\u00f3n de MariaDB","text":"<pre><code>sudo mysql_secure_installation\n</code></pre>"},{"location":"Ud3/Ch3_DGD/#instalacion-de-phpmyadmin","title":"Instalaci\u00f3n de PHPMyAdmin","text":"<pre><code>sudo apt install phpmyadmin\n</code></pre>"},{"location":"Ud3/Ch3_DMP/","title":"\ud83d\udcdd UD3 - Servidores web - Cheatsheet","text":"<p>David Maratrat Pons</p>"},{"location":"Ud3/Ch3_DMP/#comandos-nginx","title":"\ud83e\uddd1\u200d\ud83d\udcbb Comandos Nginx","text":"Comando Descripci\u00f3n <code>systemctl start nginx</code> <code>Inicia el servidor web nginx</code> <code>systemctl stop nginx</code> <code>Detiene el servidor web nginx</code> <code>systemctl restart nginx</code> <code>Reinicia el servidor web nginx</code> <code>systemctl reload nginx</code> <code>Recarga la configuraci\u00f3n del servidor web nginx</code> <code>nginx -t</code> <code>Prueba la configuraci\u00f3n del servidor web nginx</code>"},{"location":"Ud3/Ch3_DMP/#sitios-virtuales-en-nginx","title":"\ud83c\udf10 Sitios Virtuales en Nginx","text":"<p>Los sitios virtuales en Nginx se configuran a trav\u00e9s de bloques server.  Cada bloque puede representar un sitio web independiente, configurando directivas como el puerto de escucha, el nombre del servidor (server_name) y la ruta del contenido (root). <pre><code>server {\n    listen 80;\n    server_name example.com;\n    root /var/www/example;\n\n    location / {\n        index index.html;\n    }\n\n    error_log /var/log/nginx/error.log;\n    access_log /var/log/nginx/access.log;\n}\n</code></pre></p>"},{"location":"Ud3/Ch3_DMP/#configuracion-ssl-en-nginx","title":"\ud83d\udd12 Configuraci\u00f3n SSL en Nginx","text":"<p>Para habilitar SSL en Nginx, debes asegurarte de que el servidor escuche en el puerto 443 y configurar las directivas ssl_certificate y ssl_certificate_key con la ruta de tus certificados.</p> <pre><code>server {\n    listen 443 ssl;\n    server_name example.com;\n\n    ssl_certificate /etc/ssl/certs/server.crt;\n    ssl_certificate_key /etc/ssl/private/server.key;\n\n    location / {\n        root /usr/share/nginx/html;\n        index index.html;\n    }\n}\n</code></pre>"},{"location":"Ud3/Ch3_DMP/#ejemplo-completo-de-nginxconf","title":"\ud83d\udcd1 Ejemplo completo de nginx.conf","text":"<pre><code>worker_processes auto;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    # Habilitar compatibilidad con HTTPS\n    server {\n        listen 80;\n        server_name example.com;\n        return 301 https://$host$request_uri; # Redirecci\u00f3n a HTTPS\n    }\n\n    server {\n        listen 443 ssl;\n        server_name example.com;\n\n        root /var/www/example_com;\n        index index.html;\n\n        ssl_certificate /etc/ssl/certs/example_com.crt;\n        ssl_certificate_key /etc/ssl/private/example_com.key;\n\n        error_log /var/log/nginx/example_com_error.log;\n        access_log /var/log/nginx/example_com_access.log;\n\n        location / {\n            index index.html;\n        }\n    }\n\n    server {\n        listen 80;\n        server_name example.org;\n        return 301 https://$host$request_uri; # Redirecci\u00f3n a HTTPS\n    }\n\n    server {\n        listen 443 ssl;\n        server_name example.org;\n\n        root /var/www/example_org;\n        index index.html;\n\n        ssl_certificate /etc/ssl/certs/example_org.crt;\n        ssl_certificate_key /etc/ssl/private/example_org.key;\n\n        error_log /var/log/nginx/example_org_error.log;\n        access_log /var/log/nginx/example_org_access.log;\n\n        location /app {\n            index index.html;\n        }\n    }\n}\n</code></pre>"},{"location":"Ud3/Ch3_DMP/#comandos-apache2","title":"\ud83e\uddd1\u200d\ud83d\udcbb Comandos Apache2","text":"Comando Descripci\u00f3n <code>systemctl start apache2</code> <code>Inicia el servicio Apache2.</code> <code>systemctl stop apache2</code> <code>Detiene el servicio Apache2.</code> <code>systemctl restart apache2</code> <code>Reinicia el servicio Apache2.</code> <code>systemctl reload apache2</code> <code>Recarga la configuraci\u00f3n de Apache2 sin detener el servicio.</code> <code>apachectl configtest</code> <code>Prueba la configuraci\u00f3n de Apache2.</code>"},{"location":"Ud3/Ch3_DMP/#sitios-virtuales-en-apache","title":"\ud83c\udf10 Sitios Virtuales en Apache","text":"<p>En Apache, los sitios virtuales se configuran usando el bloque , que permite especificar configuraciones espec\u00edficas por cada dominio o direcci\u00f3n IP. Puedes configurar m\u00faltiples sitios en un solo servidor, cada uno con su propio archivo de configuraci\u00f3n o mediante el uso de archivos de configuraci\u00f3n dentro del directorio sites-available y sites-enabled. <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName example.com\n    DocumentRoot /var/www/example\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_DMP/#configuracion-ssl-en-apache","title":"\ud83d\udd12 Configuraci\u00f3n SSL en Apache","text":"<p>En Apache, para habilitar SSL debes activar el m\u00f3dulo ssl y configurar el bloque  para usar el puerto 443 junto con las directivas de SSL SSLCertificateFile y SSLCertificateKeyFile. <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName example.com\n\n    SSLEngine on\n    SSLCertificateFile /etc/ssl/certs/server.crt\n    SSLCertificateKeyFile /etc/ssl/private/server.key\n\n    DocumentRoot /var/www/html\n    &lt;Directory /var/www/html&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_DMP/#ejemplo-completo-de-apache2conf","title":"\ud83d\udcd1 Ejemplo completo de apache2.conf","text":"<pre><code># Sitio Virtual 1 - example.com\n&lt;VirtualHost *:80&gt;\n    ServerName example.com\n    DocumentRoot /var/www/html\n\n    &lt;Directory /var/www/html&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n\n    # Redirecci\u00f3n a HTTPS\n    Redirect permanent / https://example.com/\n\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:443&gt;\n    ServerName example.com\n\n    SSLEngine on\n    SSLCertificateFile /etc/ssl/certs/server.crt\n    SSLCertificateKeyFile /etc/ssl/private/server.key\n\n    DocumentRoot /var/www/html\n    &lt;Directory /var/www/html&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n\n# Sitio Virtual 2 - example.org\n&lt;VirtualHost *:80&gt;\n    ServerName example.org\n    DocumentRoot /var/www/example\n\n    &lt;Directory /var/www/example&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n\n    # Redirecci\u00f3n a HTTPS\n    Redirect permanent / https://example.org/\n\n    ErrorLog ${APACHE_LOG_DIR}/example_error.log\n    CustomLog ${APACHE_LOG_DIR}/example_access.log combined\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:443&gt;\n    ServerName example.org\n\n    SSLEngine on\n    SSLCertificateFile /etc/ssl/certs/example_org.crt\n    SSLCertificateKeyFile /etc/ssl/private/example_org.key\n\n    DocumentRoot /var/www/example\n    &lt;Directory /var/www/example&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n\n    ErrorLog ${APACHE_LOG_DIR}/example_error.log\n    CustomLog ${APACHE_LOG_DIR}/example_access.log combined\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_DMP/#ejemplo-dockerfile-enfocado-a-servidores-web","title":"\ud83d\udcc4 Ejemplo Dockerfile enfocado a servidores web","text":"<p>Define la imagen de un contenedor, incluyendo el sistema base, configuraciones y archivos necesarios.</p> <pre><code># Dockerfile para un servidor Nginx\nFROM nginx:latest\n\n# Copiar archivo de configuraci\u00f3n personalizado\nCOPY nginx.conf /etc/nginx/nginx.conf\n\n# Copiar contenido de la web\nCOPY ./html /usr/share/nginx/html\n\n# Exponer el puerto\nEXPOSE 80\n\n# Iniciar el servidor\nCMD \\[\"nginx\", \"-g\", \"daemon off;\"]\n</code></pre>"},{"location":"Ud3/Ch3_DMP/#docker-composeyml-enfocado-a-servidores-web","title":"\ud83d\udcc4 docker-compose.yml enfocado a servidores web","text":"<p>Configura y orquesta m\u00faltiples contenedores, estableciendo servicios, redes y vol\u00famenes.</p> <pre><code>version: '3.9'\nservices:\n  web:\n    image: nginx:latest\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n      - ./html:/usr/share/nginx/html\n    networks:\n      - webnet\n  db:\n    image: mysql:8\n    environment:\n      MYSQL_ROOT_PASSWORD: example\n      MYSQL_DATABASE: appdb\n      MYSQL_USER: appuser\n      MYSQL_PASSWORD: apppass\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - db_data:/var/lib/mysql\n    networks:\n      - webnet\nnetworks:\n  webnet:\n    driver: bridge\nvolumes:\n  db_data:\n</code></pre>"},{"location":"Ud3/Ch3_EGM/","title":"Cheatsheet UD3: Configuraci\u00f3n de Servidores Web","text":""},{"location":"Ud3/Ch3_EGM/#_1","title":"CH3 - EGM","text":""},{"location":"Ud3/Ch3_EGM/#instalacion-y-configuracion-basica","title":"\ud83d\ude80 Instalaci\u00f3n y Configuraci\u00f3n B\u00e1sica \ud83d\ude80","text":"<p>\ud83d\udce6 Instalaci\u00f3n en Ubuntu o Debian : </p> <pre><code>   &gt; sudo apt update &amp;&amp; sudo apt install nginx\n</code></pre> <p>\ud83d\udd0c Habilitar y verificar servicio :</p> <pre><code>   &gt; sudo systemctl enable nginx\n   &gt; sudo systemctl start nginx\n   &gt; sudo systemctl status nginx\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#directorios-esenciales-de-nginx","title":"\ud83d\udcc1 Directorios esenciales de Nginx \ud83d\udcc1","text":"\ud83d\udcc2 Directorio \ud83d\udcdd Descripci\u00f3n <code>/etc/nginx</code> Directorio de configuraci\u00f3n de NGINX. <code>/var/log/nginx</code> Directorio donde se guardan los registros de NGINX. <code>/var/www/html</code> Directorio donde se alojan los contenidos de nuestra web. <code>/etc/nginx/sites-available</code> Configuraci\u00f3n de sitios web disponibles. <code>/etc/nginx/sites-enabled</code> Directorio donde se alojan las webs que tenemos habilitadas."},{"location":"Ud3/Ch3_EGM/#gestion-de-permisos","title":"Gesti\u00f3n de Permisos","text":"<pre><code>    &gt; sudo mkdir /var/www/mi_sitio\n    &gt; sudo touch /var/www/mi_sitio/index.html \n    &gt; sudo chown -R $USER:www-data /var/www/mi_sitio\n    &gt; sudo chmod 755 /var/www/mi_sitio\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#configurar-un-sitio-virtual-nginx","title":"Configurar un sitio virtual Nginx","text":"<p>\ud83d\udee0\ufe0f\ud83d\udcc4 Crear archivo de configuraci\u00f3n :</p> <pre><code>   &gt; sudo nano /etc/nginx/sites-available/mi_sitio.conf\n</code></pre> <p>\u2699\ufe0f Ejemplo de configuraci\u00f3n b\u00e1sica :</p> <pre><code>server {\n      listen 80;\n      listen [::]:80;\n      root /var/www/mi_sitio;\n      index index.html index.htm index.nginx-debian.html;\n      server_name mi_sitio;\n      location / {\n            try_files $uri $uri/ =404;\n      }\n   }\n</code></pre> <p>\ud83d\udd0c Habilitar el sitio :</p>"},{"location":"Ud3/Ch3_EGM/#sudo-ln-s-etcnginxsites-availablemi_sitio-etcnginxsites-enabled-sudo-systemctl-reload-nginx","title":"<pre><code>   &gt; sudo ln -s /etc/nginx/sites-available/mi_sitio /etc/nginx/sites-enabled/\n   &gt; sudo systemctl reload nginx\n</code></pre>","text":""},{"location":"Ud3/Ch3_EGM/#comprobacion-del-funcionamiento","title":"Comprobaci\u00f3n del funcionamiento","text":"<p>Si no tenemos un servidor DNS, debemos configurar manualmente nuestro cliente para que pueda acceder al sitio virtual de dos formas:</p> <ul> <li> <p>Si tenemos acceso a un usuario administrador (sudo), podemos modificar el archivo <code>/etc/hosts</code> y a\u00f1adir la siguiente linea: <code>IP_SERVIDOR  mi_sitio</code>.</p> </li> <li> <p>Si no tenemos acceso al usuario administrador, podemos lanzar nuestra navegador (en incognito para evitar cach\u00e9) desde terminal con un par\u00e1metro que indique el servidor DNS que quieres que aplique con el siguiente comando:    Linux : <code>google-chrome --incognito --host-resolver-rules=\"MAP mi-sitio IPSERVER\" --ignore-certificate-error</code>.    Windows : <code>&amp; \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\" --incognito --host-resolver-rules=\"MAP mi_sitio localhost\" --ignore-certificate-errors</code>.</p> </li> </ul> <p>\u2705</p>"},{"location":"Ud3/Ch3_EGM/#autenticacion-basica","title":"\ud83d\udee1\ufe0f Autenticaci\u00f3n B\u00e1sica","text":"<p>\ud83d\udd11 Crear archivo de contrase\u00f1as :</p> <pre><code>   &gt; sudo apt install apache2-utils\n   &gt; sudo htpasswd -c /etc/nginx/.htpasswd usuario\n   &gt; sudo mkdir /var/www/mi_sitio/areaprivada\n</code></pre> <p>\u2699\ufe0f Configurar autenticaci\u00f3n :</p> <pre><code>server {\n   listen 80;\n   listen [::]:80;\n   root /var/www/mi_sitio;\n   index index.html index.htm index.nginx-debian.html;\n   server_name mi_sitio;\n\n   location /areaprivada/ {\n         auth_basic \"Acceso Restringido\";\n         auth_basic_user_file /etc/nginx/.htpasswd;\n         try_files $uri $uri/ =404;\n   }\n}\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#autentificacion-por-ip","title":"\ud83d\udea7 Autentificaci\u00f3n por IP","text":"<p>\u2699\ufe0f Configurar autenticaci\u00f3n :</p> <p>El orden de <code>allow</code> y <code>deny</code> es muy importante en Nginx, ya que se eval\u00faan en el mismo orden en que aparecen.</p> <pre><code>server{\n   #Configuraci\u00f3n anterior\n\n   location /areaprivada/ {\n        satisfy all;\n        deny 172.1.10.6;\n        allow 172.1.10.15;\n        allow 172.1.3.14;\n        deny all;\n        auth_basic \"Acceso Restringido\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        root /var/www/mi_sitio;\n   }\n}\n</code></pre> <p>\u267b\ufe0f Reiniciar el servicio :</p> <pre><code>   &gt; sudo systemctl reload nginx\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#activar-https","title":"\u2705\ud83d\udd12 Activar HTTPS","text":"<pre><code>   &gt; sudo apt install openssl\n</code></pre> <p>\ud83d\udcdc Crear certificado autofirmado :</p> <pre><code> &gt; sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt\n</code></pre> <p>\u2699\ufe0f Configurar HTTPS :</p> <pre><code>server {\n   listen 443 ssl;\n   server_name mi_sitio;\n   ssl_certificate /etc/nginx/ssl/server.crt;\n   ssl_certificate_key /etc/nginx/ssl/server.key;\n   root /var/www/mi_sitio;\n   index index.html;\n}\n</code></pre> <p>\ud83d\udd10\ud83c\udf10\u27a1\ufe0f Forzar redirecci\u00f3n a HTTPS :</p> <pre><code>server {\n   listen 80;\n   server_name mi_sitio;\n   access_log /var/log/nginx/http_access.log;\n   return 301 https://$host$request_uri;\n}\n</code></pre> <p>\u267b\ufe0f Reiniciar el servicio :</p> <pre><code>   &gt; sudo systemctl reload nginx\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#-","title":"---","text":""},{"location":"Ud3/Ch3_EGM/#apache2","title":"Apache2","text":""},{"location":"Ud3/Ch3_EGM/#instalacion-y-configuracion-basica_1","title":"\ud83d\ude80 Instalaci\u00f3n y Configuraci\u00f3n B\u00e1sica \ud83d\ude80","text":"<p>\ud83d\udce6 Instalaci\u00f3n en Ubuntu o Debian :</p> <pre><code>   &gt; sudo apt update &amp;&amp; sudo apt install apache2\n</code></pre> <p>\ud83d\udd0c Habilitar y verificar servicio:</p> <pre><code>   &gt; sudo systemctl enable apache2\n   &gt; sudo systemctl start apache2\n   &gt; sudo systemctl status apache2\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#directorios-esenciales-de-apache","title":"\ud83d\udcc2 Directorios esenciales de Apache \ud83d\udcc2","text":"\ud83d\udcc2 Directorio \ud83d\udcdd Descripci\u00f3n <code>/etc/apache2</code> Directorio de configuraci\u00f3n de Apache2. <code>/var/log/apache2</code> Directorio donde se guardan los registros de Apache2. <code>/var/www/html</code> Directorio donde se alojan los contenidos de nuestra web. <code>/etc/apache2/sites-available</code> Configuraci\u00f3n de sitios web disponibles. <code>/etc/apache2/sites-enabled</code> Directorio donde se alojan las webs que tenemos habilitadas."},{"location":"Ud3/Ch3_EGM/#gestion-de-permisos_1","title":"Gesti\u00f3n de Permisos","text":"<p>\u27a1\ufe0f Gesti\u00f3n de Permisos</p>"},{"location":"Ud3/Ch3_EGM/#configurar-un-sitio-virtual-apache2","title":"Configurar un sitio virtual Apache2","text":"<p>\ud83d\udee0\ufe0f\ud83d\udcc4 Crear archivo de configuraci\u00f3n :</p> <pre><code>   &gt; sudo nano /etc/apache2/sites-available/mi_sitio.conf \n</code></pre> <p>\u2699\ufe0f Ejemplo de configuraci\u00f3n b\u00e1sica :</p> <pre><code>&lt;VirtualHost *:80&gt;\n   ServerName mi_sitio\n   ServerAlias www.mi_sitio.com mi_sitio.local\n   DocumentRoot /var/www/mi_sitio\n   &lt;Directory /var/www/mi_sitio&gt;\n      AllowOverride All\n      Require all granted\n   &lt;/Directory&gt;\n   ErrorLog ${APACHE_LOG_DIR}/mi_sitio_error.log\n   CustomLog ${APACHE_LOG_DIR}/mi_sitio_access.log combined\n&lt;/VirtualHost&gt;\n</code></pre> <p>\ud83d\udd0c Habilitar el sitio :</p>"},{"location":"Ud3/Ch3_EGM/#sudo-a2ensite-mi_sitioconf-sudo-systemctl-reload-apache2","title":"<pre><code>   &gt; sudo a2ensite mi_sitio.conf\n   &gt; sudo systemctl reload apache2\n</code></pre>","text":""},{"location":"Ud3/Ch3_EGM/#comprobacion-del-funcionamiento_1","title":"Comprobaci\u00f3n del funcionamiento","text":"<p>\u2705 \u27a1\ufe0f Comprobaci\u00f3n del funcionamiento</p>"},{"location":"Ud3/Ch3_EGM/#autenticacion-basica_1","title":"\ud83d\udee1\ufe0f Autenticaci\u00f3n B\u00e1sica","text":"<p>\ud83d\udd11 Crear archivo de contrase\u00f1as :</p> <pre><code>   &gt; sudo apt install apache2-utils\n   &gt; sudo htpasswd -c /etc/apache2/.htpasswd usuario\n   &gt; sudo mkdir /var/www/mi_sitio/areaprivada\n</code></pre> <p>\u2699\ufe0f Configurar autenticaci\u00f3n :</p> <pre><code>&lt;Directory \"/var/www/mi_sitio/areaprivada\"&gt;\n    AuthType Basic\n    AuthName \"Acceso Restringido\"\n    AuthBasicProvider file\n    AuthUserFile /etc/apache2/.htpasswd\n    Require valid-user\n&lt;/Directory&gt;\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#autentificacion-por-ip_1","title":"\ud83d\udea7 Autentificaci\u00f3n por IP","text":"<p>\u2699\ufe0f Configurar autenticaci\u00f3n :</p> <pre><code>&lt;Directory \"/var/www/mi_sitio/areaprivada\"&gt;\n    AuthType Basic\n    AuthName \"Restricted Area\"\n    AuthUserFile /etc/apache2/.htpasswd\n    Require valid-user\n    Order allow,deny\n    Allow from 172.1.10.15 172.1.3.14\n    Deny from all\n&lt;/Directory&gt;\n</code></pre> <p>\u267b\ufe0f Reiniciar el servicio :</p> <pre><code>   &gt; sudo systemctl reload apache2\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#activar-https_1","title":"\u2705\ud83d\udd12 Activar HTTPS","text":"<pre><code>   &gt; sudo apt install openssl\n</code></pre> <p>\ud83d\udcdc Crear certificado autofirmado : <pre><code>   &gt; sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/apache2/ssl/server.key -out /etc/apache2/ssl/server.crt\n</code></pre></p> <p>\u2699\ufe0f Configurar HTTPS : <pre><code>&lt;VirtualHost *:443&gt;\n   SSLEngine on\n   SSLCertificateFile /etc/apache2/ssl/apache.crt\n   SSLCertificateKeyFile /etc/apache2/ssl/apache.key\n   DocumentRoot /var/www/mi_sitio\n   ServerName mi_sitio\n   &lt;Directory \"/var/www/mi_sitio\"&gt;\n      Options Indexes FollowSymLinks\n      AllowOverride All\n      Require all granted\n   &lt;/Directory&gt;\n   ErrorLog ${APACHE_LOG_DIR}/mi_sitio_ssl_error.log\n   CustomLog ${APACHE_LOG_DIR}/mi_sitio_ssl_access.log combined\n&lt;/VirtualHost&gt;\n</code></pre></p> <p>\ud83d\udd10\ud83c\udf10\u27a1\ufe0f Forzar redirecci\u00f3n a HTTPS : <pre><code>&lt;VirtualHost *:80&gt;\n  Redirect \"/\" \"https://mi_sitio/\"\n&lt;/VirtualHost&gt;\n</code></pre></p>"},{"location":"Ud3/Ch3_EGM/#habilitar-modulos-necesarios-y-reiniciar-apache2","title":"\u2714\ufe0f Habilitar m\u00f3dulos necesarios y reiniciar Apache2","text":"<pre><code>   &gt; sudo a2enmod ssl\n   &gt; sudo a2enmod rewrite\n   &gt; sudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_EGM/#pila-lamp","title":"Pila LAMP \ud83d\udd25\ud83d\udc27\ud83d\udc2c\ud83d\udc18","text":"<p>\ud83d\udce6 Instalar componentes :</p> <pre><code>   &gt; sudo apt update\n   &gt; sudo apt install apache2 mysql-server php libapache2-mod-php php-mysql\n</code></pre> <p>\u2699\ufe0f Configurar base de datos :</p> <pre><code>   &gt; sudo mysql_secure_installation\n</code></pre> <p>\u2705 Probar PHP :</p> <p>Crear un archivo en <code>/var/www/html/info.php</code> con: <pre><code> &gt;&lt;?php phpinfo(); ?&gt;\n</code></pre> Acceder desde el navegador: <code>http://&lt;IP-DEL-SERVIDOR&gt;/info.php</code>.</p>"},{"location":"Ud3/Ch3_EGM/#phpmyadmin","title":"phpMyAdmin \ud83d\udc18\ud83d\udcca","text":"<p>\ud83d\udce6 Instalaci\u00f3n : <pre><code>   &gt; sudo apt-get install phpmyadmin\n</code></pre></p> <p>\ud83d\udd13 Acceso:</p> <p>Puedes acceder a phpMyAdmin desde <code>http://IP/phpmyadmin</code> para gestionar las bases de datos de manera m\u00e1s sencilla desde una interfaz web.</p>"},{"location":"Ud3/Ch3_EV/","title":"Ch3 - EV","text":""},{"location":"Ud3/Ch3_EV/#actualizar-y-preparar-el-sistema","title":"Actualizar y preparar el sistema","text":"<ul> <li>Actualizar repositorios y sistema : <code>sudo apt-get update &amp;&amp; sudo apt-get upgrade</code></li> </ul>"},{"location":"Ud3/Ch3_EV/#servidores-web","title":"Servidores Web","text":""},{"location":"Ud3/Ch3_EV/#apache","title":"Apache","text":"<ul> <li>Instalar Apache : <code>sudo apt install apache2</code></li> <li>Verificar estado : <code>sudo systemctl status apache2</code></li> <li>Activar y arrancar <pre><code>sudo systemctl enable apache2\nsudo systemctl start apache2\n</code></pre></li> <li>Ubicaci\u00f3n de archivos web : <code>/var/www/html</code></li> <li>Acceso en navegador : <code>http://&lt;IP-servidor&gt;</code></li> </ul>"},{"location":"Ud3/Ch3_EV/#nginx","title":"Nginx","text":"<ul> <li>Instalar Nginx : <code>sudo apt install nginx</code></li> <li>Verificar el estado : <code>systemctl status nginx</code></li> </ul> <p>Logs - Accesos : <code>/var/log/nginx/access.log</code> - Errores : <code>/var/log/nginx/error.log</code></p> <ul> <li>Acceso en navegador : <code>http://&lt;IP-servidor&gt;</code></li> </ul>"},{"location":"Ud3/Ch3_EV/#bases-de-datos","title":"Bases de datos","text":""},{"location":"Ud3/Ch3_EV/#mariadb","title":"MariaDB","text":"<ul> <li>Instalar MariaDB : <code>sudo apt install mariadb-server</code></li> <li>Verificar estado : <code>sudo systemctl status mysql</code></li> <li>Configurar seguridad : <code>sudo mysql_secure_installation</code></li> </ul> <p>Respuestas clave - Cambiar contrase\u00f1a root : <code>Y</code> - Contrase\u00f1a : <code>ieselcaminas</code></p> <ul> <li>Conectar : <code>mysql -u root -p</code></li> </ul>"},{"location":"Ud3/Ch3_EV/#php","title":"PHP","text":"<ul> <li>Instalar PHP y m\u00f3dulos : <code>sudo apt-get install php libapache2-mod-php php-mysql</code></li> <li>Reiniciar Apache : <code>sudo systemctl restart apache2</code></li> <li>Archivo de prueba : <code>sudo nano /var/www/html/info.php</code></li> <li>Contenido <pre><code>&lt;?php\nphpinfo();\n?&gt;\n</code></pre></li> <li>Acceso navegador : <code>http://&lt;IP-servidor&gt;/info.php</code></li> </ul>"},{"location":"Ud3/Ch3_EV/#gestion-grafica-de-bases-de-datos-con-phpmyadmin","title":"Gesti\u00f3n gr\u00e1fica de Bases de Datos con phpMyAdmin","text":"<ul> <li>Instalar phpMyAdmin : <code>sudo apt-get install phpmyadmin</code></li> </ul> <p>Respuestas clave - Servidor : <code>apache2</code> - Configuraci\u00f3n con <code>dbconfig-common</code>: S\u00ed - Contrase\u00f1a root : <code>ieselcaminas</code></p> <ul> <li>Crear enlace simb\u00f3lico si no se accede : <code>sudo ln -s /usr/share/phpmyadmin/ /var/www/html/phpmyadmin</code></li> <li>Acceso en navegador : <code>http://&lt;IP-servidor&gt;/phpmyadmin</code></li> </ul>"},{"location":"Ud3/Ch3_EV/#sitios-virtuales","title":"Sitios Virtuales","text":"<p>Configuraci\u00f3n b\u00e1sica de permisos - Archivos : <code>sudo chmod 644 /var/www/html/index.html</code> - Carpetas : <code>sudo chmod 755 /var/www/html</code> - Propietario : <code>sudo chown -R www-data:www-data /var/www/html</code></p>"},{"location":"Ud3/Ch3_EV/#nginx_1","title":"Nginx","text":"<ul> <li>Crear archivo de configuraci\u00f3n : <code>sudo nano /etc/nginx/sites-available/sitio1</code></li> <li>Contenido <pre><code>server {\n    listen 80;\n    root /var/www/sitio1;\n    index index.html;\n    server_name sitio1;\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre></li> <li>Activar sitio <pre><code>sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/\nsudo systemctl restart nginx\n</code></pre></li> </ul>"},{"location":"Ud3/Ch3_EV/#apache_1","title":"Apache","text":"<ul> <li>Crear archivo de configuraci\u00f3n : <code>sudo nano /etc/apache2/sites-available/sitio1.conf</code></li> <li>Contenido <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitio1\n    DocumentRoot /var/www/sitio1\n    &lt;Directory /var/www/sitio1&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre></li> <li>Activar sitio <pre><code>sudo a2ensite sitio1.conf\nsudo systemctl restart apache2\n</code></pre></li> </ul>"},{"location":"Ud3/Ch3_EV/#https","title":"HTTPS","text":""},{"location":"Ud3/Ch3_EV/#nginx_2","title":"Nginx","text":"<ul> <li>Crear contenidos <pre><code>sudo mkdir -p /etc/nginx/ssl\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt\n</code></pre></li> <li>Configurar HTTPS <pre><code>server {\n    listen 443 ssl;\n    ssl_certificate /etc/nginx/ssl/server.crt;\n    ssl_certificate_key /etc/nginx/ssl/server.key;\n}\n</code></pre></li> <li>Redirigir HTTP a HTTPS <pre><code>server {\n    listen 80;\n    return 301 https://$host$request_uri;\n}\n</code></pre></li> <li>Reiniciar servicio : <code>sudo systemctl restart nginx</code></li> </ul>"},{"location":"Ud3/Ch3_EV/#apache_2","title":"Apache","text":"<ul> <li>Activar m\u00f3dulo SSL <pre><code>sudo a2enmod ssl\nsudo systemctl restart apache2\n</code></pre></li> <li>Crear certificados <pre><code>sudo mkdir -p /etc/apache2/ssl\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/apache2/ssl/server.key -out /etc/apache2/ssl/server.crt\n</code></pre></li> <li>Configurar HTTPS <pre><code>&lt;VirtualHost *:443&gt;\n    SSLEngine on\n    SSLCertificateFile /etc/apache2/ssl/server.crt\n    SSLCertificateKeyFile /etc/apache2/ssl/server.key\n&lt;/VirtualHost&gt;\n</code></pre></li> <li>Redirigir HTTP a HTTPS <pre><code>&lt;VirtualHost *:80&gt;\n    Redirect permanent / https://sitio1/\n&lt;/VirtualHost&gt;\n</code></pre></li> <li>Reiniciar servicio : <code>sudo systemctl restart apache2</code></li> </ul>"},{"location":"Ud3/Ch3_JMJ/","title":"CH3 - JMJ","text":"<p>\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\"</p>"},{"location":"Ud3/Ch3_MCG/","title":"cheatsheet 3 - servidores web","text":""},{"location":"Ud3/Ch3_MCG/#instalaciones-varias","title":"Instalaciones varias","text":""},{"location":"Ud3/Ch3_MCG/#instala-tu-server-de-preferencia","title":"instala tu server de preferencia","text":"<p><pre><code>sudo apt install nginx\n</code></pre> <pre><code>sudo apt install apache2\n</code></pre> <pre><code>sudo apt install apache2utils\n</code></pre></p>"},{"location":"Ud3/Ch3_MCG/#instala-la-pila-lamp","title":"instala la pila LAMP","text":"<p><pre><code>sudo apt install mariadb-server\n</code></pre> <pre><code>sudo apt-get install php libapache2-mod-php php-mysql\n</code></pre> <pre><code>sudo apt-get install phpmyadmin\n</code></pre></p>"},{"location":"Ud3/Ch3_MCG/#comprobacion-de-servicios-con-systemctl","title":"comprobaci\u00f3n de servicios con systemctl","text":"<pre><code>systemctl status $serverInstalado\nsystemctl start $serverInstalado\nsystemctl stop $serverInstalado\nsystemctl restart $serverInstalado\nsystemctl disable $serverInstalado\n</code></pre>"},{"location":"Ud3/Ch3_MCG/#ruta-a-archivos-de-configuracion","title":"Ruta a archivos de configuraci\u00f3n","text":"<pre><code>/etc/$serverInstalado/sites-available/\n</code></pre>"},{"location":"Ud3/Ch3_MCG/#comandos-utiles","title":"Comandos \u00fatiles","text":"<p><pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt  # OJO CON LAS RUTAS DE SALIDA.\n</code></pre> <pre><code>sudo a2ensite $nombreSitio\n</code></pre> <pre><code>sudo a2enmod $nombreSitio\n</code></pre> <pre><code>google-chrome --host-resolver-rules=\"MAP $nombreSitio $direccionIP\" --ignore-certificate-error\n</code></pre> <pre><code>sudo mysql_secure_installation\n</code></pre></p>"},{"location":"Ud3/Ch3_MCG/#ejemplos-de-archivos-de-configuracion","title":"Ejemplos de archivos de configuraci\u00f3n","text":""},{"location":"Ud3/Ch3_MCG/#nginx","title":"nginx","text":"<pre><code>server {\n    listen 80;\n    server_name $nombreServer;\n    access_log /var/log/nginx/http_access.log;\n    return 301 https://$nombreServer$request_uri;\n}\n\nserver {\n    listen 443 ssl;\n    server_name $nombreServer;\n    access_log /var/log/nginx/http_access.log;\n\n    ssl_certificate /etc/nginx/ssl/server.crt;\n    ssl_certificate_key     /etc/nginx/ssl/server.key;\n    ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384';\n    ssl_protocols TLSv1.2 TLSv1.3;\n    access_log /var/log/nginx/https_access.log;\n}\n</code></pre>"},{"location":"Ud3/Ch3_MCG/#apache2","title":"apache2","text":"<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName $nombreServer\n    Redirect permanent / https://$nombreServer/\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:443&gt;\n    ServerName $nombreServer\n    DocumentRoot $directorioDeLaPagina\n\n    SSLEngine on\n    SSLCertificateFile /etc/apache2/ssl/server.crt\n    SSLCertificateKeyFile /etc/apache2/ssl/server.key\n\n    &lt;Directory $directorio&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> <p>(la verdad no sab\u00eda con que m\u00e1s rellenar esto :|)</p>"},{"location":"Ud3/Ch3_MIP/","title":"Cheatsheet para Instalaci\u00f3n y Configuraci\u00f3n de Servidores Web y Pila LAMP","text":""},{"location":"Ud3/Ch3_MIP/#configuracion-inicial-del-servidor","title":"Configuraci\u00f3n Inicial del Servidor","text":"<ol> <li>Preparar el entorno:</li> <li> <p>Configurar una m\u00e1quina virtual (VM) o instancia en la nube con:</p> <ul> <li>Sistema operativo: Debian (o similar basado en Linux).</li> <li>Puertos abiertos seg\u00fan necesidades (SSH, HTTP, HTTPS, etc.).</li> <li>Actualizar sistema operativo:    <pre><code>sudo apt update &amp;&amp; sudo apt upgrade\n</code></pre></li> </ul> </li> <li> <p>Configurar acceso SSH seguro:</p> </li> <li>Crear o usar un par de claves existente.</li> <li>Configurar grupos de seguridad para limitar el acceso a los puertos necesarios.</li> </ol>"},{"location":"Ud3/Ch3_MIP/#instalacion-de-servidor-web","title":"Instalaci\u00f3n de Servidor Web","text":"<ol> <li>Instalar Nginx o Apache:</li> <li>Para Nginx:      <pre><code>sudo apt install nginx\nsudo systemctl start nginx\n</code></pre></li> <li> <p>Para Apache:      <pre><code>sudo apt install apache2\nsudo systemctl start apache2\n</code></pre></p> </li> <li> <p>Configurar directorios y permisos:</p> </li> <li>Crear directorios para los sitios web:      <pre><code>sudo mkdir -p /var/www/sitio1\n</code></pre></li> <li> <p>Ajustar propietarios y permisos:      <pre><code>sudo chown -R www-data:www-data /var/www/sitio1\n</code></pre></p> </li> <li> <p>Habilitar sitios virtuales:</p> </li> <li>Crear un archivo de configuraci\u00f3n para cada sitio en <code>/etc/nginx/sites-available</code> o <code>/etc/apache2/sites-available</code>.</li> <li>Activar sitios y reiniciar el servicio:      <pre><code>sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/\nsudo nginx -t\nsudo systemctl restart nginx\n</code></pre></li> </ol>"},{"location":"Ud3/Ch3_MIP/#habilitar-autenticacion-en-el-servidor-web","title":"Habilitar Autenticaci\u00f3n en el Servidor Web","text":"<ol> <li> <p>Instalar herramientas de autenticaci\u00f3n:    <pre><code>sudo apt install apache2-utils\n</code></pre></p> </li> <li> <p>Crear archivo de contrase\u00f1as:    <pre><code>sudo htpasswd -c /etc/nginx/.htpasswd usuario\n</code></pre></p> </li> <li> <p>Configurar autenticaci\u00f3n en el sitio:</p> </li> <li> <p>Modificar el archivo de configuraci\u00f3n del sitio:      <pre><code>location /protected {\n    auth_basic \"Restricted Content\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n}\n</code></pre></p> </li> <li> <p>Reiniciar el servidor web:    <pre><code>sudo systemctl restart nginx\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_MIP/#habilitar-https","title":"Habilitar HTTPS","text":"<ol> <li>Obtener un certificado SSL:</li> <li> <p>Usar Let's Encrypt para certificados gratuitos:      <pre><code>sudo apt install certbot python3-certbot-nginx\nsudo certbot --nginx -d example.com -d www.example.com\n</code></pre></p> </li> <li> <p>Configurar HTTPS en el servidor web:</p> </li> <li> <p>Asegurarse de que el archivo de configuraci\u00f3n incluye:      <pre><code>server {\n    listen 443 ssl;\n    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n}\n</code></pre></p> </li> <li> <p>Validar y reiniciar:    <pre><code>sudo nginx -t\nsudo systemctl restart nginx\n</code></pre></p> </li> </ol>"},{"location":"Ud3/Ch3_MIP/#instalacion-de-la-pila-lamp","title":"Instalaci\u00f3n de la Pila LAMP","text":"<ol> <li>Instalar componentes b\u00e1sicos:</li> <li>Apache:      <pre><code>sudo apt install apache2\n</code></pre></li> <li>MariaDB:      <pre><code>sudo apt install mariadb-server\nsudo mysql_secure_installation\n</code></pre></li> <li> <p>PHP:      <pre><code>sudo apt install php libapache2-mod-php php-mysql\n</code></pre></p> </li> <li> <p>Configurar Apache con PHP:</p> </li> <li>Editar <code>/etc/apache2/sites-available/000-default.conf</code>:      <pre><code>DocumentRoot /var/www/html\n&lt;Directory /var/www/html&gt;\n    AllowOverride All\n&lt;/Directory&gt;\n</code></pre></li> <li> <p>Reiniciar Apache:      <pre><code>sudo systemctl restart apache2\n</code></pre></p> </li> <li> <p>Probar configuraci\u00f3n:</p> </li> <li>Crear un archivo <code>info.php</code>:      <pre><code>&lt;?php\nphpinfo();\n?&gt;\n</code></pre></li> <li>Acceder desde el navegador: <code>http://&lt;server_ip&gt;/info.php</code>.</li> </ol>"},{"location":"Ud3/Ch3_MIP/#dockerizacion-de-servicios","title":"Dockerizaci\u00f3n de Servicios","text":"<ol> <li> <p>Instalar Docker y Docker Compose:    <pre><code>sudo apt install docker.io\nsudo apt install docker-compose\n</code></pre></p> </li> <li> <p>Configurar servicios en <code>docker-compose.yml</code>:    <pre><code>version: '3.8'\nservices:\n  web:\n    image: php:apache\n    volumes:\n      - ./html:/var/www/html\n    ports:\n      - \"8080:80\"\n  db:\n    image: mariadb\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpassword\n      MYSQL_DATABASE: exampledb\n      MYSQL_USER: exampleuser\n      MYSQL_PASSWORD: examplepassword\n    ports:\n      - \"3306:3306\"\n</code></pre></p> </li> <li> <p>Iniciar servicios:    <pre><code>docker-compose up -d\n</code></pre></p> </li> <li> <p>Validar la configuraci\u00f3n:</p> </li> <li>Acceder al sitio en <code>http://localhost:8080</code>.</li> <li>Verificar la conexi\u00f3n a la base de datos desde PHP.</li> </ol>"},{"location":"Ud3/Ch3_MIP/#consideraciones-generales","title":"Consideraciones Generales","text":"<ul> <li>Seguridad:</li> <li>Configurar permisos adecuados para evitar accesos no autorizados.</li> <li>Usar autenticaci\u00f3n y cifrado HTTPS siempre que sea posible.</li> <li>Pruebas:</li> <li>Validar configuraci\u00f3n tras cada cambio con <code>nginx -t</code> o <code>apachectl configtest</code>.</li> <li>Automatizaci\u00f3n:</li> <li>Utilizar scripts o herramientas como Ansible o Terraform para configurar entornos repetibles.</li> <li>Backups:</li> <li>Realizar copias de seguridad de configuraciones y bases de datos peri\u00f3dicamente.</li> </ul>"},{"location":"Ud3/Ch3_MMC/","title":"CheatSheet Servidor Web Marcel Ma\u00f1as","text":"<p>Tipo: Apuntes Estado: En proceso Tema: Despliegue</p>"},{"location":"Ud3/Ch3_MMC/#instalacion-servidor-web","title":"Instalaci\u00f3n servidor web","text":"sudo apt install [nginx o apache2] Instalar servidor web"},{"location":"Ud3/Ch3_MMC/#comprobar-registros","title":"Comprobar registros","text":"cat /var/log/[nginx o apache2]/access.log Comprobaci\u00f3n de solicitudes cat /var/log/[nginx o apache2]/error.log Comprobaci\u00f3n de errores"},{"location":"Ud3/Ch3_MMC/#dockerizacion","title":"Dockerizaci\u00f3n","text":"<ul> <li> <p>Dockerfile para instalar nginx o apache2:</p> <pre><code>FROM debian:latest\nMAINTAINER Nombre Apellido &lt;correo_electr\u00f3nico&gt;\n\n# Actualizamos e instalamos Nginx\nRUN apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install -y [nginx o apache2] &amp;&amp; \\\n    rm -rf /var/lib/apt/lists/*\n\n# Exponemos el puerto 80\nEXPOSE 80\n\n# Comando para iniciar Nginx en primer plano\nCMD [\"nginx\", \"-g\", \"daemon off;\"] o\nCMD [\"apache2ctl\", \"-D\", \"FOREGROUND\"]\n</code></pre> </li> </ul> mkdir -p ~/web Creaci\u00f3n de directorio para almacenar nuestras p\u00e1ginas web - Creaci\u00f3n de fichero index.html (p\u00e1gina web) <pre><code>```html\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Servidor dockerizado!&lt;/title&gt;\n&lt;style&gt;\nhtml { color-scheme: light dark; }\nbody { width: 35em; margin: 0 auto;\nfont-family: Tahoma, Verdana, Arial, sans-serif; }\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Bienvendido al servidor web dockerizado!&lt;/h1&gt;\n&lt;p&gt; Este es un servidor web dockerizado &lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n```\n</code></pre> <p>| docker run -d --name=miservernginx --mount\\ type=bind,source=/home/admin/web,target=/var/www/html \\ -p 80:80 \\ servernginx | Creaci\u00f3n del contenedor con la p\u00e1gina web anterior. | | --- | --- |</p>"},{"location":"Ud3/Ch3_MMC/#sitios-web-virtuales","title":"Sitios web virtuales","text":"nano /var/www/sitio1/index.html Creaci\u00f3n de la p\u00e1gina web virtual <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Sitio1!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Bienvendido al sitio1!&lt;/h1&gt;\n&lt;p&gt; Este es el sitio1 de usuario1&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"Ud3/Ch3_MMC/#configuracion-sitio-web","title":"Configuraci\u00f3n sitio web","text":"sudo nano /etc/nginx/sites-available/sitio1 Acceso a la configuraci\u00f3n de la p\u00e1gina anterior <pre><code>server {\n        listen 80;\n        listen [::]:80;\n        root /var/www/sitio1;\n        index index.html index.htm index.nginx-debian.html;\n        server_name sitio1;\n        location / {\n                try_files $uri $uri/ =404;\n        }\n}\n</code></pre> <p>| sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/ ls -la /etc/nginx/sites-enabled/ | Creaci\u00f3n de archivo simb\u00f3lico. | | --- | --- | | sudo systemctl restart nginx | Reinicio del servidor | | google-chrome --host-resolver-rules=\"MAP sitio1 IPSERVER\" --ignore-certificate-error | Para comprobar que funciona la p\u00e1gina web |</p>"},{"location":"Ud3/Ch3_MMC/#auntentificacion","title":"Auntentificaci\u00f3n","text":"sudo apt install apache2-utils Instalaci\u00f3n de paquete para usar htpasswd sudo htpasswd -c /etc/nginx/.htpasswd profe Crea el archivo que guarda los usuarios y contrase\u00f1as, adem\u00e1s crea al usuario \u201cprofe\u201d sudo htpasswd /etc/nginx/.htpasswd otro_usuario Crea usuarios para el archivo sudo nano /etc/nginx/sites-available/sitio1 Modificar la configuraci\u00f3n: <pre><code>server {\n        listen 80;\n        listen [::]:80;\n        root /var/www/sitio1;\n        index index.html index.htm index.nginx-debian.html;\n        server_name sitio1;\n        location / {\n            auth_basic  \"\u00c1rea restringida\";\n            auth_basic_user_file    /etc/nginx/.htpasswd;\n            try_files $uri $uri/ =404;\n        }\n}\n</code></pre> <ul> <li> <p>Para que sea una autentificaci\u00f3n en una p\u00e1gina en espec\u00edfico:</p> <pre><code>server {\n    listen 80;\n    server_name sitio1.com;\n\n    root /var/www/sitio1;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n\n    location /intranet {\n        auth_basic \"\u00c1rea restringida\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre> </li> <li> <p>Autentificar mediante IP:</p> <pre><code>server {\n    listen 80;\n    server_name sitio1.com;\n\n    root /var/www/sitio1;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n\n    location /intranet {\n        try_files $uri $uri/ =404;\n    }\n\n    location /api {\n        #..\n        satisfy all;\n\n        deny 192.168...\n        allow 192.168...\n        allow 127.0...\n        deny all;\n    }\n}\n</code></pre> allow 192.168\u2026 Garantiza acceso deny 127.0\u2026 Deniega acceso satisfy all/any all: debe cumplir todas las condiciones any: Basta con cumplir una de las condiciones </li> </ul>"},{"location":"Ud3/Ch3_MMC/#autentificacion-mediante-https","title":"Autentificaci\u00f3n mediante HTTPS","text":"sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt Creaci\u00f3n del certificado y las claves de autentificaci\u00f3n. - Modificaci\u00f3n de la configuraci\u00f3n de la p\u00e1gina: <pre><code>server {\n          listen 443 ssl;\n                  ssl_certificate /etc/nginx/ssl/server.crt;\n                  ssl_certificate_key     /etc/nginx/ssl/server.key;\n                  ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384';\n                  ssl_protocols TLSv1.2 TLSv1.3;\n                  access_log /var/log/nginx/https_access.log;\n        }\n}\n</code></pre>"},{"location":"Ud3/Ch3_MMC/#sitios-virtuales-en-servidor-dockerizado","title":"Sitios virtuales en servidor dockerizado","text":"<ul> <li> <p>Estructura de directorios:</p> <pre><code>~\n\u251c\u2500\u2500 sitiosvirtuales/\n\u2502   \u251c\u2500\u2500 html\n\u2502   \u2502\u00a0\u00a0 \u2514\u2500\u2500 index.html\n\u2502   \u2514\u2500\u2500 sitio1\n\u2502       \u2514\u2500\u2500 index.html\n\u2514\u2500\u2500 nginxvirtual\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 docker-compose.yaml\n    \u251c\u2500\u2500 entrypoint.sh\n    \u2514\u2500\u2500 sites-available\n        \u251c\u2500\u2500 default\n        \u2514\u2500\u2500 sitio1\n</code></pre> </li> <li> <p>Contenido docker-compose.yaml:</p> <pre><code>services:\n    nginx:\n        build: .\n        volumes:\n            - ../sitiosvirtuales:/var/www\n            - ./sites-available:/etc/nginx/sites-available\n        ports:\n            - 80:80\n</code></pre> </li> <li> <p>Contenido Dockerfile:</p> <pre><code>FROM debian:latest\nMAINTAINER Nombre Apellido &lt;correo_electr\u00f3nico&gt;\n\n# Actualizamos e instalamos Nginx\nRUN apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install -y [nginx o apache2] &amp;&amp; \\\n    rm -rf /var/lib/apt/lists/*\n\n# Copiar el script de arranque\nCOPY entrypoint.sh /entrypoint.sh\n\n# Hacer que sea ejecutable\nRUN chmod +x /entrypoint.sh\n\n# Exponemos el puerto 80\nEXPOSE 80\n\n# Establecer el script como el entrypoint\nENTRYPOINT [\"/entrypoint.sh\"]\n</code></pre> </li> </ul>"},{"location":"Ud3/Ch3_PPE/","title":"Cheatsheet UD3 - Servidores Web","text":"<p>Este documento resume los comandos y ficheros de configuraci\u00f3n para la creaci\u00f3n y gesti\u00f3n de servidores Web en Nginx y Apache2 en sistemas Ubuntu, correspondientes a la Unidad 3 del curso de Despliegue de Aplicaciones.</p>"},{"location":"Ud3/Ch3_PPE/#instalacion-de-servidores-paso-a-paso-linux","title":"\ud83d\udda5\ufe0f Instalaci\u00f3n de Servidores paso a paso (Linux)","text":"<p>La instalaci\u00f3n puede variar dependiendo de nuestra distribuci\u00f3n de Linux. A continuaci\u00f3n, se presenta solo la instalaci\u00f3n en sistemas Ubuntu.</p>"},{"location":"Ud3/Ch3_PPE/#instalacion-del-servidor-nginx","title":"\ud83c\udf10 Instalaci\u00f3n del servidor Nginx","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt update &amp;&amp; sudo apt upgrade</code> Actualiza la lista y los paquetes instalados a la \u00faltima versi\u00f3n disponible. <code>sudo apt install nginx</code> Instala los paquetes para configurar el servicio Nginx. <code>systemctl status nginx</code> Muestra el estado del servicio Nginx. <code>sudo nano /var/www/html/index.html</code> Comando para modificar la plantilla principal que muestra el servicio Nginx <code>less /var/log/nginx/access.log</code> Muestra el contenido del archivo de registro con cada solicitud registrada en el servidor Nginx. <code>tail -n 3 /var/log/nginx/error.log</code> Muestra las tres ultimas lineas del archivo de registro con cada error registrado en el servidor Nginx."},{"location":"Ud3/Ch3_PPE/#instalacion-del-servidor-apache2","title":"\ud83c\udf10 Instalaci\u00f3n del servidor Apache2","text":"<p>Para instalar apache2, debemos seguir los mismos pasos que en la instalaci\u00f3n de Nginx pero sustituyendo los comandos de <code>nginx</code> por <code>apache2</code>. A continuaci\u00f3n, se muestran los cambios en la siguiente tabla:</p> \ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt install apache2</code> Instala los paquetes para configurar el servicio Apache2. <code>systemctl status apache2</code> Muestra el estado del servicio Apache2. <code>less /var/log/apache2/access.log</code> Muestra el contenido del archivo de registro con cada solicitud registrada en el servidor Apache2. <code>tail -n 3 /var/log/apache2/error.log</code> Muestra las tres ultimas lineas del archivo de registro con cada error registrado en el servidor Apache2. <p>\ud83d\udca1 Tip: Para acceder al servidor con nuestro navegador y comprobar que esta funcionando correctamente, simplemente debemos introducir la IP p\u00fablica de nuestro servidor en el navegador utilizando un protocolo HTTP <code>http://IP_SERVIDOR</code>. Debemos asegurarnos que el estado de nuestro servicio sea active (running)</p>"},{"location":"Ud3/Ch3_PPE/#creacion-de-sitios-virtuales","title":"\ud83d\udda5\ufe0f Creaci\u00f3n de Sitios Virtuales","text":""},{"location":"Ud3/Ch3_PPE/#preparacion-de-usuarios-gestores","title":"\ud83d\udc64 Preparaci\u00f3n de Usuarios Gestores","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo usermod -g www-data &lt;usuario&gt;</code> Ponemos al usuario que vayamos a utilizar en el grupo con permisos para gestionar las plantillas. <code>sudo mkdir -p /var/www/sitio1</code> Creamos una carpeta para almacenar las plantillas de nuestro sitio virtual. <code>sudo chown &lt;usuario&gt;:www-data /var/www/sitio1</code> Asignamos al usuario y el grupo <code>www-data</code> como propietario del directorio. <code>sudo chmod 755 /var/www/sitio1</code> Le damos permisos a usuarios y grupos para que el servidor web pueda leer el contenido y navegar dentro de los directorios. <p>\ud83d\udca1 Tip: Dentro del directorio <code>sitio1</code>, podremos crear plantillas para dar forma a nuestro sitio virtual. Para que funcione correctamente, es recomendable crear al menos un fichero <code>index.html</code> con una plantilla b\u00e1sica para que el servidor tenga una respuesta a las peticiones de los clientes que acceden al sitio virtual.</p>"},{"location":"Ud3/Ch3_PPE/#modificar-la-configuracion-en-nginx","title":"\ud83c\udf10 Modificar la configuraci\u00f3n en Nginx","text":"<p>En el directorio <code>/etc/nginx</code> se guardan los ficheros de configuraci\u00f3n. Para crear un sitio virtual, debemos crear un archivo dentro de la carpeta <code>/etc/nginx/sites-avaliable</code> con un aspecto similar al siguiente:</p> <pre><code>server {\n        # Puerto en el que el servidor escuchar\u00e1 las solicitudes HTTP\n        listen 80;\n        listen [::]:80;\n\n        # Directorio ra\u00edz del sitio web\n        root /var/www/sitio1;\n\n        # Archivos de \u00edndice que se buscar\u00e1n en el directorio ra\u00edz\n        index index.html index.htm index.nginx-debian.html;\n\n        # Nombre de dominio\n        server_name sitio1;\n\n        location / {\n                # Intenta servir el archivo solicitado, si no se encuentra, devuelve un error 404\n                try_files $uri $uri/ =404;\n        }\n}\n</code></pre> \ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/</code> Creamos un enlace simb\u00f3lico para que se habilite el sitio virtual. <code>sudo systemctl restart nginx</code> Reiniciamos el servicio nginx para que se apliquen los cambios realizados."},{"location":"Ud3/Ch3_PPE/#modificar-la-configuracion-en-apache2","title":"\ud83c\udf10 Modificar la configuraci\u00f3n en Apache2","text":"<p>En apache2, debemos configurar el archivo de configuraci\u00f3n en la ruta <code>/etc/apache2/sites-avaliable</code> y asegurarnos que el fichero tenga la extensi\u00f3n <code>.conf</code> para que funcione correctamente. Un ejemplo del archivo para apache ser\u00eda:</p> <p><pre><code>&lt;VirtualHost *:80&gt;\n        # Nombre de dominio\n        ServerName sitio1\n\n        # Directorio ra\u00edz del sitio web\n        DocumentRoot /var/www/sitio1\n\n        &lt;Directory /var/www/sitio1&gt;\n                # Permite la sobrescritura de configuraciones en este directorio\n                AllowOverride All\n\n                # Permite el acceso a todos los usuarios\n                Require all granted\n        &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> | \ud83d\udd27 Comando                                     | \ud83d\udcdd Descripci\u00f3n                                                                                           | |----------------------------------------------------|--------------------------------------------------------------------------------------------------------------| | <code>sudo a2ensite sitio1</code>                             | Habilitamos el sitio virtual que hemos creado en el fichero de configuracion.                                | | <code>sudo systemctl restart apache2</code>                   | Reiniciamos el servicio apache para que se apliquen los cambios realizados.                                  |</p>"},{"location":"Ud3/Ch3_PPE/#comprobacion-del-funcionamiento","title":"\u2705 Comprobaci\u00f3n del funcionamiento","text":"<p>Si no tenemos un servidor DNS, debemos configurar manualmente nuestro cliente para que pueda acceder al sitio virtual de dos formas:</p> <ul> <li>Si tenemos acceso a un usuario administrador (sudo), podemos modificar el archivo <code>/etc/hosts</code> y a\u00f1adir la siguiente linea: <code>IP_SERVIDOR  sitio1</code>.</li> <li>Si no tenemos acceso al usuario administrador, podemos lanzar nuestra navegador desde terminal con un par\u00e1metro que indique el servidor DNS que quieres que aplique con el siguiente comando: <code>google-chrome --host-resolver-rules=\"MAP sitio1 IPSERVER\" --ignore-certificate-error</code>.</li> </ul>"},{"location":"Ud3/Ch3_PPE/#autenticacion","title":"\ud83d\udda5\ufe0f Autenticaci\u00f3n","text":"<p>Antes de empezar, debemos instalar la herramienta <code>htpasswd</code> para generar contrase\u00f1as con el comando <code>sudo apt install apache2-utils</code></p>"},{"location":"Ud3/Ch3_PPE/#preparacion-del-entorno-nginx","title":"\ud83c\udf10 Preparaci\u00f3n del entorno (Nginx)","text":"<p>Debemos modificar el fichero de configuraci\u00f3n del sitio virtual para que, en la ruta que nosotros queramos, habilitemos las restricciones de acceso.</p> <pre><code>    location / {\n            auth_basic  \"\u00c1rea restringida\";\n            auth_basic_user_file    /etc/nginx/.htpasswd;\n            try_files $uri $uri/ =404;\n        }\n</code></pre> \ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo htpasswd -c /etc/nginx/.htpasswd &lt;usuario&gt;</code> Creamos el archivo oculto que almacema los usuario y contrase\u00f1as que tienen acceso, y a\u00f1adimos un primer usuario (para a\u00f1adir otro usuario, podemos ejecutar el mismo comando sin la opci\u00f3n <code>-c</code>)."},{"location":"Ud3/Ch3_PPE/#restricciones-por-ip","title":"\ud83d\udc64 Restricciones por IP","text":"<p>Tambi\u00e9n podemos realizar la restricci\u00f3n de acceso por direcci\u00f3n IP y combinarla de forma efectiva con la autenticaci\u00f3n HTTP de la siguiente forma:</p> <pre><code>    location / {\n            satisfy all;\n            deny 192.168.1.2;\n            allow 192.168.1.3;\n            deny all;\n\n            auth_basic  \"\u00c1rea restringida\";\n            auth_basic_user_file    /etc/nginx/.htpasswd;\n        }\n</code></pre>"},{"location":"Ud3/Ch3_PPE/#preparacion-del-entorno-apache2","title":"\ud83c\udf10 Preparaci\u00f3n del entorno (Apache2)","text":"<p>Para habilitar las autenticaci\u00f3n en un sitio virtual apache2, hay que modificar el fichero <code>/etc/apache2/sites-available/sitio1.conf</code> y a\u00f1adir el siguiente contenido:</p> <pre><code>&lt;Directory /var/www/sitio1&gt;\n        AuthType Basic\n        AuthName \"Intranet\"\n        AuthBasicProvider file\n        AuthUserFile /etc/apache2/.htpasswd\n        Require valid-user\n&lt;/Directory&gt;\n</code></pre> \ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo htpasswd -c /etc/apache2/.htpasswd &lt;usuario&gt;</code> De la misma forma que en Nginx, debemos crear el archivo que almacena los usuarios y un usuario inicial. <code>ls -la /etc/apache2/mods-enabled/</code> Comprobamos si los modulos de autenticaci\u00f3n de apache2 est\u00e1n habilitados. <code>a2enmod auth_basic</code> Habilitamos los m\u00f3dulos si hay alguno que no aparece. <p>\ud83d\udca1 Tip: Es importante que, al terminar las configuraciones, reiniciemos el servicio (tanto en apache2 como en nginx) para que los cambios se apliquen correctamente antes de hacer las comprobaciones.</p>"},{"location":"Ud3/Ch3_PPE/#activar-el-protocolo-https","title":"\ud83d\udda5\ufe0f Activar el protocolo HTTPS","text":""},{"location":"Ud3/Ch3_PPE/#configuracion-en-nginx","title":"\ud83c\udf10 Configuraci\u00f3n en Nginx","text":"<ul> <li>Podemos crear el certificado y las claves de forma simult\u00e1nea con un \u00fanico comando: <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt</code></li> </ul> <p>Y una vez los tenemos generados, debemos modificar el fichero de configuraci\u00f3n <code>/etc/nginx/sites-available</code> eliminando y a\u00f1adiendo las siguientes lineas:</p> <pre><code>-        listen 80;\n-        listen [::]:80;\n+        listen 443 ssl;\n+        ssl_certificate /etc/nginx/ssl/server.crt;\n+        ssl_certificate_key     /etc/nginx/ssl/server.key;\n+        ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384';\n+        ssl_protocols TLSv1.2 TLSv1.3;\n+        access_log /var/log/nginx/https_access.log;\n</code></pre> <p>Por \u00faltimo, para forzar la redirecci\u00f3n a HTTPS, debemos a\u00f1adir en el fichero de configuraci\u00f3n otro bloque \u201cserver\u201d adicional y separado del otro con una sintaxis similar a esta:</p> <pre><code>server {\n        listen 80;\n        server_name sitio1;\n\n        # Ruta del archivo de registro de accesos\n        access_log /var/log/nginx/http_access.log;\n\n        # Redirige todas las solicitudes HTTP a HTTPS\n        return 301 https://sitio1$request_uri;\n}\n</code></pre>"},{"location":"Ud3/Ch3_PPE/#configuracion-en-apache2","title":"\ud83c\udf10 Configuraci\u00f3n en Apache2","text":"<p>Los certificados y las claves se crean con el mismo comando que en Nginx, pero cambiando la ruta a <code>/etc/apache2/ssl</code>, y debemos asegurarnos de que el m\u00f3dulo <code>ssl</code> est\u00e9 activo.</p> <p>Y luego modificar el fichero de configuraci\u00f3n para que quede similar a este:</p> <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName sitio1\n    DocumentRoot /var/www/sitio1\n\n    #Activa SSL\n    SSLEngine on\n    # Especifica la ruta a tu certificado SSL y clave privada\n    SSLCertificateFile /etc/apache2/ssl/server.crt\n    SSLCertificateKeyFile /etc/apache2/ssl/server.key\n\n    &lt;Directory /var/www/sitio1&gt;\n            AllowOverride All\n            Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> <p>De la misma forma que en Nginx, para habilitar la redirecci\u00f3n forzosa a HTTPS debemos a\u00f1adir un nuevo bloque \u201cVirtualHost\u201d con la siguiente sintaxis:</p> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitio1\n    Redirect permanent / https://sitio1/\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_PPE/#instalacion-de-la-pila-lamp","title":"\ud83d\udda5\ufe0f Instalaci\u00f3n de la pila LAMP","text":"<p>Vamos a hacer una plataforma web LAMP completa, formada por un servidor web (apache2), un gestor de bases de datos (mariadb) y un lenguaje interpretado PHP.</p> \ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo systemctl status apache2</code> Comprobamos que tenemos un servidor web instalado y corriendo en nuestro equipo. <code>sudo apt install mariadb-server</code> Instalamos el servidor de bases de datos. <code>sudo mysql_secure_installation</code> Ejecutamos el script para securizar el servicio de bases de datos (importante configurar una contrase\u00f1a para el usuario administrador). <code>sudo apt-get install php libapache2-mod-php php-mysql</code> Instalamos los paquetes de php necesarios para gestionar los servicios anteriores. <code>sudo systemctl restart apache2</code> Reiniciamos el servicio web para aplicar los paquetes que hemos instalado. <ul> <li>Con ello, podemos comprobar si funciona correctamente creando un fichero b\u00e1sico PHP en el directorio <code>/var/www/html</code> y accediendo al servidor web desde nuestro navegador buscando la ruta <code>http://IPservidor/NOMBRE_FICHERO.php</code>.</li> </ul>"},{"location":"Ud3/Ch3_RPE/","title":"\ud83c\udf10 Cheatsheet de Servidores Web y Pila LAMP","text":""},{"location":"Ud3/Ch3_RPE/#nginx","title":"NGINX \ud83d\udfe2","text":""},{"location":"Ud3/Ch3_RPE/#instalacion-y-configuracion-basica","title":"\ud83d\udee0 Instalaci\u00f3n y Configuraci\u00f3n B\u00e1sica","text":"Descripci\u00f3n Comando Actualizar repositorios y sistema <code>sudo apt update &amp;&amp; sudo apt upgrade</code> Instalar Nginx <code>sudo apt install nginx</code> Comprobar el estado de Nginx <code>sudo systemctl status nginx</code>"},{"location":"Ud3/Ch3_RPE/#directorios-importantes","title":"\ud83d\udcc1 Directorios Importantes","text":"Ubicaci\u00f3n Descripci\u00f3n <code>/etc/nginx/nginx.conf</code> Archivo principal de configuraci\u00f3n de Nginx. <code>/etc/nginx/sites-available/</code> Configuraci\u00f3n de sitios disponibles. <code>/etc/nginx/sites-enabled/</code> Configuraci\u00f3n de sitios habilitados (enlaces simb\u00f3licos a sites-available). <code>/etc/nginx/conf.d/</code> Archivos de configuraci\u00f3n adicionales. <code>/var/www/html/</code> Directorio por defecto para archivos web est\u00e1ticos. <code>/var/log/nginx/access.log</code> Archivo de registro de accesos. <code>/var/log/nginx/error.log</code> Archivo de registro de errores."},{"location":"Ud3/Ch3_RPE/#configuracion-de-sitios-virtuales","title":"\ud83c\udf0d Configuraci\u00f3n de Sitios Virtuales","text":"<ol> <li> <p>Crear directorio para el sitio: <pre><code>sudo mkdir -p /var/www/sitiovirtual\nsudo chown usuario1:www-data /var/www/sitiovirtual\nsudo chmod 755 /var/www/sitiovirtual\n</code></pre></p> </li> <li> <p>Configurar archivo de sitio:</p> </li> </ol> <p><pre><code>sudo nano /etc/nginx/sites-available/sitiovirtual\n</code></pre> Contenido b\u00e1sico:</p> <pre><code>server {\n    listen 80;\n    root /var/www/sitiovirtual;\n    index index.html;\n    server_name sitiovirtual;\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre> <ol> <li>Habilitar el sitio:</li> </ol> <pre><code>sudo ln -s /etc/nginx/sites-available/sitiovirtual /etc/nginx/sites-enabled/\n</code></pre> <ol> <li>Reiniciar Nginx:</li> </ol> <pre><code>sudo systemctl restart nginx\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#autenticacion-en-nginx","title":"\ud83d\udd11 Autenticaci\u00f3n en Nginx","text":"<ol> <li> <p>Crear fichero de contrase\u00f1as:</p> <pre><code>sudo apt install apache2-utils\nhtpasswd -c /etc/nginx/.htpasswd usuario1\n</code></pre> </li> <li> <p>Configurar autenticaci\u00f3n b\u00e1sica:</p> <pre><code>server {\n    listen 80;\n    root /var/www/sitiovirtual;\n    index index.html;\n    server_name sitiovirtual;\n    location / {\n        auth_basic \"\u00c1rea privada\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre> </li> </ol>"},{"location":"Ud3/Ch3_RPE/#combinar-autenticacion-con-restricciones-de-ip","title":"\ud83d\udd12 Combinar autenticaci\u00f3n con restricciones de IP:","text":"<pre><code>location /private {\n    satisfy all;\n\n    allow 192.168.1.0/24;\n    deny all;\n\n    auth_basic \"\u00c1rea privada\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n}\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#activar-https-con-certificados-ssl","title":"\ud83d\udd12 Activar HTTPS con Certificados SSL","text":"<ol> <li>Crear certificados auto-firmados:</li> </ol> <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt\n</code></pre> <ol> <li> <p>Configurar archivo para SSL:</p> <pre><code>server {\n    listen 443 ssl;\n    ssl_certificate /etc/nginx/ssl/server.crt;\n    ssl_certificate_key /etc/nginx/ssl/server.key;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;  ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384';\n    ssl_protocols TLSv1.2 TLSv1.3;\n    access_log /var/log/nginx/https_access.log;\n\n\n   root /var/www/sitiovirtual;\n   index index.html;\n   server_name sitiovirtual;\n}\n</code></pre> </li> <li> <p>Redirigir HTTP a HTTPS:</p> </li> </ol> <pre><code>server {\n    listen 80;\n    server_name sitiovirtual;\n    access_log /var/log/nginx/http_access.log;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#apache","title":"APACHE \ud83d\udfe0","text":""},{"location":"Ud3/Ch3_RPE/#instalacion-y-configuracion-basica_1","title":"\ud83d\udee0 Instalaci\u00f3n y Configuraci\u00f3n B\u00e1sica","text":"Tarea Comando Actualizar repositorios y sistema <code>sudo apt update &amp;&amp; sudo apt upgrade</code> Instalar Apache <code>sudo apt install apache2</code> Comprobar el estado de Apache <code>sudo systemctl status apache2</code>"},{"location":"Ud3/Ch3_RPE/#directorios-importantes_1","title":"\ud83d\udcc1 Directorios Importantes","text":"Ubicaci\u00f3n Descripci\u00f3n <code>/etc/apache2/apache2.conf</code> Archivo principal de configuraci\u00f3n de Apache. <code>/etc/apache2/sites-available/</code> Configuraci\u00f3n de sitios disponibles. <code>/etc/apache2/sites-enabled/</code> Configuraci\u00f3n de sitios habilitados (enlaces simb\u00f3licos a sites-available). <code>/etc/apache2/conf-available/</code> Archivos de configuraci\u00f3n disponibles. <code>/etc/apache2/conf-enabled/</code> Archivos de configuraci\u00f3n habilitados (enlaces simb\u00f3licos a conf-available). <code>/var/www/html/</code> Directorio por defecto para archivos web est\u00e1ticos. <code>/var/log/apache2/access.log</code> Archivo de registro de accesos. <code>/var/log/apache2/error.log</code> Archivo de registro de errores."},{"location":"Ud3/Ch3_RPE/#configuracion-de-sitios-virtuales_1","title":"\ud83c\udf0d Configuraci\u00f3n de Sitios Virtuales","text":"<ol> <li>Crear directorio para el sitio:</li> </ol> <pre><code>sudo mkdir -p /var/www/sitiovirtual\nsudo chown usuario1:www-data /var/www/sitiovirtual\nsudo chmod 755 /var/www/sitiovirtual\n</code></pre> <ol> <li> <p>Configurar archivo del sitio:</p> <pre><code>sudo nano /etc/apache2/sites-available/sitiovirtual.conf\n</code></pre> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitiovirtual\n    DocumentRoot /var/www/sitiovirtual\n    &lt;Directory /var/www/sitiovirtual&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> </li> </ol>"},{"location":"Ud3/Ch3_RPE/#autenticacion-en-apache","title":"\ud83d\udd11 Autenticaci\u00f3n en Apache","text":"<ol> <li> <p>Crear fichero de contrase\u00f1as:</p> <pre><code>sudo apt install apache2-utils\nhtpasswd -c /etc/nginx/.htpasswd usuario1\n</code></pre> </li> <li> <p>Configurar autenticaci\u00f3n:</p> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitiovirtual\n    DocumentRoot /var/www/sitiovirtual\n    &lt;Directory /var/www/sitiovirtual&gt;\n            AllowOverride All\n            Require all granted\n    &lt;/Directory&gt;\n    &lt;Directory /var/www/sitiovirtual/secret&gt;\n            AuthType Basic\n            AuthName \"Secret area\"\n            AuthBasicProvider file\n            AuthUserFile /etc/apache2/.htpasswd\n            Require valid-user\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> </li> <li> <p>Habilitar m\u00f3dulos de autenticaci\u00f3n:</p> <pre><code>sudo a2enmod auth_basic authn_file authz_user\nsudo systemctl restart apache2\n</code></pre> </li> <li> <p>Reiniciar Apache:</p> <pre><code>sudo systemctl restart apache2\n</code></pre> </li> </ol>"},{"location":"Ud3/Ch3_RPE/#activacion-https-en-apache","title":"\ud83d\udd10 Activaci\u00f3n HTTPS en Apache","text":"<ol> <li> <p>Activar el m\u00f3dulo ssl en Apache2:</p> <pre><code>sudo a2enmod ssl\nsudo systemctl restart apache2\n</code></pre> </li> <li> <p>Modificar el archivo de configuraci\u00f3n para activar HTTPS:</p> <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName sitiovirtual\n    DocumentRoot /var/www/sitiovirtual\n\n    SSLEngine on\n    SSLCertificateFile /etc/apache2/ssl/server.crt\n    SSLCertificateKeyFile /etc/apache2/ssl/server.key\n\n    &lt;Directory /var/www/sitiovirtual&gt;\n            AllowOverride All\n            Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> </li> <li> <p>Redirecci\u00f3n forzosa de HTTP a HTTPS:</p> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitiovirtual\n    Redirect permanent / https://sitiovirtual/\n&lt;/VirtualHost&gt;\n</code></pre> </li> </ol>"},{"location":"Ud3/Ch3_RPE/#instalacion-de-la-pila-lamp","title":"\ud83d\ude80 Instalaci\u00f3n de la Pila LAMP","text":""},{"location":"Ud3/Ch3_RPE/#1-instalacion-de-apache","title":"1\ufe0f\u20e3 Instalaci\u00f3n de Apache","text":"<pre><code>sudo apt install apache2\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#verificar-el-estado-de-apache","title":"\u2705 Verificar el estado de Apache","text":"<pre><code>sudo systemctl status apache2\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#2-instalacion-de-mariadb","title":"2\ufe0f\u20e3 Instalaci\u00f3n de MariaDB","text":"<pre><code>sudo apt install mariadb-server\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#verificar-el-estado-de-mariadb","title":"\u2705 Verificar el estado de MariaDB","text":"<pre><code>sudo systemctl status mariadb\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#3-instalacion-de-php","title":"3\ufe0f\u20e3 Instalaci\u00f3n de PHP","text":"<pre><code>sudo apt-get install php libapache2-mod-php php-mysql\nsudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#4-instalacion-de-phpmyadmin","title":"4\ufe0f\u20e3 Instalaci\u00f3n de phpMyAdmin","text":"<pre><code>sudo apt-get install phpmyadmin\nsudo ln -s /usr/share/phpmyadmin/ /var/www/html/phpmyadmin\n</code></pre>"},{"location":"Ud3/Ch3_RPE/#verificar-el-estado-de-phpmyadmin","title":"\u2705 Verificar el estado de phpMyAdmin","text":"<pre><code>http://&lt;IP-DEL-SERVIDOR&gt;/phpmyadmin\n</code></pre>"},{"location":"Ud3/Ch3_RRL/","title":"Cheatsheet de Servidores Web","text":""},{"location":"Ud3/Ch3_RRL/#nginx","title":"NGINX","text":""},{"location":"Ud3/Ch3_RRL/#instalacion-y-gestion-del-servidor-nginx","title":"Instalaci\u00f3n y gesti\u00f3n del servidor - Nginx","text":""},{"location":"Ud3/Ch3_RRL/#instalacion-nginx","title":"Instalaci\u00f3n - Nginx","text":"<pre><code>    sudo apt update &amp;&amp; sudo apt upgrade\n    sudo apt install nginx\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#gestion-del-servidor-nginx","title":"Gesti\u00f3n del servidor - Nginx","text":""},{"location":"Ud3/Ch3_RRL/#ver-estado-nginx","title":"Ver estado - Nginx","text":"<pre><code>sudo systemctl status nginx\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#iniciar-nginx","title":"Iniciar - Nginx","text":"<pre><code>sudo systemctl start nginx\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#detener-nginx","title":"Detener - Nginx","text":"<pre><code>sudo systemctl stop nginx\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#habilitar-inicio-automatico-nginx","title":"Habilitar inicio autom\u00e1tico - Nginx","text":"<pre><code>sudo systemctl enable nginx\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#deshabilitar-inicio-automatico-nginx","title":"Deshabilitar inicio autom\u00e1tico - Nginx","text":"<pre><code>sudo systemctl disable nginx\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#configuracion-basica-nginx","title":"Configuraci\u00f3n b\u00e1sica - Nginx","text":""},{"location":"Ud3/Ch3_RRL/#editar-la-pagina-principal-nginx","title":"Editar la p\u00e1gina principal - Nginx","text":"<pre><code>sudo nano /var/www/html/index.nginx-debian.html\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#logs-del-servidor-nginx","title":"Logs del Servidor - Nginx","text":""},{"location":"Ud3/Ch3_RRL/#ver-solicitudes-del-servidor-nginx","title":"Ver solicitudes del servidor - Nginx","text":"<pre><code>sudo cat /var/log/nginx/access.log\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#ver-errores-del-servidor-nginx","title":"Ver errores del servidor - Nginx","text":"<pre><code>sudo cat /var/log/nginx/error.log\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#sitios-virtuales-nginx","title":"Sitios virtuales - Nginx","text":""},{"location":"Ud3/Ch3_RRL/#crear-directorio-para-el-sitio-nginx","title":"Crear directorio para el sitio - Nginx","text":"<pre><code>sudo mkdir -p /var/www/sitio1\nsudo chown www-data:www-data /var/www/sitio1\nsudo chmod 755 /var/www/sitio1\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#crear-archivo-de-configuracion-nginx","title":"Crear archivo de configuraci\u00f3n - Nginx","text":"<pre><code>sudo nano /etc/nginx/sites-available/sitio1\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#archivo-de-configuracion-nginx","title":"Archivo de configuraci\u00f3n - Nginx","text":"<pre><code>server {\n        listen 80;\n        listen [::]:80;\n        root /var/www/sitio1;\n        index index.html index.htm index.nginx-debian.html;\n        server_name sitio1;\n        location / {\n            try_files $uri $uri/ =404;\n        }\n}\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#crear-enlace-simbolico-nginx","title":"Crear enlace simb\u00f3lico - Nginx","text":"<pre><code>sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/\nsudo systemctl restart nginx\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#comprobar-su-funcionamiento","title":"Comprobar su funcionamiento","text":""},{"location":"Ud3/Ch3_RRL/#linux","title":"Linux","text":"<pre><code>sudo nano /etc/hosts\n</code></pre> <p>A\u00f1adimos la siguiente l\u00ednea</p> <pre><code>127.0.0.1 sitio1\n</code></pre> <p>IP de la m\u00e1quina local o IP publica del servidor(AWS) y nombre del sitio virtual</p>"},{"location":"Ud3/Ch3_RRL/#windows","title":"Windows","text":"<p>Accedemos aqu\u00ed: <code>C:\\Windows\\System32\\drivers\\etc\\hosts</code> y a\u00f1adimos la misma l\u00ednea que en linux</p>"},{"location":"Ud3/Ch3_RRL/#sin-permisos-para-modificar-hosts","title":"Sin permisos para modificar hosts","text":"<p>Si no tienes permisos para modificar el archivo de <code>hosts</code> puedes usar este comando</p> <pre><code>google-chrome --host-resolver-rules=\"MAP sitio1 IPSERVER\" --ignore-certificate-error\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#autenticacion-nginx","title":"Autenticaci\u00f3n - Nginx","text":""},{"location":"Ud3/Ch3_RRL/#instalar-herramienta-nginx","title":"Instalar herramienta - Nginx","text":"<pre><code>sudo apt install apache2-utils\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#crear-archivo-de-contrasenas-nginx","title":"Crear archivo de contrase\u00f1as - Nginx","text":"<pre><code>sudo htpasswd -c /etc/nginx/.htpasswd usuario\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#modificar-configuracion-nginx","title":"Modificar configuraci\u00f3n - Nginx","text":"<pre><code>location /intranet {\n    auth_basic \"\u00c1rea restringida\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n    try_files $uri $uri/ =404;\n}\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#restricciones-de-ip-nginx","title":"Restricciones de IP - Nginx","text":"<ul> <li> <p>deny -&gt; Denegar el acceso a una IP espec\u00edfica</p> </li> <li> <p>allow -&gt; Permite el acceso a una IP espec\u00edfica</p> </li> <li> <p>deny all -&gt; Denega el acceso a todas las IP </p> </li> <li> <p>satisfy all -&gt; Debe cumplir todas las directivas, tanto las de IP y las de autentificaci\u00f3n</p> </li> </ul> <pre><code>location /intranet {\n    satisfy all\n    deny 192.168.1.100;\n    allow 127.0.0.1;\n    deny all;\n    auth_basic \"\u00c1rea restringida\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n    try_files $uri $uri/ =404;\n}\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#https-nginx","title":"HTTPS - Nginx","text":""},{"location":"Ud3/Ch3_RRL/#crearcion-certificados-ssl-nginx","title":"Crearci\u00f3n certificados SSL - Nginx","text":"<pre><code>sudo mkdir -p /etc/nginx/ssl\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#modificacion-de-la-configuracion-nginx","title":"Modificaci\u00f3n de la configuraci\u00f3n - Nginx","text":"<pre><code>listen 443 ssl;\nssl_certificate /etc/nginx/ssl/server.crt;\nssl_certificate_key /etc/nginx/ssl/server.key;\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#redireccion-forzosa-a-https-nginx","title":"Redirecci\u00f3n forzosa a HTTPS - Nginx","text":"<pre><code>server {\n    listen 80;\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#apache","title":"APACHE","text":""},{"location":"Ud3/Ch3_RRL/#instalacion-y-gestion-del-servidor-apache","title":"Instalaci\u00f3n y gesti\u00f3n del servidor - Apache","text":""},{"location":"Ud3/Ch3_RRL/#instalacion-apache","title":"Instalaci\u00f3n - Apache","text":"<pre><code>    sudo apt update &amp;&amp; sudo apt upgrade\n    sudo apt install apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#gestion-del-servidor-apache","title":"Gesti\u00f3n del servidor - Apache","text":""},{"location":"Ud3/Ch3_RRL/#ver-estado-apache","title":"Ver estado - Apache","text":"<pre><code>sudo systemctl status apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#iniciar-apache","title":"Iniciar - Apache","text":"<pre><code>sudo systemctl start apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#detener-apache","title":"Detener - Apache","text":"<pre><code>sudo systemctl stop apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#habilitar-inicio-automatico-apache","title":"Habilitar inicio autom\u00e1tico - Apache","text":"<pre><code>sudo systemctl enable apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#deshabilitar-inicio-automatico-apache","title":"Deshabilitar inicio autom\u00e1tico - Apache","text":"<pre><code>sudo systemctl disable apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#configuracion-basica-apache","title":"Configuraci\u00f3n b\u00e1sica - Apache","text":""},{"location":"Ud3/Ch3_RRL/#editar-la-pagina-principal-apache","title":"Editar la p\u00e1gina principal - Apache","text":"<pre><code>sudo nano /var/www/html/index.html \n</code></pre>"},{"location":"Ud3/Ch3_RRL/#logs-del-servidor-apache","title":"Logs del Servidor - Apache","text":""},{"location":"Ud3/Ch3_RRL/#ver-solicitudes-del-servidor-apache","title":"Ver solicitudes del servidor - Apache","text":"<pre><code>sudo cat /var/log/apache2/access.log\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#ver-errores-del-servidor-apache","title":"Ver errores del servidor - Apache","text":"<pre><code>sudo cat /var/log/apache2/error.log\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#sitios-virtuales-apache","title":"Sitios virtuales - Apache","text":""},{"location":"Ud3/Ch3_RRL/#crear-directorio-para-el-sitio-apache","title":"Crear directorio para el sitio - Apache","text":"<pre><code>sudo mkdir -p /var/www/sitio1\nsudo chown www-data:www-data /var/www/sitio1\nsudo chmod 755 /var/www/sitio1\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#crear-archivo-de-configuracion-apache","title":"Crear archivo de configuraci\u00f3n - Apache","text":"<pre><code>sudo nano /etc/apache2/sites-available/sitio1.conf\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#archivo-de-configuracion-apache","title":"Archivo de configuraci\u00f3n - Apache","text":"<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitio1\n    DocumentRoot /var/www/sitio1\n    &lt;Directory /var/www/sitio1&gt;\n        AllowOverride All\n        Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#crear-enlace-simbolico-apache","title":"Crear enlace simb\u00f3lico - Apache","text":"<pre><code>sudo a2ensite sitio1.conf\nsudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#autenticacion-apache","title":"Autenticaci\u00f3n - Apache","text":""},{"location":"Ud3/Ch3_RRL/#instalar-herramienta-apache","title":"Instalar herramienta - Apache","text":"<pre><code>sudo apt install apache2-utils\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#crear-archivo-de-contrasenas-apache","title":"Crear archivo de contrase\u00f1as - Apache","text":"<pre><code>sudo htpasswd -c /etc/apache2/.htpasswd usuario\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#modificar-configuracion-apache","title":"Modificar configuraci\u00f3n - Apache","text":"<pre><code>&lt;Directory /var/www/sitio1/intranet&gt;\n    AuthType Basic\n    AuthName \"Intranet\"\n    AuthBasicProvider file\n    AuthUserFile /etc/apache2/.htpasswd\n    Require valid-user\n&lt;/Directory&gt;\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#https-apache","title":"HTTPS - Apache","text":""},{"location":"Ud3/Ch3_RRL/#crearcion-certificados-ssl-apache","title":"Crearci\u00f3n certificados SSL - Apache","text":"<pre><code>sudo mkdir -p /etc/apache2/ssl\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/apache2/ssl/server.key -out /etc/apache2/ssl/server.crt\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#activar-modulo-ssl-apache","title":"Activar m\u00f3dulo SSL - Apache","text":"<pre><code>sudo a2enmod ssl\nsudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#modificacion-de-la-configuracion-apache","title":"Modificaci\u00f3n de la configuraci\u00f3n - Apache","text":"<pre><code>&lt;VirtualHost *:443&gt;\n    SSLEngine on\n    SSLCertificateFile /etc/apache2/ssl/server.crt\n    SSLCertificateKeyFile /etc/apache2/ssl/server.key\n    ServerName sitio1\n    DocumentRoot /var/www/sitio1\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#redireccion-forzosa-a-https-apache","title":"Redirecci\u00f3n forzosa a HTTPS - Apache","text":"<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitio1\n    Redirect permanent / https://sitio1/\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#pila-lamp","title":"Pila LAMP","text":""},{"location":"Ud3/Ch3_RRL/#mariadb","title":"MariaDB","text":""},{"location":"Ud3/Ch3_RRL/#instalacion-mariadb","title":"Instalaci\u00f3n - MariaDB","text":"<pre><code>sudo apt install mariadb-server\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#comprobar-si-el-servicio-esta-activo-mariadb","title":"Comprobar si el servicio est\u00e1 activo - MariaDB","text":"<pre><code>sudo systemctl status mysql\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#securizacion-del-servicio-mariadb","title":"Securizaci\u00f3n del servicio - MariaDB","text":"<pre><code>sudo mysql_secure_installation\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#php","title":"PHP","text":""},{"location":"Ud3/Ch3_RRL/#instalacion-php","title":"Instalaci\u00f3n - PHP","text":"<pre><code>sudo apt-get install php libapache2-mod-php php-mysql\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#reiniciar-el-servidor-php","title":"Reiniciar el servidor - PHP","text":"<pre><code>sudo systemctl restart apache2\n</code></pre>"},{"location":"Ud3/Ch3_RRL/#phpmyadmin","title":"PhpMyAdmin","text":""},{"location":"Ud3/Ch3_RRL/#instalacion-phpmyadmin","title":"Instalaci\u00f3n - PhpMyAdmin","text":"<pre><code>sudo apt-get install phpmyadmin\n</code></pre>"},{"location":"Ud3/Ch3_RXN/","title":"Servidores Web \ud83c\udf10","text":"<p>Los servidores web, son utilizados para realizar una conexi\u00f3n mediante cliente servidor. Una vez realizada dicha conexi\u00f3n el cliente podr\u00e1 acceder a los datos visibles                                                                                                                                                                                                                                                                                                                                                                                                                                         proporcionados por el servidor, pero para que \u00e9stos datos sean visibles y el usuario pueda acceder al propio servidor, se deben realizar una serie de comandos para poder entrar.</p>"},{"location":"Ud3/Ch3_RXN/#activacion-https-en-nginx","title":"Activaci\u00f3n HTTPS en NGINX \u25b6\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo apt update &amp;&amp; sudo apt upgrade</code> Actualizaci\u00f3n de repositorios y sistema <code>sudo apt install nginx</code> Instalaci\u00f3n de nginx <code>systemctl status nginx</code> Comprobaci\u00f3n de Instalaci\u00f3n"},{"location":"Ud3/Ch3_RXN/#dockerizacion-nginx","title":"Dockerizaci\u00f3n NGINX \ud83d\udce6","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>nano Dockerfile</code> Creaci\u00f3n de Dockerfile, donde se habilitar\u00e1n puertos, permisos... <code>docker build -t servernginx</code> Creaci\u00f3n de la imagen nginx <code>docker run --name=miservernginx -d -p 80:80 servernginx</code> Creaci\u00f3n del contenedor nginx <code>docker stop miservernginx</code> Parar contenedor <code>docker rm miservernginx</code> Borrar contenedor <code>mkdir -p ~/web</code> Creaci\u00f3n de directorio en m\u00e1quina host <code>bash docker run -d --name=miservernginx \\ --mount type=bind,source=/home/admin/web,target=/var/www/html \\ -p 80:80 \\ servernginx</code> Lanzar nuevamente docker run, con nuevos par\u00e1metros <code>docker run -d --name=miservernginx2 \\-v /home/admin/web:/usr/share/nginx/html:ro \\-p 80:80 \\nginx:latest</code> Lanzar nuevamente, pero desde la imagen oficial"},{"location":"Ud3/Ch3_RXN/#creacion-de-un-sitio-virtual","title":"Creaci\u00f3n de un sitio virtual \ud83d\udda5\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo chown -R www-data:www-data /var/www/html</code> Hacer que el directorio pertenezca al usuario www-data <code>sudo chmod 644 /var/www/html/index.html</code> Permisos de lecturo y escritura, y el grupo solo de lectura <code>sudo chmod 755 /var/www/html/images</code> Para que el servidor web pueda leer y navegar entre directorios <code>sudo useradd -m usuario</code> Creaci\u00f3n de usario <code>sudo usermod -g www-data usuario1</code> Cambio de grupo del usuario <code>sudo passwd usuario1</code> Creaci\u00f3n de contrase\u00f1a \"usuario1\" <code>sudo mkdir -p /var/www/sitio1</code> Creaci\u00f3n de espacio para el sitio virtual <code>sudo chown usuario1:www-data /var/www/sitio1</code> Asignaci\u00f3n de propietario y grupo correcto <code>sudo chmod 755 /var/www/sitio1</code> Asignaci\u00f3n de permisos adecuados <code>su usuario1</code> Entrando al terminal como usuario1 <code>nano /var/www/sitio1/index.html</code> Creaci\u00f3n del html para el sitio virtual <code>sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/</code> Creaci\u00f3n de archivo simb\u00f3lico <code>sudo systemctl restart nginx</code> Reinicio de servidor para aplicar cambios <code>google-chrome --host-resolver-rules=\"MAP midominio.com 123.45.67.89, MAP otrodominio.com 98.76.54.32\" --ignore-certificate-errors</code> Si no tuvieramos permisos en la m\u00e1quina host, habr\u00eda que aplicar este comando <code>google-chrome --host-resolver-rules=\"MAP sitio1 IPSERVER\" --ignore-certificate-error</code> Hay que sustituir IP server por la de AWS"},{"location":"Ud3/Ch3_RXN/#autenticacion","title":"Autenticaci\u00f3n \u2705","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>mkdir intranet</code> Creaci\u00f3n de carpeta intranet <code>sudo apt install apache2-utils</code> Instalaci\u00f3n de utilidades para apache2 <code>sudo htpasswd -c /etc/nginx/.htpasswd profe</code> Creaci\u00f3n de archivo oculto en el directorio de configuraci\u00f3n <code>sudo htpasswd /etc/nginx/.htpasswd otro_usuario</code> Mismo paso para usuarios sin la -c <code>tail -n 3 /var/log/nginx/access.log</code> Obtenci\u00f3n IP peticiones <code>sudo htpasswd -c /etc/apache2/.htpasswd profe</code> Creaci\u00f3n de archivo oculto apache2"},{"location":"Ud3/Ch3_RXN/#activacion-https","title":"Activaci\u00f3n HTTPS \u267b\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>mkdir /etc/nginx/ssl</code> Creaci\u00f3n directorio para generar certificados <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt</code> Comando para generar certificados <code>mkdir /etc/apache2/ssl</code> Creaci\u00f3n directorio para generar certificados en apache2 <code>ls -la /etc/apache2/mods-enabled/ssl*</code> Comprobaci\u00f3n si el modulo necesario esta activo <code>sudo a2enmod ssl</code> Activaci\u00f3n de modulo necesario <code>sudo systemctl restart apache2</code> Reiniciar el servicio para aplicar cambios"},{"location":"Ud3/Ch3_RXN/#instalacion-de-pila-lamp","title":"Instalaci\u00f3n de pila LAMP \ud83d\udd0b","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo apt update &amp;&amp; sudo apt upgrade</code> Actualizaci\u00f3n de repositorios y sistema <code>sudo apt install apache2</code> Instalaci\u00f3n servicio apache2 <code>sudo systemctl status apache2</code> Comprobaci\u00f3n de la instalaci\u00f3n <code>sudo apt install mariadb-server</code> Instalaci\u00f3n del servicor de mariadb <code>sudo systemctl status mysql</code> Comprobaci\u00f3n de que el servicio est\u00e1 en marcha <code>sudo mysql_secure_installation</code> Ejecuci\u00f3n de script que ayuda a securizar el servicio <code>sudo apt-get install php libapache2-mod-php php-mysql</code> Instalaci\u00f3n de PHP <code>sudo systemctl restart apache2</code> Reinicio del servicio de apache2 <code>sudo apt-get install phpmyadmin</code> Instalaci\u00f3n de phpMyAdmin <code>sudo ln -s /usr/share/phpmyadmin/ /var/www/html/phpmyadmin</code> Enlace s\u00edmbolico por si no se pudiera acceder a phpMyAdmin"},{"location":"Ud3/Ch3_RXN/#instalacion-de-pila-lamp-dockerizada","title":"Instalaci\u00f3n de pila LAMP dockerizada \ud83d\udd0b\ud83d\udce6","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>nano docker-compose.yml</code> Edici\u00f3n del archivo de docker <code>docker-compose up -d</code> Iniciaci\u00f3n del proceso <code>docker ps</code> Comprobaci\u00f3n de que el contenedor funciona correctamente <code>mkdir -p /home/usuario/practica6-2/www/html</code> Creaci\u00f3n carpeta para levantar el contenedor <code>nano /home/usuario/practica6-2/www/html/index.php</code> Creaci\u00f3n documento para levantar el contenedor <code>mkdir /home/usuario/practica6-2/nginx</code> Creaci\u00f3n de directorio nginx <code>nano /home/usuario/practica6-2/nginx/default.conf</code> Creaci\u00f3n de archivo de configuraci\u00f3n <code>nano /home/usuario/practica6-2/nginx/Dockerfile</code> Creaci\u00f3n Dockerfile dentro del directior de nginx <code>cd /home/usuario/practica6-2</code> Cambio de directorio <code>docker-compose up -d</code> Levantamiento del contenedor <code>docker ps</code> Comprobaci\u00f3n de si los contenedores est\u00e1n funcionando"},{"location":"Ud3/Ch3_RXN/#configuraciones-de-archivos","title":"Configuraciones de archivos \ud83d\udcdc","text":"<pre><code>&gt; Configuraci\u00f3n dockerfile nginx (P1)\n\nFROM debian:latest\nMAINTAINER Raul Simarro &lt;alusim0931@ieselcaminas.org&gt;\n\n# Actualizamos e instalamos Nginx\nRUN apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install -y nginx &amp;&amp; \\\n    rm -rf /var/lib/apt/lists/*\n\n# Exponemos el puerto 80\nEXPOSE 80\n\n# Comando para iniciar Nginx en primer plano\nCMD [\"nginx\", \"-g\", \"daemon off;\"]\n</code></pre> <pre><code>&gt; Configuraci\u00f3n html (P1)\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Servidor dockerizado!&lt;/title&gt;\n&lt;style&gt;\nhtml { color-scheme: light dark; }\nbody { \n    width: 35em; \n    margin: 0 auto; \n    font-family: Tahoma, Verdana, Arial, sans-serif; \n    background-color: #f0f8ff;\n    color: #333;\n}\nh1 {\n    color: #ff4500;\n}\np {\n    color: #4682b4;\n}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Bienvenido al servidor web dockerizado!&lt;/h1&gt;\n&lt;p&gt;Este es un servidor web dockerizado.&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <pre><code>&gt; Creaci\u00f3n html (P2)\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Sitio1!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Bienvendido al sitio1!&lt;/h1&gt;\n&lt;p&gt; Este es el sitio1 de usuario1&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n nginx (P2)\n\nserver {\n        listen 80;\n        listen [::]:80;\n        root /var/www/sitio1;\n        index index.html index.htm index.nginx-debian.html;\n        server_name sitio1;\n        location / {\n                try_files $uri $uri/ =404;\n        }\n}\n</code></pre> <pre><code>&gt; Configuraci\u00f3n docker-compose (P2)\n\nservices:\n    nginx:\n        build: .\n        volumes:\n            - ../sitiosvirtuales:/var/www\n            - ./sites-available:/etc/nginx/sites-available\n        ports:\n            - 80:80\n</code></pre> <pre><code>&gt; Configuraci\u00f3n dockerfile (P2)\nFROM debian:latest\nMAINTAINER Raul Simarro &lt;alusim0931@ieselcaminas.org&gt;\n\n# Actualizamos e instalamos Nginx\nRUN apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install -y nginx &amp;&amp; \\\n    rm -rf /var/lib/apt/lists/*\n\n# Copiar el script de arranque\nCOPY entrypoint.sh /entrypoint.sh\n\n# Hacer que sea ejecutable\nRUN chmod +x /entrypoint.sh\n\n# Exponemos el puerto 80\nEXPOSE 80\n\n# Establecer el script como el entrypoint\nENTRYPOINT [\"/entrypoint.sh\"]\n</code></pre> <pre><code>&gt;Configuraci\u00f3n ficher nginx (P3)\n\nserver {\n        listen 80;\n        listen [::]:80;\n        root /var/www/sitio1;\n        index index.html index.htm index.nginx-debian.html;\n        server_name sitio1;\n        location / {\n            auth_basic  \"\u00c1rea restringida\";\n            auth_basic_user_file    /etc/nginx/.htpasswd;\n            try_files $uri $uri/ =404;\n        }\n}\n</code></pre> <pre><code>&gt;Configuraci\u00f3n sitio1 (P3)\n\n&lt;VirtualHost *:80&gt;\n        ServerName sitio1\n        DocumentRoot /var/www/sitio1\n        &lt;Directory /var/www/sitio1&gt;\n                AllowOverride All\n                Require all granted\n        &lt;/Directory&gt;\n        &lt;Directory /var/www/sitio1/intranet&gt;\n                AuthType Basic\n                AuthName \"Intranet\"\n                AuthBasicProvider file\n                AuthUserFile /etc/apache2/.htpasswd\n                Require valid-user\n        &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> <pre><code>&gt; Configuraci\u00f3n fichero sitio1 para https\n\n&lt;VirtualHost *:443&gt;\n    ServerName sitio1\n    DocumentRoot /var/www/sitio1\n\n    #Activa SSL\n    SSLEngine on\n    # Especifica la ruta a tu certificado SSL y clave privada\n    SSLCertificateFile /etc/apache2/ssl/server.crt\n    SSLCertificateKeyFile /etc/apache2/ssl/server.key\n\n    &lt;Directory /var/www/sitio1&gt;\n            AllowOverride All\n            Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> <pre><code>&gt;Creaci\u00f3n docker-compose.yml (P6)\nnginx:\n  image: nginx:latest\n  container_name: nginx-container\n  ports:\n    - 80:80\n</code></pre> <pre><code>&gt; Creaci\u00f3n del fichero html (P6)\n&lt;!DOCTYPE html&gt;\n&lt;head&gt;\n  &lt;title&gt;\u00a1Hola mundo!&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;h1&gt;\u00a1Hola mundo!&lt;/h1&gt;\n  &lt;p&gt;&lt;?php echo 'Estamos corriendo PHP, version: ' . phpversion(); ?&gt;&lt;/p&gt;\n&lt;/body&gt;\n</code></pre> <pre><code>&gt; Configuraci\u00f3n para que pueda correr la aplicaci\u00f3n PHP\nserver {\n\n     listen 80 default_server;\n     root /var/www/html;\n     index index.html index.php;\n\n     charset utf-8;\n\n     location / {\n      try_files $uri $uri/ /index.php?$query_string;\n     }\n\n     location = /favicon.ico { access_log off; log_not_found off; }\n     location = /robots.txt { access_log off; log_not_found off; }\n\n     access_log off;\n     error_log /var/log/nginx/error.log error;\n\n     sendfile off;\n\n     client_max_body_size 100m;\n\n     location ~ .php$ {\n      fastcgi_split_path_info ^(.+.php)(/.+)$;\n      fastcgi_pass php:9000;\n      fastcgi_index index.php;\n      include fastcgi_params;\n      fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n      fastcgi_intercept_errors off;\n      fastcgi_buffer_size 16k;\n      fastcgi_buffers 4 16k;\n    }\n\n     location ~ /.ht {\n      deny all;\n     }\n    }\n</code></pre> <pre><code>&gt; Configuraci\u00f3n docker-compose\n\nservices:\n  nginx:\n    build: ./nginx/\n    container_name: nginx-container\n    ports:\n      - 80:80\n    links:\n      - php\n    volumes_from:\n      - app-data\n  php:\n    build: ./php/\n    container_name: php-container\n    expose:\n      - 9000\n    links:\n      - mysql\n    volumes_from:\n      - app-data\n\n  app-data:\n    image: php:7.0-fpm\n    container_name: app-data-container\n    volumes:\n      - ./www/html/:/var/www/html/\n    command: \"true\"\n\n  mysql:\n    image: mysql:5.7\n    container_name: mysql-container\n    volumes_from:\n      - mysql-data\n    environment:\n      MYSQL_ROOT_PASSWORD: secret\n      MYSQL_DATABASE: mydb\n      MYSQL_USER: myuser\n      MYSQL_PASSWORD: password\n\n  mysql-data:\n    image: mysql:5.7\n    container_name: mysql-data-container\n    volumes:\n      - /var/lib/mysql\n    command: \"true\"\n</code></pre> <p>Todas las conexi\u00f3nes se han realizado desde el servidor de AWS academy</p>"},{"location":"Ud3/Ch3_VATC/","title":"\ud83c\udf1f Configuraci\u00f3n de Servidores Web","text":"<p>\u270d\ufe0f Victor Alexandru Teleanu Covaci</p>"},{"location":"Ud3/Ch3_VATC/#instalacion-de-servidores","title":"\ud83c\udf10 Instalaci\u00f3n de Servidores","text":"\ud83d\udcbb Servidor Web / \ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n \ud83d\udce1 Nginx <code>sudo apt-get update &amp;&amp; sudo apt-get upgrade</code> Actualizar paquetes antes de instalar Docker <code>sudo apt install nginx</code> Instala Nginx \ud83d\udd17 Apache2 <code>sudo apt-get update &amp;&amp; sudo apt-get upgrade</code> Actualizar paquetes antes de instalar Docker <code>sudo apt install apache2</code> Instala Apache"},{"location":"Ud3/Ch3_VATC/#directorios-importantes","title":"\ud83d\udcca Directorios Importantes","text":"\ud83d\udcbb Servidor Web / \ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n \ud83d\udce1 Nginx <code>/etc/nginx</code> Configuraci\u00f3n principal de Nginx <code>/etc/nginx/sites-available/</code> Configuraci\u00f3n de sitios disponibles <code>/etc/nginx/sites-enabled/</code> Configuraci\u00f3n de sitios habilitados <code>/var/log/nginx</code> Registros de Nginx \ud83d\udd17 Apache2 <code>/etc/apache2</code> Configuraci\u00f3n principal de Apache <code>/etc/apache2/sites-available/</code> Configuraci\u00f3n de sitios disponibles <code>/etc/apache2/sites-enabled/</code> Configuraci\u00f3n de sitios habilitados <code>/var/log/apache2</code> Registros de Apache \ud83d\udcf6 Com\u00fan <code>/etc/apache2</code> Contenido web"},{"location":"Ud3/Ch3_VATC/#configuracion-basica","title":"\ud83d\udee0\ufe0f Configuraci\u00f3n B\u00e1sica","text":""},{"location":"Ud3/Ch3_VATC/#crear-un-sitio-web","title":"\ud83d\udcc4 Crear un sitio web","text":"<ul> <li>Con <code>sudo mkdir /var/www/sitio1</code> creamos el directorio de nuestra web.</li> <li>Con <code>sudo touch /var/www/sitio1/index.html</code> creamos el archivo index.html.</li> <li>Con <code>sudo chown -R www-data:www-data /var/www/sitio1</code> cambiamos el propietario y grupo.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#configurar-nginx","title":"\ud83d\udcd1 Configurar Nginx","text":"<ul> <li>Creamos el archivo de configuraci\u00f3n usando <code>sudo nano /etc/nginx/sites-available/sitio1</code>.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#contenido","title":"\ud83d\uddc2\ufe0f Contenido","text":"<pre><code>server {\n    listen 80;\n    root /var/www/sitio1;\n    index index.html;\n    server_name sitio1;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre> <ul> <li>Con <code>sudo ln -s /etc/nginx/sites-available/sitio1 /etc/nginx/sites-enabled/</code> habilitamos el sitio web.</li> <li>Y reiniciamos el servicio mediante <code>sudo systemctl restart nginx</code>.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#configurar-apache2","title":"\ud83d\udcd1 Configurar Apache2","text":"<ul> <li>Creamos el archivo de configuraci\u00f3n usando <code>sudo nano /etc/apache2/sites-available/sitio1.conf</code>. </li> </ul>"},{"location":"Ud3/Ch3_VATC/#importante","title":"\u26a0\ufe0f Importante","text":"<p>En apache los ficheros de configruaci\u00f3n acaban en .conf.</p>"},{"location":"Ud3/Ch3_VATC/#contenido_1","title":"\ud83d\uddc2\ufe0f Contenido","text":"<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitiovirtual\n    DocumentRoot /var/www/sitiovirtual\n    &lt;Directory /var/www/sitiovirtual&gt;\n            AllowOverride All\n            Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> <ul> <li>Con <code>sudo a2ensite sitio1.conf</code> habilitamos el sitio web.</li> <li>Y reiniciamos el servicio mediante <code>sudo systemctl reload apache2</code>.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#seguridad-y-ssl","title":"\ud83d\udee1\ufe0f Seguridad y SSL","text":""},{"location":"Ud3/Ch3_VATC/#generar-certificado-ssl","title":"\ud83d\udd12 Generar Certificado SSL","text":"<ul> <li>Con <code>sudo mkdir /etc/nginx/ssl</code> creamos el directorio para la creaci\u00f3n del certificado.</li> <li>Con <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key -out /etc/nginx/ssl/nginx.crtl</code> creamos la clave.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#configurar-https-nginx","title":"\ud83d\udd11 Configurar HTTPS Nginx","text":"<ul> <li><code>sudo nano /etc/nginx/sites-available/sitio1</code>.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#contenido_2","title":"\ud83d\uddc2\ufe0f Contenido","text":"<pre><code>server {\n+       listen 443 ssl;\n+       ssl_certificate /etc/nginx/ssl/server.crt;\n+       ssl_certificate_key /etc/nginx/ssl/server.key;\n+       ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384';\n+       ssl_protocols TLSv1.2 TLSv1.3;\n+       access_log /var/log/nginx/https_access.log;\n\n    root /var/www/sitio1;\n    index index.html;\n    server_name sitio1;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre>"},{"location":"Ud3/Ch3_VATC/#redireccion-a-https","title":"\ud83d\udd04 Redirecci\u00f3n a HTTPS","text":"<pre><code>server {\n+   listen 80;\n+   server_name sitio1;\n+   return 301 https://$host$request_uri;\n}\n</code></pre> <ul> <li>Reiniciamos Nginx con <code>sudo systemctl restart nginx</code>.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#configurar-https-apache","title":"\ud83d\udd11 Configurar HTTPS Apache","text":"<pre><code>&lt;VirtualHost *:443&gt;\n    ServerName sitio1\n    DocumentRoot /var/www/sitio1\n\n+       #Activa SSL\n+       SSLEngine on\n+       # Especifica la ruta a tu certificado SSL y clave privada\n+       SSLCertificateFile /etc/apache2/ssl/server.crt\n+       SSLCertificateKeyFile /etc/apache2/ssl/server.key\n\n    &lt;Directory /var/www/sitio1&gt;\n            AllowOverride All\n            Require all granted\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_VATC/#redireccion-a-https_1","title":"\ud83d\udd04 Redirecci\u00f3n a HTTPS","text":"<pre><code>&lt;VirtualHost *:80&gt;\n+       ServerName sitio1\n+       Redirect permanent / https://sitio1/\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_VATC/#habilitar-modulos-necesarios-y-reiniciar-apache","title":"\u267b\ufe0f Habilitar m\u00f3dulos necesarios y reiniciar Apache","text":"<ul> <li><code>sudo a2enmod ssl</code> habilitar\u00e1 el m\u00f3dulo SSL para habilitar conexiones HTTPS.</li> <li><code>sudo a2enmod rewrite</code> habilita el m\u00f3dulo de reescritura de URL para permitir la manipulaci\u00f3n de direcciones web.</li> <li><code>sudo systemctl restart apache2</code> reinicia el servicio.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#autenticacion-de-usuarios","title":"\ud83d\udeaa Autenticaci\u00f3n de Usuarios","text":""},{"location":"Ud3/Ch3_VATC/#habilitar-autenticacion","title":"\ud83d\udd10 Habilitar autenticaci\u00f3n","text":"<ul> <li>Creamos el usuario con <code>sudo apt install apache2-utils</code> y <code>httpasswd -c /etc/nginx/.htpasswd usuario</code>.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#configurar-autenticacion-nginx","title":"\ud83d\uddc2\ufe0f Configurar autenticaci\u00f3n Nginx","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n    root /var/www/sitio1;\n    index index.html index.htm index.nginx-debian.html;\n    server_name sitio1;\n    location / {\n+           auth_basic \"\u00c1rea restringida\";\n+           auth_basic_user_file /etc/nginx/.htpasswd;\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre>"},{"location":"Ud3/Ch3_VATC/#configurar-autenticacion-apache2","title":"\ud83d\uddc2\ufe0f Configurar autenticaci\u00f3n Apache2","text":"<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName sitio1\n    DocumentRoot /var/www/sitio1\n    &lt;Directory /var/www/sitio1&gt;\n            AllowOverride All\n            Require all granted\n    &lt;/Directory&gt;\n+       &lt;Directory /var/www/sitio1/intranet&gt;\n+               AuthType Basic\n+               AuthName \"Intranet\"\n+               AuthBasicProvider file\n+               AuthUserFile /etc/apache2/.htpasswd\n+               Require valid-user\n+       &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud3/Ch3_VATC/#reiniciamos-los-servicios","title":"\u267b\ufe0f Reiniciamos los servicios","text":"<ul> <li>Con <code>sudo systemctl reload apache2</code> reiniciamos apache.</li> <li>Con <code>sudo systemctl reload nginx</code> reiniciamos nginx.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#pila-lamp","title":"\ud83d\udd25 Pila LAMP","text":""},{"location":"Ud3/Ch3_VATC/#instalacion-de-componentes","title":"\ud83d\udcbe Instalaci\u00f3n de componentes","text":"<ul> <li>Usamos <code>sudo apt update &amp;&amp; sudo apt upgrade</code> para actualizar los paquetes a su versi\u00f3n m\u00e1s reciente.</li> <li>Con <code>sudo apt install apache2 php libapache2-mod-php php-mysql mariadb-server</code> instalamos todos los paquetes necesarios.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#configurar-mariadb","title":"\u2699\ufe0f Configurar MariaDB","text":"<ul> <li><code>sudo mysql_secure_installation</code> inicia la configuraci\u00f3n de seguridad de MariaDB para proteger la instalaci\u00f3n.</li> </ul>"},{"location":"Ud3/Ch3_VATC/#instalar-phpmyadmin","title":"\ud83d\udce6 Instalar phpMyAdmin","text":"<ul> <li>Se usa <code>sudo apt install phpmyadmin</code> para instalar una herramienta web para gestionar bases de datos MySQL/MariaDB.</li> </ul>"},{"location":"Ud4/CH4_RSN/","title":"CH4 - RSN","text":""},{"location":"Ud4/CH4_RSN/#configuracion-servidor-dns","title":"Configuraci\u00f3n servidor DNS \u25b6\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo apt-get install dnsutils</code> Instala als herramientas necesarias para el DNS <code>sudo apt-get install bind9 bind9utils bind9-doc</code> Instalaci\u00f3n de servidor DNS <code>sudo named-checkzone deaw.es /etc/bind/db.deaw.es</code> Comprobar el estado de la zona"},{"location":"Ud4/CH4_RSN/#dockerizacion-dns","title":"Dockerizaci\u00f3n DNS \ud83d\udce6","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>docker run -d --named=miserverdns --publish 53:53/udp --publish 53:53/tcp internetsystemsconsortium/bind9:9.18</code> Creaci\u00f3n del contenedor dns <code>docker cp \"nombre archivo\" \"nombre contenedor\":/etc/bind</code> Copiar archivos locales al contenedor"},{"location":"Ud4/CH4_RSN/#configuracion-de-un-servidor-ldap","title":"Configuraci\u00f3n de un servidor LDAP \ud83d\udda5\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo apt-get install slapd ldap-utils</code> Instalar OpenLDAP y sus utilidades <code>sudo slapcat</code> Muestra la informaci\u00f3n de la base de datos <code>sudo dpkg-reconfigure slapd</code> Reconfiguraci\u00f3n del servidor LDAP"},{"location":"Ud4/CH4_RSN/#carga-de-datos-en-servidor-ldap-mediante-ficheros-ldif","title":"Carga de datos en servidor LDAP mediante ficheros ldif \ud83d\udd01","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas  -f \"archivo.ldif\"</code> A\u00f1adir informaci\u00f3n a la base de datos <code>ldapmodify \"datos anteriores\"</code> Modificaci\u00f3n ldif <code>ldapsearch -x -b</code> B\u00fasqueda en la base de datos <code>ldapdelete -x -D</code> Borrar registros de la base de datos"},{"location":"Ud4/CH4_RSN/#dockerizacion-ldap","title":"Dockerizaci\u00f3n LDAP \ud83d\udce6","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>docker run --env LDAP_ORGANISATION=\"My Company\" --env LDAP_DOMAIN=\"my-company.com\" --env LDAP_ADMIN_PASSWORD=\"JonSn0w\" --detach osixia/openldap:1.5.0</code> Lanzar contenedor ldap <code>docker network create ldap-network</code> Crear network para el ldap"},{"location":"Ud4/CH4_RSN/#autenticacion-apache-contra-ldap","title":"Autenticaci\u00f3n Apache contra LDAP \ud83e\udeb6\u2705","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo a2enmod authnz_ldap</code> Habilitar m\u00f3dula de autenticaci\u00f3n <code>sudo mkdir /var/www/html/test</code> Crear directorio test <code>sudo nano /var/www/html/test/index.html</code> Crear html <code>sudo chown -R www-data:www-data /var/www/html/test</code> Cambia el usuario y grupo del directorio"},{"location":"Ud4/CH4_RSN/#autenticacion-apache-dockerizada","title":"Autenticaci\u00f3n apache dockerizada \ud83e\udeb6\ud83d\udce6","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>docker run -d --name apache2_server --net ldap-network -d -p 80:80 -e LDAP_BIND_ON= cn=admin,dc=daw,dc=ieselcaminas  -e LDAP_PASSWORD=ieselcaminas -e LDAP_URL=ldap://ldap-service ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub my-apache2</code> Creaci\u00f3n del contenedor ldap"},{"location":"Ud4/CH4_RSN/#autenticacion-nginx-contra-ldap","title":"Autenticaci\u00f3n Nginx contra LDAP \u2705","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo mkdir -p /var/www/sitioldap</code> Creaci\u00f3n carpeta ldap <code>sudo nano /var/www/sitioldap/index.html</code> Creaci\u00f3n index.html en ldap <code>sudo nano /etc/nginx/sites-available/sitioldap</code> Creaci\u00f3n sitio virtual <code>sudo ln -s /etc/nginx/sites-available/sitioldap /etc/nginx/sites-enabled/</code> Activaci\u00f3n sitio virtual ``"},{"location":"Ud4/CH4_RSN/#configuraciones-de-archivos","title":"Configuraciones de archivos \ud83d\udcdc","text":"<pre><code>&gt; Archivo configuraci\u00f3n named.conf (P1)\n\n// This is the primary configuration file for the BIND DNS server named.\n//\n// Please read /usr/share/doc/bind9/README.Debian for information on the\n// structure of BIND configuration files in Debian, *BEFORE* you customize\n// this configuration file.\n//\n// If you are just adding zones, please do that in /etc/bind/named.conf.local\n\ninclude \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\ninclude \"/etc/bind/named.conf.default-zones\";\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n named.conf.local (P1)\n\n//\n// Do any local configuration here\n//\n\n// Consider adding the 1918 zones here, if they are not used in your\n// organization\n//include \"/etc/bind/zones.rfc1918\";\n\nzone \"deaw.es\" {\n        type master;\n        file \"/etc/bind/db.deaw.es\";  //Ruta donde ubicamos nuestro archivo de zona\n};\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n de db.deaw.es (P1)\n\n$TTL 1d\n$ORIGIN deaw.es. ; base domain-name\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; A records\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n de zona inversa (P1)\n\nzone \"104.85.3.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.3.85.104\";  # Ruta al archivo de zona inversa\n};\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n de db.3.85.104 (P1)\n\n$TTL 1d\n$ORIGIN 104.85.3.IN-ADDR.ARPA.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n\n; Name Servers\n    IN  NS      ns1.deaw.es.\n\n; PTR record\n173 IN  PTR     ns1.deaw.es. ; fully qualified domain name (FQDN)\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n estructura_basica.lidf (P1)\n\n# Usuarios\ndn: ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: usuarios\n\n# Grupos\ndn: ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: grupos\n</code></pre> <p><pre><code>&gt; Archivo configuraci\u00f3n grupos.lidf (P1)\n\n#Grupo profesores\ndn: cn=profesores,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: profesores\ngidNumber: 10000\n\n#Grupo alumnos\ndn: cn=alumnos,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: alumnos   \ngidNumber: 10001\n</code></pre> <pre><code>&gt; Archivo de configuraci\u00f3n de los usuarios\n# Profe01\ndn: uid=profe01,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe01\ncn: profe01\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/profe01\ngecos: Profe01 DAW\nuserPassword: 123456\n\n# Profe02\ndn: uid=profe02,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe02\ncn: profe02\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1002\ngidNumber: 10000\nhomeDirectory: /home/profe02\ngecos: Profe02 DAW\nuserPassword: 123456\n</code></pre></p> <pre><code>&gt; Html del index.html\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Sitio LDAP!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Bienvendido al sitio validado por LDAP!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n````\n\n```c\n&gt; Archivo configuraci\u00f3n 000-default.conf\n\n&lt;VirtualHost *:80&gt;\n        ServerAdmin webmaster@localhost\n        DocumentRoot /var/www/html\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n        &lt;Directory \"/var/www/html/test\"&gt; \n        AuthType Basic\n        AuthName \"Apache LDAP authentication\"\n        AuthBasicProvider ldap \n        AuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub\" \n        AuthLDAPBindDN \"cn=admin,dc=daw,dc=ieselcaminas\"\n        AuthLDAPBindPassword ieselcaminas\n        Require valid-user\n        &lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre> <p><pre><code>&gt; Configuraci\u00f3n dockerfile\n\n# Usamos la imagen base de PHP 7 con Apache\nFROM php:7-apache\n\n# Activamos el m\u00f3dulo LDAP de Apache ejecutando el siguiente comando\nRUN a2enmod authnz_ldap\n\n# Creamos el directorio test como en la pr\u00e1ctica anterior\nRUN mkdir -p /var/www/html/test\n\n# Copiamos los ficheros como los de la pr\u00e1ctica anterior\nCOPY index.html /var/www/html/test/index.html\n\n# Copiamos el archivo de configuraci\u00f3n del sitio por defecto\nCOPY 000-default.conf /etc/apache2/sites-enabled/000-default.conf\n</code></pre> <pre><code>&gt; Configuraci\u00f3n index.html de nginx\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Sitio LDAP!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Bienvendido al sitio validado por LDAP!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></p> <pre><code>&gt; Configuraci\u00f3n sitio ldap de nginx\nserver {\n    listen 80;\n    server_name sitioldap;\n    root /var/www/sitioldap;\n    index index.html;\n\n    location / {\n         try_files $uri $uri/ =404;\n    }\n}\n\nhttp {\n    ldap_server mi_servidor_ldap {\n        url ldap://IPSERVIDOR/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub;\n        binddn \"cn=admin,dc=daw,dc=ieselcaminas\";\n        binddn_passwd \"ieselcaminas\";\n        group_attribute member;\n        group_attribute_is_dn on;\n\n        require valid_user;\n    }\n\n    include /etc/nginx/sites-enabled/*;\n}\n</code></pre> <p>Todas las conexi\u00f3nes se han realizado desde el servidor de AWS academy</p>"},{"location":"Ud4/Ch4_ABM/","title":"\ud83d\udee0\ufe0f Cheatsheet: Servicios de Red (DNS y LDAP) \ud83d\udee0\ufe0f","text":"<p>Este cheatsheet proporciona una referencia r\u00e1pida y clara para los servicios de red DNS y LDAP, con una clasificaci\u00f3n adecuada de comandos, archivos de configuraci\u00f3n y opciones importantes. </p>"},{"location":"Ud4/Ch4_ABM/#1-dns-domain-name-system","title":"\ud83e\udded 1. DNS (Domain Name System)","text":"<p>El DNS convierte nombres de dominio legibles por humanos (por ejemplo, <code>example.com</code>) en direcciones IP.</p>"},{"location":"Ud4/Ch4_ABM/#archivos-de-configuracion-importantes","title":"\ud83d\udcc2 Archivos de Configuraci\u00f3n Importantes","text":"Archivo Descripci\u00f3n <code>/etc/bind/named.conf</code> Archivo principal de configuraci\u00f3n de BIND. Incluye otros archivos de configuraci\u00f3n. <code>/etc/bind/named.conf.options</code> Configuraci\u00f3n de opciones globales (por ejemplo, reenviadores). <code>/etc/bind/named.conf.local</code> Definici\u00f3n de zonas locales personalizadas. <code>/etc/bind/named.conf.default-zones</code> Define las zonas predeterminadas (por ejemplo, <code>localhost</code>). <code>/etc/bind/db.deaw.es</code> Archivo de zona con los registros de recursos (SOA, NS, A, etc.)."},{"location":"Ud4/Ch4_ABM/#comandos-para-administrar-bind","title":"\ud83d\udd27 Comandos para Administrar BIND","text":"Comando Descripci\u00f3n <code>sudo named-checkconf</code> Verifica la sintaxis de la configuraci\u00f3n de BIND. <code>sudo named-checkzone deaw.es /etc/bind/db.deaw.es</code> Verifica la sintaxis y la validez del archivo de la zona DNS. <code>host &lt;nombre_dominio&gt;</code> Resuelve un nombre de dominio en una direcci\u00f3n IP. <code>nslookup &lt;nombre_dominio&gt;</code> Resuelve un nombre de dominio, proporcionando m\u00e1s detalles."},{"location":"Ud4/Ch4_ABM/#ejemplo-de-configuracion-de-zona-dbdeawes","title":"\ud83d\udcdc Ejemplo de Configuraci\u00f3n de Zona (db.deaw.es)","text":"<pre><code>$TTL 1d\n$ORIGIN deaw.es. ; dominio base\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Servidores de nombres (Name Servers)\n    IN  NS      ns1.deaw.es.\n; Registros A (direcciones IP)\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n</code></pre>"},{"location":"Ud4/Ch4_ABM/#configuracion-de-etcbindnamedconf","title":"\u2699\ufe0f Configuraci\u00f3n de /etc/bind/named.conf","text":"<pre><code>// Archivo de configuraci\u00f3n principal de BIND\ninclude \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\ninclude \"/etc/bind/named.conf.default-zones\";\n\nallow-query { any; };  // Permitir consultas desde cualquier IP\n</code></pre>"},{"location":"Ud4/Ch4_ABM/#opciones-comunes-de-configuracion-namedconfoptions","title":"\ud83d\udcd8 Opciones Comunes de Configuraci\u00f3n (named.conf.options)","text":"<pre><code>options {\n    recursion no; // Desactiva la recursividad\n    forwarders {\n        8.8.8.8;  // Google DNS 1\n        8.8.4.4;  // Google DNS 2\n    };\n};\n</code></pre>"},{"location":"Ud4/Ch4_ABM/#2-ldap-lightweight-directory-access-protocol","title":"\ud83d\udd10 2. LDAP (Lightweight Directory Access Protocol)","text":"<p>El LDAP se usa para almacenar informaci\u00f3n de usuarios, grupos y otros objetos de forma jer\u00e1rquica.</p>"},{"location":"Ud4/Ch4_ABM/#archivos-de-configuracion-importantes_1","title":"\ud83d\udcc2 Archivos de Configuraci\u00f3n Importantes","text":"Archivo Descripci\u00f3n <code>/etc/ldap/ldap.conf</code> Configuraci\u00f3n principal de cliente LDAP. <code>/etc/slapd/slapd.conf</code> Configuraci\u00f3n del servidor LDAP (slapd). <code>estructura_basica.ldif</code> Archivo LDIF con la estructura inicial de la base de datos LDAP."},{"location":"Ud4/Ch4_ABM/#comandos-para-administrar-ldap","title":"\ud83d\udd27 Comandos para Administrar LDAP","text":"Comando Descripci\u00f3n <code>sudo dpkg-reconfigure slapd</code> Reconfigurar el servicio slapd (LDAP). <code>sudo slapcat</code> Exportar toda la base de datos LDAP en formato LDIF. <code>ldapadd -x -D \"cn=admin,dc=proyecto-empresa,dc=local\" -w &lt;contrase\u00f1a&gt; -f estructura_basica.ldif</code> A\u00f1adir objetos a la base LDAP desde un archivo LDIF. <code>ldapsearch -x -b \"dc=proyecto-empresa,dc=local\" \"(uid=*profe*)\"</code> Buscar entradas LDAP que coincidan con la expresi\u00f3n <code>(uid=*profe*)</code>."},{"location":"Ud4/Ch4_ABM/#ejemplo-de-archivo-ldif-estructura_basicaldif","title":"\ud83d\udcdc Ejemplo de Archivo LDIF (estructura_basica.ldif)","text":"<pre><code>dn: dc=proyecto-empresa,dc=local\nobjectClass: top\nobjectClass: dcObject\nobjectClass: organization\no: Proyecto Empresa\ndc: proyecto-empresa\n\ndn: ou=people,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: people\n\ndn: ou=groups,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: groups\n</code></pre>"},{"location":"Ud4/Ch4_ABM/#comando-ldapadd","title":"\ud83d\udd10 Comando ldapadd","text":"<pre><code>ldapadd -x -D \"cn=admin,dc=proyecto-empresa,dc=local\" -w ieselcaminas -f estructura_basica.ldif\n</code></pre> <p>Explicaci\u00f3n: - <code>-x</code>: Usa autenticaci\u00f3n simple. - <code>-D</code>: Define el usuario administrador LDAP (distinguished name, DN). - <code>-w</code>: Contrase\u00f1a del usuario LDAP. - <code>-f</code>: Especifica el archivo LDIF a usar para la importaci\u00f3n.</p>"},{"location":"Ud4/Ch4_ABM/#buscar-entradas-con-ldapsearch","title":"\ud83d\udcd8 Buscar Entradas con ldapsearch","text":"<pre><code>ldapsearch -x -b \"dc=proyecto-empresa,dc=local\" \"(uid=*profe*)\"\n</code></pre> <p>Explicaci\u00f3n: - <code>-x</code>: Usa autenticaci\u00f3n simple. - <code>-b</code>: Define la base de b\u00fasqueda (<code>dc=proyecto-empresa,dc=local</code>). - <code>(uid=*profe*)</code>: Expresi\u00f3n de b\u00fasqueda LDAP. Busca todas las entradas cuyo <code>uid</code> contenga \"profe\".  </p>"},{"location":"Ud4/Ch4_ACF/","title":"\ud83c\udf10 Servicios de red DNS y LDAP","text":""},{"location":"Ud4/Ch4_ACF/#1-comandos-de-instalacion","title":"1. \u2699\ufe0f Comandos de instalaci\u00f3n","text":"Comando Explicaci\u00f3n <code>apt-get install dnsutils</code> \ud83d\udd0d Comando para instalar herramientas dig, host y nslookup <code>apt-get install bind9 bind9utils bind9-doc</code> \ud83d\udce1 Comando para instalar un servidor DNS en Debian <code>apt-get install slapd ldap-utils</code> \ud83d\udee1\ufe0f Comando para instalar un servidor OpenLDAP <code>sudo apt-get install phpldapadmin</code> \ud83d\udee0\ufe0f Comando para instalar Phpldapadmin <code>sudo systemctl restart nginx</code> \u267b\ufe0f Reiniciar el servicio de nginx"},{"location":"Ud4/Ch4_ACF/#2-comandos-de-configuracion-y-comprobacion","title":"2. \ud83e\uddf0 Comandos de configuraci\u00f3n y comprobaci\u00f3n","text":"Comando Explicaci\u00f3n <code>sudo named-checkzone deaw.es /etc/bind/db.deaw.es</code> \ud83d\udd27 Comando para comprobar que no hay errores en el archivo de creaci\u00f3n de zona <code>nslookup 3.85.104.173</code> \ud83d\udd0e Comando para consultar el nombre de dominio <code>dig -x 3.85.104.173</code> \ud83d\uddfa\ufe0f Comando para hacer una consulta inversa para obtener el nombre de dominio <code>sudo slapcat</code> \ud83d\udccb Comando para ver la informaci\u00f3n actual de la base de datos <code>sudo dpkg-reconfigure slapd</code> \u2699\ufe0f Comando para configurar nuestro directorio <p>\ud83d\udcdd Ejemplo de archivo de configuraci\u00f3n del archivo named.conf.local: <pre><code>zone \"deaw.es\" {\n        type master;\n        file \"/etc/bind/db.deaw.es\";  //Ruta donde ubicamos nuestro archivo de zona\n};\n</code></pre> \ud83d\udcdd Ejemplo de archivo de creaci\u00f3n de zona: <pre><code>$TTL 1d\n$ORIGIN deaw.es. ; base domain-name\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; A records\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n</code></pre> \ud83d\udcdd Ejemplo de archivo de configuraci\u00f3n de php: <pre><code>$servers-&gt;setValue('server','base',array('dc=daw,dc=ieselcaminas'));\n$servers-&gt;setValue('login','bind_id','cn=admin,dc=daw,dc=ieselcaminas');\n</code></pre></p>"},{"location":"Ud4/Ch4_ACF/#3-comandos-de-ldap","title":"3. \ud83d\udee0\ufe0f Comandos de LDAP","text":"Comando Explicaci\u00f3n <code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f estructura_basica.ldif</code> \ud83d\udcc2 Comando para a\u00f1adir unidades organizativas, usuarios o grupos a partir de un archivo ldif <code>ldapmodify -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f cambiar_usuario.ldif</code> \u270f\ufe0f Comando para modificar un par\u00e1metro de unidades organizativas, usuarios o grupos a partir de un archivo ldif <code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uid=*profe*)\"</code> \ud83d\udd0d Comando para buscar unidades organizativas, usuarios o grupos <code>ldapdelete -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas uid=alu02,ou=usuarios,dc=proyecto-empresa,dc=local</code> \u274c Comando para borrar unidades organizativas, usuarios o grupos <p>\ud83d\udcdd Ejemplo de archivo de creaci\u00f3n de unidades organizativas: <pre><code># Usuarios\ndn: ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: usuarios\n</code></pre></p> <p>\ud83d\udcdd Ejemplo de archivo de creaci\u00f3n de grupos: <pre><code>#Grupo profesores\ndn: cn=profesores,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: profesores\ngidNumber: 10000\n</code></pre> \ud83d\udcdd Ejemplo de archivo de creaci\u00f3n de usuarios: <pre><code># Profe01\ndn: uid=profe01,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe01\ncn: profe01\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/profe01\ngecos: Profe01 DAW\nuserPassword: 123456\n</code></pre></p>"},{"location":"Ud4/Ch4_ACF/#4-comandos-de-autenticacion-apache-contra-ldap","title":"4. \ud83d\udd12 Comandos de Autenticaci\u00f3n Apache contra LDAP","text":"Comando Explicaci\u00f3n <code>sudo a2enmod authnz_ldap</code> \ud83d\udee1\ufe0f Comando para habilitar el m\u00f3dulo de autenticaci\u00f3n <p>\ud83d\udcdd Ejemplo de archivo .htacces: <pre><code>    AuthType Basic\n    AuthName \"Apache LDAP authentication\"\n    AuthBasicProvider ldap\n    AuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub\"\n    Require valid-user\n</code></pre> \ud83d\udcdd Ejemplo de archivo ldap.conf: <pre><code>    BINDDN cn=admin,dc=daw,dc=ieselcaminas\n    BINDPW ieselcaminas\n</code></pre></p>"},{"location":"Ud4/Ch4_ACV/","title":"CH4 - ACV","text":"<p>DNS traduce nombres de dominio a direcciones IP y viceversa.</p> <p>Sistemas de nombre planos: En los albores de las redes de ARPANET, los nombres los equipos se centralizaban en un archivo llamado host.txt o /etc/hosts en Linux, que incluia el nombre del equipo y su IP. A esto es lo que se conoce como un sistema de nombres plano.</p> <p>Elementos de DNS: - Dominios: Etiquetas separadas por puntos.      Ejemplo: www.google.es         - www -&gt; Dominio de tercer nivel.         - google -&gt; Dominio de segundo nivel.         - es -&gt; Dominio de primer nivel. - Zonas:      - Son gestionadas por servidores, los cuales tienen informaci\u00f3n completa sobre ellas.     - Son almacenadas en archivos de texto o bases de datos.</p> <p>Tipos de servidores DNS: - Maestro o primario: Gestiona archivos de zona. - Esclavo o secundario: Extrae los datos del maestro mediante la transferencia de zona. - Cach\u00e9: Sirven para mejorar los tiempos de respuesta de las consultas, reducir la carga de los equipos y disminuir el tr\u00e1fico de red. - Forwarder: Son utilizados para minimizar las consultas y el tr\u00e1fico de peticiones DNS desde una red hacia Internet. - Solo autorizado: Es un servidor primario y/o secundario que responde \u00fanicamente sobre sus zonas. - Ra\u00edz: Autorizado para el dominio ra\u00edz. Existen 13 servidores ra\u00edz en el mundo.</p> <p>Tipos de consulta: - Recursiva: Da una respuesta completa. - Iterativas: Proporciona una respuesta parcial.</p> <p>Resoluci\u00f3n Inversa: Obtienes informaci\u00f3n de un nombre de dominio preguntando por la direcci\u00f3n IP en vez de preguntar por el nombre de domino.</p> <p>Herramientas de DNS: - Nslookup: Diagnosticos en los servidores. - Dig: Consultas avanzadas en los servidores. - Host: Traduce nombres de servidores y diagn\u00f3sticos. - Whois: Informa sobre los registros de dominios.</p> <p>LDAP: Protocolo que ofrece el acceso a un servicio de directorio implementado sobre un entorno de red, con el objeto de acceder a una determinada informaci\u00f3n.</p> <p>OpenLDAP: Es una implementaci\u00f3n libre de LDAP.</p> <p>\u00bfComo funcionan?: Se basa en entradas(un conjunto de atributos identificados por un nombre global \u00fanico). Estas,  se utilizan para identificarla de forma espec\u00edfica.</p> <p>Integraci\u00f3n del servicio de directorio con otros servicios: Se usan como repositorio en el cual almacenar la informaci\u00f3n que varios servidores deben compartir, por ejemplo: la configuraci\u00f3n, informaci\u00f3n sobre el control de acceso, etc.</p> <p>Formato LDIF: Es el est\u00e1ndar para representar entradas del directorio en formato texto ASCII. Este sistema destaca por su capacidad para centralizar la gesti\u00f3n de datos en redes complejas, mejorando la eficiencia, seguridad y consistencia de la informaci\u00f3n.</p>"},{"location":"Ud4/Ch4_ALS/","title":"Ultimate Cheat Sheet: Servicios de Red (DNS y LDAP)","text":"<p>Esta referencia definitiva cubre conceptos clave, configuraciones, y comandos esenciales para la administraci\u00f3n de los servicios DNS y LDAP.</p>"},{"location":"Ud4/Ch4_ALS/#1-dns-domain-name-system","title":"1. DNS (Domain Name System)","text":"<p>El DNS traduce nombres de dominio a direcciones IP, facilitando la navegaci\u00f3n en redes.</p>"},{"location":"Ud4/Ch4_ALS/#conceptos-clave","title":"Conceptos Clave","text":"<ul> <li>Resoluci\u00f3n de nombres: Traduce dominios a IPs.</li> <li>Jerarqu\u00eda: Estructura en \u00e1rbol invertido.</li> <li>Zonas: Segmentos del espacio de nombres administrados por servidores.</li> <li>Registros de Recursos (RR):</li> <li>SOA: Informaci\u00f3n de la zona.</li> <li>NS: Servidores de nombres autorizados.</li> <li>A/AAAA: Asociaci\u00f3n de dominios con direcciones IPv4/IPv6.</li> <li>CNAME: Alias de dominios.</li> <li>MX: Servidores de correo.</li> <li>PTR: Resoluci\u00f3n inversa (IP -&gt; dominio).</li> <li>TXT: Informaci\u00f3n adicional (e.g., claves DKIM).</li> </ul>"},{"location":"Ud4/Ch4_ALS/#archivos-clave","title":"Archivos Clave","text":"Archivo Descripci\u00f3n <code>/etc/bind/named.conf</code> Archivo principal de configuraci\u00f3n. <code>/etc/bind/named.conf.options</code> Opciones globales. <code>/etc/bind/named.conf.local</code> Definici\u00f3n de zonas locales. <code>/etc/bind/db.example.com</code> Archivo de zona para registros DNS."},{"location":"Ud4/Ch4_ALS/#ejemplo-de-configuracion-de-zona","title":"Ejemplo de Configuraci\u00f3n de Zona","text":"<p>Archivo <code>/etc/bind/db.example.com</code>: <pre><code>$TTL 1d\n$ORIGIN example.com.\n@   IN  SOA     ns1.example.com. admin.example.com. (\n                  2024010101 ; Serial\n                  8H         ; Refresh\n                  2H         ; Retry\n                  4W         ; Expire\n                  1D )       ; Minimum TTL\n    IN  NS      ns1.example.com.\nns1 IN  A       192.168.1.1\nwww IN  A       192.168.1.2\n</code></pre></p>"},{"location":"Ud4/Ch4_ALS/#comandos-esenciales","title":"Comandos Esenciales","text":"Comando Descripci\u00f3n <code>sudo named-checkconf</code> Verifica la sintaxis de configuraci\u00f3n DNS. <code>sudo named-checkzone example.com /etc/bind/db.example.com</code> Valida un archivo de zona. <code>host &lt;dominio&gt;</code> Consulta r\u00e1pida de registros DNS. <code>dig &lt;dominio&gt;</code> Detalles avanzados de resoluci\u00f3n DNS. <code>nslookup &lt;dominio&gt;</code> Resoluci\u00f3n interactiva/no interactiva."},{"location":"Ud4/Ch4_ALS/#2-ldap-lightweight-directory-access-protocol","title":"2. LDAP (Lightweight Directory Access Protocol)","text":"<p>El LDAP permite gestionar informaci\u00f3n jer\u00e1rquica sobre usuarios, grupos y recursos.</p>"},{"location":"Ud4/Ch4_ALS/#conceptos-clave_1","title":"Conceptos Clave","text":"<ul> <li>DIT (Directory Information Tree): Estructura jer\u00e1rquica de datos.</li> <li>DN (Distinguished Name): Identificador \u00fanico de una entrada.</li> <li>Autenticaci\u00f3n y Autorizaci\u00f3n: Facilita el control de acceso centralizado.</li> </ul>"},{"location":"Ud4/Ch4_ALS/#archivos-clave_1","title":"Archivos Clave","text":"Archivo Descripci\u00f3n <code>/etc/ldap/ldap.conf</code> Configuraci\u00f3n del cliente LDAP. <code>/etc/slapd/slapd.conf</code> Configuraci\u00f3n del servidor LDAP. <code>estructura_basica.ldif</code> Archivo LDIF para inicializar la base de datos."},{"location":"Ud4/Ch4_ALS/#ejemplo-de-archivo-ldif","title":"Ejemplo de Archivo LDIF","text":"<p>Estructura b\u00e1sica: <pre><code>dn: dc=example,dc=com\nobjectClass: top\nobjectClass: dcObject\nobjectClass: organization\no: Example Organization\ndc: example\n\ndn: ou=users,dc=example,dc=com\nobjectClass: organizationalUnit\nou: users\n\ndn: uid=user01,ou=users,dc=example,dc=com\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: user01\ncn: User One\nsn: One\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 1001\nhomeDirectory: /home/user01\nuserPassword: {SSHA}encrypted_password\n</code></pre></p>"},{"location":"Ud4/Ch4_ALS/#comandos-esenciales_1","title":"Comandos Esenciales","text":"Comando Descripci\u00f3n <code>sudo dpkg-reconfigure slapd</code> Reconfigura el servidor LDAP. <code>sudo slapcat</code> Exporta la base de datos LDAP a formato LDIF. <code>ldapadd -x -D \"cn=admin,dc=example,dc=com\" -w &lt;password&gt; -f &lt;archivo.ldif&gt;</code> Agrega entradas LDAP desde un archivo LDIF. <code>ldapsearch -x -b \"dc=example,dc=com\" \"(uid=user01)\"</code> Realiza b\u00fasquedas en la base LDAP. <code>ldapdelete -x -D \"cn=admin,dc=example,dc=com\" -w &lt;password&gt; &lt;dn&gt;</code> Elimina entradas LDAP."},{"location":"Ud4/Ch4_ALS/#modificar-contrasenas","title":"Modificar Contrase\u00f1as","text":"<p>Ejemplo de archivo LDIF para cambiar contrase\u00f1a: <pre><code>dn: uid=user01,ou=users,dc=example,dc=com\nchangetype: modify\nreplace: userPassword\nuserPassword: nuevaContrase\u00f1a\n</code></pre> Comando: <pre><code>ldapmodify -x -D \"cn=admin,dc=example,dc=com\" -w &lt;password&gt; -f modificar.ldif\n</code></pre></p>"},{"location":"Ud4/Ch4_ALS/#3-autenticacion-ldap-en-servidores-web","title":"3. Autenticaci\u00f3n LDAP en Servidores Web","text":""},{"location":"Ud4/Ch4_ALS/#apache","title":"Apache","text":"<ol> <li>Habilitar m\u00f3dulos: <pre><code>sudo a2enmod authnz_ldap\nsudo systemctl restart apache2\n</code></pre></li> <li>Configurar VirtualHost: <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName example.com\n    &lt;Directory /var/www/html/protegido&gt;\n        AuthType Basic\n        AuthName \"Autenticaci\u00f3n LDAP\"\n        AuthBasicProvider ldap\n        AuthLDAPURL \"ldap://ldap.example.com:389/ou=users,dc=example,dc=com?uid\"\n        AuthLDAPBindDN \"cn=admin,dc=example,dc=com\"\n        AuthLDAPBindPassword \"adminPassword\"\n        Require valid-user\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre></li> </ol>"},{"location":"Ud4/Ch4_ALS/#nginx","title":"NGINX","text":"<ol> <li>Descargar e instalar el m\u00f3dulo LDAP: <pre><code>wget https://example.com/nginx-auth-ldap.deb\nsudo dpkg -i nginx-auth-ldap.deb\n</code></pre></li> <li>Configurar nginx.conf: <pre><code>http {\n    ldap_server example_ldap {\n        url ldap://ldap.example.com/ou=users,dc=example,dc=com?uid?sub;\n        binddn \"cn=admin,dc=example,dc=com\";\n        binddn_passwd \"adminPassword\";\n        group_attribute member;\n        group_attribute_is_dn on;\n        require valid_user;\n    }\n    include /etc/nginx/sites-enabled/*;\n}\n</code></pre></li> <li>Configurar el sitio: <pre><code>server {\n    listen 80;\n    server_name example.com;\n    location / {\n        auth_ldap \"Protected Area\";\n        auth_ldap_servers example_ldap;\n    }\n}\n</code></pre></li> </ol>"},{"location":"Ud4/Ch4_BSO/","title":"Cheatshet 4 - Servicios de red DNS y LDAP","text":""},{"location":"Ud4/Ch4_BSO/#servicio-dns-domain-name-system","title":"\ud83d\udcc4 Servicio DNS (Domain Name System)","text":""},{"location":"Ud4/Ch4_BSO/#herramientas-utiles-para-gestionar-dns","title":"\ud83d\udd27Herramientas \u00fatiles para gestionar DNS","text":"<pre><code>sudo apt-get install dnsutils  #Instalar estas herramientas en Debian\n</code></pre> <ul> <li> <p><code>nslookup</code>: Se utiliza para saber si un servidor DNS resuelve correctamente los nombres DNS y las direcciones IP.</p> <ul> <li>nslookup cisco.com</li> </ul> </li> </ul> <pre><code>Server:     1.1.1.1\nAddress:    1.1.1.1#53\n\nNon-authoritative answer:\nName:   cisco.com\nAddress: 72.163.4.185\nName:   cisco.com\nAddress: 2001:420:1101:1::185\n</code></pre> <ul> <li> <p><code>dig</code>: Utilizada para solucionar problemas de DNS gracias a su facilidad de uso y claridad en la presentaci\u00f3n de la informaci\u00f3n.</p> <ul> <li>dig cisco.com</li> </ul> </li> </ul> <pre><code>; &lt;&lt;&gt;&gt; DiG 9.20.3 &lt;&lt;&gt;&gt; cisco.com\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 28149\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 1232\n;; QUESTION SECTION:\n;cisco.com.         IN  A\n\n;; ANSWER SECTION:\ncisco.com.      1621    IN  A   72.163.4.185\n\n;; Query time: 13 msec\n;; SERVER: 1.1.1.1#53(1.1.1.1) (UDP)\n;; WHEN: Sat Dec 14 16:40:58 CET 2024\n;; MSG SIZE  rcvd: 54\n</code></pre> <ul> <li> <p><code>host</code>: Herramienta CLI sencilla y f\u00e1cil de usar para realizar consultas DNS.</p> <ul> <li>host cisco.com</li> </ul> </li> </ul> <pre><code>cisco.com has address 72.163.4.185\ncisco.com has IPv6 address 2001:420:1101:1::185\ncisco.com mail is handled by 10 alln-mx-01.cisco.com.\ncisco.com mail is handled by 20 rcdn-mx-01.cisco.com.\ncisco.com mail is handled by 30 aer-mx-01.cisco.com.\n</code></pre> <ul> <li> <p><code>whois</code>: Aunque no es una herramienta de diagn\u00f3stico DNS si que nos ofrece informaci\u00f3n sobre el registro del dominio.</p> <ul> <li>whois cisco.com</li> </ul> </li> </ul> <pre><code>Domain Name: CISCO.COM\n   Registry Domain ID: 4987030_DOMAIN_COM-VRSN\n   Registrar WHOIS Server: whois.markmonitor.com\n   Registrar URL: http://www.markmonitor.com\n   Updated Date: 2024-04-13T09:39:41Z\n   Creation Date: 1987-05-14T04:00:00Z\n   Registry Expiry Date: 2025-05-15T04:00:00Z\n   Registrar: MarkMonitor Inc.\n   Registrar IANA ID: 292\n   Registrar Abuse Contact Email: abusecomplaints@markmonitor.com\n   Registrar Abuse Contact Phone: +1.2086851750\n   Domain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited\n   Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited\n   Domain Status: clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited\n   Domain Status: serverDeleteProhibited https://icann.org/epp#serverDeleteProhibited\n   Domain Status: serverTransferProhibited https://icann.org/epp#serverTransferProhibited\n   Domain Status: serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited\n   Name Server: NS1.CISCO.COM\n   Name Server: NS2.CISCO.COM\n   Name Server: NS3.CISCO.COM\n   DNSSEC: unsigned\n   URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/\n&gt;&gt;&gt; Last update of whois database: 2024-12-14T15:42:34Z &lt;&lt;&lt;\n</code></pre>"},{"location":"Ud4/Ch4_BSO/#instalacion-de-un-servidor-dns","title":"\ud83d\udcbeInstalaci\u00f3n de un servidor DNS","text":"<pre><code>sudo apt-get install bind9 bind9utils bind9-doc \n</code></pre> <p><code>sudo nano /etc/systemd/resolved.conf</code>: cambiar el DNS al que consulta nuestro servidor.</p> <pre><code>[Resolve]\nDNS=127.0.0.1\n</code></pre> <p><code>sudo systemctl restart systemd-resolved</code>: Aplica la configuraci\u00f3n</p>"},{"location":"Ud4/Ch4_BSO/#configuracion-de-un-servidor-dns","title":"\u270f\ufe0fConfiguraci\u00f3n de un servidor DNS","text":"<ul> <li> <p><code>/etc/bind/named.conf</code>: Archivo de configuraci\u00f3n principal</p> <ul> <li>Sirve simplemente para aglutinar o agrupar a los archivos de configuraci\u00f3n que usaremos.</li> </ul> </li> </ul> <pre><code>// This is the primary configuration file for the BIND DNS server named.\n//\n// Please read /usr/share/doc/bind9/README.Debian for information on the\n// structure of BIND configuration files in Debian, *BEFORE* you customize\n// this configuration file.\n//\n// If you are just adding zones, please do that in /etc/bind/named.conf.local\n\ninclude \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\ninclude \"/etc/bind/named.conf.default-zones\";\n</code></pre> <ul> <li> <p><code>named.conf.options</code>: Se encarga de contener las configuraciones globales.</p> </li> <li> <p><code>named.conf.local</code>: En este archivo configuraremos aspectos relativos a nuestras zonas.</p> </li> <li> <p><code>named.conf.default-zones</code>: Se encarga de definir las zonas predeterminadas.</p> </li> </ul>"},{"location":"Ud4/Ch4_BSO/#creacion-de-un-archivo-de-zona","title":"\ud83d\udcc4Creaci\u00f3n de un archivo de zona","text":"<p><code>sudo nano named.conf.local</code></p> <pre><code>//\n// Do any local configuration here\n//\n\n// Consider adding the 1918 zones here, if they are not used in your\n// organization\n//include \"/etc/bind/zones.rfc1918\";\n\nzone \"deaw.es\" {\n        type master;\n        file \"/etc/bind/db.deaw.es\";  //Ruta donde ubicamos nuestro archivo de zona\n};\n</code></pre> <p><code>sudo nano /etc/bind/db.deaw.es</code></p> <p>```/etc/bind/db.deaw.es $TTL 1d $ORIGIN deaw.es. ; base domain-name @   IN  SOA     ns1.deaw.es. admin.deaw.es. (                   2023112301  ; Serial                   8H          ; Refresh                   2H          ; Retry                   4W          ; Expire                   1D )        ; Minimum TTL ; Name Servers     IN  NS      ns1.deaw.es. ; A records ns1 IN  A       3.85.104.173 www IN  A       3.85.104.173 <pre><code>- `$TTL`: Tiempo de vida predeterminado para los registros de la zona.\n\n- `SOA (Start of Authority)`: Indica informaci\u00f3n sobre la zona, como el nombre del servidor primario, el contacto del administrador y detalles de tiempo.\n\n- `NS`: Registra los servidores de nombres autoritativos para la zona.\n\n- `A`: Registra la direcci\u00f3n IP asociada con un nombre de host espec\u00edfico.\n\n#### \ud83d\udd0eComprobaciones importantes de la configuraci\u00f3n\n\n- `named-checkconf`: Se utiliza para comprobar que no hay errores en la configuraci\u00f3n.\n\n- `named-checkzone deaw.es /etc/bind/db.deaw.es`: Comprueba si la zona configurada es correcta.\n\n```bash\n$ sudo named-checkzone deaw.es /etc/bind/db.deaw.es\nzone deaw.es/IN: loaded serial 2023112301\nOK\n</code></pre></p> <ul> <li><code>sudo systemctl restart systemd-resolved</code>: Si todo va correctamente, se reinicia el servicio.</li> </ul>"},{"location":"Ud4/Ch4_BSO/#zona-de-resolucion-inversa","title":"\ud83d\udcc3Zona de resoluci\u00f3n inversa","text":"<pre><code># /etc/bind/named.conf.local\nzone \"104.85.3.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.3.85.104\";  # Ruta al archivo de zona inversa\n};\n</code></pre> <pre><code># /etc/bind/db.3.85.104\n$TTL 1d\n$ORIGIN 104.85.3.IN-ADDR.ARPA.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n\n; Name Servers\n    IN  NS      ns1.deaw.es.\n\n; PTR record\n173 IN  PTR     ns1.deaw.es. ; fully qualified domain name (FQDN)\n</code></pre>"},{"location":"Ud4/Ch4_BSO/#servicio-de-directorio-ldap-lightweight-directory-access-protocol","title":"\ud83d\udd10Servicio de directorio LDAP (Lightweight Directory Access Protocol)","text":""},{"location":"Ud4/Ch4_BSO/#instalacion-del-servidor-ldap","title":"\ud83d\udcbeInstalaci\u00f3n del servidor LDAP","text":"<ul> <li> <p><code>sudo apt install slapd ldap-utils</code>: Instala el servidor LDAP</p> </li> <li> <p><code>sudo dpkg-reconfigure slapd</code>: Te permite configurar desde cero el servidor LDAP o reconfigurarlo si ya lo ten\u00edas.</p> </li> </ul>"},{"location":"Ud4/Ch4_BSO/#administracion-del-servidor-ldap","title":"\ud83d\udccbAdministraci\u00f3n del servidor LDAP","text":"<ul> <li> <p><code>sudo slapcat</code>: Te permite ver la informaci\u00f3n actual que tienes configurada en LDAP.</p> </li> <li> <p><code>sudo apt-get install phpldapadmin</code>: Instala phpldapadmin, con lo que podemos configurar nuestro servidor ldap desde una interfaz gr\u00e1fica desde un navegador.</p> </li> </ul> <pre><code>#/etc/phpldapadmin/config.php --&gt; Cambiamos el DIT (Directory Information Tree)\n\n- $servers-&gt;;setValue('server','base',array('dc=example,dc=com'));\n- $servers-&gt;setValue('login','bind_id','cn=admin,dc=example,dc=com');\n\n+ $servers-&gt;setValue('server','base',array('dc=daw,dc=ieselcaminas'));\n+ $servers-&gt;setValue('login','bind_id','cn=admin,dc=daw,dc=ieselcaminas');\n</code></pre>"},{"location":"Ud4/Ch4_BSO/#configuracion-del-servidor-ldap","title":"\u270f\ufe0fConfiguraci\u00f3n del servidor LDAP","text":"<ul> <li><code>/etc/ldap/ldap.conf</code>: Configuraci\u00f3n del cliente LDAP.</li> <li><code>/etc/slapd/slapd.conf</code>: Configuraci\u00f3n del servidor LDAP.</li> <li><code>archivo.ldif</code>: Aqu\u00ed va la configuraci\u00f3n de la estructura organizativa que queremos a\u00f1adir en nuestro servidor LDAP, o definir grupos o usuarios.</li> </ul> <pre><code># estructura_basica.ldif --&gt; Estructura organizativa b\u00e1sica LDAP\n\n# Usuarios\ndn: ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: usuarios\n\n# Grupos\ndn: ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: grupos\n</code></pre> <ul> <li><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f estructura_basica.ldif</code>: Incorporar los cambios</li> </ul> <pre><code># grupos.ldif --&gt; Creaci\u00f3n de grupos\n\n#Grupo profesores\ndn: cn=profesores,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: profesores\ngidNumber: 10000\n\n#Grupo alumnos\ndn: cn=alumnos,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: alumnos   \ngidNumber: 10001\n</code></pre> <ul> <li><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f grupos.ldif</code>: Incorporar grupos</li> </ul> <pre><code># profesores.ldif --&gt; Creaci\u00f3n de usuarios\n\n# Profe01\ndn: uid=profe01,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe01\ncn: profe01\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/profe01\ngecos: Profe01 DAW\nuserPassword: 123456\n\n# Profe02\ndn: uid=profe02,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe02\ncn: profe02\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1002\ngidNumber: 10000\nhomeDirectory: /home/profe02\ngecos: Profe02 DAW\nuserPassword: 123456\n</code></pre> <ul> <li><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f profesores.ldif</code>: Incorporar usuarios</li> </ul>"},{"location":"Ud4/Ch4_BSO/#explicacion-del-comando","title":"\u27bfExplicaci\u00f3n del comando","text":"<ul> <li> <p><code>ldapadd -x -D \"cn=admin,dc=proyecto-empresa,dc=local\" -w ieselcaminas -f estructura_basica.ldif</code></p> <ul> <li><code>x</code>: Realiza la autenticaci\u00f3n en modo simple.</li> <li><code>D</code>: Indica el usuario administrador de LDAP (nombre distinguido o DN).</li> <li><code>w</code>: Proporciona la contrase\u00f1a del usuario LDAP.</li> <li><code>f</code>: Define el archivo LDIF que se utilizar\u00e1 para la importaci\u00f3n.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_BSO/#modificacion-de-objetos","title":"\ud83d\udd29Modificaci\u00f3n de objetos","text":"<pre><code># cambiar_usuario.ldif\n\n# Cambiar contrase\u00f1a Usuario\ndn: uid=alu01,ou=usuarios,dc=proyecto-empresa,dc=local\nchangetype: modify\nreplace: userPassword\nuserPassword: 654321\n</code></pre> <ul> <li><code>ldapmodify -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f cambiar_usuario.ldif</code></li> </ul>"},{"location":"Ud4/Ch4_BSO/#busqueda","title":"\ud83d\udd0dB\u00fasqueda","text":"<ul> <li><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uid=*profe*)\"</code>: Buscar todos los profesores usando el uid</li> <li><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uidNumber=1002)\"</code>: Buscar usando el uidNumber</li> </ul>"},{"location":"Ud4/Ch4_BSO/#eliminacion","title":"\ud83d\udd28Eliminaci\u00f3n","text":"<ul> <li><code>ldapdelete -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas uid=alu02,ou=usuarios,dc=proyecto-empresa,dc=local</code>: Eliminamos el usuario alu02</li> </ul>"},{"location":"Ud4/Ch4_DGD/","title":"\ud83c\udf10 Configuraci\u00f3n y Uso de DNS y LDAP","text":""},{"location":"Ud4/Ch4_DGD/#comandos-utiles-para-servidor-dns","title":"\ud83d\udda7 Comandos \u00datiles para Servidor DNS","text":""},{"location":"Ud4/Ch4_DGD/#herramientas-de-diagnostico","title":"Herramientas de Diagn\u00f3stico","text":"Comando Descripci\u00f3n <code>host &lt;dominio&gt;</code> Consulta r\u00e1pida de registros DNS. <code>dig &lt;dominio&gt;</code> Muestra detalles avanzados de resoluci\u00f3n. <code>nslookup &lt;dominio&gt;</code> Resuelve nombres interactiva o no interactivamente. <p>Ejemplo de uso: <pre><code>host cisco.com\ndig cisco.com\nnslookup cisco.com\n</code></pre></p>"},{"location":"Ud4/Ch4_DGD/#configuracion-basica-del-servidor","title":"Configuraci\u00f3n B\u00e1sica del Servidor","text":"<ul> <li> <p>Archivo principal: /etc/bind/named.conf.</p> <ul> <li>Incluye configuraciones con:</li> </ul> <pre><code>include \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\ninclude \"/etc/bind/named.conf.default-zones\";\n</code></pre> </li> <li> <p>Permitir consultas externas:</p> </li> </ul> <pre><code>allow-query { any; };\n</code></pre>"},{"location":"Ud4/Ch4_DGD/#configuracion-de-zonas","title":"Configuraci\u00f3n de Zonas","text":"<ul> <li>Declaraci\u00f3n de zona directa:</li> </ul> <pre><code>zone \"example.com\" {\n    type master;\n    file \"/etc/bind/db.example.com\";\n};\n</code></pre> <ul> <li>Archivo de zona (/etc/bind/db.example.com):</li> </ul> <pre><code>$TTL 1d\n@   IN  SOA     ns1.example.com. admin.example.com. (\n                2024010101 ; Serial\n                8H         ; Refresh\n                2H         ; Retry\n                4W         ; Expire\n                1D )       ; Minimum TTL\n    IN  NS      ns1.example.com.\nns1 IN  A       192.168.1.1\nwww IN  A       192.168.1.2\n</code></pre> <ul> <li>Comprobar configuraci\u00f3n:</li> </ul> <pre><code>sudo named-checkzone example.com /etc/bind/db.example.com\n</code></pre>"},{"location":"Ud4/Ch4_DGD/#resolucion-inversa","title":"Resoluci\u00f3n Inversa","text":"<ul> <li>Zona inversa:</li> </ul> <pre><code>zone \"1.168.192.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.192.168.1\";\n};\n</code></pre> <ul> <li>Archivo de zona inversa (/etc/bind/db.192.168.1):</li> </ul> <pre><code>$TTL 1d\n@   IN  SOA     ns1.example.com. admin.example.com. (\n                2024010101 ; Serial\n                8H         ; Refresh\n                2H         ; Retry\n                4W         ; Expire\n                1D )       ; Minimum TTL\n    IN  NS      ns1.example.com.\n1   IN  PTR     ns1.example.com.\n</code></pre> <ul> <li>Consultar resoluci\u00f3n inversa:</li> </ul> <pre><code>dig -x 192.168.1.1\n</code></pre>"},{"location":"Ud4/Ch4_DGD/#comandos-utiles-para-ldap","title":"\ud83d\udcc2 Comandos \u00datiles para LDAP","text":""},{"location":"Ud4/Ch4_DGD/#gestion-de-objetos-con-ldif","title":"\ud83d\udcc1 Gesti\u00f3n de Objetos con LDIF","text":"Comando Descripci\u00f3n ldapadd -x -D  -w  -f  A\u00f1adir objetos al directorio. ldapmodify -x -D  -w  -f  Modificar objetos existentes. ldapdelete -x -D  -w  Eliminar objetos del directorio."},{"location":"Ud4/Ch4_DGD/#ejemplo-de-archivo-ldif-para-usuarios","title":"Ejemplo de archivo LDIF para usuarios:","text":"<pre><code>dn: uid=profe01,ou=usuarios,dc=example,dc=com\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe01\ncn: Profesor01\nsn: Departamento01\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/profe01\nloginShell: /bin/bash\nuserPassword: {SSHA}contrase\u00f1aEncriptada\n</code></pre>"},{"location":"Ud4/Ch4_DGD/#consultas-con-ldap","title":"\ud83d\udd0d Consultas con LDAP","text":"Comando Descripci\u00f3n ldapsearch -x -b  Buscar en la base de datos. <ul> <li> <p>Filtros comunes:</p> </li> <li> <p>Buscar usuarios con \"profe\" en su UID:</p> </li> </ul> <pre><code>ldapsearch -x -b dc=example,dc=com \"(uid=*profe*)\"\n</code></pre> <ul> <li>Buscar usuarios con GID 10001:</li> </ul> <pre><code>ldapsearch -x -b dc=example,dc=com \"(gidNumber=10001)\"\n</code></pre>"},{"location":"Ud4/Ch4_DGD/#modificaciones","title":"\ud83d\udcdc Modificaciones","text":"<ul> <li> <p>Cambiar contrase\u00f1a de un usuario:</p> </li> <li> <p>Archivo LDIF:</p> </li> </ul> <pre><code>dn: uid=profe01,ou=usuarios,dc=example,dc=com\nchangetype: modify\nreplace: userPassword\nuserPassword: nuevaContrase\u00f1a\n</code></pre> <ul> <li>Comando:</li> </ul> <pre><code>ldapmodify -x -D cn=admin,dc=example,dc=com -w adminPassword -f modificar.ldif\n</code></pre>"},{"location":"Ud4/Ch4_DGD/#autenticacion-con-ldap-en-apache","title":"\ud83d\udd12 Autenticaci\u00f3n con LDAP en Apache","text":""},{"location":"Ud4/Ch4_DGD/#configuracion-de-apache-para-ldap","title":"Configuraci\u00f3n de Apache para LDAP","text":"<ol> <li>Habilitar m\u00f3dulos necesarios: <pre><code>sudo a2enmod authnz_ldap\nsudo systemctl restart apache2\n</code></pre></li> <li>Configurar el archivo de VirtualHost: <pre><code>&lt;VirtualHost *:80&gt;\nServerName example.com\n\n    &lt;Directory /var/www/html/protegido&gt;\n        AuthType Basic\n        AuthName \"Autenticaci\u00f3n LDAP\"\n        AuthBasicProvider ldap\n        AuthLDAPURL \"ldap://ldap.example.com:389/ou=usuarios,dc=example,dc=com?uid\"\n        AuthLDAPBindDN \"cn=admin,dc=example,dc=com\"\n        AuthLDAPBindPassword \"adminPassword\"\n        Require valid-user\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre></li> </ol>"},{"location":"Ud4/Ch4_DGD/#autenticacion-con-ldap-en-nginx","title":"\ud83d\udd12 Autenticaci\u00f3n con LDAP en NGINX","text":""},{"location":"Ud4/Ch4_DGD/#configuracion-de-nginx-para-ldap","title":"Configuraci\u00f3n de NGINX para LDAP","text":"<ol> <li> <p>Habilitar m\u00f3dulos necesarios:</p> <p>Primero es necesario descargar los m\u00f3dulos, ya que Nginx por defecto no los tiene:</p> <p><pre><code>wget https://jmunozji.github.io/DAW/Ud4%20Servicios%20de%20red%20DNS%20y%20LDAP/P5/libnginx-mod-http-auth-ldap_1.0.0-1_amd64.deb\n\nsudo dpkg -i libnginx-mod-http-auth-ldap_1.0.0-1_amd64.deb\n</code></pre> 2. Configurar los archivos necesarios:</p> </li> <li> <p>Modificamos nginx.conf:</p> </li> </ol> <pre><code>http {\n    ldap_server mi_servidor_ldap {\n        url ldap://IPSERVIDOR/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub;\n        binddn \"cn=admin,dc=daw,dc=ieselcaminas\";\n        binddn_passwd \"ieselcaminas\";\n        group_attribute member;\n        group_attribute_is_dn on;\n\n        require valid_user;\n    }\n\n    include /etc/nginx/sites-enabled/*;\n}\n</code></pre> <ul> <li>A\u00f1adimos la configuraci\u00f3n al sitio:</li> </ul> <pre><code>server {\n    listen 80;\n    server_name sitioldap;\n    root /var/www/sitioldap;\n    index index.html;\n\n    # Configuraci\u00f3n LDAP\n    location / {\n        try_files $uri $uri/ =404;\n        auth_ldap \"Protected Area\";\n        auth_ldap_servers mi_servidor_ldap;\n    }\n}\n</code></pre>"},{"location":"Ud4/Ch4_DMP/","title":"\ud83d\udcdd UD4 - Servicios de red DNS y LDAP - Cheatsheet","text":"<p>David Maratrat Pons</p>"},{"location":"Ud4/Ch4_DMP/#bind9","title":"\ud83e\uddd1\u200d\ud83d\udcbb Bind9","text":"Comando Descripci\u00f3n <code>sudo apt-get install bind9 bind9utils bind9-doc</code> <code>Instala el servicio DNS de bind9</code> <code>named-checkconf</code> <code>Comprueba la sintaxis de los archivos .conf</code> <code>named-checkzone davidmaratrat.local db.davidmaratrat.local</code> <code>Comprueba la existencia del dominio en el archivo</code> --- ### \ud83d\udee0\ufe0f Configuraci\u00f3n Bind9 - #### named.conf <pre><code>include \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\n</code></pre> - #### named.conf.local <pre><code>zone \"davidmaratrat.local\" {\ntype master;\nfile \"/etc/bind/db.davidmaratrat.local\";  // Archivo de zona para la zona local\n};\n\nzone \"0.0.127.in-addr.arpa\" {\ntype master;\nfile \"/etc/bind/db.127\";  // Configuraci\u00f3n para resoluci\u00f3n inversa (opcional)\n};\n</code></pre> - #### named.conf.options <pre><code>options {\ndirectory \"/var/cache/bind\";  // Directorio de almacenamiento de cache de DNS\n\n// Configuraci\u00f3n b\u00e1sica para permitir consultas de cualquier fuente\nallow-query { any; };\n\n// Configuraci\u00f3n de reenv\u00edo a servidores DNS p\u00fablicos\nforwarders {\n    8.8.8.8;  // Servidor DNS de Google\n    8.8.4.4;  // Otro servidor DNS de Google\n};\n\ndnssec-validation auto;\n\nlisten-on { any; };  // Escuchar en todas las interfaces\nlisten-on-v6 { any; };  // Escuchar en IPv6\n};\n</code></pre> - #### db.davidmaratrat.local <pre><code>$TTL    604800\n$ORIGIN davidmaratrat.local.\n@       IN      SOA     davidmaratrat.local. admin.davidmaratrat.local. (\n2024121201 ; Serial\n604800     ; Refresh\n86400      ; Retry\n2419200    ; Expire\n604800 )   ; Negative Cache TTL\n;\n\n       IN      NS      practicaservicios.davidmaratrat.local.\n\npracticaservicios.davidmaratrat.local. IN A 127.0.0.1\nldap.davidmaratrat.local.              IN CNAME practicaservicios.davidmaratrat.local.\n</code></pre> - #### db.127 <pre><code>$TTL 1d\n$ORIGIN 0.0.127.IN-ADDR.ARPA.\n@   IN  SOA     ns1.davidmaratrat.local. admin.davidmaratrat.local. (\n                2023121201  ; Serial\n                8H          ; Refresh\n                2H          ; Retry\n                4W          ; Expire\n                1D )        ; Minimum TTL\n\n; Name Servers\nIN  NS      ns1.davidmaratrat.local.\n\n; PTR record\n1 IN  PTR     ns1.davidmaratrat.local. ; fully qualified domain name (FQDN)\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#dockerizacion-de-un-bind9","title":"\ud83d\udc33 Dockerizaci\u00f3n de un BIND9","text":"<pre><code>docker run -d \n    --name=docker-dns \n    --publish 53:53/udp \n    --publish 53:53/tcp \n    internetsystemsconsortium/bind9:9.18\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#ldap","title":"\ud83e\uddd1\u200d\ud83d\udcbb LDAP","text":"Comando Descripci\u00f3n <code>sudo apt-get install slapd ldap-utils</code> <code>Instala el servicio LDAP</code> <code>sudo dpkg-reconfigure slapd</code> <code>Configura el servicio una vez instalado</code> <code>sudo apt-get install phpldapadmin</code> <code>Instala la herramienta web para poder configurar el LDAP de manera sencilla</code> --- ### \ud83d\udee0\ufe0f Configuraci\u00f3n LDAP - #### \ud83d\udc18 PHPLDAPADMIN - Para poder iniciar sesi\u00f3n de manera mas f\u00e1cil, hay que a\u00f1adir estas dos l\u00edneas al fichero /etc/phpldapadmin/config.php <pre><code>$servers-&gt;setValue('server','base',array('dc=davidmaratrat,dc=local'));\n$servers-&gt;setValue('login','bind_id','cn=admin,dc=davidmaratrat,dc=local');\n</code></pre> - Para crear usurarios se ha de usar las opciones de Default -&gt; posixAccount + Account. - Para crear grupos se ha de usar la opci\u00f3n de Default -&gt; posixGroup"},{"location":"Ud4/Ch4_DMP/#ldif","title":"\ud83d\udcc2 LDIF","text":"Comando Descripci\u00f3n <code>ldapadd -x -D cn=admin,dc=davidmaratrat,dc=local -w davidmaratrat -f fichero.ldif</code> <code>Inyecta la informaci\u00f3n de los ldif en el LDAP</code> <code>ldapmodify -x -D cn=admin,dc=davidmaratrat,dc=local -w davidmaratrat -f fichero.ldif</code> <code>Modifica una entidad con el fichero ldif en el LDAP</code> <code>ldapsearch -x -b dc=davidmaratrat,dc=local \"(uid=*usuario01*)\"</code> <code>Busca una entidad con el fichero ldif en el LDAP</code> <code>ldapdelete -x -D cn=admin,dc=davidmaratrat,dc=local -w davidmaratrat uid=usuario01,ou=usuarios,dc=davidmaratrat,dc=local</code> <code>Elimina una entidad con el fichero ldif en el LDAP</code>"},{"location":"Ud4/Ch4_DMP/#estructura-basicaldif","title":"\ud83d\udcdc Estructura-basica.ldif","text":"<pre><code># Usuarios\ndn: ou=usuarios,dc=davidmaratrat,dc=local\nobjectClass: organizationalUnit\nou: usuarios\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#gruposlidf","title":"\ud83d\udcdc Grupos.lidf","text":"<pre><code>#Grupo usuarios\ndn: cn=usuarios,ou=grupos,dc=davidmaratrat,dc=local\nobjectClass: posixGroup\ncn: usuarios\ngidNumber: 10000\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#usuarioslidf","title":"\ud83d\udcdc Usuarios.lidf","text":"<pre><code># Profe01\ndn: uid=usuario01,ou=usuarios,dc=davidmaratrat,dc=local\nobjectClass: Account\nobjectClass: posixAccount\nuid: usuario01\ncn: usuario01\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/usuario01\nuserPassword: usuario01\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#modificacionlidf","title":"\ud83d\udcdc Modificaci\u00f3n.lidf","text":"<pre><code># Cambiar contrase\u00f1a Usuario\ndn: uid=usuario01,ou=usuarios,dc=davidmaratrat,dc=local\nchangetype: modify\nreplace: userPassword\nuserPassword: 123456\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#dockerizacion-de-un-ldap","title":"\ud83d\udc33 Dockerizaci\u00f3n de un LDAP","text":"<pre><code>docker run \n--name docker-ldap\n--env LDAP_ORGANISATION=\"davidmaratrat.local\" \n--env LDAP_DOMAIN=\"davidmaratrat.local\" \n--env LDAP_ADMIN_PASSWORD=\"davidmaratrat\" \n--detach osixia/openldap:1.5.0\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#apache-autenticado","title":"\ud83d\udc2f APACHE AUTENTICADO","text":"Comando Descripci\u00f3n <code>sudo a2enmod authnz_ldap</code> <code>Activa el m\u00f3dulo de autenticaci\u00f3n en apache</code>"},{"location":"Ud4/Ch4_DMP/#000-defaultconf","title":"\ud83d\udcdc 000-default.conf","text":"<pre><code>&lt;VirtualHost *:80&gt;\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/html\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    &lt;Directory \"/var/www/html/test\"&gt; \n    AllowOverride All\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#htacces","title":"\ud83d\udcdc .htacces","text":"<pre><code>AuthType Basic\nAuthName \"Apache LDAP authentication\"\nAuthBasicProvider ldap\nAuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=davidmaratrat,dc=local?uid?sub\"\nAuthLDAPBindDN \"cn=admin,dc=davidmaratrat,dc=local\"\nAuthLDAPBindPassword davidmaratrat\nRequire valid-user\n</code></pre>"},{"location":"Ud4/Ch4_DMP/#herramientas-utiles","title":"\ud83d\udd27 Herramientas \u00fatiles","text":"Comando Descripci\u00f3n <code>nslookup &lt;dominio&gt;</code> <code>Realiza una consulta de un dominio</code> <code>nslookup -type=&lt;registro&gt; &lt;dominio&gt;</code> <code>Realiza una consulta al dominio  de un tipo de registro espec\u00edfico</code> <code>nslookup &lt;dominio&gt; &lt;DNS&gt;</code> <code>Realiza una consulta con un servidor DNS espec\u00edfico</code> <code>dig &lt;dominio&gt;</code> <code>Realiza una consulta de un dominio</code> <code>dig &lt;dominio&gt; &lt;registro&gt;</code> <code>Realiza una consulta al dominio de un tipo de registro espec\u00edfico</code> <code>dig @&lt;DNS&gt; &lt;dominio</code> <code>Realiza una consulta con un servidor DNS espec\u00edfico</code> <code>dig -x &lt;IP&gt;</code> <code>Realiza una consulta inversa de una IP</code> <code>host &lt;dominio&gt;</code> <code>Realiza una consulta de un dominio</code> <code>host -t &lt;registro&gt; &lt;dominio&gt;</code> <code>Realiza una consulta al dominio de un tipo de registro espec\u00edfico</code> <code>host &lt;IP&gt;</code> <code>Realiza una consulta inversa de una IP</code> <code>whois &lt;dominio&gt;</code> <code>Realiza una consulta de un dominio</code> <code>whois &lt;IP&gt;</code> <code>Realiza una consulta inversa de una IP</code>"},{"location":"Ud4/Ch4_EGM/","title":"Cheatshet 4 - Servicios de red DNS y LDAP","text":""},{"location":"Ud4/Ch4_EGM/#servicio-dns-domain-name-system","title":"\ud83d\udcc4 Servicio DNS (Domain Name System)","text":""},{"location":"Ud4/Ch4_EGM/#herramientas-utiles-para-gestionar-dns","title":"\ud83d\udd27Herramientas \u00fatiles para gestionar DNS","text":"<pre><code>sudo apt-get install dnsutils  #Instalar estas herramientas en Debian\n</code></pre> <ul> <li> <p><code>nslookup</code>: Se utiliza para saber si un servidor DNS resuelve correctamente los nombres DNS y las direcciones IP.</p> <ul> <li>nslookup cisco.com</li> </ul> </li> </ul> <pre><code>Server:     1.1.1.1\nAddress:    1.1.1.1#53\n\nNon-authoritative answer:\nName:   cisco.com\nAddress: 72.163.4.185\nName:   cisco.com\nAddress: 2001:420:1101:1::185\n</code></pre> <ul> <li> <p><code>dig</code>: Utilizada para solucionar problemas de DNS gracias a su facilidad de uso y claridad en la presentaci\u00f3n de la informaci\u00f3n.</p> <ul> <li>dig cisco.com</li> </ul> </li> </ul> <p><pre><code>; &lt;&lt;&gt;&gt; DiG 9.20.3 &lt;&lt;&gt;&gt; cisco.com\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 28149\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 1232\n;; QUESTION SECTION:\n;cisco.com.         IN  A\n;; ANSWER SECTION:\ncisco.com.      1621    IN  A   72.163.4.185\n;; Query time: 13 msec\n;; SERVER: 1.1.1.1#53(1.1.1.1) (UDP)\n;; WHEN: Sat Dec 14 16:40:58 CET 2024\n;; MSG SIZE  rcvd: 54\n</code></pre> - <code>host</code>: Herramienta CLI sencilla y f\u00e1cil de usar para realizar consultas DNS.     - host cisco.com <pre><code>cisco.com has address 72.163.4.185\ncisco.com has IPv6 address 2001:420:1101:1::185\ncisco.com mail is handled by 10 alln-mx-01.cisco.com.\ncisco.com mail is handled by 20 rcdn-mx-01.cisco.com.\ncisco.com mail is handled by 30 aer-mx-01.cisco.com.\n</code></pre> - <code>whois</code>: Aunque no es una herramienta de diagn\u00f3stico DNS si que nos ofrece informaci\u00f3n sobre el registro del dominio.     - whois cisco.com <pre><code>Domain Name: CISCO.COM\n   Registry Domain ID: 4987030_DOMAIN_COM-VRSN\n   Registrar WHOIS Server: whois.markmonitor.com\n   Registrar URL: http://www.markmonitor.com\n   Updated Date: 2024-04-13T09:39:41Z\n   Creation Date: 1987-05-14T04:00:00Z\n   Registry Expiry Date: 2025-05-15T04:00:00Z\n   Registrar: MarkMonitor Inc.\n   Registrar IANA ID: 292\n   Registrar Abuse Contact Email: abusecomplaints@markmonitor.com\n   Registrar Abuse Contact Phone: +1.2086851750\n   Domain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited\n   Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited\n   Domain Status: clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited\n   Domain Status: serverDeleteProhibited https://icann.org/epp#serverDeleteProhibited\n   Domain Status: serverTransferProhibited https://icann.org/epp#serverTransferProhibited\n   Domain Status: serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited\n   Name Server: NS1.CISCO.COM\n   Name Server: NS2.CISCO.COM\n   Name Server: NS3.CISCO.COM\n   DNSSEC: unsigned\n   URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/\n&gt;&gt;&gt; Last update of whois database: 2024-12-14T15:42:34Z &lt;&lt;&lt;\n</code></pre></p>"},{"location":"Ud4/Ch4_EGM/#instalacion-de-un-servidor-dns","title":"\ud83d\udcbeInstalaci\u00f3n de un servidor DNS","text":"<p><pre><code>sudo apt-get install bind9 bind9utils bind9-doc \n</code></pre> <code>sudo nano /etc/systemd/resolved.conf</code>: cambiar el DNS al que consulta nuestro servidor. <pre><code>[Resolve]\nDNS=127.0.0.1\n</code></pre> <code>sudo systemctl restart systemd-resolved</code>: Aplica la configuraci\u00f3n</p>"},{"location":"Ud4/Ch4_EGM/#configuracion-de-un-servidor-dns","title":"\u270f\ufe0fConfiguraci\u00f3n de un servidor DNS","text":"<ul> <li><code>/etc/bind/named.conf</code>: Archivo de configuraci\u00f3n principal<ul> <li>Sirve simplemente para aglutinar o agrupar a los archivos de configuraci\u00f3n que usaremos. <pre><code>// This is the primary configuration file for the BIND DNS server named.\n//\n// Please read /usr/share/doc/bind9/README.Debian for information on the\n// structure of BIND configuration files in Debian, *BEFORE* you customize\n// this configuration file.\n//\n// If you are just adding zones, please do that in /etc/bind/named.conf.local\ninclude \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\ninclude \"/etc/bind/named.conf.default-zones\";\n</code></pre></li> </ul> </li> <li><code>named.conf.options</code>: Se encarga de contener las configuraciones globales.</li> <li><code>named.conf.local</code>: En este archivo configuraremos aspectos relativos a nuestras zonas.</li> <li><code>named.conf.default-zones</code>: Se encarga de definir las zonas predeterminadas.</li> </ul>"},{"location":"Ud4/Ch4_EGM/#creacion-de-un-archivo-de-zona","title":"\ud83d\udcc4Creaci\u00f3n de un archivo de zona","text":"<p><code>sudo nano named.conf.local</code> <pre><code>//\n// Do any local configuration here\n//\n// Consider adding the 1918 zones here, if they are not used in your\n// organization\n//include \"/etc/bind/zones.rfc1918\";\nzone \"deaw.es\" {\n        type master;\n        file \"/etc/bind/db.deaw.es\";  //Ruta donde ubicamos nuestro archivo de zona\n};\n</code></pre> <code>sudo nano /etc/bind/db.deaw.es</code> <code>``/etc/bind/db.deaw.es $TTL 1d $ORIGIN deaw.es. ; base domain-name @   IN  SOA     ns1.deaw.es. admin.deaw.es. (                   2023112301  ; Serial                   8H          ; Refresh                   2H          ; Retry                   4W          ; Expire                   1D )        ; Minimum TTL ; Name Servers     IN  NS      ns1.deaw.es. ; A records ns1 IN  A       3.85.104.173 www IN  A       3.85.104.173 <pre><code>- `$TTL`: Tiempo de vida predeterminado para los registros de la zona.\n- `SOA (Start of Authority)`: Indica informaci\u00f3n sobre la zona, como el nombre del servidor primario, el contacto del administrador y detalles de tiempo.\n- `NS`: Registra los servidores de nombres autoritativos para la zona.\n- `A`: Registra la direcci\u00f3n IP asociada con un nombre de host espec\u00edfico.\n#### \ud83d\udd0eComprobaciones importantes de la configuraci\u00f3n\n- `named-checkconf`: Se utiliza para comprobar que no hay errores en la configuraci\u00f3n.\n- `named-checkzone deaw.es /etc/bind/db.deaw.es`: Comprueba si la zona configurada es correcta.\n```bash\n$ sudo named-checkzone deaw.es /etc/bind/db.deaw.es\nzone deaw.es/IN: loaded serial 2023112301\nOK\n</code></pre> -</code>sudo systemctl restart systemd-resolved`: Si todo va correctamente, se reinicia el servicio.</p>"},{"location":"Ud4/Ch4_EGM/#zona-de-resolucion-inversa","title":"\ud83d\udcc3Zona de resoluci\u00f3n inversa","text":"<p><pre><code># /etc/bind/named.conf.local\nzone \"104.85.3.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.3.85.104\";  # Ruta al archivo de zona inversa\n};\n</code></pre> <pre><code># /etc/bind/db.3.85.104\n$TTL 1d\n$ORIGIN 104.85.3.IN-ADDR.ARPA.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; PTR record\n173 IN  PTR     ns1.deaw.es. ; fully qualified domain name (FQDN)\n</code></pre></p>"},{"location":"Ud4/Ch4_EGM/#servicio-de-directorio-ldap-lightweight-directory-access-protocol","title":"\ud83d\udd10Servicio de directorio LDAP (Lightweight Directory Access Protocol)","text":""},{"location":"Ud4/Ch4_EGM/#instalacion-del-servidor-ldap","title":"\ud83d\udcbeInstalaci\u00f3n del servidor LDAP","text":"<ul> <li><code>sudo apt install slapd ldap-utils</code>: Instala el servidor LDAP</li> <li><code>sudo dpkg-reconfigure slapd</code>: Te permite configurar desde cero el servidor LDAP o reconfigurarlo si ya lo ten\u00edas.</li> </ul>"},{"location":"Ud4/Ch4_EGM/#administracion-del-servidor-ldap","title":"\ud83d\udccbAdministraci\u00f3n del servidor LDAP","text":"<ul> <li><code>sudo slapcat</code>: Te permite ver la informaci\u00f3n actual que tienes configurada en LDAP.</li> <li><code>sudo apt-get install phpldapadmin</code>: Instala phpldapadmin, con lo que podemos configurar nuestro servidor ldap desde una interfaz gr\u00e1fica desde un navegador. <pre><code>#/etc/phpldapadmin/config.php --&gt; Cambiamos el DIT (Directory Information Tree)\n- $servers-&gt;;setValue('server','base',array('dc=example,dc=com'));\n- $servers-&gt;setValue('login','bind_id','cn=admin,dc=example,dc=com');\n+ $servers-&gt;setValue('server','base',array('dc=daw,dc=ieselcaminas'));\n+ $servers-&gt;setValue('login','bind_id','cn=admin,dc=daw,dc=ieselcaminas');\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EGM/#configuracion-del-servidor-ldap","title":"\u270f\ufe0fConfiguraci\u00f3n del servidor LDAP","text":"<ul> <li><code>/etc/ldap/ldap.conf</code>: Configuraci\u00f3n del cliente LDAP.</li> <li><code>/etc/slapd/slapd.conf</code>: Configuraci\u00f3n del servidor LDAP.</li> <li><code>archivo.ldif</code>: Aqu\u00ed va la configuraci\u00f3n de la estructura organizativa que queremos a\u00f1adir en nuestro servidor LDAP, o definir grupos o usuarios. <pre><code># estructura_basica.ldif --&gt; Estructura organizativa b\u00e1sica LDAP\n# Usuarios\ndn: ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: usuarios\n# Grupos\ndn: ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: grupos\n</code></pre></li> <li><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f estructura_basica.ldif</code>: Incorporar los cambios <pre><code># grupos.ldif --&gt; Creaci\u00f3n de grupos\n#Grupo profesores\ndn: cn=profesores,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: profesores\ngidNumber: 10000\n#Grupo alumnos\ndn: cn=alumnos,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: alumnos   \ngidNumber: 10001\n</code></pre></li> <li><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f grupos.ldif</code>: Incorporar grupos <pre><code># profesores.ldif --&gt; Creaci\u00f3n de usuarios\n# Profe01\ndn: uid=profe01,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe01\ncn: profe01\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/profe01\ngecos: Profe01 DAW\nuserPassword: 123456\n# Profe02\ndn: uid=profe02,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe02\ncn: profe02\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1002\ngidNumber: 10000\nhomeDirectory: /home/profe02\ngecos: Profe02 DAW\nuserPassword: 123456\n</code></pre></li> <li><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f profesores.ldif</code>: Incorporar usuarios</li> </ul>"},{"location":"Ud4/Ch4_EGM/#explicacion-del-comando","title":"\u27bfExplicaci\u00f3n del comando","text":"<ul> <li><code>ldapadd -x -D \"cn=admin,dc=proyecto-empresa,dc=local\" -w ieselcaminas -f estructura_basica.ldif</code><ul> <li><code>x</code>: Realiza la autenticaci\u00f3n en modo simple.</li> <li><code>D</code>: Indica el usuario administrador de LDAP (nombre distinguido o DN).</li> <li><code>w</code>: Proporciona la contrase\u00f1a del usuario LDAP.</li> <li><code>f</code>: Define el archivo LDIF que se utilizar\u00e1 para la importaci\u00f3n.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_EGM/#modificacion-de-objetos","title":"\ud83d\udd29Modificaci\u00f3n de objetos","text":"<p><pre><code># cambiar_usuario.ldif\n# Cambiar contrase\u00f1a Usuario\ndn: uid=alu01,ou=usuarios,dc=proyecto-empresa,dc=local\nchangetype: modify\nreplace: userPassword\nuserPassword: 654321\n</code></pre> - <code>ldapmodify -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f cambiar_usuario.ldif</code></p>"},{"location":"Ud4/Ch4_EGM/#busqueda","title":"\ud83d\udd0dB\u00fasqueda","text":"<ul> <li><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uid=*profe*)\"</code>: Buscar todos los profesores usando el uid</li> <li><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uidNumber=1002)\"</code>: Buscar usando el uidNumber</li> </ul>"},{"location":"Ud4/Ch4_EGM/#eliminacion","title":"\ud83d\udd28Eliminaci\u00f3n","text":"<ul> <li><code>ldapdelete -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas uid=alu02,ou=usuarios,dc=proyecto-empresa,dc=local</code>: Eliminamos el usuario alu02</li> </ul>"},{"location":"Ud4/Ch4_EV/","title":"CH4 - EV","text":""},{"location":"Ud4/Ch4_EV/#configuracion-de-un-servidor-dns","title":"Configuraci\u00f3n de un servidor DNS","text":"<ul> <li>Instalar herramientas de l\u00ednea de comandos <code>dig</code>, <code>host</code> y <code>nslookup</code> : <code>sudo apt-get install dnsutils</code></li> <li>Comprobar el servidor de nombres de nuestra EC2 : <code>cat /etc/resolv.conf</code></li> <li>Probar los comandos <code>dig</code>, <code>host</code> y <code>nslookup</code> junto con <code>cisco.com</code> para ver la IP y el servidor DNS que nos la proporciona</li> </ul>"},{"location":"Ud4/Ch4_EV/#instalacion-de-servidor-dns","title":"Instalaci\u00f3n de servidor DNS","text":"<ul> <li>Instalar el servidor DNS : <code>sudo apt-get install bind9 bind9utils bind9-doc</code></li> <li>Editar <code>/etc/systemd/resolved.conf</code>, a\u00f1adir en [Resolve] : <code>DNS= &lt;IP_del_servidor_DNS&gt;</code></li> <li>Reiniciar systemd-resolved para aplicar la nueva configuraci\u00f3n : <code>sudo systemctl restart systemd-resolved</code></li> </ul>"},{"location":"Ud4/Ch4_EV/#configuracion-del-servidor","title":"Configuraci\u00f3n del servidor","text":"<ul> <li>En <code>/etc/bind/named.conf.options</code> agregar : <code>allow-query { any; };</code></li> <li>Comprobar que el archivo de configuraci\u00f3n es correcto : <code>sudo named-checkconf</code></li> </ul>"},{"location":"Ud4/Ch4_EV/#desactivar-la-recursividad","title":"Desactivar la recursividad","text":"<ul> <li>Desactivar la recursividad incluyendo la siguiente directiva en <code>/etc/bind/named.conf.options</code> : <code>recursion no;</code></li> </ul>"},{"location":"Ud4/Ch4_EV/#configuracion-de-los-forwarder","title":"Configuraci\u00f3n de los forwarder","text":"<ul> <li>Agregar los n\u00fameros de IP de los servidores DNS deseados en la  secci\u00f3n forwarders de <code>/etc/bind/named.conf.options</code> <pre><code>    forwarders {\n            8.8.8.8;\n            8.8.4.4;\n    };\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#configurar-zonas-directas","title":"Configurar zonas directas","text":"<ul> <li>En <code>/etc/bind/named.conf.local</code>, declarar la zona: <pre><code>zone \"example.com\" {\n    type master;\n    file \"/etc/bind/db.example.com\";  # Ruta al archivo de zona inversa\n};\n</code></pre></li> <li>Configuraci\u00f3n de la resoluci\u00f3n inversa en el fichero descrito <code>/etc/bind/db.example.com</code>: <pre><code>$TTL 1d\n@   IN  SOA     ns1.example.com. admin.example.com. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n\n; Name Servers\n    IN  NS      ns1.example.com.\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#configurar-zonas-inversas","title":"Configurar zonas inversas","text":"<ul> <li>En <code>/etc/bind/named.conf.local</code>, a\u00f1adir: <pre><code>zone \"1.1.168.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.1.1.168\";\n};\n</code></pre></li> <li>Contenido de <code>/etc/bind/db.1.1.168</code>: <pre><code>$TTL 1d\n@   IN  SOA     ns1.example.com. admin.example.com. (\n              2023121501 ; Serial\n              8H         ; Refresh\n              2H         ; Retry\n              4W         ; Expire\n              1D )       ; Minimum TTL\n    IN  NS      ns1.example.com.\n1   IN  PTR     ns1.example.com.\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#dockerizacion-de-un-servidor-dns","title":"Dockerizaci\u00f3n de un servidor DNS","text":"<ul> <li>Crear el contenedor: <pre><code>docker run -d \\\n        --name=miserverdns \\\n        --publish 53:53/udp \\\n        --publish 53:53/tcp \\\n        internetsystemsconsortium/bind9:9.18\n</code></pre></li> <li>Preguntar por un dominio y comprobar que resuleve correctamente : <code>nslookup cisco.com 127.0.0.1</code></li> <li>Para crear una zona igual que la de la pr\u00e1ctica anterior, crear una carpeta <code>miserverdns</code> con estos ficheros: <pre><code>named.conf\nnamed.conf.options\nnamed.conf.local\ndb.deaw.es\ndb.3.85.104 # Cambiar por el que corresponda a tu IP de resoluci\u00f3n inversa\n</code></pre></li> <li>Los ficheros tendr\u00e1n el mismo contenido que anteriormente, excepto  <code>named.conf</code>, que contendr\u00e1 lo siguiente:  <pre><code>include \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\n</code></pre></li> <li>Copiar cada uno al interior del contenedor : <code>docker cp named.conf miserverdns:/etc/bind ...</code></li> <li>Parar y reiniciar el contenedor, o arrancarlo si estaba parado y comprobar que resuelve correctamente</li> </ul>"},{"location":"Ud4/Ch4_EV/#configuracion-de-un-servidor-ldap","title":"Configuraci\u00f3n de un servidor LDAP","text":"<ul> <li>Instalar el paquete ldap-utils : <code>sudo apt-get install slapd ldap-utils</code></li> <li>Configurar nuestro directorio : <code>sudo dpkg-reconfigure slapd</code></li> <li>Ejecutar comando <code>slapcat</code> para verificar la base de datos</li> <li>Instalar phpldapadmin : <code>sudo apt-get install phpldapadmin</code></li> <li>Acceder desde el navegador web a \"http://IPSERVER/phpldapadmin\"</li> <li>Iniciar sesi\u00f3n con los datos de la salida de slapd</li> <li>Editar el fichero de configuraci\u00f3n de phpldapadmin <code>/etc/phpldapadmin/config.php</code> y sustituir las l\u00edneas <pre><code>$servers-&gt;;setValue('server','base',array('dc=example,dc=com'));\n$servers-&gt;setValue('login','bind_id','cn=admin,dc=example,dc=com');\n</code></pre> por <pre><code>$servers-&gt;setValue('server','base',array('dc=daw,dc=ieselcaminas'));\n$servers-&gt;setValue('login','bind_id','cn=admin,dc=daw,dc=ieselcaminas');\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#crear-unidades-organizativas","title":"Crear unidades organizativas","text":"<ul> <li>Desde PHP LDAP Admin, seleccionar <code>Create a child entry</code> &gt; <code>Organizational Unit</code></li> <li>Ejemplo en <code>estructura.ldif</code>: <pre><code>dn: ou=usuarios,dc=example,dc=com\nobjectClass: organizationalUnit\nou: usuarios\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#crear-grupos-y-usuarios","title":"Crear grupos y usuarios","text":"<ul> <li>Grupos (<code>grupos.ldif</code>): <pre><code>dn: cn=profesores,ou=grupos,dc=example,dc=com\nobjectClass: posixGroup\ncn: profesores\ngidNumber: 5000\n</code></pre></li> <li>Usuarios (<code>usuarios.ldif</code>): <pre><code>dn: uid=usuario1,ou=usuarios,dc=example,dc=com\nobjectClass: posixAccount\nuid: usuario1\ncn: Usuario Uno\ngidNumber: 5000\nhomeDirectory: /home/usuario1\nuserPassword: password\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#comandos-utiles","title":"Comandos \u00fatiles","text":"<ul> <li>A\u00f1adir registros : <code>ldapadd -x -D cn=admin,dc=example,dc=com -w &lt;password&gt; -f estructura.ldif</code></li> <li>Modificar registros:  <pre><code>dn: uid=usuario1,ou=usuarios,dc=example,dc=com\nchangetype: modify\nreplace: userPassword\nuserPassword: newpassword\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#dockerizacion-de-servidor-ldap","title":"Dockerizaci\u00f3n de servidor LDAP","text":"<ul> <li>Crear la red: <code>docker network create ldap-network</code></li> <li>Lanzar los contenedores: <pre><code>docker run \\\n    --net ldap-network \\\n    --hostname ldap-service \\\n    --name ldap-service \\\n    --env LDAP_ORGANISATION=\"daw.ieselcaminas\" \\\n    --env LDAP_DOMAIN=\"daw.ieselcaminas\" \\\n    --env LDAP_ADMIN_PASSWORD=\"ieselcaminas\" \\\n    --detach osixia/openldap\n\ndocker run \\\n    --net ldap-network \\\n    --name phpldapadmin-service \\\n    --publish 443:443 \\\n    --hostname phpldapadmin-service \\\n    --env PHPLDAPADMIN_LDAP_HOSTS=ldap-service \\\n    --detach osixia/phpldapadmin\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#autenticacion-apache-contra-ldap","title":"Autenticaci\u00f3n Apache contra LDAP","text":"<ul> <li>Habilitar el m\u00f3dulo de autenticaci\u00f3n LDAP Apache2: <code>sudo a2enmod authnz_ldap</code></li> <li>Crear directorio <code>test</code>, crear dentro un archivo <code>index.html</code> y cambiar el usuario y el grupo del directorio <code>test</code> y su contenido a <code>www-data</code>: <pre><code>sudo mkdir /var/www/html/test\nsudo nano /var/www/html/test/index.html\nsudo chown -R www-data:www-data /var/www/html/test\n</code></pre></li> <li>Contenido del fichero <code>index.html</code>: <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Sitio LDAP!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Bienvendido al sitio validado por LDAP!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></li> <li>Modificar <code>/etc/apache2/sites-enabled/000-default.conf</code>: <pre><code>        &lt;Directory \"/var/www/html/test\"&gt; \n        AuthType Basic\n        AuthName \"Apache LDAP authentication\"\n        AuthBasicProvider ldap \n        AuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub\" \n        AuthLDAPBindDN \"cn=admin,dc=daw,dc=ieselcaminas\"\n        AuthLDAPBindPassword ieselcaminas\n        Require valid-user\n        &lt;/Directory&gt;\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_EV/#dockerizacion-de-apache","title":"Dockerizaci\u00f3n de Apache","text":"<ul> <li>Crear Dockerfile con el contenido siguiente: <pre><code>FROM php:7-apache\n\n# Activamos el m\u00f3dulo LDAP de Apache ejecutando el siguiente comando\nRUN a2enmod authnz_ldap\n\n# Creamos el directorio test como en la pr\u00e1ctica anterior\nRUN mkdir -p /var/www/html/test\n\n# Copiamos los ficheros como los de la pr\u00e1ctica anterior\nCOPY index.html /var/www/html/test/index.html\nCOPY 000-default.conf /etc/apache2/sites-enabled/000-default.conf\n</code></pre></li> <li>Crear imagen llamada <code>my-apache2</code></li> <li>Lanzar el contenedor:  <pre><code>docker run \\\n    --net ldap-network \\\n    --name apache2_server \\\n    -d \\\n    -p80:80 \\\n    my-apache2\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MCG/","title":"cheatsheet 4 - dns's","text":""},{"location":"Ud4/Ch4_MCG/#instalar-cosas","title":"instalar cosas","text":""},{"location":"Ud4/Ch4_MCG/#dnsutils","title":"dnsutils","text":"<pre><code>sudo apt-get install dnsutils\n</code></pre> <p>este comando instala el paquete <code>dnsutils</code>, que incluye herramientas \u00fatiles para la administraci\u00f3n de DNS. las herramientas que nos interesan son:</p> <pre><code>nslookup  $direccion $direccionDNS\ndig  $direccion\nhost $direcion\n</code></pre> <p>las 3 nos devulven informaci\u00f3n relevente respecto a dns de la direcci\u00f3n objetivo, con ligeras diferencias a la hora de presentarla. </p>"},{"location":"Ud4/Ch4_MCG/#bind9","title":"bind9","text":"<p><pre><code>sudo apt-get install bind9 bind9utils bind9-doc\n</code></pre> este comando instala el servidor DNS BIND9 y varias utilidades necesarias para configurarlo y administrarlo.</p>"},{"location":"Ud4/Ch4_MCG/#ldap","title":"ldap","text":"<p><pre><code>sudo apt-get install slapd ldap-utils\n</code></pre> este comando instala los paquetes necesarios para configurar un servidor LDAP en linux</p> <p>para poder configurar de forma guiada nuestro servicio ldap podemosusar el comando:  <pre><code>sudo dpkg-reconfigure slapd\n</code></pre></p> <p>este comando se utiliza para reconfigurar el servidor LDAP (slapd) despu\u00e9s de la instalaci\u00f3n. permite establecer par\u00e1metros como el dominio base, el administrador, y las configuraciones de seguridad.</p> <p>el mismo abrir\u00e1 en nuestra consola una \"interfaz gr\u00e1fica\" que nos ir\u00e1 guiando para que podamos configurar por primera vez o de nuevo nustro servidor ldap.</p>"},{"location":"Ud4/Ch4_MCG/#phpldapadmin","title":"phpldapadmin","text":"<pre><code>sudo apt-get install phpldapadmin\n</code></pre> <p>este comando instala phpLDAPadmin, una herramienta web para administrar un servidor LDAP de manera gr\u00e1fica. facilita la creaci\u00f3n, modificaci\u00f3n y eliminaci\u00f3n de entradas en el directorio LDAP.</p>"},{"location":"Ud4/Ch4_MCG/#administracion-de-ldap","title":"administraci\u00f3n de LDAP","text":"<p>a contunuaci\u00f3n mostrar\u00e9 una serie de ejemplos con los que podremos modificar nuestro directorio.</p>"},{"location":"Ud4/Ch4_MCG/#ldapadd","title":"ldapadd","text":"<p><pre><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f profesores.ldif\n</code></pre> este comando se utiliza para agregar nuevos registros al directorio LDAP. se usa un archivo de entrada en formato LDIF (LDAP Data Interchange Format) para proporcionar los datos.</p> <ul> <li>D: especifica el usuario administrador que tiene permisos para agregar entradas.</li> <li>w: especifica la contrase\u00f1a del usuario administrador.</li> <li>f: especifica el archivo LDIF con los datos a agregar.</li> </ul> <p>aqui un ejemplo de dicho \"profesores.ldif\". <pre><code># Profe01\ndn: uid=profe01,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe01\ncn: profe01\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/profe01\ngecos: Profe01 DAW\nuserPassword: 123456\n\n# Profe02\ndn: uid=profe02,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe02\ncn: profe02\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1002\ngidNumber: 10000\nhomeDirectory: /home/profe02\ngecos: Profe02 DAW\nuserPassword: 123456\n</code></pre></p>"},{"location":"Ud4/Ch4_MCG/#ldapmodify","title":"ldapmodify","text":"<p>este comando se utiliza para modificar registros existentes en el directorio LDAP. al igual que el comando anterior, se utiliza un archivo LDIF para describir los cambios.</p> <pre><code>ldapmodify -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f cambiar_usuario.ldif\n</code></pre> <p>aqui un ejemplo de dicho \"cambiar_usuario.ldif\". <pre><code># Cambiar contrase\u00f1a Usuario\ndn: uid=alu01,ou=usuarios,dc=proyecto-empresa,dc=local\nchangetype: modify\nreplace: userPassword\nuserPassword: 654321\n</code></pre></p>"},{"location":"Ud4/Ch4_MCG/#autenticacion-web-con-ldap","title":"autenticacion web con ldap","text":"<p>podemos configurar un servidor web para pedirnos credenciales respecto a uno o un grupo de usuarios en nuestro directorio ldap. esto lo podemos hacer con apache2 y con nginx.</p>"},{"location":"Ud4/Ch4_MCG/#apache2","title":"apache2","text":"<p>primero que todo, para usar la autenticacion a trav\u00e9s de ldap en apache2 deberemos habilitar el modulo para ello. con el siguiente comando podemos hacerlo.</p> <pre><code>sudo a2enmod authnz_ldap\n</code></pre> <p>entonces deberemos modificar nuestro archivo de configuracion de web para implementar la autenticaci\u00f3n. aqui dejo un ejemplo de archivo \".conf\":</p> <p><pre><code>&lt;VirtualHost *:80&gt;\n        ServerAdmin webmaster@localhost\n        DocumentRoot /var/www/html\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n        &lt;Directory \"/var/www/html/test\"&gt; \n        AuthType Basic\n        AuthName \"Apache LDAP authentication\"\n        AuthBasicProvider ldap \n        AuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub\" \n        AuthLDAPBindDN \"cn=admin,dc=daw,dc=ieselcaminas\"\n        AuthLDAPBindPassword ieselcaminas\n        Require valid-user\n        &lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre> ahora explico brevemente que significan algunas de las declaraciones del ejemplo:</p> <ul> <li>AuthType Basic: define que hay autenticacion.</li> <li>AuthBasicProvider ldap: define que se usar\u00e1 ldap para la autenticacion.</li> <li>AuthLDAPURL: define la url del server ldap.</li> <li>AuthLDAPBindDN : especifica el usuario.</li> <li>Require valid-user: obliga a usar un usuario valido.</li> </ul> <p>para aplicar los cambios deberemos de reiniciar apache2.</p> <pre><code>sudo systemctl restart apache2\n</code></pre>"},{"location":"Ud4/Ch4_MCG/#nginx","title":"nginx","text":"<p>en nginx deberemos primero configurar nginx en si para poder habilitar esta funcion. aqui tenemos el archivo \"/etc/nginx/nginx.conf\": </p> <pre><code>http {\n    ldap_server mi_servidor_ldap {\n        url ldap://IPSERVIDOR/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub;\n        binddn \"cn=admin,dc=daw,dc=ieselcaminas\";\n        binddn_passwd \"ieselcaminas\";\n        group_attribute member;\n        group_attribute_is_dn on;\n\n        require valid_user;\n    }\n\n    include /etc/nginx/sites-enabled/*;\n}\n</code></pre> <p>obviamente deberiamos cambiar la url y los binds para que cuandren con nuestro server y con nuestros usuarios autenticables.</p> <p>entonces configuramos nuestro sitio para habilitar la autenticacion. esta configuraci\u00f3n es generica asique no hacen falta cambios.</p> <pre><code>server {\n    listen 80;\n    server_name sitioldap;\n    root /var/www/sitioldap;\n    index index.html;\n\n    location / {\n        try_files $uri $uri/ =404;\n        auth_ldap \"Protected Area\";\n        auth_ldap_servers mi_servidor_ldap;\n    }\n}\n</code></pre>"},{"location":"Ud4/Ch4_MIP/","title":"Ch4 - MIP","text":""},{"location":"Ud4/Ch4_MIP/#cheatsheet-configuracion-de-un-servidor-dns-en-debian","title":"Cheatsheet: Configuraci\u00f3n de un Servidor DNS en Debian","text":""},{"location":"Ud4/Ch4_MIP/#1-preparacion-del-entorno","title":"1. Preparaci\u00f3n del Entorno","text":"<ul> <li>Eliminar entradas en <code>/etc/hosts</code>: Aseg\u00farate de que no haya entradas previas que puedan interferir con la resoluci\u00f3n DNS.</li> <li>Crear una instancia EC2 en AWS:<ul> <li>Nombre: <code>P5ServidorDNS</code>.</li> <li>Sistema operativo: Debian.</li> <li>Grupo de seguridad: Abre los puertos necesarios para consultas DNS (puerto 53 UDP/TCP).</li> </ul> </li> <li>Asignar una IP el\u00e1stica:<ul> <li>Asigna una IP el\u00e1stica en AWS y as\u00edociala a la instancia EC2.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#2-instalacion-de-herramientas-de-diagnostico","title":"2. Instalaci\u00f3n de Herramientas de Diagn\u00f3stico","text":"<ul> <li>Instala las herramientas <code>dig</code>, <code>host</code>, y <code>nslookup</code>:   <pre><code>sudo apt-get install dnsutils\n</code></pre></li> <li>Verifica el servidor DNS configurado:   <pre><code>cat /etc/resolv.conf\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#3-pruebas-de-resolucion-de-nombres","title":"3. Pruebas de Resoluci\u00f3n de Nombres","text":"<ul> <li>Usar <code>host</code>:   <pre><code>host cisco.com\n</code></pre></li> <li>Usar <code>dig</code>:   <pre><code>dig cisco.com\n</code></pre></li> <li>Usar <code>nslookup</code>:   <pre><code>nslookup cisco.com\n</code></pre></li> <li>Consultar a un DNS espec\u00edfico:   <pre><code>nslookup cisco.com 8.8.8.8\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#4-instalacion-del-servidor-dns-bind9","title":"4. Instalaci\u00f3n del Servidor DNS (BIND9)","text":"<ul> <li>Instala BIND9:   <pre><code>sudo apt-get install bind9 bind9utils bind9-doc\n</code></pre></li> <li>Verifica si el servicio est\u00e1 activo:   <pre><code>sudo systemctl status bind9\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#5-configuracion-basica-de-bind9","title":"5. Configuraci\u00f3n B\u00e1sica de BIND9","text":"<ul> <li>Archivo de configuraci\u00f3n principal: <code>/etc/bind/named.conf</code>.</li> <li>Habilitar consultas externas:<ul> <li>Edita <code>/etc/bind/named.conf.options</code> y a\u00f1ade:   <pre><code>allow-query { any; };\n</code></pre></li> </ul> </li> <li>Desactivar recursividad (opcional):   <pre><code>recursion no;\n</code></pre></li> <li>Configurar forwarders:<ul> <li>Edita <code>/etc/bind/named.conf.options</code> y a\u00f1ade:   <pre><code>forwarders {\n    8.8.8.8;\n    8.8.4.4;\n};\n</code></pre></li> </ul> </li> <li>Reiniciar el servicio:   <pre><code>sudo systemctl restart bind9\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#6-configuracion-de-zonas-dns","title":"6. Configuraci\u00f3n de Zonas DNS","text":"<ul> <li>Zona directa:<ul> <li>Edita <code>/etc/bind/named.conf.local</code> y a\u00f1ade:   <pre><code>zone \"deaw.es\" {\n    type master;\n    file \"/etc/bind/db.deaw.es\";\n};\n</code></pre></li> <li>Crea el archivo de zona <code>/etc/bind/db.deaw.es</code>:   <pre><code>$TTL 1d\n$ORIGIN deaw.es.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; A records\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n</code></pre></li> <li>Verifica la configuraci\u00f3n:   <pre><code>sudo named-checkzone deaw.es /etc/bind/db.deaw.es\n</code></pre></li> </ul> </li> <li>Zona inversa:<ul> <li>Edita <code>/etc/bind/named.conf.local</code> y a\u00f1ade:   <pre><code>zone \"104.85.3.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.3.85.104\";\n};\n</code></pre></li> <li>Crea el archivo de zona inversa <code>/etc/bind/db.3.85.104</code>:   <pre><code>$TTL 1d\n$ORIGIN 104.85.3.IN-ADDR.ARPA.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; PTR record\n173 IN  PTR     ns1.deaw.es.\n</code></pre></li> <li>Verifica la configuraci\u00f3n:   <pre><code>sudo named-checkzone 104.85.3.in-addr.arpa /etc/bind/db.3.85.104\n</code></pre></li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#7-pruebas-de-funcionamiento","title":"7. Pruebas de Funcionamiento","text":"<ul> <li>Resoluci\u00f3n directa:   <pre><code>nslookup www.deaw.es\ndig deaw.es\n</code></pre></li> <li>Resoluci\u00f3n inversa:   <pre><code>nslookup 3.85.104.173\ndig -x 3.85.104.173\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#8-comprobacion-de-la-cache-dns","title":"8. Comprobaci\u00f3n de la Cach\u00e9 DNS","text":"<ul> <li>Realiza una consulta inicial y observa el tiempo de respuesta:   <pre><code>dig cisco.com\n</code></pre></li> <li>Realiza la misma consulta nuevamente y verifica que el tiempo de respuesta ha disminuido debido a la cach\u00e9.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#9-reiniciar-el-servicio-dns","title":"9. Reiniciar el Servicio DNS","text":"<ul> <li>Despu\u00e9s de cada cambio en la configuraci\u00f3n, reinicia el servicio:   <pre><code>sudo systemctl restart bind9\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#cheatsheet-dockerizacion-de-un-servidor-dns-con-bind9","title":"Cheatsheet: Dockerizaci\u00f3n de un Servidor DNS con BIND9","text":""},{"location":"Ud4/Ch4_MIP/#1-preparacion-del-entorno_1","title":"1. Preparaci\u00f3n del Entorno","text":"<ul> <li>Verificar puerto 53: Aseg\u00farate de que el puerto 53 no est\u00e9 en uso por otro servicio (como <code>systemd-resolved</code>). Si es necesario, det\u00e9n el servicio:   <pre><code>sudo systemctl stop systemd-resolved\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#2-creacion-del-contenedor-docker","title":"2. Creaci\u00f3n del Contenedor Docker","text":"<ul> <li>Usa la imagen oficial de BIND9:   <pre><code>docker run -d \\\n    --name=miserverdns \\\n    --publish 53:53/udp \\\n    --publish 53:53/tcp \\\n    internetsystemsconsortium/bind9:9.18\n</code></pre></li> <li>Explicaci\u00f3n:<ul> <li><code>-d</code>: Ejecuta el contenedor en segundo plano (modo detached).</li> <li><code>--name=miserverdns</code>: Asigna un nombre al contenedor.</li> <li><code>--publish 53:53/udp</code> y <code>--publish 53:53/tcp</code>: Publica el puerto 53 (UDP y TCP) en el host.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#3-prueba-inicial-del-servidor-dns","title":"3. Prueba Inicial del Servidor DNS","text":"<ul> <li>Verifica que el servidor DNS funciona correctamente:   <pre><code>nslookup cisco.com 127.0.0.1\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#4-preparacion-de-archivos-de-configuracion","title":"4. Preparaci\u00f3n de Archivos de Configuraci\u00f3n","text":"<ul> <li>Crea una carpeta en tu host para almacenar los archivos de configuraci\u00f3n:   <pre><code>mkdir miserverdns\ncd miserverdns\n</code></pre></li> <li> <p>Crea los siguientes archivos dentro de la carpeta:</p> <ul> <li><code>named.conf</code>:   <pre><code>include \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\n</code></pre></li> <li><code>named.conf.options</code>: Configura las opciones de BIND9 (por ejemplo, <code>allow-query</code> y <code>forwarders</code>).</li> <li><code>named.conf.local</code>: Define las zonas DNS (directa e inversa).</li> <li><code>db.deaw.es</code>: Archivo de zona directa para el dominio <code>deaw.es</code>.</li> <li><code>db.3.85.104</code>: Archivo de zona inversa para la red <code>3.85.104</code>.</li> </ul> </li> <li> <p>Ejemplo de <code>named.conf.local</code>:   <pre><code>zone \"deaw.es\" {\n    type master;\n    file \"/etc/bind/db.deaw.es\";\n};\n\nzone \"104.85.3.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.3.85.104\";\n};\n</code></pre></p> </li> <li> <p>Ejemplo de <code>db.deaw.es</code>:   <pre><code>$TTL 1d\n$ORIGIN deaw.es.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; A records\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n</code></pre></p> </li> <li> <p>Ejemplo de <code>db.3.85.104</code>:   <pre><code>$TTL 1d\n$ORIGIN 104.85.3.IN-ADDR.ARPA.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; PTR record\n173 IN  PTR     ns1.deaw.es.\n</code></pre></p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#5-copiar-archivos-al-contenedor","title":"5. Copiar Archivos al Contenedor","text":"<ul> <li>Copia los archivos de configuraci\u00f3n al contenedor:   <pre><code>docker cp named.conf miserverdns:/etc/bind/\ndocker cp named.conf.options miserverdns:/etc/bind/\ndocker cp named.conf.local miserverdns:/etc/bind/\ndocker cp db.deaw.es miserverdns:/etc/bind/\ndocker cp db.3.85.104 miserverdns:/etc/bind/\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#6-reiniciar-el-contenedor","title":"6. Reiniciar el Contenedor","text":"<ul> <li>Reinicia el contenedor para aplicar los cambios:   <pre><code>docker restart miserverdns\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#7-verificacion-de-la-configuracion","title":"7. Verificaci\u00f3n de la Configuraci\u00f3n","text":"<ul> <li>Verifica la configuraci\u00f3n con los siguientes comandos:   <pre><code>docker exec miserverdns named-checkconf\ndocker exec miserverdns named-checkzone deaw.es /etc/bind/db.deaw.es\ndocker exec miserverdns named-checkzone 104.85.3.in-addr.arpa /etc/bind/db.3.85.104\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#8-pruebas-de-funcionamiento","title":"8. Pruebas de Funcionamiento","text":"<ul> <li>Resoluci\u00f3n directa:   <pre><code>nslookup www.deaw.es 127.0.0.1\ndig deaw.es @127.0.0.1\n</code></pre></li> <li>Resoluci\u00f3n inversa:   <pre><code>nslookup 3.85.104.173 127.0.0.1\ndig -x 3.85.104.173 @127.0.0.1\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#cheatsheet-configuracion-de-un-servidor-ldap-con-openldap-y-phpldapadmin","title":"Cheatsheet: Configuraci\u00f3n de un Servidor LDAP con OpenLDAP y phpLDAPadmin","text":""},{"location":"Ud4/Ch4_MIP/#1-creacion-de-la-maquina-virtual-en-aws","title":"1. Creaci\u00f3n de la M\u00e1quina Virtual en AWS","text":"<ul> <li>Nombre de la instancia: <code>ServidorLDAP</code>.</li> <li>Sistema operativo: Debian.</li> <li>Grupo de seguridad: Abre los puertos necesarios para LDAP (389 TCP) y phpLDAPadmin (80 TCP).</li> <li>Actualizaci\u00f3n del sistema:   <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade -y\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#2-instalacion-de-openldap","title":"2. Instalaci\u00f3n de OpenLDAP","text":"<ul> <li>Instala los paquetes necesarios:   <pre><code>sudo apt-get install slapd ldap-utils\n</code></pre></li> <li>Durante la instalaci\u00f3n, se solicitar\u00e1 una contrase\u00f1a para el administrador de LDAP. Usa <code>ieselcaminas</code>.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#3-configuracion-inicial-de-openldap","title":"3. Configuraci\u00f3n Inicial de OpenLDAP","text":"<ul> <li>Reconfigura <code>slapd</code> para definir el dominio base:   <pre><code>sudo dpkg-reconfigure slapd\n</code></pre></li> <li> <p>Pasos durante la reconfiguraci\u00f3n:</p> <ol> <li>Omitir configuraci\u00f3n inicial: Selecciona \"No\".</li> <li>Nombre del dominio: Introduce <code>daw.ieselcaminas</code>.</li> <li>Nombre de la organizaci\u00f3n: Introduce <code>daw.ieselcaminas</code>.</li> <li>Contrase\u00f1a de administrador: Usa <code>ieselcaminas</code>.</li> <li>Base de datos backend: Selecciona <code>MDB</code>.</li> <li>Eliminar base de datos al purgar: Selecciona \"No\".</li> <li>Mover la base de datos antigua: Selecciona \"Yes\".</li> </ol> </li> <li> <p>Verifica la configuraci\u00f3n con:   <pre><code>sudo slapcat\n</code></pre>   Deber\u00edas ver el nodo ra\u00edz <code>dc=daw,dc=ieselcaminas</code>.</p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#4-instalacion-de-phpldapadmin","title":"4. Instalaci\u00f3n de phpLDAPadmin","text":"<ul> <li>Instala phpLDAPadmin para la gesti\u00f3n gr\u00e1fica:   <pre><code>sudo apt-get install phpldapadmin\n</code></pre></li> <li>Accede a phpLDAPadmin desde tu navegador:   <pre><code>http://&lt;IP_DEL_SERVIDOR&gt;/phpldapadmin\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#5-configuracion-de-phpldapadmin","title":"5. Configuraci\u00f3n de phpLDAPadmin","text":"<ul> <li>Edita el archivo de configuraci\u00f3n para ajustar el dominio base:   <pre><code>sudo nano /etc/phpldapadmin/config.php\n</code></pre></li> <li>Busca y modifica las siguientes l\u00edneas:   <pre><code>$servers-&gt;setValue('server','base',array('dc=daw,dc=ieselcaminas'));\n$servers-&gt;setValue('login','bind_id','cn=admin,dc=daw,dc=ieselcaminas');\n</code></pre></li> <li>Guarda y cierra el archivo.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#6-creacion-de-unidades-organizativas-ou","title":"6. Creaci\u00f3n de Unidades Organizativas (OU)","text":"<ul> <li>Accede a phpLDAPadmin:<ul> <li>Usuario: <code>cn=admin,dc=daw,dc=ieselcaminas</code>.</li> <li>Contrase\u00f1a: <code>ieselcaminas</code>.</li> </ul> </li> <li>Crea las OU:<ol> <li>Haz clic en <code>dc=daw,dc=ieselcaminas</code>.</li> <li>Selecciona \"Create a child entry\".</li> <li>Elige \"Generic: Organizational Unit\".</li> <li>Crea las OU <code>ou=grupos</code> y <code>ou=usuarios</code>.</li> </ol> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#7-creacion-de-grupos","title":"7. Creaci\u00f3n de Grupos","text":"<ul> <li>Crea el grupo <code>profesores</code>:<ol> <li>Selecciona <code>ou=grupos</code>.</li> <li>Haz clic en \"Create a child entry\".</li> <li>Elige \"Default\" y luego \"posixGroup\".</li> <li>Completa los campos:<ul> <li>Group Name: <code>profesores</code>.</li> <li>GID Number: <code>10000</code>.</li> </ul> </li> </ol> </li> <li>Crea el grupo <code>alumnos</code>:<ul> <li>Sigue los mismos pasos, pero usa <code>alumnos</code> como nombre y <code>10001</code> como GID.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#8-creacion-de-usuarios","title":"8. Creaci\u00f3n de Usuarios","text":"<ul> <li>Crea el usuario <code>profe01</code>:<ol> <li>Selecciona <code>ou=usuarios</code>.</li> <li>Haz clic en \"Create a child entry\".</li> <li>Elige \"Default\" y luego selecciona <code>account</code> y <code>posixAccount</code>.</li> <li>Completa los campos:<ul> <li>First Name: <code>profe01</code>.</li> <li>Last Name: <code>profesor</code>.</li> <li>Common Name: <code>profe01</code>.</li> <li>User ID: <code>profe01</code>.</li> <li>Group ID: <code>10000</code> (profesores).</li> <li>Home Directory: <code>/home/profe01</code>.</li> <li>Password: Establece una contrase\u00f1a.</li> </ul> </li> </ol> </li> <li>Crea los usuarios <code>alu01</code> y <code>alu02</code>:<ul> <li>Sigue los mismos pasos, pero usa <code>alumnos</code> como grupo (GID <code>10001</code>).</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#9-verificacion-de-la-configuracion","title":"9. Verificaci\u00f3n de la Configuraci\u00f3n","text":"<ul> <li>Verifica los usuarios y grupos:<ul> <li>Navega por el \u00e1rbol LDAP en phpLDAPadmin para asegurarte de que los usuarios y grupos se han creado correctamente.</li> </ul> </li> <li>Prueba la autenticaci\u00f3n:<ul> <li>Usa <code>ldapsearch</code> para verificar que los usuarios y grupos son accesibles:   <pre><code>ldapsearch -x -b \"dc=daw,dc=ieselcaminas\" -D \"cn=admin,dc=daw,dc=ieselcaminas\" -w \"ieselcaminas\"\n</code></pre></li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#cheatsheet-carga-de-datos-en-un-servidor-ldap-mediante-ficheros-ldif","title":"Cheatsheet: Carga de Datos en un Servidor LDAP mediante Ficheros LDIF","text":""},{"location":"Ud4/Ch4_MIP/#1-creacion-de-la-maquina-virtual-en-aws_1","title":"1. Creaci\u00f3n de la M\u00e1quina Virtual en AWS","text":"<ul> <li>Nombre de la instancia: <code>ServidorLDAP2</code>.</li> <li>Sistema operativo: Debian.</li> <li>Grupo de seguridad: Usa el grupo de seguridad <code>ServidorLDAP</code> creado anteriormente.</li> <li>Actualizaci\u00f3n del sistema:   <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade -y\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#2-instalacion-de-openldap_1","title":"2. Instalaci\u00f3n de OpenLDAP","text":"<ul> <li>Instala los paquetes necesarios:   <pre><code>sudo apt-get install slapd ldap-utils\n</code></pre></li> <li>Durante la instalaci\u00f3n, se solicitar\u00e1 una contrase\u00f1a para el administrador de LDAP. Usa <code>ieselcaminas</code>.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#3-configuracion-inicial-de-openldap_1","title":"3. Configuraci\u00f3n Inicial de OpenLDAP","text":"<ul> <li>Reconfigura <code>slapd</code> para definir el dominio base:   <pre><code>sudo dpkg-reconfigure slapd\n</code></pre></li> <li> <p>Pasos durante la reconfiguraci\u00f3n:</p> <ol> <li>Omitir configuraci\u00f3n inicial: Selecciona \"No\".</li> <li>Nombre del dominio: Introduce <code>proyecto-empresa.local</code>.</li> <li>Nombre de la organizaci\u00f3n: Introduce <code>proyecto-empresa.local</code>.</li> <li>Contrase\u00f1a de administrador: Usa <code>ieselcaminas</code>.</li> <li>Base de datos backend: Selecciona <code>MDB</code>.</li> <li>Eliminar base de datos al purgar: Selecciona \"No\".</li> <li>Mover la base de datos antigua: Selecciona \"Yes\".</li> </ol> </li> <li> <p>Verifica la configuraci\u00f3n con:   <pre><code>sudo slapcat\n</code></pre>   Deber\u00edas ver el nodo ra\u00edz <code>dc=proyecto-empresa,dc=local</code>.</p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#4-creacion-de-unidades-organizativas-ou","title":"4. Creaci\u00f3n de Unidades Organizativas (OU)","text":"<ul> <li>Crea un archivo <code>estructura_basica.ldif</code> con el siguiente contenido:   <pre><code># Usuarios\ndn: ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: usuarios\n\n# Grupos\ndn: ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: grupos\n</code></pre></li> <li>A\u00f1ade las OU al servidor LDAP:   <pre><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f estructura_basica.ldif\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#5-creacion-de-grupos","title":"5. Creaci\u00f3n de Grupos","text":"<ul> <li>Crea un archivo <code>grupos.ldif</code> con el siguiente contenido:   <pre><code># Grupo profesores\ndn: cn=profesores,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: profesores\ngidNumber: 10000\n\n# Grupo alumnos\ndn: cn=alumnos,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: alumnos\ngidNumber: 10001\n</code></pre></li> <li>A\u00f1ade los grupos al servidor LDAP:   <pre><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f grupos.ldif\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#6-creacion-de-usuarios","title":"6. Creaci\u00f3n de Usuarios","text":"<ul> <li>Crea un archivo <code>profesores.ldif</code> con el siguiente contenido:   <pre><code># Profe01\ndn: uid=profe01,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe01\ncn: profe01\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/profe01\ngecos: Profe01 DAW\nuserPassword: 123456\n\n# Profe02\ndn: uid=profe02,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe02\ncn: profe02\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1002\ngidNumber: 10000\nhomeDirectory: /home/profe02\ngecos: Profe02 DAW\nuserPassword: 123456\n</code></pre></li> <li> <p>A\u00f1ade los usuarios al servidor LDAP:   <pre><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f profesores.ldif\n</code></pre></p> </li> <li> <p>Crea usuarios alumnos:</p> <ul> <li>Sigue el mismo formato que <code>profesores.ldif</code>, pero usa <code>alu01</code> y <code>alu02</code> como nombres, <code>2001</code> y <code>2002</code> como <code>uidNumber</code>, y <code>10001</code> como <code>gidNumber</code>.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#7-modificacion-de-objetos","title":"7. Modificaci\u00f3n de Objetos","text":"<ul> <li>Crea un archivo <code>cambiar_usuario.ldif</code> para cambiar la contrase\u00f1a de un usuario:   <pre><code># Cambiar contrase\u00f1a Usuario\ndn: uid=alu01,ou=usuarios,dc=proyecto-empresa,dc=local\nchangetype: modify\nreplace: userPassword\nuserPassword: 654321\n</code></pre></li> <li>Modifica la contrase\u00f1a:   <pre><code>ldapmodify -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f cambiar_usuario.ldif\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#8-busqueda-en-la-base-de-datos","title":"8. B\u00fasqueda en la Base de Datos","text":"<ul> <li>Buscar todos los profesores:   <pre><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uid=*profe*)\"\n</code></pre></li> <li>Buscar un profesor por <code>uidNumber</code>:   <pre><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uidNumber=1002)\"\n</code></pre></li> <li>Buscar profesores con <code>gidNumber</code> espec\u00edfico:   <pre><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(&amp;(uid=*profe*)(gidNumber=10001))\"\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#9-eliminacion-de-registros","title":"9. Eliminaci\u00f3n de Registros","text":"<ul> <li>Eliminar un usuario:   <pre><code>ldapdelete -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas uid=alu02,ou=usuarios,dc=proyecto-empresa,dc=local\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#cheatsheet-dockerizacion-de-un-servidor-ldap-con-openldap-y-phpldapadmin","title":"Cheatsheet: Dockerizaci\u00f3n de un Servidor LDAP con OpenLDAP y phpLDAPadmin","text":""},{"location":"Ud4/Ch4_MIP/#1-creacion-de-una-red-docker","title":"1. Creaci\u00f3n de una Red Docker","text":"<ul> <li>Crea una red Docker para que los contenedores de OpenLDAP y phpLDAPadmin puedan comunicarse:   <pre><code>docker network create ldap-network\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#2-creacion-del-contenedor-openldap","title":"2. Creaci\u00f3n del Contenedor OpenLDAP","text":"<ul> <li>Usa la imagen oficial de OpenLDAP para crear el contenedor:   <pre><code>docker run \\\n    --net ldap-network \\\n    --hostname ldap-service \\\n    --name ldap-service \\\n    --env LDAP_ORGANISATION=\"daw.ieselcaminas\" \\\n    --env LDAP_DOMAIN=\"daw.ieselcaminas\" \\\n    --env LDAP_ADMIN_PASSWORD=\"ieselcaminas\" \\\n    --detach osixia/openldap\n</code></pre></li> <li> <p>Explicaci\u00f3n:</p> <ul> <li><code>--net ldap-network</code>: Conecta el contenedor a la red <code>ldap-network</code>.</li> <li><code>--hostname ldap-service</code>: Asigna un nombre de host al contenedor dentro de la red.</li> <li><code>--env</code>: Define variables de entorno para configurar OpenLDAP.</li> <li><code>--detach</code>: Ejecuta el contenedor en segundo plano.</li> </ul> </li> <li> <p>Verifica la creaci\u00f3n de la base de datos:   <pre><code>docker exec ldap-service slapcat\n</code></pre>   Deber\u00edas ver el nodo ra\u00edz <code>dc=daw,dc=ieselcaminas</code>.</p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#3-creacion-del-contenedor-phpldapadmin","title":"3. Creaci\u00f3n del Contenedor phpLDAPadmin","text":"<ul> <li>Usa la imagen oficial de phpLDAPadmin para crear el contenedor:   <pre><code>docker run \\\n    --net ldap-network \\\n    --name phpldapadmin-service \\\n    --publish 443:443 \\\n    --hostname phpldapadmin-service \\\n    --env PHPLDAPADMIN_LDAP_HOSTS=ldap-service \\\n    --detach osixia/phpldapadmin\n</code></pre></li> <li>Explicaci\u00f3n:<ul> <li><code>--net ldap-network</code>: Conecta el contenedor a la red <code>ldap-network</code>.</li> <li><code>--publish 443:443</code>: Expone el puerto 443 del contenedor para acceder a phpLDAPadmin.</li> <li><code>--env PHPLDAPADMIN_LDAP_HOSTS=ldap-service</code>: Indica a phpLDAPadmin que el servidor LDAP est\u00e1 en el host <code>ldap-service</code>.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#4-acceso-a-phpldapadmin","title":"4. Acceso a phpLDAPadmin","text":"<ul> <li>Accede a phpLDAPadmin desde tu navegador:   <pre><code>https://&lt;IP_DEL_SERVIDOR&gt;\n</code></pre></li> <li>Credenciales de inicio de sesi\u00f3n:<ul> <li>Usuario: <code>cn=admin,dc=daw,dc=ieselcaminas</code>.</li> <li>Contrase\u00f1a: <code>ieselcaminas</code>.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#5-configuracion-de-la-base-de-datos-ldap","title":"5. Configuraci\u00f3n de la Base de Datos LDAP","text":"<ul> <li>Creaci\u00f3n de Unidades Organizativas (OU):<ul> <li>Usa phpLDAPadmin para crear las OU <code>ou=usuarios</code> y <code>ou=grupos</code> bajo <code>dc=daw,dc=ieselcaminas</code>.</li> </ul> </li> <li>Creaci\u00f3n de Grupos:<ul> <li>Crea los grupos <code>profesores</code> (GID <code>10000</code>) y <code>alumnos</code> (GID <code>10001</code>).</li> </ul> </li> <li>Creaci\u00f3n de Usuarios:<ul> <li>Crea usuarios como <code>profe01</code>, <code>profe02</code>, <code>alu01</code>, y <code>alu02</code> dentro de las OU correspondientes.</li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#6-verificacion-de-la-configuracion","title":"6. Verificaci\u00f3n de la Configuraci\u00f3n","text":"<ul> <li>Verifica los usuarios y grupos:<ul> <li>Navega por el \u00e1rbol LDAP en phpLDAPadmin para asegurarte de que los usuarios y grupos se han creado correctamente.</li> </ul> </li> <li>Prueba la autenticaci\u00f3n:<ul> <li>Usa <code>ldapsearch</code> para verificar que los usuarios y grupos son accesibles:   <pre><code>ldapsearch -x -b \"dc=daw,dc=ieselcaminas\" -D \"cn=admin,dc=daw,dc=ieselcaminas\" -w \"ieselcaminas\"\n</code></pre></li> </ul> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#cheatsheet-autenticacion-apache-contra-ldap","title":"Cheatsheet: Autenticaci\u00f3n Apache contra LDAP","text":""},{"location":"Ud4/Ch4_MIP/#1-preparacion-del-entorno_2","title":"1. Preparaci\u00f3n del Entorno","text":"<ul> <li>Arranca la m\u00e1quina <code>ServidorLDAP</code>: Aseg\u00farate de que el servidor LDAP est\u00e9 funcionando.</li> <li>Verifica el servicio Apache: Comprueba que Apache est\u00e1 en ejecuci\u00f3n:   <pre><code>sudo systemctl status apache2\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#2-habilitar-el-modulo-de-autenticacion-ldap-en-apache","title":"2. Habilitar el M\u00f3dulo de Autenticaci\u00f3n LDAP en Apache","text":"<ul> <li>Habilita el m\u00f3dulo <code>authnz_ldap</code>:   <pre><code>sudo a2enmod authnz_ldap\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#3-creacion-del-directorio-protegido","title":"3. Creaci\u00f3n del Directorio Protegido","text":"<ul> <li>Crea un directorio <code>test</code> dentro de <code>/var/www/html</code>:   <pre><code>sudo mkdir /var/www/html/test\n</code></pre></li> <li>Crea un archivo <code>index.html</code> dentro del directorio:   <pre><code>sudo nano /var/www/html/test/index.html\n</code></pre>   Contenido de <code>index.html</code>:   <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Sitio LDAP!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;Bienvenido al sitio validado por LDAP!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></li> <li>Cambia el propietario del directorio y su contenido a <code>www-data</code>:   <pre><code>sudo chown -R www-data:www-data /var/www/html/test\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#4-configuracion-de-apache-para-autenticacion-ldap","title":"4. Configuraci\u00f3n de Apache para Autenticaci\u00f3n LDAP","text":"<ul> <li>Haz una copia de seguridad del archivo de configuraci\u00f3n de Apache:   <pre><code>sudo cp /etc/apache2/sites-enabled/000-default.conf /etc/apache2/sites-enabled/000-default.conf.backup\n</code></pre></li> <li>Edita el archivo de configuraci\u00f3n:   <pre><code>sudo nano /etc/apache2/sites-enabled/000-default.conf\n</code></pre></li> <li>A\u00f1ade las siguientes l\u00edneas dentro del bloque <code>&lt;VirtualHost&gt;</code>:   <pre><code>&lt;Directory \"/var/www/html/test\"&gt;\n    AuthType Basic\n    AuthName \"Apache LDAP authentication\"\n    AuthBasicProvider ldap\n    AuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub\"\n    AuthLDAPBindDN \"cn=admin,dc=daw,dc=ieselcaminas\"\n    AuthLDAPBindPassword ieselcaminas\n    Require valid-user\n&lt;/Directory&gt;\n</code></pre></li> <li> <p>Explicaci\u00f3n de las directivas:</p> <ul> <li><code>AuthType Basic</code>: Define el m\u00e9todo de autenticaci\u00f3n b\u00e1sica.</li> <li><code>AuthName</code>: Especifica el mensaje que se muestra en el cuadro de di\u00e1logo de autenticaci\u00f3n.</li> <li><code>AuthBasicProvider ldap</code>: Indica que el proveedor de autenticaci\u00f3n es LDAP.</li> <li><code>AuthLDAPURL</code>: Especifica la URL del servidor LDAP y los par\u00e1metros de b\u00fasqueda.</li> <li><code>AuthLDAPBindDN</code> y <code>AuthLDAPBindPassword</code>: Credenciales para autenticarse en el servidor LDAP.</li> <li><code>Require valid-user</code>: Permite el acceso solo a usuarios autenticados.</li> </ul> </li> <li> <p>Reinicia Apache:   <pre><code>sudo systemctl restart apache2\n</code></pre></p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#5-prueba-de-autenticacion","title":"5. Prueba de Autenticaci\u00f3n","text":"<ul> <li>Abre una ventana privada en tu navegador y accede a:   <pre><code>http://&lt;IP_DEL_SERVIDOR&gt;/test\n</code></pre></li> <li>Introduce las credenciales de un usuario LDAP (por ejemplo, <code>profe01</code> y su contrase\u00f1a).</li> <li>Verifica que el acceso es correcto y que se muestra la p\u00e1gina <code>index.html</code>.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#6-configuracion-con-htaccess-opcional","title":"6. Configuraci\u00f3n con <code>.htaccess</code> (Opcional)","text":"<ul> <li>Recupera la configuraci\u00f3n original de Apache:   <pre><code>sudo cp /etc/apache2/sites-enabled/000-default.conf.backup /etc/apache2/sites-enabled/000-default.conf\n</code></pre></li> <li>Modifica el bloque <code>&lt;Directory&gt;</code> en el archivo de configuraci\u00f3n:   <pre><code>&lt;Directory \"/var/www/html/test\"&gt;\n    AllowOverride All\n&lt;/Directory&gt;\n</code></pre></li> <li>Crea un archivo <code>.htaccess</code> en <code>/var/www/html/test</code>:   <pre><code>sudo nano /var/www/html/test/.htaccess\n</code></pre>   Contenido de <code>.htaccess</code>:   <pre><code>AuthType Basic\nAuthName \"Apache LDAP authentication\"\nAuthBasicProvider ldap\nAuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub\"\nRequire valid-user\n</code></pre></li> <li>Configura las credenciales de LDAP en <code>/etc/ldap/ldap.conf</code>:   <pre><code>sudo nano /etc/ldap/ldap.conf\n</code></pre>   Contenido de <code>ldap.conf</code>:   <pre><code># Opciones de conexi\u00f3n\nBINDDN cn=admin,dc=daw,dc=ieselcaminas\nBINDPW ieselcaminas\n</code></pre></li> <li>Reinicia Apache:   <pre><code>sudo systemctl restart apache2\n</code></pre></li> <li>Prueba nuevamente el acceso a <code>http://&lt;IP_DEL_SERVIDOR&gt;/test</code>.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#cheatsheet-autenticacion-apache-contra-ldap-dockerizada","title":"Cheatsheet: Autenticaci\u00f3n Apache contra LDAP Dockerizada","text":""},{"location":"Ud4/Ch4_MIP/#1-preparacion-del-entorno_3","title":"1. Preparaci\u00f3n del Entorno","text":"<ul> <li>Aseg\u00farate de tener el servidor OpenLDAP dockerizado funcionando: Debe estar configurado con los usuarios creados en la \"Pr\u00e1ctica 5 - Dockerizaci\u00f3n de servidor LDAP\".</li> <li>Verifica la red Docker: Aseg\u00farate de que la red <code>ldap-network</code> est\u00e9 creada y que los contenedores de OpenLDAP y phpLDAPadmin est\u00e9n conectados a ella.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#2-creacion-del-dockerfile","title":"2. Creaci\u00f3n del Dockerfile","text":"<ul> <li> <p>Crea un archivo <code>Dockerfile</code> con el siguiente contenido:   <pre><code>FROM php:7-apache\n\n# Activamos el m\u00f3dulo LDAP de Apache\nRUN a2enmod authnz_ldap\n\n# Creamos el directorio test\nRUN mkdir -p /var/www/html/test\n\n# Copiamos los ficheros necesarios\nCOPY index.html /var/www/html/test/index.html\nCOPY 000-default.conf /etc/apache2/sites-enabled/000-default.conf\n</code></pre></p> </li> <li> <p>Archivo <code>index.html</code>:   <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Sitio LDAP!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;Bienvenido al sitio validado por LDAP!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></p> </li> <li> <p>Archivo <code>000-default.conf</code>:   <pre><code>&lt;VirtualHost *:80&gt;\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/html\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    &lt;Directory \"/var/www/html/test\"&gt;\n        AuthType Basic\n        AuthName \"Apache LDAP authentication\"\n        AuthBasicProvider ldap\n        AuthLDAPURL \"ldap://ldap-service/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub\"\n        AuthLDAPBindDN \"cn=admin,dc=daw,dc=ieselcaminas\"\n        AuthLDAPBindPassword ieselcaminas\n        Require valid-user\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre></p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#3-construccion-de-la-imagen-docker","title":"3. Construcci\u00f3n de la Imagen Docker","text":"<ul> <li>Construye la imagen Docker:   <pre><code>docker build -t my-apache2 .\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#4-ejecucion-del-contenedor-apache","title":"4. Ejecuci\u00f3n del Contenedor Apache","text":"<ul> <li>Lanza el contenedor Apache conectado a la red <code>ldap-network</code>:   <pre><code>docker run \\\n    --net ldap-network \\\n    --name apache2_server \\\n    -d \\\n    -p 80:80 \\\n    my-apache2\n</code></pre></li> </ul>"},{"location":"Ud4/Ch4_MIP/#5-prueba-de-autenticacion_1","title":"5. Prueba de Autenticaci\u00f3n","text":"<ul> <li>Accede desde un navegador a:   <pre><code>http://&lt;IP_DEL_SERVIDOR&gt;/test\n</code></pre></li> <li>Introduce las credenciales de un usuario LDAP (por ejemplo, <code>profe01</code> y su contrase\u00f1a).</li> <li>Verifica que el acceso es correcto y que se muestra la p\u00e1gina <code>index.html</code>.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#6-configuracion-con-variables-de-entorno-opcional","title":"6. Configuraci\u00f3n con Variables de Entorno (Opcional)","text":"<ul> <li> <p>Modifica el archivo <code>000-default.conf</code> para usar variables de entorno:   <pre><code>PassEnv LDAP_BIND_ON\nPassEnv LDAP_PASSWORD\nPassEnv LDAP_URL\n&lt;VirtualHost *:80&gt;\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/html\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    &lt;Directory \"/var/www/html/test\"&gt;\n        AuthType Basic\n        AuthName \"Apache LDAP authentication\"\n        AuthBasicProvider ldap\n        AuthLDAPBindDN ${LDAP_BIND_ON}\n        AuthLDAPBindPassword ${LDAP_PASSWORD}\n        AuthLDAPURL ${LDAP_URL}\n        Require valid-user\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre></p> </li> <li> <p>Reconstruye la imagen Docker:   <pre><code>docker build -t my-apache2 .\n</code></pre></p> </li> <li> <p>Lanza el contenedor con variables de entorno:   <pre><code>docker run -d \\\n    --name apache2_server \\\n    --net ldap-network \\\n    -p 80:80 \\\n    -e LDAP_BIND_ON='cn=admin,dc=daw,dc=ieselcaminas' \\\n    -e LDAP_PASSWORD='ieselcaminas' \\\n    -e LDAP_URL='ldap://ldap-service/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub' \\\n    my-apache2\n</code></pre></p> </li> <li> <p>Prueba nuevamente el acceso a <code>http://&lt;IP_DEL_SERVIDOR&gt;/test</code>.</p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#cheatsheet-autenticacion-nginx-contra-ldap","title":"Cheatsheet: Autenticaci\u00f3n Nginx contra LDAP","text":""},{"location":"Ud4/Ch4_MIP/#1-preparacion-del-entorno_4","title":"1. Preparaci\u00f3n del Entorno","text":"<ul> <li>Servidor LDAP: Aseg\u00farate de que el servidor LDAP configurado en la \"Pr\u00e1ctica 2\" est\u00e9 en ejecuci\u00f3n. Obt\u00e9n su IP p\u00fablica.</li> <li>Servidor Nginx: Crea una nueva instancia EC2 en AWS o utiliza una existente con Nginx instalado.</li> </ul>"},{"location":"Ud4/Ch4_MIP/#2-creacion-del-sitio-virtual-en-nginx","title":"2. Creaci\u00f3n del Sitio Virtual en Nginx","text":"<ul> <li>Crea el directorio para el sitio virtual:   <pre><code>sudo mkdir -p /var/www/sitioldap\n</code></pre></li> <li> <p>Crea el archivo <code>index.html</code>:   <pre><code>sudo nano /var/www/sitioldap/index.html\n</code></pre>   Contenido de <code>index.html</code>:   <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Sitio LDAP!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;Bienvenido al sitio validado por LDAP!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></p> </li> <li> <p>Crea el archivo de configuraci\u00f3n del sitio virtual:   <pre><code>sudo nano /etc/nginx/sites-available/sitioldap\n</code></pre>   Contenido inicial (sin autenticaci\u00f3n LDAP):   <pre><code>server {\n    listen 80;\n    server_name sitioldap;\n    root /var/www/sitioldap;\n    index index.html;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre></p> </li> <li> <p>Activa el sitio virtual:   <pre><code>sudo ln -s /etc/nginx/sites-available/sitioldap /etc/nginx/sites-enabled/\n</code></pre></p> </li> <li> <p>Verifica la configuraci\u00f3n de Nginx:   <pre><code>sudo nginx -t\n</code></pre></p> </li> <li> <p>Reinicia Nginx:   <pre><code>sudo systemctl restart nginx\n</code></pre></p> </li> <li> <p>Acceso al sitio: Modifica el archivo <code>/etc/hosts</code> en tu m\u00e1quina local para incluir la IP del servidor Nginx y el nombre <code>sitioldap</code>. Accede a <code>http://sitioldap</code> para verificar que el sitio funciona sin autenticaci\u00f3n.</p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#3-instalacion-del-modulo-de-autenticacion-ldap-en-nginx","title":"3. Instalaci\u00f3n del M\u00f3dulo de Autenticaci\u00f3n LDAP en Nginx","text":"<ul> <li> <p>Descarga e instala el m\u00f3dulo <code>ngx_http_auth_ldap_module</code>:   <pre><code>wget https://example.com/path/to/libnginx-mod-http-auth-ldap_1.0.0-1_amd64.deb\nsudo dpkg -i libnginx-mod-http-auth-ldap_1.0.0-1_amd64.deb\n</code></pre></p> </li> <li> <p>Verifica que el m\u00f3dulo est\u00e9 habilitado:   <pre><code>ls -la /etc/nginx/modules-enabled/\n</code></pre></p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#4-configuracion-de-la-autenticacion-ldap-en-nginx","title":"4. Configuraci\u00f3n de la Autenticaci\u00f3n LDAP en Nginx","text":"<ul> <li> <p>Edita el archivo de configuraci\u00f3n principal de Nginx (<code>/etc/nginx/nginx.conf</code>) para a\u00f1adir el bloque <code>ldap_server</code>:   <pre><code>http {\n    ldap_server mi_servidor_ldap {\n        url ldap://&lt;IP_SERVIDOR_LDAP&gt;/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub;\n        binddn \"cn=admin,dc=daw,dc=ieselcaminas\";\n        binddn_passwd \"ieselcaminas\";\n        group_attribute member;\n        group_attribute_is_dn on;\n        require valid_user;\n    }\n\n    include /etc/nginx/sites-enabled/*;\n}\n</code></pre>   Reemplaza <code>&lt;IP_SERVIDOR_LDAP&gt;</code> con la IP p\u00fablica del servidor LDAP.</p> </li> <li> <p>Modifica el archivo de configuraci\u00f3n del sitio virtual (<code>/etc/nginx/sites-available/sitioldap</code>) para habilitar la autenticaci\u00f3n LDAP:   <pre><code>server {\n    listen 80;\n    server_name sitioldap;\n    root /var/www/sitioldap;\n    index index.html;\n\n    location / {\n        try_files $uri $uri/ =404;\n        auth_ldap \"Protected Area\";\n        auth_ldap_servers mi_servidor_ldap;\n    }\n}\n</code></pre></p> </li> <li> <p>Verifica la configuraci\u00f3n de Nginx:   <pre><code>sudo nginx -t\n</code></pre></p> </li> <li> <p>Reinicia Nginx:   <pre><code>sudo systemctl restart nginx\n</code></pre></p> </li> </ul>"},{"location":"Ud4/Ch4_MIP/#5-prueba-de-autenticacion-ldap","title":"5. Prueba de Autenticaci\u00f3n LDAP","text":"<ul> <li>Accede a <code>http://sitioldap</code> desde un navegador.</li> <li>Deber\u00eda aparecer un cuadro de di\u00e1logo solicitando usuario y contrase\u00f1a.</li> <li>Usa las credenciales de un usuario LDAP (por ejemplo, <code>profe01</code> y su contrase\u00f1a) para autenticarte.</li> <li>Verifica que el acceso es correcto y que se muestra la p\u00e1gina <code>index.html</code>.</li> </ul>"},{"location":"Ud4/Ch4_MMC/","title":"CheatSheet DNS y LDAP","text":"<p>Tipo: Apuntes Estado: Completado Tema: Despliegue</p>"},{"location":"Ud4/Ch4_MMC/#herramientas-de-diagnostico-de-servidor-de-nombres","title":"Herramientas de Diagn\u00f3stico de Servidor de Nombres \ud83d\udd0d","text":"sudo apt-get install dnsutils Instalar: dig, host y nslookup host (zona) // dig (zona) // nslookup (zona) Consulta de nombre."},{"location":"Ud4/Ch4_MMC/#servidor-dns","title":"Servidor DNS \u2601\ufe0f","text":"sudo apt-get install bind9 bind9utils bind9-doc Instalar DNS /etc/bind/named.conf Archivo de configuraci\u00f3n de Bind"},{"location":"Ud4/Ch4_MMC/#configuracion-namedconfoptions","title":"Configuraci\u00f3n named.conf.options \u26c8\ufe0f","text":"allow-query { any; }; A\u00f1adir  a named.conf.options para aceptar todas las solicitudes sudo named-checkconf Comprobar si las modificaciones son correctas recursion no; A\u00f1adir a named.conf.options para eliminar la recursividad. forwarders { 8.8.8.8; 8.8.4.4; }; A\u00f1adir a named.conf.options para realizar consultas recursivas a un DNS propio"},{"location":"Ud4/Ch4_MMC/#configuracion-namedconflocal","title":"Configuraci\u00f3n named.conf.local \u26c5","text":"<p>| zone \"deaw.es\" {         type master;         file \"/etc/bind/db.deaw.es\";  //Ruta donde ubicamos nuestro archivo de zona }; | A\u00f1adir  a named.conf.local para declarar zonas. | | --- | --- |</p>"},{"location":"Ud4/Ch4_MMC/#creacion-zonas","title":"Creaci\u00f3n zonas \ud83c\udf24\ufe0f","text":"<p>| $TTL 1d $ORIGIN deaw.es. ; base domain-name @   IN  SOA     ns1.deaw.es. admin.deaw.es. (  2023112301  ; Serial   8H           ; Refresh   2H           ; Retry   4W          ; Expire   1D )         ; Minimum TTL ; Name Servers   IN  NS      ns1.deaw.es. ; A records   ns1 IN  A       3.85.104.173   www IN  A       3.85.104.173 | Zona resoluci\u00f3n directa | | --- | --- | | $TTL 1d $ORIGIN 104.85.3.IN-ADDR.ARPA. @   IN  SOA     ns1.deaw.es. admin.deaw.es. (   2023112301  ; Serial   8H           ; Refresh   2H           ; Retry   4W          ; Expire   1D )         ; Minimum TTL</p> <p>; Name Servers   IN  NS      ns1.deaw.es.</p> <p>; PTR record   173 IN  PTR     ns1.deaw.es. ; fully qualified domain name (FQDN) | Zona de resoluci\u00f3n inversa |</p>"},{"location":"Ud4/Ch4_MMC/#servidor-ldap","title":"Servidor LDAP \ud83d\udd78\ufe0f","text":"sudo apt-get install slapd ldap-utils Instalar OpenLDAP sudo slapcat Informaci\u00f3n de la base de datos sudo dpkg-reconfigure slapd Configurar OpenLDAP sudo apt-get install phpldapadmin Instalar app web para modificar la base de datos. Acceso: http://IPSERVER/phpldapadmin sudo nano /etc/phpldapadmin/config.php Fichero de configuraci\u00f3n de phpLDAPadmin"},{"location":"Ud4/Ch4_MMC/#creacion-de-base-de-datos-mediante-ficheros-ldif","title":"Creaci\u00f3n de base de datos mediante ficheros .ldif \ud83c\udfd9\ufe0f","text":"<p>| # Usuarios    dn: ou=usuarios,dc=proyecto-empresa,dc=local    objectClass: organizationalUnit    ou: usuarios</p>"},{"location":"Ud4/Ch4_MMC/#grupos","title":"Grupos","text":"<p>dn: ou=grupos,dc=proyecto-empresa,dc=local    objectClass: organizationalUnit    ou: grupos | Fichero .ldif con 2 unidades organizativas (ou). | | --- | --- | | ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f estructura_basica.ldif | Incorporaci\u00f3n de los datos .ldif a la base de datos | | ldapsearch -x -b dc=proyecto-empresa,dc=local \"(b\u00fasqueda)\" | Buscar en la base de datos | | $ ldapdelete -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas uid=alu02,ou=usuarios,dc=proyecto-empresa,dc=local | Borrar registros de la base de datos |</p>"},{"location":"Ud4/Ch4_MMC/#autentificacion-apache-con-ldap","title":"Autentificaci\u00f3n Apache con LDAP \ud83d\udd10","text":"sudo a2enmod authnz_ldap Habilita el m\u00f3dulo de autenticaci\u00f3n LDAP Apache2 AuthType Basic AuthName \"Apache LDAP authentication\" AuthBasicProvider ldap AuthLDAPURL ldap://host:port/basedn?attribute?scope?filter [NONE SSL AuthLDAPBindDN \"cn=admin,dc=daw,dc=ieselcaminas\" AuthLDAPBindPassword ieselcaminas Require valid-user L\u00edneas de 000-default.conf para habilitar LDAP."},{"location":"Ud4/Ch4_MMC/#autentificacion-nginx-con-ldap","title":"Autentificaci\u00f3n Nginx con LDAP \ud83d\udd10","text":"sudo dpkg -i libnginx-mod-http-auth-ldap_1.0.0-1_amd64.deb M\u00f3dulo de autentificaci\u00f3n http { ldap_server mi_servidor_ldap { url  ldap://IPSERVIDOR/ou=usuarios,dc=daw, dc=ieselcaminas?uid?sub; binddn \"cn=admin,dc=daw,dc=ieselcaminas\"; binddn_passwd \"ieselcaminas\"; group_attribute member; group_attribute_is_dn on; <pre><code> require valid_user;\n</code></pre> <p>}</p> <p>include /etc/nginx/sites-enabled/*; } | L\u00edneas de /etc/nginx/nginx.conf para habilitar LDAP. | | server {     listen 80;     server_name sitioldap;     root /var/www/sitioldap;     index index.html;</p> <pre><code># Configuraci\u00f3n LDAP\nlocation / {\n   try_files $uri $uri/ =404;\n   auth_ldap \"Protected Area\";\n   auth_ldap_servers mi_servidor_ldap;\n}\n</code></pre> <p>} | Modificaci\u00f3n de /etc/nginx/sites-available/sitioldap para la utilizaci\u00f3n de LDAP. | | sudo nginx -t | Comprobaci\u00f3n de la  configuraci\u00f3n |</p>"},{"location":"Ud4/Ch4_PPE/","title":"Cheatsheet UD4 - Servicios de Red","text":"<p>Este documento resume los comandos y ficheros de configuraci\u00f3n para la creaci\u00f3n y gesti\u00f3n de servicios de red DNS y LDAP en sistemas Ubuntu, correspondientes a la Unidad 4 del curso de Despliegue de Aplicaciones.</p>"},{"location":"Ud4/Ch4_PPE/#servidor-dns","title":"\ud83d\udda5\ufe0f Servidor DNS","text":""},{"location":"Ud4/Ch4_PPE/#herramientas-de-resolucion-de-nombres","title":"\ud83c\udf10 Herramientas de resoluci\u00f3n de nombres","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt update &amp;&amp; sudo apt upgrade</code> Actualiza la lista y los paquetes instalados a la \u00faltima versi\u00f3n disponible. <code>sudo apt install dnsutils</code> Instalamos las herramientas en nuestro sistema. <code>cat /etc/resolv.conf \\| grep nameserver</code> Visualizar la IP del servidor DNS que tenemos configurado. <code>host DOM_NAME 127.0.0.1</code> Devuelve informaci\u00f3n b\u00e1sica sobre el dominio, como la direcci\u00f3n IP. Si no le especificamos la IP, coge la del servidor DNS configurado por defecto. <code>dig DOM_NAME</code> Proporciona detalles sobre la resoluci\u00f3n DNS, incluyendo secciones de respuesta, autoridad y adicionales. <code>nslookup DOM_NAME</code> Permite realizar consultas espec\u00edficas y obtener informaci\u00f3n detallada sobre el dominio."},{"location":"Ud4/Ch4_PPE/#instalacion-del-servidor-dns","title":"\ud83c\udf10 Instalaci\u00f3n del servidor DNS","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt install bind9 bind9utils bind9-doc</code> Instalamos los repositorios oficiales para configurar el servidor. <p>Una vez lo hemos instalado, vamos a editar el fichero <code>/etc/systemd/resolved.conf</code> y modificamos la siguiente l\u00ednea para establecer nuestro servidor como DNS por defecto.</p> <pre><code>[Resolve]\nDNS=127.0.0.1\n</code></pre> <p>Al terminar, debemos reiniciar el servicio para aplicar la configuraci\u00f3n <code>sudo systemctl restart systemd-resolved</code>.</p>"},{"location":"Ud4/Ch4_PPE/#configuraciones-dns","title":"\ud83c\udf10 Configuraciones DNS","text":"\ud83d\udd27 Fichero de configuraci\u00f3n \ud83d\udcdd Funcionalidad <code>/etc/bind/named.conf</code> Archivo principal que incluye otros archivos de configuraci\u00f3n y define opciones globales. <code>/etc/bind/named.conf.options</code> Contiene las opciones globales, las direcciones de los servidores DNS a los que reenviar consultas. <code>/etc/bind/named.conf.local</code> Define zonas locales, zonas directas e inversas para los dominios que el servidor DNS es autoritativo. <code>/etc/bind/named.conf.default-zones</code> Contiene la configuraci\u00f3n de las zonas predeterminadas, las zonas ra\u00edz y localhost. <p>\ud83d\udca1 Tip: Es recomendable hacer una copia de seguridad de cada fichero de configuraci\u00f3n antes de hacer cualquier tipo de modificaci\u00f3n. Ejemplo: <code>sudo cp /etc/bind/named.conf.options /etc/bind/named.conf.options.old</code>. Adem\u00e1s, cada vez que queramos aplicar los cambios, debemos reiniciar el servicio con el comando <code>sudo systemctl restart bind9</code>.</p>"},{"location":"Ud4/Ch4_PPE/#configuracion-namedconfoptions","title":"\ud83d\udee0\ufe0f Configuraci\u00f3n named.conf.options","text":"<pre><code>options {\n    directory \"/var/cache/bind\";\n\n    # Permitir consultas desde cualquier origen\n    allow-query { any; };\n\n    # Desactivar la recursividad\n    recursion no;\n\n    # Configuraci\u00f3n de los forwarders (DNS de Google)\n    forwarders {\n        8.8.8.8;\n        8.8.4.4;\n    };\n\n    dnssec-validation auto;\n    listen-on-v6 { any; };\n};\n</code></pre> <p>Para verificar que el fichero no tiene errores de sintaxis, podemos ejecutar el comando <code>sudo named-checkconf</code>.</p>"},{"location":"Ud4/Ch4_PPE/#configuracion-namedconflocal","title":"\ud83d\udee0\ufe0f Configuraci\u00f3n named.conf.local","text":"<pre><code># Zona directa\nzone \"ZONE_NAME\" {\n        type master;\n        file \"/etc/bind/db.ZONE_NAME\"; #Ruta donde ubicamos nuestro archivo de zona\n};\n\n# Zona inversa\nzone \"104.85.3.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.3.85.104\";  # Ruta al archivo de zona inversa\n};\n</code></pre> <p>Una vez configuramos las zonas en el fichero, debemos crear los archivos de zona correspondientes con la ruta que hemos establecido en <code>named.conf.local</code>.</p>"},{"location":"Ud4/Ch4_PPE/#configuracion-de-la-zona-directa","title":"\ud83d\udee0\ufe0f Configuraci\u00f3n de la zona directa","text":"<pre><code>; Zona directa (/etc/bind/db.ZONE_NAME)\n$TTL 1d\n$ORIGIN deaw.es. ; base domain-name\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; A records\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n</code></pre>"},{"location":"Ud4/Ch4_PPE/#configuracion-de-la-zona-inversa","title":"\ud83d\udee0\ufe0f Configuraci\u00f3n de la zona inversa","text":"<pre><code>; Zona inversa (/etc/bind/db.3.85.104)\n$TTL 1d\n$ORIGIN 104.85.3.IN-ADDR.ARPA.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n\n; Name Servers\n    IN  NS      ns1.deaw.es.\n\n; PTR record\n173 IN  PTR     ns1.deaw.es. ; fully qualified domain name (FQDN)\n</code></pre> <p>Para verificar que el archivo de zona no tiene errores de sintaxis, podemos ejecutar el comando <code>sudo named-checkzone ZONE_NAME /etc/bind/db.ZONE_NAME</code>.</p>"},{"location":"Ud4/Ch4_PPE/#reiniciar-el-servicio","title":"\ud83d\udd04 Reiniciar el servicio","text":"<p>Despu\u00e9s de realizar las configuraciones, reinicia el servicio BIND9 para aplicar los cambios:</p> <pre><code>sudo systemctl restart bind9\n</code></pre> <p>Con estas configuraciones y verificaciones, tu servidor DNS deber\u00eda estar funcionando correctamente y respondiendo a las consultas tanto locales como externas.</p>"},{"location":"Ud4/Ch4_PPE/#servidor-ldap","title":"\ud83d\udda5\ufe0f Servidor LDAP","text":""},{"location":"Ud4/Ch4_PPE/#instalacion-del-servicio","title":"\ud83d\udee0\ufe0f Instalaci\u00f3n del servicio","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt install slapd ldap-utils</code> Instala el servidor OpenLDAP y sus utilidades. <code>sudo dpkg-reconfigure slapd</code> Reconfigura el servidor LDAP (slapd) permitiendo cambiar la configuraci\u00f3n inicial. <code>sudo slapcat</code> Ver la informaci\u00f3n actual de la base de datos de ldap desde terminal."},{"location":"Ud4/Ch4_PPE/#configuracion-mediante-phpldapadmin","title":"\ud83d\udda5\ufe0f Configuraci\u00f3n mediante phpLDAPadmin","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt install phpldapadmin</code> Actualiza la lista y los paquetes instalados a la \u00faltima versi\u00f3n disponible. <p>\ud83d\udca1 Tip: Antes de acceder a la herramienta, es recomendable acceder al fichero de configuraci\u00f3n <code>/etc/phpldapadmin/config.php</code> y cambiar el DIT por defecto por el que vamos a utilizar nosotros. Por ejemplo:</p> <pre><code>-   $servers-&gt;;setValue('server','base',array('dc=example,dc=com'));\n-   $servers-&gt;setValue('login','bind_id','cn=admin,dc=example,dc=com');\n\n+   $servers-&gt;setValue('server','base',array('dc=daw,dc=ieselcaminas'));\n+   $servers-&gt;setValue('login','bind_id','cn=admin,dc=daw,dc=ieselcaminas');\n</code></pre>"},{"location":"Ud4/Ch4_PPE/#configuracion-mediante-ficheros-ldif","title":"\ud83d\uddc2\ufe0f Configuraci\u00f3n mediante ficheros ldif","text":"<pre><code># Ejemplo de estructura b\u00e1sica de fichero ldif\n\n# OU\ndn: ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: usuarios\n\n# Grupos\ndn: cn=profesores,ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: posixGroup\ncn: profesores\ngidNumber: 10000 # es importante que no lo est\u00e9 utilizando otro grupo antes\n\n# Usuarios\ndn: uid=profe01,ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: profe01\ncn: profe01\nsn: DAW\nloginShell: /bin/bash\nuidNumber: 1001\ngidNumber: 10000\nhomeDirectory: /home/profe01\ngecos: Profe01 DAW\nuserPassword: 123456\n</code></pre> \ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>ldapadd -x -D cn=admin,dc=USER -w PASSWD -f FILE.ldif</code> A\u00f1ade entradas al directorio LDAP desde un archivo LDIF. <code>ldapmodify -x -D cn=admin,dc=USER -w PASSWD -f FILE.ldif</code> Modifica entradas existentes en el directorio LDAP utilizando un archivo LDIF. <code>ldapsearch -x -b dc=DN \"(&amp;(uid=*profe*)(gidNumber=10001))\"</code> Realiza una busqueda en el directorio LDAP con el filtro especificado entre comas \"\". <code>ldapdelete -x -D cn=admin,dc=USER -w PASSWD uid=USER,ou=OU</code> Elimina un usuario del directorio LDAP."},{"location":"Ud4/Ch4_PPE/#autenticacion-con-apache","title":"\ud83c\udf10 Autenticaci\u00f3n con Apache","text":"<p>Para habilitar la autenticaci\u00f3n, debemos realizar los cambios en los siguientes ficheros de configuraci\u00f3n de Apache y LDAP:</p> <pre><code># /etc/apache2/sites-enabled/000-default.conf\n\n&lt;Directory \"/var/www/html/ldap\"&gt; \n        AuthType Basic\n        AuthName \"Apache LDAP authentication\"\n        AuthBasicProvider ldap \n+        AuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=daw,dc=ieselcaminas?uid?sub\" \n+        AuthLDAPBindDN \"cn=admin,dc=daw,dc=ieselcaminas\"\n+        AuthLDAPBindPassword ieselcaminas\n        Require valid-user\n&lt;/Directory&gt;\n</code></pre> <pre><code># /etc/ldap/ldap.conf\n\n+    BINDDN cn=admin,dc=daw,dc=ieselcaminas\n+    BINDPW ieselcaminas\n</code></pre> <p>\ud83d\udca1 Tip: Debemos asegurarnos tambi\u00e9n de que el m\u00f3dulo de autenticaci\u00f3n de LDAP est\u00e1 habilitado en Apache con <code>sudo a2enmod authnz_ldap</code>.</p>"},{"location":"Ud4/Ch4_RPE/","title":"Cheatsheet de Servicios de red DNS y LDAP \ud83c\udf10\ud83d\udd10","text":""},{"location":"Ud4/Ch4_RPE/#dns-domain-name-system","title":"DNS - Domain Name System \ud83c\udf0d","text":""},{"location":"Ud4/Ch4_RPE/#comandos-de-resolucion-de-nombres","title":"Comandos de resoluci\u00f3n de nombres \ud83d\udd0e","text":""},{"location":"Ud4/Ch4_RPE/#instalacion-de-dnsutils","title":"Instalaci\u00f3n de dnsutils \ud83d\udee0\ufe0f","text":"<pre><code>sudo apt-get install dnsutils\n</code></pre> Comando Descripci\u00f3n <code>host &lt;dominio&gt;</code> Muestra informaci\u00f3n b\u00e1sica del dominio, principalmente su direcci\u00f3n IP <code>dig &lt;dominio&gt;</code> Muestra m\u00e1s informaci\u00f3n sobre el dominio, como la lista de servidores DNS que utilizan para resolver el nombre <code>nslookup &lt;dominio&gt;</code> Similar a hosts, pero permite cambiar el servidor DNS a utilizar"},{"location":"Ud4/Ch4_RPE/#instalacion-de-bind9","title":"Instalaci\u00f3n de Bind9 \ud83d\udee0\ufe0f","text":"<pre><code>sudo apt-get install bind9 bind9utils bind9-doc\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#archivos-de-configuracion","title":"Archivos de configuraci\u00f3n \ud83d\udcc2","text":"\u2699\ufe0f Archivo \ud83d\udcdd Descripci\u00f3n <code>/etc/bind/named.conf</code> Archivo principal de configuraci\u00f3n de Bind. <code>/etc/bind/named.conf.options</code> Archivo de configuraci\u00f3n global. <code>/etc/bind/named.conf.local</code> Archivo de configuraci\u00f3n para las zonas locales. <code>/etc/bind/named.conf.default-zones</code> Archivo de configuraci\u00f3n de zonas predeterminadas. <code>/etc/bind/db.&lt;dominio&gt;</code> Registros DNS para un dominio personalizado."},{"location":"Ud4/Ch4_RPE/#comandos-para-comprobar-la-configuracion-de-bind","title":"Comandos para comprobar la configuraci\u00f3n de Bind \ud83d\udee0\ufe0f","text":"Comando Descripci\u00f3n <code>named-checkconf</code> Verifica la sintaxis de los archivos de configuraci\u00f3n <code>named-checkzone &lt;dominio&gt; /etc/bind/&lt;dominio&gt;</code> Verifica la configuraci\u00f3n de un dominio espec\u00edfico"},{"location":"Ud4/Ch4_RPE/#ejemplos-de-archivos-de-configuracion-de-bind","title":"Ejemplos de archivos de configuraci\u00f3n de Bind \ud83d\udcd1","text":""},{"location":"Ud4/Ch4_RPE/#archivo-de-configuracion-principal-namedconf","title":"Archivo de configuraci\u00f3n principal (named.conf)","text":"<pre><code>include \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\ninclude \"/etc/bind/named.conf.default-zones\";\n\nallow-query { any; };  // Permitir todas las solicitudes desde cualquier IP\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#archivo-de-configuracion-global-namedconfoptions","title":"Archivo de configuraci\u00f3n global (named.conf.options)","text":"<pre><code>options {\n    recursion no; // Desactiva la recursividad\n    forwarders {\n        // DNS de Google\n        8.8.8.8;\n        8.8.4.4;\n    };\n};\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#archivo-de-configuracion-local-namedconflocal","title":"Archivo de configuraci\u00f3n local (named.conf.local)","text":"<pre><code>//\n// Do any local configuration here\n//\n\n// Consider adding the 1918 zones here, if they are not used in your\n// organization\n//include \"/etc/bind/zones.rfc1918\";\n\nzone \"prueba\" {\n    type master;\n    file \"/etc/bind/db.prueba\";\n};\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#archivo-de-zona-de-prueba-dbprueba","title":"Archivo de zona de prueba (db.prueba)","text":"<pre><code>$TTL 1d\n$ORIGIN deaw.es. ; base domain-name\n@   IN  SOA     ns1.prueba. admin.prueba. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.prueba.\n; A records\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#configuracion-de-una-zona-inversa","title":"\u26a0\ufe0f Configuraci\u00f3n de una zona inversa","text":"<p>Para crear una zona inversa a\u00f1adiremos la siguiente l\u00ednea al archivo de configuraci\u00f3n de Bind:</p> <pre><code>zone \"104.85.3.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.3.85.104\";  # Ruta al archivo de zona inversa\n};\n</code></pre> <p>Y en el archivo de zona inversa:</p> <pre><code>$TTL 1d\n$ORIGIN 104.85.3.IN-ADDR.ARPA.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n\n; Name Servers\n    IN  NS      ns1.deaw.es.\n\n; PTR record\n173 IN  PTR     ns1.deaw.es. ; fully qualified domain name (FQDN)\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#ldap-lightweight-directory-access-protocol","title":"LDAP - Lightweight Directory Access Protocol \ud83d\udd11","text":""},{"location":"Ud4/Ch4_RPE/#instalacion-de-ldap","title":"Instalaci\u00f3n de LDAP \ud83d\udee0\ufe0f","text":"<pre><code>sudo apt-get install slapd ldap-utils\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#archivos-de-configuracion_1","title":"Archivos de configuraci\u00f3n \ud83d\udcc2","text":"\u2699\ufe0f Archivo \ud83d\udcdd Descripci\u00f3n <code>/etc/ldap/ldap.conf</code> Configuraci\u00f3n de los clientes LDAP <code>/etc/sldap/sldap.conf</code> Configuraci\u00f3n del servidor LDAP <code>estructura.lidf</code> Definici\u00f3n de la estructura de los datos LDAP"},{"location":"Ud4/Ch4_RPE/#comandos-de-configuracion-de-ldap","title":"Comandos de configuraci\u00f3n de LDAP","text":"Comando Descripci\u00f3n <code>dpkg-reconfigure slapd</code> Recofigura el servicio LDAP <code>slapcat</code> Extrae el contenido de la base de datos LDAP"},{"location":"Ud4/Ch4_RPE/#ejemplos-de-archivos-de-configuracion-de-ldap","title":"Ejemplos de archivos de configuraci\u00f3n de LDAP \ud83d\udcd1","text":""},{"location":"Ud4/Ch4_RPE/#archivo-de-estructura-de-datos-estructuraldif","title":"Archivo de estructura de datos (estructura.ldif)","text":"<pre><code>dn: dc=aplicacion,dc=local\nobjectClass: top\nobjectClass: dcObject\nobjectClass: organization\no: Aplicaci\u00f3n\ndc: aplicacion\n\ndn: ou=frontend,dc=aplicacion,dc=local\nobjectClass: organizationalUnit\nou: frontend\n\ndn: ou=backend,dc=aplicacion,dc=local\nobjectClass: organizationalUnit\nou: backend\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#comandos-ldap","title":"Comandos LDAP \ud83d\udee0\ufe0f","text":""},{"location":"Ud4/Ch4_RPE/#creacion-de-objetos-ldap","title":"Creaci\u00f3n de objetos LDAP \u2795","text":"<p>A\u00f1ade nuevos objetos al directorio LDAP desde un archivo LDIF.</p> <p><pre><code>ldapadd -x -D \"cn=admin,dc=aplicacion,dc=local\" -w \"&lt;contrase\u00f1a_LDAP&gt;\" -f estructura.ldif\n</code></pre> - El par\u00e1metro <code>-x</code> indica que se debe a\u00f1adir el objeto sin confirmaci\u00f3n. - El par\u00e1metro <code>-D</code> indica el DN de la cuenta de administrador. - El par\u00e1metro <code>-w</code> indica la contrase\u00f1a de la cuenta de administrador. - El par\u00e1metro <code>-f</code> indica el archivo LDIF que contiene los datos a a\u00f1adir.</p>"},{"location":"Ud4/Ch4_RPE/#modificacion-de-objetos-ldap","title":"Modificaci\u00f3n de objetos LDAP \u270f\ufe0f","text":"<pre><code>ldapmodify -x -D \"cn=admin,dc=aplicacion,dc=local\" -w \"&lt;contrase\u00f1a_LDAP&gt;\" -f estructura.ldif\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#eliminacion-de-objetos-ldap","title":"Eliminaci\u00f3n de objetos LDAP \u274c","text":"<pre><code>ldapdelete -x -D \"cn=admin,dc=aplicacion,dc=local\" -w \"&lt;contrase\u00f1a_LDAP&gt;\" -f estructura.ldif\n</code></pre>"},{"location":"Ud4/Ch4_RPE/#consulta-de-objetos-ldap","title":"Consulta de objetos LDAP \ud83d\udd0d","text":"<pre><code>ldapsearch -x -b dc=aplicacion,dc=local \"(uid=*dev01*)\"\n</code></pre> <ul> <li>El par\u00e1metro <code>-b</code> indica el DN de la base de datos a consultar.</li> </ul>"},{"location":"Ud4/Ch4_RRL/","title":"Cheatsheet DNS y LDAP","text":""},{"location":"Ud4/Ch4_RRL/#dns","title":"DNS","text":"<p>El DNS traduce nombres de dominio legibles por humanos a direcciones IP num\u00e9ricas.</p>"},{"location":"Ud4/Ch4_RRL/#dnsutils","title":"DNSUTILS","text":"<pre><code>sudo apt install dnsutils\n</code></pre> <p>Gracias a este paquete podemos utilizar herramientas para la administraci\u00f3n y resoluci\u00f3n de DNS en sistemas Linux.</p> <pre><code>nslookup $direccion\n\ndig  $direccion\n\nhost $direccion\n</code></pre>"},{"location":"Ud4/Ch4_RRL/#bind9","title":"BIND9","text":"<pre><code>sudo apt-get install bind9 bind9utils bind9-doc \n</code></pre> <p>Gracias a este comando podemos usar el servidor DNS bind9 y varias utilidades que nos ayudar\u00e1n a administrarlo y configurarlo.</p>"},{"location":"Ud4/Ch4_RRL/#archivos-de-configuracion-bind9","title":"ARCHIVOS DE CONFIGURACI\u00d3N BIND9","text":"<ul> <li> <p><code>/etc/bind/named.conf</code> -&gt;  Este archivo contiene las directrices b\u00e1sicas y referencias a otros archivos de configuraci\u00f3n utilizados por el servidor.</p> </li> <li> <p><code>/etc/bind/named.conf.options</code> -&gt; Aqu\u00ed es donde se configuran opciones globales y par\u00e1metros principales para el servidor DNS.</p> </li> <li> <p><code>/etc/bind/named.conf.local</code> -&gt; En este archivo se definen las zonas DNS personalizadas para el servidor DNS.</p> </li> <li> <p><code>/etc/bind/named.conf.default-zones</code> -&gt; Aqu\u00ed se definen las zonas DNS predeterminadas.</p> </li> <li> <p><code>/etc/bind/db.example.com</code> -&gt; Archivo de zona en el que se encuentran los registros de recursos.</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#configuracion-del-archivo-de-zona","title":"CONFIGURACI\u00d3N DEL ARCHIVO DE ZONA","text":"<pre><code>$TTL 1d\n$ORIGIN example.com. ; dominio base\n@   IN  SOA     ns1.example.com. admin.example.com. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Servidores de nombres (Name Servers)\n    IN  NS      ns1.example.com.\n; Registros A (direcciones IP)\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n</code></pre>"},{"location":"Ud4/Ch4_RRL/#configuracion-del-archivo-de-etcbindnamedconf","title":"CONFIGURACI\u00d3N DEL ARCHIVO DE /etc/bind/named.conf","text":"<pre><code>include \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\ninclude \"/etc/bind/named.conf.default-zones\";\nallow-query { any; };  // Permitir consultas desde cualquier IP\n</code></pre>"},{"location":"Ud4/Ch4_RRL/#configuracion-del-archivo-de-etcbindnamedconfoptions","title":"CONFIGURACI\u00d3N DEL ARCHIVO DE /etc/bind/named.conf.options","text":"<pre><code>options {\n    recursion no; // Desactiva la recursividad\n    forwarders {\n        8.8.8.8;  // Google DNS 1\n        8.8.4.4;  // Google DNS 2\n    };\n};\n</code></pre>"},{"location":"Ud4/Ch4_RRL/#comandos-de-administracion-bind9","title":"COMANDOS DE ADMINISTRACI\u00d3N BIND9","text":"<ul> <li> <p><code>sudo named-checkconf</code> -&gt; Verifica la sintaxis del archivo de configuraci\u00f3n.</p> </li> <li> <p><code>sudo named-checkzone example.com /etc/bind/db.example.com</code> -&gt; Verifica la sintaxis y la validez del archivo de la zona.</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#ldap","title":"LDAP","text":"<p>Los directorios LDAP se utilizan com\u00fanmente para almacenar informaci\u00f3n sobre usuarios, grupos, dispositivos y otros objetos, organizados de manera jer\u00e1rquica.</p> <pre><code>sudo apt install slapd ldap-utils\n</code></pre> <p>Este comando instala los paquetes necesarios para configurar un servidor LDAP.</p> <pre><code>sudo dpkg-reconfigure slapd\n</code></pre> <p>Este comando se usa para reconfigurar el servidor LDAP, permite establecer par\u00e1metros como el dominio de base, el administrador y las configuraciones de seguridad.</p>"},{"location":"Ud4/Ch4_RRL/#archivos-de-configuracion-ldap","title":"ARCHIVOS DE CONFIGURACI\u00d3N LDAP","text":"<ul> <li> <p><code>/etc/ldap/ldap.conf</code> -&gt; Configuraci\u00f3n principal del cliente LDAP.</p> </li> <li> <p><code>/etc/slapd/slapd.conf</code> -&gt; Configuraci\u00f3n del servidor SLAPD, que es el servidor LDAP que se utiliza para gestionar directorios LDAP.</p> </li> <li> <p><code>ejemplo.ldif</code> -&gt;  Los archivos LDIF son archivos de texto que contienen registros que representan entradas de un directorio LDAP.</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#comandos-para-administrar-ldap","title":"COMANDOS PARA ADMINISTRAR LDAP","text":"<ul> <li> <p><code>sudo slapcat</code> -&gt; Exporta el contenido de un servidor LDAP a un archivo en formato LDIF.</p> </li> <li> <p><code>ldapadd -x -D \"cn=admin,dc=ejemplo,dc=local\" -w contrase\u00f1a -f ejemplo.ldif</code> -&gt; A\u00f1adir objetos a la base LDAP desde un archivo LDIF.</p> </li> <li> <p><code>ldapsearch -x -b \"dc=ejemplo,dc=local\" \"(uid=*usuario*)\"</code> -&gt; Buscar entradas LDAP que coincidan con la expresi\u00f3n <code>(uid=*usuario*)</code>.</p> </li> <li> <p><code>ldapmodify -x -D cn=admin,dc=ejemplo,dc=local -w contrase\u00f1a -f cambiarUsuario.ldif</code> -&gt;  Se utiliza para realizar modificaciones en el directorio LDAP</p> </li> <li> <p><code>ldapdelete -x -D cn=admin,dc=ejemplo,dc=local -w contrase\u00f1a uid=alu02,ou=usuarios,dc=ejemplo,dc=local</code> -&gt; Elimina la entrada especificada del directorio LDAP</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#archivo-ldif","title":"ARCHIVO LDIF","text":"<pre><code>dn: dc=empresa,dc=local\nobjectClass: top\nobjectClass: dcObject\nobjectClass: organization\no: Proyecto Empresa\ndc: empresa\n\ndn: ou=people,dc=empresa,dc=local\nobjectClass: organizationalUnit\nou: people\n\ndn: ou=groups,dc=empresa,dc=local\nobjectClass: organizationalUnit\nou: groups\n</code></pre>"},{"location":"Ud4/Ch4_RRL/#ldapadd","title":"LDAPADD","text":"<pre><code>ldapadd -x -D \"cn=admin,dc=ejemplo,dc=local\" -w contrase\u00f1a -f ejemplo.ldif\n</code></pre> <ul> <li> <p><code>-x</code> -&gt; Autenticaci\u00f3n simple.</p> </li> <li> <p><code>-D</code> -&gt; Define el usuario administrador LDAP (DN).</p> </li> <li> <p><code>-w</code> -&gt; Contrase\u00f1a del usuario LDAP.</p> </li> <li> <p><code>-f</code> -&gt; Especifica el archivo LDIF a usar.</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#ldapsearch","title":"LDAPSEARCH","text":"<pre><code>ldapsearch -x -b \"dc=ejemplo,dc=local\" \"(uid=*usuario*)\"\n</code></pre> <ul> <li> <p><code>-x</code> -&gt; Autenticaci\u00f3n simple.</p> </li> <li> <p><code>-b</code> -&gt; Define la base de b\u00fasqueda.</p> </li> <li> <p><code>(uid=*usuario*)</code> -&gt; Expresi\u00f3n de b\u00fasqueda.</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#ldapmodify","title":"LDAPMODIFY","text":"<pre><code>ldapmodify -x -D cn=admin,dc=ejemplo,dc=local -w contrase\u00f1a -f cambiarUsuario.ldif\n</code></pre> <ul> <li> <p><code>-x</code> -&gt; Autenticaci\u00f3n simple.</p> </li> <li> <p><code>-D</code> -&gt; Define el usuario administrador LDAP (DN).</p> </li> <li> <p><code>-w</code> -&gt; Contrase\u00f1a del usuario LDAP.</p> </li> <li> <p><code>-f</code> -&gt; Especifica el archivo LDIF a usar.</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#ldapdelete","title":"LDAPDELETE","text":"<pre><code>ldapdelete -x -D cn=admin,dc=ejemplo,dc=local -w contrase\u00f1a uid=alu02,ou=usuarios,dc=ejemplo,dc=local\n</code></pre> <ul> <li> <p><code>-x</code> -&gt; Autenticaci\u00f3n simple.</p> </li> <li> <p><code>-D</code> -&gt; Define el usuario administrador LDAP (DN).</p> </li> <li> <p><code>-w</code> -&gt; Contrase\u00f1a del usuario LDAP.</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#autentificacion-web-con-ldap","title":"AUTENTIFICACI\u00d3N WEB CON LDAP","text":"<p>Podemos configurar un servidor web para que utilice un servidor LDAP como fuente de autenticaci\u00f3n, lo que significa que las credenciales de los usuarios ser\u00e1n validadas contra la base de datos LDAP.</p>"},{"location":"Ud4/Ch4_RRL/#apache2","title":"APACHE2","text":"<p>Primero que todo, tenemos que activar un m\u00f3dulo.</p> <pre><code>sudo a2enmod authnz_ldap\n</code></pre> <p>Ahora vamos a implementar la autentificaci\u00f3n en el archivo de configuraci\u00f3n.</p> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/html\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    &lt;Directory \"/var/www/html/test\"&gt;\n        AuthType Basic\n        AuthName \"Apache LDAP authentication\"\n        AuthBasicProvider ldap\n        AuthLDAPURL \"ldap://127.0.0.1/ou=usuarios,dc=ejemplo,dc=local?uid?sub\"\n        AuthLDAPBindDN \"cn=admin,dc=ejemplo,dc=local\"\n        AuthLDAPBindPassword \"contrase\u00f1a\"\n        Require valid-user\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre> <ul> <li> <p><code>AuthType Basic</code> -&gt; Define la autentificaci\u00f3n.</p> </li> <li> <p><code>AuthBasicProvider ldap</code> -&gt; Define que se usara LDAP para la autentificaci\u00f3n.</p> </li> <li> <p><code>AuthLDAPURL</code> -&gt; Define la URL del servidor LDAP.</p> </li> <li> <p><code>AuthLDAPBindDN</code> -&gt; Especifica el usuario.</p> </li> <li> <p><code>Require valid-user</code> -&gt; Obliga a que el usuario introducido sea v\u00e1lido.</p> </li> </ul>"},{"location":"Ud4/Ch4_RRL/#nginx","title":"NGINX","text":"<p>Primero tenemos que instalar el m\u00f3dulo de autentificaci\u00f3n LDAP.</p> <pre><code>sudo dpkg -i libnginx-mod-http-auth-ldap_1.0.0-1_amd64.deb\n\nls -la /etc/nginx/modules-enabled/\nlrwxrwxrwx 1 root root   58 Nov 27 19:01 50-mod-http-auth-ldap.conf -&gt; /usr/share/nginx/modules-available/mod-http-auth-ldap.conf\n</code></pre> <p>Ahora vamos a modificar el archivo de configuraci\u00f3n.</p> <pre><code>http {\n    ldap_server mi_servidor_ldap {\n        url ldap://IPSERVIDOR/ou=usuarios,dc=ejemplo,dc=local?uid?sub;\n        binddn \"cn=admin,dc=ejemplo,dc=local\";\n        binddn_passwd \"contrase\u00f1a\";\n        group_attribute member;\n        group_attribute_is_dn on;\n\n        require valid_user;\n    }\n\n    include /etc/nginx/sites-enabled/*;\n}\n</code></pre> <p>Ahora vamos a modificar el archivo de nuestro sitio virtual en <code>sites-available</code>.</p> <pre><code>server {\n    listen 80;\n    server_name sitioldap;\n    root /var/www/sitioldap;\n    index index.html;\n\n    # Configuraci\u00f3n LDAP\n    location / {\n        try_files $uri $uri/ =404;\n        auth_ldap \"Protected Area\";\n        auth_ldap_servers mi_servidor_ldap;\n    }\n}\n</code></pre>"},{"location":"Ud4/Ch4_RRL/#phpldapadmin","title":"PHPLDAPADMIN","text":"<pre><code>sudo apt install phpldapadmin\n</code></pre> <p>Este comando instala phpldapadmin, una herramienta web para administrar un servidor LDAP de manera gr\u00e1fica.</p>"},{"location":"Ud4/Ch4_VATC/","title":"\ud83c\udf1f Servicios de Red (DNS y LDAP)","text":"<p>\u270d\ufe0f Victor Alexandru Teleanu Covaci</p>"},{"location":"Ud4/Ch4_VATC/#dns-domain-name-system","title":"\ud83c\udf10 DNS - Domain Name System","text":""},{"location":"Ud4/Ch4_VATC/#herramientas-de-consulta-de-dns","title":"\ud83d\udd0d Herramientas de consulta de DNS","text":"<ul> <li>Con <code>sudo apt-get install dnsutils</code> instalamos herramientas para consultas DNS.</li> </ul> \ud83d\udee0\ufe0f Archivo \ud83d\udcdd Descripci\u00f3n <code>nslookup www.deaw.es</code> Realiza una consulta DNS para obtener la direcci\u00f3n IP de www.deaw.es. <code>nslookup www.deaw.es IP_SERVER</code> Realiza una consulta DNS utilizando un servidor espec\u00edfico para obtener la IP de www.deaw.es. <code>dig deaw.es</code> Realiza una consulta DNS para obtener informaci\u00f3n detallada de la zona de deaw.es."},{"location":"Ud4/Ch4_VATC/#configuracion-del-servidor","title":"\u2699\ufe0f Configuraci\u00f3n del servidor","text":"<ul> <li>Con <code>sudo apt-get install bind9 bind9utils bind9-doc</code> instalamos el servidor DNS con los repositorios oficiales.</li> </ul>"},{"location":"Ud4/Ch4_VATC/#archivos-importantes","title":"\ud83d\udcc2 Archivos importantes","text":"\ud83d\udee0\ufe0f Archivo \ud83d\udcdd Descripci\u00f3n <code>/etc/bind/named.conf</code> Configuraci\u00f3n principal de BIND. <code>/etc/bind/named.conf.options</code> Opciones globales de configuraci\u00f3n de BIND. <code>/etc/bind/named.conf.local</code> Configuraci\u00f3n local de zonas y servidores. <code>/etc/bind/named.conf.default-zones</code> Zonas predeterminadas para resoluci\u00f3n de nombres. <code>/etc/bind/db.deaw.es</code> Base de datos de zona para deaw.es."},{"location":"Ud4/Ch4_VATC/#configuracion-de-namedconf","title":"\ud83d\udcdd Configuraci\u00f3n de named.conf","text":"<pre><code>include \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#configuracion-de-namedconfoptions","title":"\u2699\ufe0f Configuraci\u00f3n de named.conf.options","text":"<ul> <li>Una buena pr\u00e1ctica es hacer una copia de seguridad de un archivo de configuraci\u00f3n cada vez que vayamos a realizar alg\u00fan cambio, para ello usamos <code>sudo cp /etc/bind/named.conf.options /etc/bind/named.conf.options.backup</code></li> </ul> <pre><code>options {\n\n    allow-query { any; }; # Permite consultas DNS desde cualquier direcci\u00f3n IP\n\n    recursion no; # Desactiva la recursi\u00f3n en el servidor DNS\n\n    forwarders {\n        8.8.8.8; # Google DNS\n        8.8.4.4; # Google DNS\n    };\n}\n</code></pre> <ul> <li>Con <code>sudo named-checkconf</code> verificamos la sintaxis del archivo de configuraci\u00f3n de BIND (named.conf).</li> </ul>"},{"location":"Ud4/Ch4_VATC/#configuracion-de-namedconflocal","title":"\ud83d\udd27 Configuraci\u00f3n de named.conf.local","text":"<pre><code>//\n// Do any local configuration here\n//\n\n// Consider adding the 1918 zones here, if they are not used in your\n// organization\n//include \"/etc/bind/zones.rfc1918\";\n\nzone \"deaw.es\" {\n        type master;\n        file \"/etc/bind/db.deaw.es\";  # Ruta donde ubicamos nuestro archivo de zona\n};\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#creacion-del-archivo-de-zona","title":"\ud83d\uddc2\ufe0f Creaci\u00f3n del archivo de zona","text":"<pre><code>$TTL 1d\n$ORIGIN deaw.es. ; base domain-name\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n; Name Servers\n    IN  NS      ns1.deaw.es.\n; A records\nns1 IN  A       3.85.104.173\nwww IN  A       3.85.104.173\n};\n</code></pre> <ul> <li>Con <code>sudo named-checkzone deaw.es /etc/bind/db.deaw.es</code> verificamos la validez del archivo de zona de deaw.es (/etc/bind/db.deaw.es).</li> </ul>"},{"location":"Ud4/Ch4_VATC/#creacion-del-archivo-de-zona-para-resolucion-inversa","title":"\ud83d\udd04 Creaci\u00f3n del archivo de zona para resoluci\u00f3n inversa","text":"<p>A\u00f1adimos estas lineas en /etc/bind/named.conf.local:</p> <pre><code>zone \"104.85.3.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.3.85.104\";  # Ruta al archivo de zona inversa\n};\n</code></pre> <p>Y la configuraci\u00f3n de la zona de resoluci\u00f3n inversa la realizaremos en el fichero descrito \"/etc/bind/db.3.85.104\"</p> <pre><code>$TTL 1d\n$ORIGIN 104.85.3.IN-ADDR.ARPA.\n@   IN  SOA     ns1.deaw.es. admin.deaw.es. (\n                  2023112301  ; Serial\n                  8H          ; Refresh\n                  2H          ; Retry\n                  4W          ; Expire\n                  1D )        ; Minimum TTL\n\n; Name Servers\n    IN  NS      ns1.deaw.es.\n\n; PTR record\n173 IN  PTR     ns1.deaw.es. ; fully qualified domain name (FQDN)\n</code></pre> <ul> <li>Con <code>sudo named-checkzone 104.85.3.in-addr.arpa /etc/bind/db.3.85.104</code></li> </ul>"},{"location":"Ud4/Ch4_VATC/#ldap-lightweight-directory-access-protocol","title":"\ud83c\udf10 LDAP - Lightweight Directory Access Protocol","text":""},{"location":"Ud4/Ch4_VATC/#instalacion-y-configuracion-openldap","title":"\ud83d\udcbb Instalaci\u00f3n y configuraci\u00f3n OpenLDAP","text":"<ul> <li>Con <code>sudo apt-get install slapd ldap-utils</code> instalamos el servidor LDAP (slapd) y herramientas de l\u00ednea de comandos para interactuar con LDAP (ldap-utils).</li> </ul>"},{"location":"Ud4/Ch4_VATC/#comandos-importantes","title":"\ud83d\udee0\ufe0f Comandos importantes","text":"\ud83d\udee0\ufe0f Comando \ud83d\udcdd Descripci\u00f3n <code>sudo slapcat</code> Exporta la base de datos de OpenLDAP. <code>sudo dpkg-reconfigure slapd</code> Reconfigura el servicio LDAP en Debian/Ubuntu. <code>sudo apt-get install phpldapadmin</code> Instala la interfaz web para administrar LDAP. <ul> <li>Con <code>sudo nano /etc/phpldapadmin/config.php</code> configuraremos la configuraci\u00f3n de phpldapadmin.</li> </ul> <p>Modificando estas lineas conseguiremos que el DIT, cuando vayamos a \"http://IPSERVER/phpldapadmin\", sea el nuestro:</p> <pre><code>$servers-&gt;setValue('server','base',array('dc=daw,dc=ieselcaminas'));\n$servers-&gt;setValue('login','bind_id','cn=admin,dc=daw,dc=ieselcaminas');\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#creacion-de-objetos-con-archivo-ldif","title":"\ud83c\udd95 Creaci\u00f3n de objetos con archivo .ldif","text":"<p>Creaci\u00f3n del archivo estructura_basica.ldif</p> <pre><code># Usuarios\ndn: ou=usuarios,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: usuarios\n\n# Grupos\ndn: ou=grupos,dc=proyecto-empresa,dc=local\nobjectClass: organizationalUnit\nou: grupos\n</code></pre> <p>Y para incorporar esta informaci\u00f3n en la base de datos usamos el siguiente comando:</p> <pre><code>ldapadd -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f estructura_basica.ldif\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#modificacion-de-objetos","title":"\ud83d\udd27 Modificaci\u00f3n de objetos","text":"<p>Creaci\u00f3n del archivo cambiar_usuario.ldif</p> <pre><code># Cambiar contrase\u00f1a Usuario\ndn: uid=alu01,ou=usuarios,dc=proyecto-empresa,dc=local\nchangetype: modify\nreplace: userPassword\nuserPassword: 654321\n</code></pre> <p>Y lo cambiamos con el siguiente comando:</p> <pre><code>ldapmodify -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas -f cambiar_usuario.ldif\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#busqueda-de-objetos","title":"\ud83d\udd0d B\u00fasqueda de objetos","text":""},{"location":"Ud4/Ch4_VATC/#para-buscar-a-todos-los-usuarios","title":"Para buscar a todos los usuarios:","text":"<pre><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uid=*usuarios*)\"\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#para-buscar-a-un-usuario-en-concreto","title":"Para buscar a un usuario en concreto:","text":"<pre><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(uidNumber=1002)\"\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#para-buscar-a-usuarios-con-gid-10001","title":"Para buscar a usuarios con gid 10001:","text":"<pre><code>ldapsearch -x -b dc=proyecto-empresa,dc=local \"(&amp;(uid=*usuarios*)(gidNumber=10001))\"\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#borrar-registros","title":"\u274c Borrar registros","text":"<p>Para borrar a un usuario en concreto (alu02):</p> <pre><code>$ ldapdelete -x -D cn=admin,dc=proyecto-empresa,dc=local -w ieselcaminas uid=alu02,ou=usuarios,dc=proyecto-empresa,dc=local\n</code></pre>"},{"location":"Ud4/Ch4_VATC/#explicacion-de-parametros","title":"\ud83d\udcda Explicaci\u00f3n de par\u00e1metros","text":"<ul> <li><code>-x</code>: Desactiva la autenticaci\u00f3n SASL, usa autenticaci\u00f3n simple.</li> <li><code>-D</code>: Especifica el DN del usuario con permisos.</li> <li><code>-w</code>: Proporciona la contrase\u00f1a del usuario.</li> <li><code>-f</code>: Indica el archivo LDIF con los datos a agregar/modificar.</li> <li><code>-b</code>: Define la base de b\u00fasqueda en el \u00e1rbol LDAP.</li> </ul>"},{"location":"Ud4/ch4_AEM/","title":"CHEATSHEEET TEMA 4 DNS ALEXANDRU EDUARD MUSAT","text":""},{"location":"Ud4/ch4_AEM/#1-comandos-para-configuracion-de-dns","title":"1. Comandos para Configuraci\u00f3n de DNS","text":"Acci\u00f3n Comando Instalar BIND9 <code>sudo apt update</code><code>sudo apt install bind9</code> Editar archivo de configuraci\u00f3n <code>sudo nano /etc/bind/named.conf.local</code> Editar archivos de zona <code>sudo nano /etc/bind/db.ejemplo.com</code><code>sudo nano /etc/bind/db.192.168.1</code> Verificar configuraci\u00f3n <code>sudo named-checkconf</code><code>sudo named-checkzone ejemplo.com /etc/bind/db.ejemplo.com</code> Reiniciar el servicio DNS <code>sudo systemctl restart bind9</code> Consultar el servidor DNS <code>nslookup ejemplo.com</code><code>dig @localhost ejemplo.com</code>"},{"location":"Ud4/ch4_AEM/#2-comandos-para-dockerizar-dns","title":"2. Comandos para Dockerizar DNS","text":"Acci\u00f3n Comando Construir imagen Docker <code>docker build -t dns_bind9 .</code> Ejecutar contenedor <code>docker run -d --name servidor_dns -p 53:53 -p 53:53/udp dns_bind9</code> Ver logs del contenedor <code>docker logs servidor_dns</code> Acceder al contenedor <code>docker exec -it servidor_dns /bin/bash</code> Listar contenedores activos <code>docker ps</code>"},{"location":"Ud4/ch4_AEM/#3-comandos-para-ldap","title":"3. Comandos para LDAP","text":"Acci\u00f3n Comando Instalar OpenLDAP <code>sudo apt update</code><code>sudo apt install slapd ldap-utils</code> Configurar OpenLDAP <code>sudo dpkg-reconfigure slapd</code> Verificar el servicio LDAP <code>sudo systemctl status slapd</code> Buscar entradas LDAP <code>ldapsearch -x -LLL -H ldap:/// -b dc=ejemplo,dc=com</code> A\u00f1adir entradas con LDIF <code>sudo ldapadd -x -D \"cn=admin,dc=ejemplo,dc=com\" -W -f archivo.ldif</code> Modificar entradas con LDIF <code>sudo ldapmodify -x -D \"cn=admin,dc=ejemplo,dc=com\" -W -f cambios.ldif</code> Eliminar entradas LDAP <code>ldapdelete -x -D \"cn=admin,dc=ejemplo,dc=com\" -W \"uid=usuario,dc=ejemplo,dc=com\"</code>"},{"location":"Ud4/ch4_AEM/#4-comandos-para-dockerizar-ldap","title":"4. Comandos para Dockerizar LDAP","text":"Acci\u00f3n Comando Descargar imagen de OpenLDAP <code>docker pull osixia/openldap</code> Crear contenedor LDAP <code>docker run --name ldap_container -p 389:389 -p 636:636 -e LDAP_DOMAIN=\"ejemplo.com\" -e LDAP_ADMIN_PASSWORD=\"admin\" -d osixia/openldap</code> Verificar el contenedor LDAP <code>docker logs ldap_container</code> Consultar el servidor LDAP <code>ldapsearch -x -H ldap://localhost -b dc=ejemplo,dc=com</code>"},{"location":"Ud4/ch4_AEM/#5-comandos-para-configurar-apache-con-ldap","title":"5. Comandos para Configurar Apache con LDAP","text":"Acci\u00f3n Comando Instalar m\u00f3dulos LDAP para Apache <code>sudo apt install apache2 libapache2-mod-ldap-userdir</code> Habilitar m\u00f3dulo de autenticaci\u00f3n <code>sudo a2enmod authnz_ldap</code> Reiniciar Apache <code>sudo systemctl restart apache2</code>"},{"location":"Ud4/ch4_AEM/#6-comandos-para-configurar-nginx-con-ldap","title":"6. Comandos para Configurar Nginx con LDAP","text":"Acci\u00f3n Comando Instalar nginx-extras <code>sudo apt install nginx-extras</code> Editar archivo de configuraci\u00f3n <code>sudo nano /etc/nginx/sites-available/default</code> Reiniciar servicio Nginx <code>sudo systemctl restart nginx</code>"},{"location":"Ud4/ch4_AEM/#7-comandos-generales-de-docker","title":"7. Comandos Generales de Docker","text":"Acci\u00f3n Comando Listar im\u00e1genes <code>docker images</code> Listar contenedores <code>docker ps</code> Listar todos los contenedores <code>docker ps -a</code> Eliminar un contenedor <code>docker rm &lt;container_id&gt;</code> Eliminar una imagen <code>docker rmi &lt;image_id&gt;</code>"},{"location":"Ud4/ch4_AEM/#8-comandos-de-debugging","title":"8. Comandos de Debugging","text":"Acci\u00f3n Comando Ver logs del sistema <code>sudo tail -f /var/log/syslog</code> Inspeccionar registros LDAP <code>sudo slapcat</code> Ver logs de un contenedor Docker <code>docker logs &lt;container_id&gt;</code>"},{"location":"Ud4/ch4_AEM/#configuraciones-importantes","title":"Configuraciones Importantes","text":"Archivo Configuraci\u00f3n <code>/etc/bind/named.conf.local</code> Configuraci\u00f3n de zonas DNS <code>/etc/bind/db.ejemplo.com</code> Zona directa: definici\u00f3n de registros A, NS, etc. <code>/etc/bind/db.192.168.1</code> Zona inversa: definici\u00f3n de registros PTR <code>base.ldif</code> Creaci\u00f3n de base LDAP <code>usuarios.ldif</code> Creaci\u00f3n de usuarios LDAP <code>/etc/apache2/sites-available</code> Configuraci\u00f3n de autenticaci\u00f3n LDAP en Apache <code>/etc/nginx/sites-available</code> Configuraci\u00f3n de autenticaci\u00f3n LDAP en Nginx"},{"location":"Ud4/ch4_AEM/#archivos-de-configuracion","title":"Archivos de configuraci\u00f3n","text":""},{"location":"Ud4/ch4_AEM/#1-configuracion-de-dns","title":"1. Configuraci\u00f3n de DNS","text":""},{"location":"Ud4/ch4_AEM/#archivos-de-configuracion_1","title":"Archivos de configuraci\u00f3n","text":""},{"location":"Ud4/ch4_AEM/#archivo-etcbindnamedconflocal","title":"Archivo <code>/etc/bind/named.conf.local</code>:","text":"<pre><code>zone \"ejemplo.com\" {\n    type master;\n    file \"/etc/bind/db.ejemplo.com\";\n};\n\nzone \"1.168.192.in-addr.arpa\" {\n    type master;\n    file \"/etc/bind/db.192.168.1\";\n};\n</code></pre>"},{"location":"Ud4/ch4_AEM/#archivo-etcbinddbejemplocom","title":"Archivo <code>/etc/bind/db.ejemplo.com</code>:","text":"<pre><code>$TTL    604800\n@       IN      SOA     ns1.ejemplo.com. admin.ejemplo.com. (\n                              2         ; Serial\n                         604800         ; Refresh\n                          86400         ; Retry\n                        2419200         ; Expire\n                         604800 )       ; Negative Cache TTL\n;\n@       IN      NS      ns1.ejemplo.com.\nns1     IN      A       192.168.1.1\nwww     IN      A       192.168.1.10\n</code></pre>"},{"location":"Ud4/ch4_AEM/#archivo-etcbinddb1921681","title":"Archivo <code>/etc/bind/db.192.168.1</code>:","text":"<pre><code>$TTL    604800\n@       IN      SOA     ns1.ejemplo.com. admin.ejemplo.com. (\n                              2         ; Serial\n                         604800         ; Refresh\n                          86400         ; Retry\n                        2419200         ; Expire\n                         604800 )       ; Negative Cache TTL\n;\n@       IN      NS      ns1.ejemplo.com.\n1       IN      PTR     ns1.ejemplo.com.\n10      IN      PTR     www.ejemplo.com.\n</code></pre>"},{"location":"Ud4/ch4_AEM/#2-configuracion-de-ldap","title":"2. Configuraci\u00f3n de LDAP","text":""},{"location":"Ud4/ch4_AEM/#archivos-de-configuracion_2","title":"Archivos de configuraci\u00f3n","text":""},{"location":"Ud4/ch4_AEM/#ejemplo-de-archivo-ldif-para-anadir-una-base-organizativa","title":"Ejemplo de archivo LDIF para a\u00f1adir una base organizativa:","text":"<p>Archivo <code>base.ldif</code>: <pre><code>dn: dc=ejemplo,dc=com\nobjectClass: top\nobjectClass: dcObject\nobjectClass: organization\no: ejemplo\ndc: ejemplo\n</code></pre></p>"},{"location":"Ud4/ch4_AEM/#archivo-ldif-para-anadir-usuarios","title":"Archivo LDIF para a\u00f1adir usuarios:","text":"<p>Archivo <code>usuarios.ldif</code>: <pre><code>dn: uid=usuario1,ou=People,dc=ejemplo,dc=com\nobjectClass: inetOrgPerson\ncn: Usuario Uno\nsn: Uno\nuid: usuario1\nuserPassword: password123\nmail: usuario1@ejemplo.com\n</code></pre></p>"},{"location":"Ud4/ch4_AEM/#configuracion-de-etcldapldapconf","title":"Configuraci\u00f3n de <code>/etc/ldap/ldap.conf</code>:","text":"<pre><code>BASE    dc=ejemplo,dc=com\nURI     ldap://localhost\n</code></pre>"},{"location":"Ud4/ch4_AEM/#archivo-de-esquema-para-slapd-opcional","title":"Archivo de esquema para slapd (opcional):","text":"<pre><code>include         /etc/ldap/schema/core.schema\ninclude         /etc/ldap/schema/cosine.schema\ninclude         /etc/ldap/schema/inetorgperson.schema\n</code></pre>"},{"location":"Ud4/ch4_AEM/#3-dockerizacion-de-dns-y-ldap","title":"3. Dockerizaci\u00f3n de DNS y LDAP","text":""},{"location":"Ud4/ch4_AEM/#dockerfile-para-bind9","title":"Dockerfile para BIND9:","text":"<p>Archivo <code>Dockerfile</code>: <pre><code>FROM ubuntu:latest\n\nRUN apt-get update &amp;&amp; apt-get install -y bind9\n\nCOPY named.conf.local /etc/bind/named.conf.local\nCOPY db.ejemplo.com /etc/bind/db.ejemplo.com\nCOPY db.192.168.1 /etc/bind/db.192.168.1\n\nCMD [\"named\", \"-g\"]\n</code></pre></p>"},{"location":"Ud4/ch4_AEM/#dockerfile-para-ldap","title":"Dockerfile para LDAP:","text":"<p>Archivo <code>Dockerfile</code>: <pre><code>FROM osixia/openldap:latest\n\nENV LDAP_DOMAIN=\"ejemplo.com\"\nENV LDAP_ADMIN_PASSWORD=\"admin123\"\nCOPY base.ldif /container/service/slapd/assets/config/bootstrap/ldif/50-base.ldif\nCOPY usuarios.ldif /container/service/slapd/assets/config/bootstrap/ldif/51-usuarios.ldif\n</code></pre></p>"},{"location":"Ud4/ch4_AEM/#4-configuracion-de-apache-con-ldap","title":"4. Configuraci\u00f3n de Apache con LDAP","text":""},{"location":"Ud4/ch4_AEM/#configuracion-en-etcapache2sites-available000-defaultconf","title":"Configuraci\u00f3n en <code>/etc/apache2/sites-available/000-default.conf</code>:","text":"<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName ejemplo.com\n\n    &lt;Location /&gt;\n        AuthType Basic\n        AuthName \"LDAP Authentication\"\n        AuthBasicProvider ldap\n        AuthLDAPURL \"ldap://localhost:389/ou=People,dc=ejemplo,dc=com?uid\"\n        AuthLDAPBindDN \"cn=admin,dc=ejemplo,dc=com\"\n        AuthLDAPBindPassword admin123\n        Require valid-user\n    &lt;/Location&gt;\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Ud4/ch4_AEM/#activar-modulos-y-reiniciar-apache","title":"Activar m\u00f3dulos y reiniciar Apache:","text":"<pre><code>sudo a2enmod authnz_ldap\nsudo systemctl restart apache2\n</code></pre>"},{"location":"Ud4/ch4_AEM/#5-configuracion-de-nginx-con-ldap","title":"5. Configuraci\u00f3n de Nginx con LDAP","text":""},{"location":"Ud4/ch4_AEM/#instalacion-del-modulo-nginx-extras","title":"Instalaci\u00f3n del m\u00f3dulo <code>nginx-extras</code>:","text":"<pre><code>sudo apt install nginx-extras\n</code></pre>"},{"location":"Ud4/ch4_AEM/#configuracion-en-etcnginxsites-availabledefault","title":"Configuraci\u00f3n en <code>/etc/nginx/sites-available/default</code>:","text":"<pre><code>server {\n    listen 80;\n    server_name ejemplo.com;\n\n    location / {\n        auth_ldap \"Restricted\";\n        auth_ldap_servers ldap_server;\n\n        root /var/www/html;\n        index index.html index.htm;\n    }\n}\n\nldap_server ldap_server {\n    url ldap://localhost:389/ou=People,dc=ejemplo,dc=com?uid?sub?(objectClass=inetOrgPerson);\n    binddn \"cn=admin,dc=ejemplo,dc=com\";\n    binddn_passwd admin123;\n    group_attribute memberUid;\n    group_attribute_is_dn off;\n}\n</code></pre>"},{"location":"Ud4/ch4_AEM/#6-docker-compose-para-ldap-y-nginx","title":"6. Docker Compose para LDAP y Nginx","text":"<p>Archivo <code>docker-compose.yml</code>: <pre><code>version: '3.7'\nservices:\n  ldap:\n    image: osixia/openldap\n    environment:\n      LDAP_DOMAIN: \"ejemplo.com\"\n      LDAP_ADMIN_PASSWORD: \"admin123\"\n    ports:\n      - \"389:389\"\n\n  nginx:\n    image: nginx\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n    ports:\n      - \"80:80\"\n</code></pre></p>"},{"location":"Ud5/Ch5_ABM/","title":"Cheat Sheet: Configuraci\u00f3n de Servidores FTP, FTPS y SFTP","text":""},{"location":"Ud5/Ch5_ABM/#1-configuracion-basica-de-un-servidor-ftp-con-vsftpd","title":"\u2728 1. Configuraci\u00f3n B\u00e1sica de un Servidor FTP con vsftpd","text":""},{"location":"Ud5/Ch5_ABM/#instalacion","title":"\ud83d\udd27 Instalaci\u00f3n","text":"<pre><code>sudo apt update\nsudo apt install vsftpd -y\n</code></pre>"},{"location":"Ud5/Ch5_ABM/#iniciar-y-habilitar-el-servicio","title":"\ud83d\ude80 Iniciar y habilitar el servicio","text":"<pre><code>sudo systemctl start vsftpd\nsudo systemctl enable vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_ABM/#crear-un-usuario-para-ftp","title":"\ud83d\udc64 Crear un usuario para FTP","text":"<pre><code>sudo adduser ftpuser\nsudo passwd ftpuser\nsudo mkdir -p /home/ftpuser/ftp/upload\nsudo chown nobody:nogroup /home/ftpuser/ftp\nsudo chmod a-w /home/ftpuser/ftp\nsudo chown ftpuser:ftpuser /home/ftpuser/ftp/upload\n</code></pre>"},{"location":"Ud5/Ch5_ABM/#configurar-vsftpd","title":"\u2699\ufe0f Configurar vsftpd","text":"<ol> <li>Editar el archivo de configuraci\u00f3n: <pre><code>sudo nano /etc/vsftpd.conf\n</code></pre></li> <li>A\u00f1adir las siguientes l\u00edneas: <pre><code>write_enable=YES\nchroot_local_user=YES\nallow_writeable_chroot=YES\nuser_sub_token=$USER\nlocal_root=/home/$USER/ftp\npasv_enable=YES\npasv_min_port=1024\npasv_max_port=1048\n</code></pre></li> <li>Reiniciar el servicio: <pre><code>sudo systemctl restart vsftpd\n</code></pre></li> </ol>"},{"location":"Ud5/Ch5_ABM/#2-configuracion-de-ftps-ftp-seguro-con-ssltls","title":"\ud83d\udd12 2. Configuraci\u00f3n de FTPS (FTP Seguro con SSL/TLS)","text":""},{"location":"Ud5/Ch5_ABM/#generar-un-certificado-ssl","title":"\ud83d\udee0 Generar un certificado SSL","text":"<pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre>"},{"location":"Ud5/Ch5_ABM/#configurar-vsftpd-para-ftps","title":"\ud83d\udcc4 Configurar vsftpd para FTPS","text":"<ol> <li>Editar el archivo: <pre><code>sudo nano /etc/vsftpd.conf\n</code></pre></li> <li>Agregar o modificar: <pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\npasv_enable=YES\npasv_min_port=1027\npasv_max_port=1030\npasv_address=&lt;DIRECCI\u00d3N_IP&gt;\n</code></pre></li> <li>Reiniciar el servicio: <pre><code>sudo systemctl restart vsftpd\n</code></pre></li> </ol>"},{"location":"Ud5/Ch5_ABM/#3-configuracion-de-sftp-ftp-seguro-sobre-ssh","title":"\ud83d\udd11 3. Configuraci\u00f3n de SFTP (FTP Seguro Sobre SSH)","text":""},{"location":"Ud5/Ch5_ABM/#verificar-que-ssh-esta-activo","title":"\u2705 Verificar que SSH est\u00e1 activo","text":"<pre><code>sudo systemctl status ssh\n</code></pre>"},{"location":"Ud5/Ch5_ABM/#crear-un-usuario-para-sftp","title":"\ud83d\udc64 Crear un usuario para SFTP","text":"<pre><code>sudo adduser sftpuser\nsudo passwd sftpuser\n</code></pre>"},{"location":"Ud5/Ch5_ABM/#configurar-el-directorio-de-sftp","title":"\ud83d\udcc1 Configurar el directorio de SFTP","text":"<ol> <li> <p>Crear directorios y establecer permisos: <pre><code>sudo mkdir -p /home/sftpuser/sftp/upload\nsudo chown root:root /home/sftpuser/sftp\nsudo chmod 755 /home/sftpuser/sftp\nsudo chown sftpuser:sftpuser /home/sftpuser/sftp/upload\n</code></pre></p> </li> <li> <p>Editar configuraci\u00f3n de SSH: <pre><code>sudo nano /etc/ssh/sshd_config\n</code></pre></p> </li> <li>Agregar al final: <pre><code>Match User sftpuser\n    ChrootDirectory /home/sftpuser/sftp\n    ForceCommand internal-sftp\n    AllowTcpForwarding no\n</code></pre></li> <li>Reiniciar SSH: <pre><code>sudo systemctl restart ssh\n</code></pre></li> </ol>"},{"location":"Ud5/Ch5_ABM/#4-probar-las-conexiones","title":"\ud83d\udd17 4. Probar las Conexiones","text":"<ul> <li> <p>Conexi\u00f3n FTP: <pre><code>ftp &lt;DIRECCI\u00d3N_IP&gt;\n</code></pre></p> </li> <li> <p>Conexi\u00f3n FTPS:  </p> </li> <li>Usar un cliente como FileZilla.  </li> <li> <p>Configuraci\u00f3n:  </p> <ul> <li>Protocolo: FTPS expl\u00edcito.  </li> <li>Puerto: 21.  </li> <li>Usuario: <code>ftpuser</code>.  </li> </ul> </li> <li> <p>Conexi\u00f3n SFTP: <pre><code>sftp sftpuser@&lt;DIRECCI\u00d3N_IP&gt;\n</code></pre></p> </li> </ul>"},{"location":"Ud5/Ch5_ACF/","title":"\ud83d\udce1 FTP","text":""},{"location":"Ud5/Ch5_ACF/#1-comandos-de-acceso-e-informacion","title":"1. \ud83d\udd11 Comandos de acceso e informaci\u00f3n","text":"Comando Explicaci\u00f3n <code>ftp</code> \ud83d\udda7 Comando para acceder al servidor ftp de nuestro equipo. <code>help</code> \u2754 Comando para visualizar los comandos ftp. <code>ftp nombre_de_host_ftp</code> \ud83c\udf10 Comando para conectarte a un servidor ftp. <code>ftp&gt; bye</code> \ud83d\udeaa Comando para cerrar la conexi\u00f3n. <code>open ftp.rediris.es</code> \ud83d\udd10 Comando para conectar con una red p\u00fablica. <code>get constitution.txt</code> \u2b07\ufe0f Comando para descargar un archivo. <code>quit</code> \ud83d\udeab Comando para salir del servidor ftp."},{"location":"Ud5/Ch5_ACF/#2-comandos-de-instalacion-y-configuracion-de-vsftpd","title":"2. \u2699\ufe0f Comandos de instalaci\u00f3n y configuraci\u00f3n de vsFTPd","text":"Comando Explicaci\u00f3n <code>sudo apt-get install vsftpd</code> \ud83d\udee0\ufe0f Comando para instalar el servidor vsFTPd <p>\ud83d\udd10 C\u00e1rcel de Chroot para los usuarios locales: <pre><code>chroot_local_user=YES\n</code></pre> <pre><code>user_sub_token=$USER\nlocal_root=/home/$USER/ftp\n</code></pre> \ud83d\udeabRestricci\u00f3n de usuarios: <pre><code>userlist_enable=YES #\nuserlist_file=/etc/vsftpd.userlist #\nuserlist_deny=NO #\n</code></pre></p>"},{"location":"Ud5/Ch5_ACF/#3-comandos-de-configuracion-de-servidor-ftp-con-cifrado","title":"3. \ud83d\udd12 Comandos de configuraci\u00f3n de servidor FTP con Cifrado","text":"Comando Explicaci\u00f3n <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem</code> \ud83d\udd0f Comando para generar un certificado autofirmado con OpenSSL <code>sudo ls -l /etc/ssl/private</code> \ud83d\udcc4 Comando para comprobar el certificado <p>\ud83d\udcdd Habilitar el cifrado SSL:</p> <p><code>sudo nano /etc/vsftpd.conf</code> <pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre></p> <p>\ud83d\udcdd Habilitar el modo pasivo: <pre><code>pasv_enable=YES\npasv_min_port=1027  # Puerto m\u00ednimo de conexi\u00f3n pasiva (reemplaza XXXX con un n\u00famero)\npasv_max_port=1030  # Puerto m\u00e1ximo de conexi\u00f3n pasiva (reemplaza XXXX con un n\u00famero)\npasv_address=X.X.X.X  # Direcci\u00f3n IP p\u00fablica o accesible desde el cliente (reemplaza X.X.X.X con la direcci\u00f3n IP)\n</code></pre></p>"},{"location":"Ud5/Ch5_AEM/","title":"Cheat Sheet - Unidad 5","text":""},{"location":"Ud5/Ch5_AEM/#instalacion-y-configuracion-del-servidor-vsftpd-sin-cifrado","title":"Instalaci\u00f3n y Configuraci\u00f3n del Servidor vsFTPd (sin cifrado)","text":""},{"location":"Ud5/Ch5_AEM/#instalacion-del-servidor","title":"Instalaci\u00f3n del servidor","text":"<pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#verificacion-de-la-instalacion","title":"Verificaci\u00f3n de la instalaci\u00f3n","text":"<pre><code>cat /etc/passwd | grep ftp\ncat /etc/group | grep ftp\nsystemctl status vsftpd\nps -ef | grep vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#archivos-y-directorios-importantes","title":"Archivos y Directorios Importantes","text":"<ul> <li>/etc/init.d/vsftpd - Script de inicio para gestionar el servicio.</li> <li>/usr/sbin/vsftpd - Binario principal del servidor.</li> <li>/etc/vsftpd.conf - Archivo de configuraci\u00f3n principal.</li> <li>/srv/ftp - Directorio por defecto para archivos.</li> <li>/etc/ftpusers - Lista de usuarios denegados.</li> <li>/etc/vsftpd.user_list - Lista de usuarios permitidos.</li> <li>/etc/vsftpd.chroot_list - Lista de usuarios con acceso restringido.</li> <li>/var/log/vsftpd.log - Archivo de registros del servidor.</li> </ul>"},{"location":"Ud5/Ch5_AEM/#comandos-del-servicio-vsftpd","title":"Comandos del servicio vsFTPd","text":"<pre><code>sudo systemctl start vsftpd   # Iniciar el servicio\nsudo systemctl stop vsftpd    # Detener el servicio\nsudo systemctl restart vsftpd # Reiniciar el servicio\nsudo systemctl reload vsftpd  # Recargar la configuraci\u00f3n\nsudo systemctl status vsftpd  # Ver el estado del servicio\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#configuracion-del-servidor","title":"Configuraci\u00f3n del servidor","text":""},{"location":"Ud5/Ch5_AEM/#copia-de-seguridad-de-configuracion","title":"Copia de seguridad de configuraci\u00f3n","text":"<pre><code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.backup\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#editar-configuracion","title":"Editar configuraci\u00f3n","text":"<pre><code>sudo nano /etc/vsftpd.conf\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#configuraciones-clave","title":"Configuraciones clave","text":"<ol> <li> <p>Acceso solo a usuarios locales</p> <pre><code>anonymous_enable=NO\nlocal_enable=YES\n</code></pre> </li> <li> <p>Habilitar carga de archivos</p> <pre><code>write_enable=YES\n</code></pre> </li> <li> <p>Permisos de archivos subidos</p> <pre><code>local_umask=022\n</code></pre> </li> <li> <p>C\u00e1rcel de chroot para usuarios locales</p> <pre><code>chroot_local_user=YES\nallow_writeable_chroot=YES\n</code></pre> </li> <li> <p>Directorio de acceso para usuarios</p> <pre><code>user_sub_token=$USER\nlocal_root=/home/$USER/ftp\n</code></pre> </li> <li> <p>Restricci\u00f3n de usuarios</p> <pre><code>userlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n</code></pre> <p>Agregar usuario permitido:</p> <pre><code>echo \"userftp\" | sudo tee -a /etc/vsftpd.userlist\n</code></pre> </li> </ol>"},{"location":"Ud5/Ch5_AEM/#creacion-de-usuario-para-pruebas","title":"Creaci\u00f3n de usuario para pruebas","text":"<pre><code>sudo adduser userftp\n</code></pre> <p>Configuraci\u00f3n del directorio para chroot:</p> <pre><code>mkdir -p /home/userftp/ftp/upload\nchmod a-w /home/userftp/ftp\nchmod 755 /home/userftp/ftp/upload\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#acceso-ftp","title":"Acceso FTP","text":"<p>Conectarse al servidor FTP:</p> <pre><code>ftp &lt;IP_DEL_SERVIDOR&gt;\n</code></pre> <p>Subir y descargar archivos:</p> <pre><code>put archivo.txt\nget archivo.txt\nbye\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#comprobaciones-finales","title":"Comprobaciones finales","text":"<ol> <li>Solo usuarios locales pueden conectarse.</li> <li>La carga de archivos est\u00e1 habilitada.</li> <li>Los archivos se suben con permisos umask 022.</li> <li>Chroot habilitado a <code>/home/$USER/ftp</code>.</li> <li>Solo <code>userftp</code> puede conectarse.</li> </ol> <p>Crear archivo de prueba:</p> <pre><code>echo \"esto es una prueba con vsftpd\" | sudo tee /home/userftp/ftp/upload/pruebaftp.txt\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#resolucion-de-problemas","title":"Resoluci\u00f3n de Problemas","text":"<ul> <li> <p>Ver registros de actividad:</p> <pre><code>cat /var/log/vsftpd.log\n</code></pre> </li> <li> <p>Verificar firewall:</p> <pre><code>sudo ufw status\nsudo ufw allow 21/tcp\n</code></pre> </li> <li> <p>Comprobaci\u00f3n de puertos abiertos:</p> <pre><code>netstat -tuln | grep :21\n</code></pre> </li> </ul>"},{"location":"Ud5/Ch5_AEM/#configuracion-de-vsftpd-con-cifrado-ftps","title":"Configuraci\u00f3n de vsFTPd con cifrado (FTPS)","text":""},{"location":"Ud5/Ch5_AEM/#generar-un-certificado-autofirmado","title":"Generar un certificado autofirmado","text":"<pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre> <p>Verificar la creaci\u00f3n del certificado:</p> <pre><code>sudo ls -l /etc/ssl/private\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#configuracion-del-servidor-para-ftps","title":"Configuraci\u00f3n del servidor para FTPS","text":"<p>Hacer una copia de seguridad del archivo de configuraci\u00f3n:</p> <pre><code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.backup2\n</code></pre> <p>Editar configuraci\u00f3n:</p> <pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <p>A\u00f1adir las siguientes l\u00edneas:</p> <pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre> <p>Habilitar el modo pasivo:</p> <pre><code>pasv_enable=YES\npasv_min_port=1027\npasv_max_port=1030\npasv_address=X.X.X.X\n</code></pre> <p>Reiniciar el servicio:</p> <pre><code>sudo systemctl restart vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#configuracion-de-sftp","title":"Configuraci\u00f3n de SFTP","text":"<p>Para habilitar SFTP no es necesario configurar vsftpd, solo asegurarse de que SSH est\u00e1 configurado correctamente.</p> <p>Comprobar el estado del servicio SSH:</p> <pre><code>sudo systemctl status ssh\n</code></pre> <p>Probar la conexi\u00f3n SFTP:</p> <pre><code>sftp user2@ipserver\n</code></pre> <p>Conexi\u00f3n mediante clave SSH:</p> <pre><code>ssh -i clave user2@ipserver\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#dockerizacion-del-servidor-vsftpd","title":"Dockerizaci\u00f3n del servidor vsFTPd","text":""},{"location":"Ud5/Ch5_AEM/#ejecutar-un-contenedor-basico","title":"Ejecutar un contenedor b\u00e1sico","text":"<pre><code>docker run --rm -p 21:21 -p 20:20 -d --name pruebavsftpd fauria/vsftpd\n</code></pre> <p>Verificar credenciales de acceso:</p> <pre><code>docker logs pruebavsftpd\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#montar-directorio-de-datos-en-el-host","title":"Montar directorio de datos en el host","text":"<pre><code>mkdir datosftp\ndocker run --rm -p 21:21 -p 20:20 -d --name pruebavsftpd -v /home/admin/datosftp:/home/vsftpd fauria/vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#contenedor-con-usuario-y-modo-pasivo","title":"Contenedor con usuario y modo pasivo","text":"<pre><code>docker run -e FTP_USER=userftp -e FTP_PASS=ieselcaminas -e PASV_MIN_PORT=21100 -e PASV_MAX_PORT=21110 -p 21:21 -p 21100-21110:21100-21110 -d --name pruebavsftpd -v /home/admin/datosftp:/home/vsftpd fauria/vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_AEM/#configurar-permisos-de-archivos","title":"Configurar permisos de archivos","text":"<pre><code>docker run -e FTP_USER=userftp -e FTP_PASS=ieselcaminas -e PASV_MIN_PORT=21100 -e PASV_MAX_PORT=21110 -e LOCAL_UMASK=022 -p 21:21 -p 21100-21110:21100-21110 -d --name vsftpdsincifrado -v /home/admin/datosftp:/home/vsftpd fauria/vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_ALS/","title":"\ud83d\udccc MEGA CHEATSHEET - SERVICIOS DE RED FTP, FTPS Y SFTP","text":""},{"location":"Ud5/Ch5_ALS/#comandos-basicos-ftp","title":"\ud83d\ude80 COMANDOS B\u00c1SICOS FTP","text":"Comando Descripci\u00f3n <code>ftp</code> Iniciar cliente FTP <code>open [hostname]</code> Conectar a un servidor FTP <code>user [usuario] [contrase\u00f1a]</code> Iniciar sesi\u00f3n en FTP <code>get [archivo]</code> Descargar un archivo <code>put [archivo]</code> Subir un archivo <code>delete [archivo]</code> Eliminar un archivo en el servidor <code>rmd [directorio]</code> Eliminar un directorio en el servidor <code>rename [nombre_original] [nuevo_nombre]</code> Renombrar archivos <code>quit</code> Salir del cliente FTP"},{"location":"Ud5/Ch5_ALS/#instalacion-y-configuracion-del-servidor-ftp-vsftpd","title":"\ud83d\udee0\ufe0f INSTALACI\u00d3N Y CONFIGURACI\u00d3N DEL SERVIDOR FTP (vsftpd)","text":""},{"location":"Ud5/Ch5_ALS/#instalacion","title":"\ud83d\udce5 Instalaci\u00f3n","text":"<pre><code>sudo apt update\nsudo apt install vsftpd -y\n</code></pre>"},{"location":"Ud5/Ch5_ALS/#iniciar-y-habilitar-el-servicio","title":"\ud83d\ude80 Iniciar y Habilitar el Servicio","text":"<pre><code>sudo systemctl start vsftpd\nsudo systemctl enable vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_ALS/#crear-usuario-ftp","title":"\ud83d\udc64 Crear Usuario FTP","text":"<pre><code>sudo adduser ftpuser\nsudo passwd ftpuser\nsudo mkdir -p /home/ftpuser/ftp/upload\nsudo chown nobody:nogroup /home/ftpuser/ftp\nsudo chmod a-w /home/ftpuser/ftp\nsudo chown ftpuser:ftpuser /home/ftpuser/ftp/upload\n</code></pre>"},{"location":"Ud5/Ch5_ALS/#configuracion-basica-editar-etcvsftpdconf","title":"\u2699\ufe0f Configuraci\u00f3n B\u00e1sica (Editar <code>/etc/vsftpd.conf</code>)","text":"<p><pre><code>anonymous_enable=NO\nlocal_enable=YES\nwrite_enable=YES\nlocal_umask=022\nchroot_local_user=YES\nallow_writeable_chroot=YES\nuser_sub_token=$USER\nlocal_root=/home/$USER/ftp\npasv_enable=YES\npasv_min_port=1024\npasv_max_port=1048\n</code></pre> Reiniciar el servicio: <pre><code>sudo systemctl restart vsftpd\n</code></pre></p>"},{"location":"Ud5/Ch5_ALS/#configuracion-de-ftps-ftp-seguro-con-ssltls","title":"\ud83d\udd12 CONFIGURACI\u00d3N DE FTPS (FTP SEGURO CON SSL/TLS)","text":""},{"location":"Ud5/Ch5_ALS/#generar-un-certificado-ssl","title":"\ud83d\udee0 Generar un Certificado SSL","text":"<pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre>"},{"location":"Ud5/Ch5_ALS/#configurar-vsftpd-para-ftps-editar-etcvsftpdconf","title":"\ud83d\udcc4 Configurar vsftpd para FTPS (Editar <code>/etc/vsftpd.conf</code>)","text":"<p><pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\npasv_enable=YES\npasv_min_port=1027\npasv_max_port=1030\npasv_address=X.X.X.X\n</code></pre> Reiniciar el servicio: <pre><code>sudo systemctl restart vsftpd\n</code></pre></p>"},{"location":"Ud5/Ch5_ALS/#configuracion-de-sftp-ftp-seguro-sobre-ssh","title":"\ud83d\udd11 CONFIGURACI\u00d3N DE SFTP (FTP SEGURO SOBRE SSH)","text":""},{"location":"Ud5/Ch5_ALS/#verificar-que-ssh-esta-activo","title":"\u2705 Verificar que SSH est\u00e1 Activo","text":"<pre><code>sudo systemctl status ssh\n</code></pre>"},{"location":"Ud5/Ch5_ALS/#crear-usuario-para-sftp","title":"\ud83d\udc64 Crear Usuario para SFTP","text":"<pre><code>sudo adduser sftpuser\nsudo passwd sftpuser\n</code></pre>"},{"location":"Ud5/Ch5_ALS/#configurar-directorio-de-sftp","title":"\ud83d\udcc1 Configurar Directorio de SFTP","text":"<pre><code>sudo mkdir -p /home/sftpuser/sftp/upload\nsudo chown root:root /home/sftpuser/sftp\nsudo chmod 755 /home/sftpuser/sftp\nsudo chown sftpuser:sftpuser /home/sftpuser/sftp/upload\n</code></pre>"},{"location":"Ud5/Ch5_ALS/#editar-configuracion-de-ssh-etcsshsshd_config","title":"\u270f\ufe0f Editar Configuraci\u00f3n de SSH (<code>/etc/ssh/sshd_config</code>)","text":"<p><pre><code>Match User sftpuser\n    ChrootDirectory /home/sftpuser/sftp\n    ForceCommand internal-sftp\n    AllowTcpForwarding no\n</code></pre> Reiniciar SSH: <pre><code>sudo systemctl restart ssh\n</code></pre></p>"},{"location":"Ud5/Ch5_ALS/#probar-las-conexiones","title":"\ud83d\udd17 PROBAR LAS CONEXIONES","text":""},{"location":"Ud5/Ch5_ALS/#conexion-ftp","title":"\ud83d\udce1 Conexi\u00f3n FTP","text":"<pre><code>ftp &lt;DIRECCI\u00d3N_IP&gt;\n</code></pre>"},{"location":"Ud5/Ch5_ALS/#conexion-ftps-usando-filezilla","title":"\ud83d\udd12 Conexi\u00f3n FTPS (Usando FileZilla)","text":"<ul> <li>Protocolo: FTPS Expl\u00edcito</li> <li>Puerto: 21</li> <li>Usuario: ftpuser</li> </ul>"},{"location":"Ud5/Ch5_ALS/#conexion-sftp","title":"\ud83d\udd11 Conexi\u00f3n SFTP","text":"<pre><code>sftp sftpuser@&lt;DIRECCI\u00d3N_IP&gt;\n</code></pre>"},{"location":"Ud5/Ch5_BSO/","title":"Servicios de red FTP","text":""},{"location":"Ud5/Ch5_BSO/#comandos-basicos-para-ftp","title":"Comandos B\u00e1sicos para FTP","text":""},{"location":"Ud5/Ch5_BSO/#establecer-conexion-con-el-servidor-ftp","title":"Establecer Conexi\u00f3n con el Servidor FTP","text":"<pre><code>ftp                # Inicia el cliente FTP.\nuser [usuario] [contrase\u00f1a]  # Inicia sesi\u00f3n con un usuario autenticado.\nopen [servidor]    # Conecta con un servidor FTP.\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#transferencia-de-archivos","title":"Transferencia de Archivos","text":"<pre><code>get archivo # Descarga un archivo desde el servidor al equipo local.\nput archivo # Sube un archivo desde el equipo local al servidor.\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#modo-activo-y-pasivo","title":"Modo Activo y Pasivo","text":"<pre><code>PASV   # Cambia al modo pasivo.\nPORT   # Cambia al modo activo.\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#configuracion-del-servidor-vsftpd","title":"Configuraci\u00f3n del Servidor vsFTPd","text":""},{"location":"Ud5/Ch5_BSO/#instalacion-del-servidor","title":"Instalaci\u00f3n del Servidor","text":"<pre><code>sudo apt install vsftpd -y\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#iniciar-y-habilitar-el-servicio-vsftpd","title":"Iniciar y Habilitar el Servicio vsftpd","text":"<pre><code>sudo systemctl start vsftpd #Inicializa el servicio.\nsudo systemctl enable vsftpd #Habilita el servicio para arrancar autom\u00e1ticamente al iniciar el sistema.\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#configuracion-de-vsftpd","title":"Configuraci\u00f3n de vsFTPd","text":"<p>Editar el archivo de configuraci\u00f3n:</p> <pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <p>configuraciones b\u00e1sicas:</p> <pre><code>anonymous_enable=NO # Deshabilita acceso an\u00f3nimo.\nlocal_enable=YES    # Habilita acceso a usuarios locales.\nwrite_enable=YES    # Permite la escritura.\n\nlocal_umask=022     # Define permisos por defecto para archivos.\n\nchroot_local_user=YES # Restringe usuarios a sus directorios.\nallow_writeable_chroot=YES # Permite escritura en chroot.\n\nuser_sub_token=$USER # Usa el nombre del usuario en el directorio.\nlocal_root=/home/$USER/ftp\n\nuserlist_enable=YES  # Habilita lista de usuarios permitidos.\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO     # Restringe el acceso a quienes no est\u00e9n en la lista.\n</code></pre> <p>Se necesita reiniciar para aplicar cambios:</p> <pre><code>sudo systemctl restart vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#configurar-usuarios","title":"Configurar Usuarios","text":"<pre><code>sudo adduser userftp # Crea un nuevo usuario.\nsudo usermod --home /userdir/userftp userftp # Cambia el directorio home de un usuario.\necho \"userftp\" | sudo tee -a /etc/vsftpd.userlist # A\u00f1ade el usuario a la lista de permitidos.\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#configuracion-de-ftps-ftp-seguro","title":"Configuraci\u00f3n de FTPS (FTP Seguro)","text":""},{"location":"Ud5/Ch5_BSO/#generar-certificado-ssl","title":"Generar certificado SSL","text":"<pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#habilitar-cifrado-ssl","title":"Habilitar cifrado SSL","text":"<p>Editar el archivo de configuraci\u00f3n de vsFTPd:</p> <pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <pre><code># Certificados SSL\nrsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n\n# Seguridad\nallow_anon_ssl=NO # Bloquea acceso an\u00f3nimo con SSL.\nforce_local_data_ssl=YES # Obliga a usar cifrado para datos locales.\nforce_local_logins_ssl=YES # Obliga a usar cifrado para inicios de sesi\u00f3n.\nssl_tlsv1=YES # Habilita TLSv1.\nssl_sslv2=NO # Deshabilita SSLv2.\nssl_sslv3=NO # Deshabilita SSLv3.\nrequire_ssl_reuse=NO # No requiere reutilizar sesiones SSL.\nssl_ciphers=HIGH # Usa cifrados fuertes.\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#configurar-modo-pasivo","title":"Configurar Modo Pasivo","text":"<pre><code>pasv_enable=YES # Activa modo pasivo.\npasv_min_port=1027 # Puerto m\u00ednimo.\npasv_max_port=1030 # Puerto m\u00e1ximo.\npasv_address=ip_publica # Direcci\u00f3n IP p\u00fablica o accesible desde el cliente.\n</code></pre> <p>Reiniciar el servicio:</p> <pre><code>sudo systemctl restart vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#configuracion-de-sftp","title":"Configuraci\u00f3n de SFTP","text":""},{"location":"Ud5/Ch5_BSO/#copias-de-seguridad","title":"Copias de seguridad","text":"<pre><code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.ftps # Crea una copia del archivo de configuraci\u00f3n\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#establecer-conexion-por-sftp","title":"Establecer conexi\u00f3n por SFTP","text":"<pre><code>ssh -i clave user2@ipserver\n</code></pre>"},{"location":"Ud5/Ch5_BSO/#restaurar-archivo-de-configuracion-anterior","title":"Restaurar archivo de configuraci\u00f3n anterior","text":"<pre><code>sudo cp /etc/vsftpd.conf.ftps /etc/vsftpd.conf\nsudo systemctl restart vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_DGD/","title":"CHEATSHEET 5 SERVICIOS DE RED FTP","text":""},{"location":"Ud5/Ch5_DGD/#basico-ftp","title":"\ud83c\udf93 B\u00c1SICO FTP","text":"<ul> <li>Entrar al ftp de tu ordenador:</li> </ul> <p><pre><code>ftp\n</code></pre> - Conectarte a una red p\u00fablica:</p> <pre><code>open ftp.rediris.es\n</code></pre> <ul> <li>Descargar archivo:</li> </ul> <pre><code>get archivo\n</code></pre> <ul> <li>Subir archivo:</li> </ul> <pre><code>put arhivo\n</code></pre> <ul> <li>Salir:</li> </ul> <pre><code>quit\n</code></pre>"},{"location":"Ud5/Ch5_DGD/#instalacion-servidor-vsftp","title":"\ud83d\udce5 INSTALACI\u00d3N SERVIDOR VSFTP","text":"<pre><code>sudo apt-get install vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_DGD/#iniciar-y-habilitar-servicio","title":"\ud83d\udcc8 INICIAR Y HABILITAR SERVICIO","text":"<pre><code>sudo systemctl start vsftpd\nsudo systemctl enable vsftpd.service\n</code></pre>"},{"location":"Ud5/Ch5_DGD/#archivo-de-configuracion","title":"\u2699\ufe0f ARCHIVO DE CONFIGURACI\u00d3N","text":"<p>El archivo de configuraci\u00f3n es: /etc/vsftpd.conf</p>"},{"location":"Ud5/Ch5_DGD/#configuraciones-basicas","title":"\u2699\ufe0f CONFIGURACIONES B\u00c1SICAS","text":"Configuraci\u00f3n Explicaci\u00f3n anonymous_enable=NO No permite la autenticaci\u00f3n an\u00f3nima en el servidor local_enable=YES Permite acceso a usuarios locales write_enable=YES Habilita la carga de archivos local_umask Indica que permisos tendr\u00e1n los archivos al subirse al servidor chroot_local_user=YES Restringe a los usuarios a sus directorios de inicio local_root Indica el directorio raiz de los usuarios"},{"location":"Ud5/Ch5_DGD/#restriccion-de-usuarios","title":"\u274c RESTRICCI\u00d3N DE USUARIOS","text":"<p>Para restringir usuarios hay que crear el siguiente archivo:</p> <p>/etc/vsftpd.userlist</p> <p>A\u00f1adimos los usuarios que queremos permitir el acceso o restringirlo y a\u00f1adimos estas configuraciones:</p> <pre><code>userlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n</code></pre>"},{"location":"Ud5/Ch5_DGD/#crear-certificado-ssl","title":"\ud83d\udcdd CREAR CERTIFICADO SSL","text":"<p>Podemos crear el certificado con el siguiente comando:</p> <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre>"},{"location":"Ud5/Ch5_DGD/#habilitar-cifrado-ssl","title":"\u2705 HABILITAR CIFRADO SSL","text":"<p>Una vez creado el certificado, podemos habilitarlo con la siguiente configuraci\u00f3n:</p> <pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre>"},{"location":"Ud5/Ch5_DGD/#habilitar-modo-pasivo","title":"\u2705 HABILITAR MODO PASIVO","text":"<p>Para habilitar el modo pasivo tambi\u00e9n se requiere modificar la configuraci\u00f3n a\u00f1adiendo:</p> <pre><code>pasv_enable=YES\npasv_min_port=1027 # Puerto m\u00ednimo de conexi\u00f3n\npasv_max_port=1030 # Puerto m\u00e1ximo de conexi\u00f3n\npasv_address=X.X.X.X # Direcci\u00f3n IP p\u00fablica\n</code></pre>"},{"location":"Ud5/Ch5_DGD/#conexion-sftp","title":"CONEXI\u00d3N SFTP","text":"<p>Podemos tener la configuraci\u00f3n por defecto</p> <pre><code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.ftps\nsudo cp /etc/vsftpd.conf.backup2 /etc/vsftpd.conf\n</code></pre> <p>Simplemente tenemos que tener un par de claves creadas, con eso hecho ejecutamos el siguiente comando:</p> <pre><code>ssh -i clave user@ipsever\n</code></pre>"},{"location":"Ud5/Ch5_DMP/","title":"\ud83d\udcdd UD5 - Servicios de red FTP - Cheatsheet","text":"<p>David Maratrat Pons</p>"},{"location":"Ud5/Ch5_DMP/#comandos-basicos-de-ftp","title":"\ud83e\uddd1\u200d\ud83d\udcbb Com\u00e1ndos b\u00e1sicos de FTP","text":"Comando Descripci\u00f3n <code>ftp</code> <code>Entra en modo FTP</code> <code>open &lt;servidor FTP&gt;</code> <code>Se conecta a un servidor FTP</code> <code>get &lt;archivo&gt;</code> <code>Descarga un archivo del servidor</code> <code>put &lt;archivo</code> <code>Sube un archivo al servidor</code> <code>quit</code> <code>Salir del modo FTP</code>"},{"location":"Ud5/Ch5_DMP/#instalacion-del-servidor-ftp","title":"\ud83d\udce5 Instalaci\u00f3n del servidor FTP","text":"Comando Descripci\u00f3n <code>sudo apt-get install vsftpd</code> <code>Descarga e instala el servidor vsftpd</code> <code>sudo systemctl start vsftpd.service</code> <code>Arranca el servicio</code> <code>sudo systemctl restart vsftpd.service</code> <code>Reinicia el servicio</code> <code>sudo systemctl stop vsftpd.service</code> <code>Para el servicio</code> <code>sudo systemctl enable vsftpd.service</code> <code>Habilita el arranque autom\u00e1tico del servidor</code>"},{"location":"Ud5/Ch5_DMP/#configuracion-del-servidor-ftp","title":"\u2699\ufe0f Configuraci\u00f3n del servidor FTP","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo nano /etc/vsftpd.conf</code> <code>Modifica el archivo de configuraci\u00f3n</code>"},{"location":"Ud5/Ch5_DMP/#vsftpdconf-basico","title":"\ud83d\udcc4 vsftpd.conf b\u00e1sico:","text":"<pre><code>anonymous_enable=NO\nlocal_enable=YES\nwrite_enable=YES\nlocal_umask\nchroot_local_user=YES\nlocal_root\n</code></pre>"},{"location":"Ud5/Ch5_DMP/#vsftpdconf-pasivo","title":"\ud83d\udcc4 vsftpd.conf pasivo:","text":"<pre><code>pasv_enable=YES\npasv_min_port=1027\npasv_max_port=1030\npasv_address=&lt;server IP&gt;\n</code></pre>"},{"location":"Ud5/Ch5_DMP/#acceso-de-usuarios","title":"\u274c Acceso de usuarios","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo nano /etc/vsftpd.userlist</code> <code>Modifica el acceso de usuarios en este archivo</code>"},{"location":"Ud5/Ch5_DMP/#vsftpdconf-usuarios","title":"\ud83d\udcc4 vsftpd.conf usuarios:","text":"<pre><code>userlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n</code></pre>"},{"location":"Ud5/Ch5_DMP/#sftp","title":"\ud83d\udcdd SFTP","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem</code> <code>Crea el certificado SSL</code>"},{"location":"Ud5/Ch5_DMP/#vsftpdconf-seguro","title":"\ud83d\udcc4 vsftpd.conf seguro:","text":"<pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre>"},{"location":"Ud5/Ch5_EGM/","title":"Configuraci\u00f3n de Servidores: FTP/FTPS/SFTP","text":""},{"location":"Ud5/Ch5_EGM/#1-comandos-basicos-ftp","title":"\ud83d\udee0 1. Comandos B\u00e1sicos FTP","text":""},{"location":"Ud5/Ch5_EGM/#conexion-al-servidor-ftp","title":"\ud83c\udf10 Conexi\u00f3n al Servidor FTP","text":"<pre><code> 'ftp' # Establece una conexi\u00f3n con un servidor FTP.\n 'open [hostname]' # Establece una conexi\u00f3n con un servidor FTP. \n 'user [nombre de usuario] [contrase\u00f1a]' # Inicia sesi\u00f3n con el usuario y contrase\u00f1a proporcionados.\n</code></pre>"},{"location":"Ud5/Ch5_EGM/#operaciones-de-archivos-y-directorios","title":"\ud83d\udcc2 Operaciones de Archivos y Directorios","text":"<pre><code>'delete [archivo]' # Elimina un archivo en el servidor FTP.                                           \n'rmd [directorio]'  # Elimina un directorio en el servidor FTP.                                        \n'rename [nombre original] [nuevo nombre]'   # Renombra un archivo o directorio en el servidor FTP.                            \n</code></pre>"},{"location":"Ud5/Ch5_EGM/#transferencia-de-archivos","title":"\ud83d\udce4 Transferencia de Archivos","text":"<pre><code>'get [archivo remoto] [archivo local]'  # Descarga un archivo desde el servidor FTP al equipo local.\n'put [archivo local] [archivo remoto]'  # Sube un archivo desde el equipo local al servidor FTP.\n</code></pre>"},{"location":"Ud5/Ch5_EGM/#modo-activo-y-pasivo","title":"\ud83d\udd04 Modo Activo y Pasivo","text":"<pre><code>'PASV'  # Activa el modo pasivo en el servidor FTP.                                         \n'PORT'  # Activa el modo activo en el servidor FTP.      \n</code></pre>"},{"location":"Ud5/Ch5_EGM/#2-configuracion-servidor-vsftpd","title":"\ud83d\udee0 2. Configuraci\u00f3n Servidor vsFTPd","text":""},{"location":"Ud5/Ch5_EGM/#instalacion","title":"\ud83d\udd27 Instalaci\u00f3n","text":"<pre><code>sudo apt update\nsudo apt install vsftpd -y\n</code></pre>"},{"location":"Ud5/Ch5_EGM/#iniciar-y-habilitar-el-servicio","title":"\ud83d\ude80 Iniciar y habilitar el servicio","text":"<pre><code>sudo systemctl start vsftpd\nsudo systemctl enable vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_EGM/#archivo-de-configuracion","title":"\u2699\ufe0f Archivo de Configuraci\u00f3n","text":"<pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <pre><code>\u274c # No permitimos acceso an\u00f3nimo\nanonymous_enable=NO\nlocal_enable=YES\n\n\u270d\ufe0f # Permitir escritura\nwrite_enable=YES\n\n\ud83c\udf1f # Configuraci\u00f3n de permisos\nlocal_umask=022\n\n\ud83d\udee1\ufe0f # Chroot para usuarios locales\nchroot_local_user=YES\nallow_writeable_chroot=YES\n\n\ud83d\uddc2\ufe0f # Directorio ra\u00edz personalizado\nuser_sub_token=userftp\nlocal_root=/home/userftp/ftp\n\n\ud83d\uddc2\ufe0f # Otra configuraci\u00f3n de directorio ra\u00edz\nuser_sub_token=$USER\nlocal_root=/home/$USER/ftp\n\n\ud83d\udc65 # Configuraci\u00f3n de lista de usuarios\nuserlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n</code></pre> <p>Reiniciar el servicio: </p> <pre><code>sudo systemctl restart vsftpd\n</code></pre> <pre><code>'sudo usermod --home /var/www userftp'  #\ud83c\udfe1 Cambia el directorio home del usuario **userftp** al directorio `/var/www`.                                \n'sudo adduser userftp www-data'   #\ud83d\udc65 A\u00f1ade el usuario **userftp** al grupo **www-data** para asignar permisos de grupo.\n'echo \"userftp' | 'sudo tee -a /etc/vsftpd.userlist'    # \u2795 A\u00f1ade el usuario **userftp** a la lista de usuarios permitidos en **vsFTPd**.  \n</code></pre>"},{"location":"Ud5/Ch5_EGM/#3-configuracion-de-ftps-ftp-seguro-con-ssltls","title":"\ud83d\udee0 3. Configuraci\u00f3n de FTPS (FTP Seguro con SSL/TLS)","text":""},{"location":"Ud5/Ch5_EGM/#generar-un-certificado-ssl","title":"\ud83d\udcc4 Generar un certificado SSL","text":"<pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre>"},{"location":"Ud5/Ch5_EGM/#configurar-vsftpd-para-ftps","title":"\u2699\ufe0f Configurar vsftpd para FTPS","text":"<pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <p>Habilitar Cifrado SSL:</p> <p>Una vez creado el certificado, podemos habilitarlo con la siguiente configuraci\u00f3n:</p> <pre><code># \ud83d\udcc2 Configuraci\u00f3n de certificados SSL predeterminados\nrsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nssl_enable=NO\n\n# \ud83d\udee1\ufe0f Activar FTPS con un certificado personalizado\nrsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n\nallow_anon_ssl=NO                  # \u274c No permitir acceso an\u00f3nimo con SSL\nforce_local_data_ssl=YES           # \ud83d\udd12 Requerir cifrado de datos locales\nforce_local_logins_ssl=YES         # \ud83d\udd10 Requerir cifrado para inicios de sesi\u00f3n\nssl_tlsv1=YES                      # \u2705 Habilitar protocolo TLSv1\nssl_sslv2=NO                       # \u274c Deshabilitar SSLv2\nssl_sslv3=NO                       # \u274c Deshabilitar SSLv3\nrequire_ssl_reuse=NO               # \ud83d\udd04 No requerir reutilizaci\u00f3n de sesi\u00f3n SSL\nssl_ciphers=HIGH                   # \ud83d\udd10 Usar cifrados fuertes\n</code></pre> <p>Habilitar Modo Pasivo: </p> <pre><code># \ud83d\udd04 Configuraci\u00f3n de modo pasivo\npasv_enable=YES                    # Habilitar modo pasivo\npasv_min_port=1027                 # Puerto m\u00ednimo para conexiones pasivas\npasv_max_port=1030                 # Puerto m\u00e1ximo para conexiones pasivas\npasv_address=X.X.X.X               # Direcci\u00f3n IP p\u00fablica del servidor\n</code></pre> <p>Reiniciar el Servicio:</p> <pre><code>sudo systemctl restart vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_EGM/#4-conexion-sftp","title":"\ud83d\udee0 4. Conexi\u00f3n SFTP","text":"<p>Podemos tener la configuraci\u00f3n por defecto</p> <pre><code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.ftps\nsudo cp /etc/vsftpd.conf.backup2 /etc/vsftpd.conf\n</code></pre> <p>Simplemente tenemos que tener un par de claves creadas, con eso hecho ejecutamos el siguiente comando:</p> <pre><code>ssh -i clave user@ipsever\n</code></pre>"},{"location":"Ud5/Ch5_EV/","title":"CH5 - EV","text":""},{"location":"Ud5/Ch5_EV/#acceso-a-un-servidor-ftp-publico-ftpredirises","title":"Acceso a un servidor FTP p\u00fablico ftp.rediris.es","text":"<ul> <li>Entrar en el servidor ftp del ordenador : <code>ftp</code></li> <li>Visualizar los comandos ftp disponibles : <code>help</code></li> <li>Conectar con la red p\u00fablica <code>ftp.rediris.es</code> : <code>open ftp.rediris.es</code></li> <li>Acceder a la carpeta <code>/debian/doc</code>, listar el contenido de archivos y directorios con <code>ls</code> y descargar el archivo constitution.txt con <code>get constitution.txt</code></li> <li>Salir del servidor ftp con <code>quit</code> y listar los archivos de la m\u00e1quina para ver si se ha descargado correctamente</li> </ul>"},{"location":"Ud5/Ch5_EV/#acceso-desde-cliente-grafico","title":"Acceso desde cliente gr\u00e1fico","text":"<ul> <li>Crear <code>Nuevo sitio</code> sin cifrado</li> <li>Servidor : <code>ftp.rediris.es</code></li> <li>Cifrado : <code>Usar s\u00f3lo FTP plano</code></li> <li>Modo de acceso : <code>an\u00f3nimo</code></li> <li>Descargar el archivo en <code>/debian/doc/constitution.txt</code> y finalizar la conexi\u00f3n con el icono de desconectar</li> </ul>"},{"location":"Ud5/Ch5_EV/#instalar-y-configurar-el-servidor-vsftpd-sin-cifrado","title":"Instalar y Configurar el servidor vsFTPd sin cifrado.","text":""},{"location":"Ud5/Ch5_EV/#crear-una-instancia-en-aws","title":"Crear una instancia en AWS","text":"<ul> <li>A\u00f1adir una regla de entrada para permitir el tr\u00e1fico en el puerto FTP que se necesita</li> <li>Para FTP no cifrado <code>puerto 21</code></li> <li>Para FTPS o SFTP con cifrado <code>puerto 22</code></li> </ul>"},{"location":"Ud5/Ch5_EV/#instalacion-del-servidor-vsftpd","title":"Instalaci\u00f3n del servidor vsFTPd","text":"<ul> <li>Actualizar repositorios de Ubuntu e instalar el servidor vsFTPd <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install vsftpd\n</code></pre> Comprobar que se han creado el usuario y grupo <code>ftp</code> en <code>/etc/passwd</code> y <code>/etc/group</code></li> <li>Comprobar que el servicio est\u00e1 en marcha : <code>systemctl status vsftpd</code></li> <li>Tambi\u00e9n se puede comprobar que el servicio vsftpd est\u00e1 funcionando : <code>ps -ef | grep vsftpd</code></li> </ul>"},{"location":"Ud5/Ch5_EV/#configurar-usuario-de-pruebas","title":"Configurar usuario de pruebas","text":"<ul> <li>Crear usuario userftp : <code>sudo adduser userftp</code></li> </ul>"},{"location":"Ud5/Ch5_EV/#configuracion-del-servidor-vsftpd","title":"Configuraci\u00f3n del servidor vsFTPd","text":"<ul> <li>Guardar una copia del archivo de configuraci\u00f3n : <code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.backup</code></li> <li>Abrir el archivo de configuraci\u00f3n : <code>sudo nano /etc/vsftpd.conf</code></li> <li>Permitir el acceso FTP a usuarios locales y deshabilitar cualquier acceso an\u00f3nimo. Comprobar estas dos l\u00edneas en el archivo <code>/etc/vsftpd.conf</code> <pre><code>  anonymous_enable=NO #\n  local_enable=YES #\n</code></pre></li> <li>Guardar el archivo y reiniciar el servicio vsftpd : <code>sudo systemctl restart vsftpd</code></li> <li>Asegurarse de que el servicio vsftpd est\u00e1 en su estado de ejecuci\u00f3n : <code>sudo systemctl status vsftpd</code></li> <li>Probar a conectarse con el usuario <code>userftp</code> con el cliente FTP</li> <li>Descomentar la l\u00ednea <code>write_enable=YES</code> para habilitar la carga de archivos Descomentar la l\u00ednea <code>#local_umask=022</code> del archivo de configuraci\u00f3n, reiniciar el servicio, subir un fichero a <code>/home/userftp</code> y comprobar sus permisos</li> <li>Cambiar la configuraci\u00f3n con la propiedad <code>chroot_local_user=YES</code> para que los usuarios est\u00e9n restringidos a sus directorios de inicio de forma predeterminada</li> </ul>"},{"location":"Ud5/Ch5_EV/#enjaular-al-usuario-en-una-carpeta-distinta-por-ejemplo-varwww","title":"Enjaular al usuario en una carpeta distinta, por ejemplo /var/www","text":"<ul> <li>Instalar apache</li> <li>Cambiar el directorio home del usuario : <code>sudo usermod --home /var/www userftp</code></li> <li>Comprobar con <pre><code>su userftp\ncd\npwd\n</code></pre></li> <li>A\u00f1adir el usuario al grupo de apache o www-data dependiendo del sistema operativo o el usuario apache configurado : <code>sudo adduser userftp www-data</code></li> </ul>"},{"location":"Ud5/Ch5_EV/#restriccion-de-usuarios","title":"Restricci\u00f3n de usuarios","text":"<ul> <li>Agregar las siguientes l\u00edneas y especificar qu\u00e9 usuarios deben poder usar FTP y agregar sus nombres de usuario en el archivo <code>/etc/vsftpd.userlist</code> <pre><code>userlist_enable=YES #\nuserlist_file=/etc/vsftpd.userlist #\nuserlist_deny=NO #\n</code></pre></li> <li>Agregar el nuevo usuario <code>userftp</code> a la lista de usuario FTP permitidos : <code>echo \"userftp\" | sudo tee -a /etc/vsftpd.userlist</code></li> <li>Guardar el archivo, reiniciar el servidor e intentar conectarse con <code>userftp</code></li> </ul>"},{"location":"Ud5/Ch5_EV/#comprobacion-del-acceso-ftp","title":"Comprobaci\u00f3n del acceso FTP","text":"<ul> <li>Comrobar que no se puede iniciar sesi\u00f3n como usuario an\u00f3nimo en el servidor FTP</li> <li>Conectarse como <code>userftp</code></li> <li>Cambiar al directorio de carga y usar el comando get para transferir el archivo de prueba a la m\u00e1quina local : <code>get pruebaftp.txt</code></li> <li>Subir el archivo con un nuevo nombre usando el comando put para probar los permisos de escritura del arhcivo : <code>put pruebaftp.txt pruebaftp2.txt</code></li> <li>Cerrar la conexi\u00f3n : <code>ftp&gt; bye</code></li> <li>Comprobar con <code>ls</code> que el archivo se ha descargado correctamente en la m\u00e1quina local</li> </ul>"},{"location":"Ud5/Ch5_EV/#configuracion-de-servidor-ftp-con-cifrado","title":"Configuraci\u00f3n de servidor FTP con Cifrado","text":"<ul> <li>Abrir instancia anterior de AWS</li> <li>Comprobar el estado del servicio : <code>sudo systemctl status vsftpd</code></li> <li>En caso de que no est\u00e9 iniciado <pre><code>sudo systemctl start vsftpd\nsudo systemctl enable vsftpd.service\n</code></pre></li> </ul>"},{"location":"Ud5/Ch5_EV/#ftps-file-transfer-protocol-secure","title":"FTPS (File Transfer Protocol Secure)","text":"<ul> <li>Generar un certificado autofirmado con OpenSSL : <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem</code></li> <li>Comprobar que se ha generado correctamente : <code>sudo ls -l /etc/ssl/private</code></li> </ul>"},{"location":"Ud5/Ch5_EV/#configurar-el-servidor-vsftpd","title":"Configurar el servidor vsftpd","text":"<ul> <li>Guardar una copia del archivo de configuraci\u00f3n : <code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.backup2</code></li> <li>Modificar el archivo de configuraci\u00f3n</li> <li>Eliminar o comentar las siguientes l\u00edneas <pre><code>rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nssl_enable=NO\n</code></pre></li> <li>A\u00f1adir las siguientes l\u00edneas <pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre></li> <li>Definir los puertos que puede abrir el servidor para el canal de datos en la conexi\u00f3n pasiva en el fichero <code>/etc/vsftpd.conf</code> con las siguientes \u00f3rdenes <pre><code>pasv_enable=YES\npasv_min_port=1027  # Puerto m\u00ednimo de conexi\u00f3n pasiva (reemplaza XXXX con un n\u00famero)\npasv_max_port=1030  # Puerto m\u00e1ximo de conexi\u00f3n pasiva (reemplaza XXXX con un n\u00famero)\npasv_address=X.X.X.X  # Direcci\u00f3n IP p\u00fablica o accesible desde el cliente (reemplaza X.X.X.X con la direcci\u00f3n IP)\n</code></pre></li> <li>Reiniciar el servicio : <code>sudo systemctl restart --now vsftpd</code></li> </ul>"},{"location":"Ud5/Ch5_EV/#comprobar-la-conexion-ftp-al-servidor-vsftpd","title":"Comprobar la Conexi\u00f3n FTP al servidor vsftpd","text":"<ul> <li>En el terminal, escribir la siguiente l\u00ednea para iniciar una sesi\u00f3n FTP reemplazando el nombre_de_host_ftp con la direcci\u00f3n IP P\u00daBLICA o el nombre de dominio del servidor FTP al que se desea conectar : <code>ftp nombre_de_host_ftp</code></li> <li>Si la conexi\u00f3n es exitosa, se ver\u00e1 un mensaje similar a este <pre><code>Connected to nombre_de_host_ftp.\n220 (nombre_del_servidor_ftp) FTP server ready\nName (nombre_de_host_ftp:tu_nombre_de_usuario_ftp):\n</code></pre></li> <li>Acceder a Filezilla y crear una conexi\u00f3n para usarla m\u00e1s adelante <pre><code>- Protocolo: FTP - Protocolo de Transferencia de Archivos\n- Servidor: IP server\n- Cifrado: Requiere FTP expl\u00edcito sobre TLS\n</code></pre></li> </ul>"},{"location":"Ud5/Ch5_EV/#sftp-ssh-file-transfer-protocol","title":"SFTP (SSH File Transfer Protocol)","text":"<ul> <li>Guardar el fichero de configuraci\u00f3n con ftps activado y recuperar el fichero de configuraci\u00f3n antes de configurar FTPS <pre><code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.ftps\nsudo cp /etc/vsftpd.conf.backup2 /etc/vsftpd.conf\n</code></pre></li> <li>Crear un par de claves p\u00fablica y privada para el usuario <code>user2</code> y configurar el servidor ssh en la m\u00e1quina virtual en AWS para que el usuario pueda conectarse con ssh usando su clave privada</li> <li>Probar que funciona : <code>ssh -i clave user2@ipserver</code></li> </ul>"},{"location":"Ud5/Ch5_EV/#conexion-en-modo-comando","title":"Conexi\u00f3n en modo comando","text":"<p><code>sftp -i &lt;archivo .pem&gt; usuario@ipserver</code></p>"},{"location":"Ud5/Ch5_EV/#conexion-en-modo-grafico","title":"Conexi\u00f3n en modo gr\u00e1fico","text":"<ul> <li>En Filezilla, seleccionar el puerto 22 y tener el arhivo de clave privada en la ubicaci\u00f3n donde el siustema espera encontrarlo</li> <li>Si el fichero con la clave privada de <code>user2</code> est\u00e1 en otro sitio se puede crear una nueva conexi\u00f3n as\u00ed <pre><code>Archivo de claves: ruta completa al fichero\n</code></pre></li> </ul>"},{"location":"Ud5/Ch5_MCG/","title":"cheatsheet 5 - ftp","text":"<p>este cheatsheet cubre comandos \u00fatiles para la instalaci\u00f3n, configuraci\u00f3n y manejo del servicio ftp utilizando <code>vsftpd</code> en sistemas basados en debian.</p>"},{"location":"Ud5/Ch5_MCG/#instalacion-y-actualizacion-de-paquetes","title":"instalaci\u00f3n y actualizaci\u00f3n de paquetes","text":"<p>actualizar el \u00edndice de paquetes    actualiza la lista de paquetes disponibles para la instalaci\u00f3n.</p> <pre><code>sudo apt-get update\n</code></pre>"},{"location":"Ud5/Ch5_MCG/#actualizar-los-paquetes-instalados","title":"actualizar los paquetes instalados","text":"<p>actualiza los paquetes a sus versiones m\u00e1s recientes. <pre><code>sudo apt-get upgrade\n</code></pre></p>"},{"location":"Ud5/Ch5_MCG/#instalar-vsftpd","title":"instalar vsftpd","text":"<p>instala el servidor ftp vsftpd, un servidor seguro y eficiente. <pre><code>sudo apt-get install vsftpd\n</code></pre></p>"},{"location":"Ud5/Ch5_MCG/#gestion-del-servicio-vsftpd","title":"gesti\u00f3n del servicio vsftpd","text":"<p>ver el estado del servicio vsftpd muestra el estado actual del servicio vsftpd (si est\u00e1 activo o inactivo). <pre><code>sudo systemctl status vsftpd\n</code></pre></p>"},{"location":"Ud5/Ch5_MCG/#reiniciar-el-servicio-vsftpd-y-aplicar-cambios","title":"reiniciar el servicio vsftpd y aplicar cambios","text":"<p>reinicia el servicio y lo pone en marcha inmediatamente. <pre><code>sudo systemctl restart --now vsftpd\n</code></pre></p>"},{"location":"Ud5/Ch5_MCG/#configuracion-de-ssl-para-vsftpd","title":"configuraci\u00f3n de ssl para vsftpd","text":"<p>generar un certificado ssl autofirmado utiliza openssl para crear un certificado ssl que se usar\u00e1 en el servidor ftp. el comando genera un archivo vsftpd.pem que incluye tanto el certificado como la clave privada. <pre><code>openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout vsftpd.pem -out vsftpd.pem\n</code></pre></p>"},{"location":"Ud5/Ch5_MCG/#configurar-vsftpd-para-usar-ssl","title":"configurar vsftpd para usar ssl","text":"<p>modifica el archivo de configuraci\u00f3n de vsftpd para habilitar ssl y especificar el archivo de certificado y la clave. en el archivo de configuraci\u00f3n /etc/vsftpd.conf, agrega o descomenta las siguientes l\u00edneas:</p> <p><pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n</code></pre> configuraciones de seguridad ssl adicionales asegura que solo se permita la conexi\u00f3n segura y que se utilicen configuraciones robustas para ssl/tls.</p> <pre><code>    allow_anon_ssl=NO                # no permitir ssl para conexiones an\u00f3nimas\n    force_local_data_ssl=YES         # forzar que los datos se transfieran solo a trav\u00e9s de ssl\n    force_local_logins_ssl=YES       # forzar que las conexiones de login se realicen solo con ssl\n    ssl_tlsv1=YES                    # habilitar el uso de tls 1.0\n    ssl_sslv2=NO                     # deshabilitar sslv2\n    ssl_sslv3=NO                     # deshabilitar sslv3\n    require_ssl_reuse=NO             # no requerir que se reutilice el mismo canal ssl\n    ssl_ciphers=HIGH                 # usar solo los cifrados de alta seguridad\n</code></pre>"},{"location":"Ud5/Ch5_MCG/#configuracion-de-modo-pasivo-en-vsftpd","title":"configuraci\u00f3n de modo pasivo en vsftpd","text":"<p>habilitar el modo pasivo el modo pasivo es necesario para que el servidor ftp pueda funcionar correctamente detr\u00e1s de un cortafuegos. <pre><code>pasv_enable=YES\n</code></pre> configurar el rango de puertos pasivos define el rango de puertos que vsftpd utilizar\u00e1 para las conexiones pasivas. esto es importante cuando el servidor est\u00e1 detr\u00e1s de un firewall.</p> <p><pre><code>pasv_min_port=1027    # puerto m\u00ednimo de conexi\u00f3n pasiva\npasv_max_port=1030    # puerto m\u00e1ximo de conexi\u00f3n pasiva\n</code></pre> especificar la direcci\u00f3n ip del servidor en modo pasivo define la ip p\u00fablica o accesible desde el cliente para las conexiones pasivas. aseg\u00farate de reemplazar X.X.X.X con la direcci\u00f3n ip correspondiente. <pre><code>    pasv_address=X.X.X.X   # direcci\u00f3n ip p\u00fablica o accesible\n</code></pre></p>"},{"location":"Ud5/Ch5_MIP/","title":"Practica 1 - Acceso a servidor FTP","text":""},{"location":"Ud5/Ch5_MIP/#acceso-modo-comando","title":"Acceso Modo Comando","text":"<ol> <li>Abrir terminal y ejecutar:    ```bash     ftp help</li> <li>Conectar al servidor:    ```bash     open ftp.rediris.es</li> <li>Navegar y descargar archivo:    ```bash     cd /debian/doc     get constitution.txt</li> <li>Verificar y salir:    ```bash     quit</li> </ol>"},{"location":"Ud5/Ch5_MIP/#acceso-con-filezilla","title":"Acceso con FileZilla","text":"<ol> <li>Conectar sin cifrado:</li> <li>Servidor: ftp.rediris.es</li> <li>Usuario: anonymous</li> <li> <p>Cifrado: Ninguno</p> </li> <li> <p>Descargar archivo:</p> </li> <li> <p>Navegar a <code>/debian/doc</code>, seleccionar <code>constitution.txt</code> y descargarlo.</p> </li> <li> <p>Desconectar:</p> </li> <li>Clicar en el icono de desconectar.</li> </ol>"},{"location":"Ud5/Ch5_MIP/#practica-2-instalar-y-configurar-el-servidor-vsftpd-sin-cifrado","title":"Pr\u00e1ctica 2 - Instalar y Configurar el servidor vsFTPd sin cifrado","text":""},{"location":"Ud5/Ch5_MIP/#introduccion","title":"Introducci\u00f3n","text":"<p>En esta pr\u00e1ctica instalaremos y configuraremos el servidor FTP vsFTPd en una m\u00e1quina virtual Debian, sin cifrado (FTP inseguro, solo para fines did\u00e1cticos).</p>"},{"location":"Ud5/Ch5_MIP/#instalacion-y-configuracion","title":"Instalaci\u00f3n y Configuraci\u00f3n","text":""},{"location":"Ud5/Ch5_MIP/#paso-1-instalacion-del-servidor-vsftpd","title":"Paso 1: Instalaci\u00f3n del servidor vsFTPd","text":"<ol> <li>Actualizamos y luego instalamos vsFTPd:    ```bash    sudo apt-get update &amp;&amp; sudo apt-get upgrade    sudo apt-get install vsftpd</li> <li>Verificamos si el servicio est\u00e1 en ejecuci\u00f3n: systemctl status vsftpd</li> </ol>"},{"location":"Ud5/Ch5_MIP/#paso-2-crear-un-usuario-de-prueba","title":"Paso 2: Crear un Usuario de Prueba","text":"<ol> <li>Creamos un usuario para pruebas, llamado userftp:    ```bash     sudo adduser userftp</li> </ol>"},{"location":"Ud5/Ch5_MIP/#paso-3-configuracion-del-servidor-vsftpd","title":"Paso 3: Configuraci\u00f3n del servidor vsFTPd","text":"<ol> <li>Hacemos una copia de seguridad del archivo de configuraci\u00f3n:    ```bash     sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.backup</li> <li>Editamos el archivo de configuraci\u00f3n:</li> </ol> <p>```bash     sudo nano /etc/vsftpd.conf Configuraciones clave:</p> <ul> <li>anonymous_enable=NO: Deshabilitar acceso an\u00f3nimo.</li> <li> <p>local_enable=YES: Habilitar acceso a usuarios locales.</p> </li> <li> <p>Reiniciamos el servicio:</p> </li> </ul> <p>```bash     sudo systemctl restart vsftpd</p>"},{"location":"Ud5/Ch5_MIP/#paso-4-habilitar-la-carga-de-archivos","title":"Paso 4: Habilitar la carga de archivos","text":"<ol> <li>Descomentamos la l\u00ednea write_enable=YES para permitir la carga de archivos:</li> </ol> <p>```bash     #write_enable=YES 2. Reiniciamos el servidor nuevamente.</p>"},{"location":"Ud5/Ch5_MIP/#paso-5-configurar-chroot-para-los-usuarios","title":"Paso 5: Configurar Chroot para los usuarios","text":"<ol> <li>Habilitamos la c\u00e1rcel (chroot) para usuarios locales:</li> </ol> <p>```bash     chroot_local_user=YES 2. Para restringir el acceso solo a su directorio, creamos un subdirectorio:</p> <ul> <li>mkdir /home/userftp/ftp</li> <li>mkdir /home/userftp/ftp/upload</li> <li>chmod a-w /home/userftp/ftp</li> <li>chmod u+w /home/userftp/ftp/upload</li> <li>Configuramos el archivo vsftpd.conf:</li> </ul> <p>```bash     user_sub_token=userftp     local_root=/home/userftp/ftp</p>"},{"location":"Ud5/Ch5_MIP/#paso-6-restriccion-de-usuarios","title":"Paso 6: Restricci\u00f3n de usuarios","text":"<ol> <li>Configuramos el archivo /etc/vsftpd.userlist para permitir acceso solo a userftp:</li> </ol> <p>```bash     echo \"userftp\" | sudo tee -a /etc/vsftpd.userlist 2. Reiniciamos el servicio para aplicar los cambios:</p> <p>```bash     sudo systemctl restart vsftpd</p>"},{"location":"Ud5/Ch5_MIP/#paso-7-comprobacion-del-acceso-ftp","title":"Paso 7: Comprobaci\u00f3n del acceso FTP","text":"<ol> <li> <p>Intentamos conectarnos como usuario an\u00f3nimo (deber\u00eda fallar).</p> </li> <li> <p>Probamos conexi\u00f3n como userftp y verificamos acceso y carga de archivos.</p> </li> <li> <p>Comandos de prueba:    ```bash     get pruebaftp.txt (descargar archivo)     put archivo.txt (subir archivo)</p> </li> <li>Verificamos que los archivos se descarguen correctamente en el directorio local y con los permisos adecuados.</li> </ol>"},{"location":"Ud5/Ch5_MIP/#resumen-de-la-configuracion-final","title":"Resumen de la configuraci\u00f3n final","text":"<ul> <li>Solo usuarios locales pueden conectarse.</li> <li>Carga de archivos habilitada con umask 022.</li> <li>Directorios de acceso restringidos usando chroot.</li> <li>S\u00f3lo userftp puede conectarse.</li> </ul>"},{"location":"Ud5/Ch5_MIP/#practica-3-configuracion-de-servidor-ftp-con-cifrado","title":"Pr\u00e1ctica 3 - Configuraci\u00f3n de servidor FTP con Cifrado","text":"<p>En esta pr\u00e1ctica, aprenderemos c\u00f3mo asegurar la conexi\u00f3n usando el protocolo SSL/TLS, lo que permitir\u00e1 transferir datos encriptados a trav\u00e9s de FTP.</p> <p>Recuerda que existen dos modos de conexi\u00f3n cifrada de FTP: FTPS y SFTP, los cuales no est\u00e1n relacionados entre s\u00ed en cuanto a configuraci\u00f3n y funcionamiento.</p>"},{"location":"Ud5/Ch5_MIP/#ftps-file-transfer-protocol-secure","title":"FTPS (File Transfer Protocol Secure)","text":"<p>Es a FTP lo que HTTPS es a HTTP. El servidor FTP define sus claves p\u00fablica y privada, las cuales comparte con el cliente para establecer un canal seguro. Para habilitar esta conexi\u00f3n cifrada, es necesario generar un certificado SSL y configurar el servidor <code>vsftpd</code>.</p> <p>Existen dos tipos de conexiones FTPS:</p> <ul> <li>FTPS Expl\u00edcito (FTPES): El cliente solicita la conexi\u00f3n segura mediante un comando (por ejemplo, <code>AUTH TLS</code>).</li> <li>FTPS Impl\u00edcito (FTPIS): La conexi\u00f3n segura se establece autom\u00e1ticamente al conectarse al puerto 990.</li> </ul>"},{"location":"Ud5/Ch5_MIP/#sftp-ssh-file-transfer-protocol","title":"SFTP (SSH File Transfer Protocol)","text":"<p>En este caso, la conexi\u00f3n se realiza a trav\u00e9s de un canal SSH, y <code>vsftpd</code> no necesita configuraci\u00f3n especial. La conexi\u00f3n usa el puerto 22 para SSH, y los datos se transfieren a trav\u00e9s de ese canal cifrado.</p>"},{"location":"Ud5/Ch5_MIP/#instancia-en-aws","title":"Instancia en AWS","text":""},{"location":"Ud5/Ch5_MIP/#iniciar-la-instancia-aws-p4-vsftpd","title":"Iniciar la instancia AWS P4-vsftpd","text":"<p>Aseg\u00farate de que la instancia creada previamente est\u00e9 en funcionamiento, ya que contiene el servidor <code>vsftpd</code> instalado y los usuarios con permisos de FTP.</p>"},{"location":"Ud5/Ch5_MIP/#comprobar-estado-del-servicio-vsftpd","title":"Comprobar estado del servicio vsftpd:","text":"<pre><code>sudo systemctl status vsftpd\n</code></pre> <p>Si no est\u00e1 en ejecuci\u00f3n, inicia y habilita el servicio:</p> <pre><code>sudo systemctl start vsftpd\nsudo systemctl enable vsftpd.service\n</code></pre>"},{"location":"Ud5/Ch5_MIP/#configuracion-de-ftps-ftp-sobre-ssltls","title":"Configuraci\u00f3n de FTPS (FTP sobre SSL/TLS)","text":""},{"location":"Ud5/Ch5_MIP/#generar-un-certificado-ssl-autofirmado","title":"Generar un certificado SSL autofirmado","text":"<p>Usaremos OpenSSL para generar un certificado SSL y su clave privada. Ejecuta el siguiente comando:</p> <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre> <p>Esto generar\u00e1 un certificado autofirmado v\u00e1lido por 365 d\u00edas.</p>"},{"location":"Ud5/Ch5_MIP/#configurar-el-servidor-vsftpd-para-habilitar-ssltls","title":"Configurar el servidor vsftpd para habilitar SSL/TLS","text":"<p>Realiza una copia de seguridad del archivo de configuraci\u00f3n:</p> <pre><code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.backup2\n</code></pre> <p>Edita el archivo de configuraci\u00f3n:</p> <pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <p>Modifica las siguientes configuraciones:</p> <pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre>"},{"location":"Ud5/Ch5_MIP/#habilitar-el-modo-pasivo","title":"Habilitar el modo pasivo","text":"<p>Para evitar problemas con conexiones pasivas, define puertos espec\u00edficos en el archivo <code>vsftpd.conf</code>:</p> <pre><code>pasv_enable=YES\npasv_min_port=1027\npasv_max_port=1030\npasv_address=X.X.X.X\n</code></pre> <p><code>pasv_address</code> debe ser la IP p\u00fablica de tu servidor. Si no se configura, se usar\u00e1 la IP local.</p>"},{"location":"Ud5/Ch5_MIP/#reiniciar-el-servicio-vsftpd","title":"Reiniciar el servicio vsftpd:","text":"<pre><code>sudo systemctl restart --now vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_MIP/#comprobacion-de-la-conexion-ftp-al-servidor-vsftpd","title":"Comprobaci\u00f3n de la conexi\u00f3n FTP al servidor vsftpd","text":""},{"location":"Ud5/Ch5_MIP/#acceso-con-cliente-ftp-en-modo-comando","title":"Acceso con Cliente FTP en Modo Comando:","text":"<p>Abre una terminal y escribe el siguiente comando para conectarte al servidor FTP:</p> <pre><code>ftp nombre_de_host_ftp\n</code></pre> <p>Reemplaza <code>nombre_de_host_ftp</code> con la direcci\u00f3n IP p\u00fablica de tu servidor FTP.</p> <p>Ingresa el usuario y la contrase\u00f1a (por ejemplo, <code>userftp</code> y <code>ieselcaminas</code>). Si la conexi\u00f3n es exitosa, deber\u00edas obtener el prompt <code>ftp&gt;</code>.</p>"},{"location":"Ud5/Ch5_MIP/#acceso-con-cliente-ftp-grafico-filezilla","title":"Acceso con Cliente FTP Gr\u00e1fico (FileZilla):","text":"<p>Abre FileZilla y crea una nueva conexi\u00f3n usando los siguientes par\u00e1metros:</p> <ul> <li>Protocolo: FTP</li> <li>Cifrado: Usar FTPS Expl\u00edcito</li> <li>Puerto: 21 (por defecto)</li> <li>Servidor: Direcci\u00f3n IP p\u00fablica de tu servidor.</li> <li>Usuario: userftp</li> <li>Contrase\u00f1a: ieselcaminas</li> </ul> <p>Acepta el certificado SSL generado al intentar conectar.</p>"},{"location":"Ud5/Ch5_MIP/#sftp-ssh-file-transfer-protocol_1","title":"SFTP (SSH File Transfer Protocol)","text":"<p>Para utilizar SFTP, no necesitas configurar <code>vsftpd</code>. La conexi\u00f3n se realiza a trav\u00e9s de SSH en el puerto 22. Aqu\u00ed se explican los pasos:</p> <ul> <li>Generar un par de claves SSH para el usuario <code>user2</code>, si a\u00fan no lo has hecho.</li> </ul>"},{"location":"Ud5/Ch5_MIP/#verificar-la-conexion-ssh","title":"Verificar la conexi\u00f3n SSH:","text":"<p>Aseg\u00farate de que la conexi\u00f3n SSH funcione correctamente antes de intentar la conexi\u00f3n SFTP:</p> <pre><code>ssh -i clave user2@ipserver\n</code></pre>"},{"location":"Ud5/Ch5_MIP/#conexion-sftp-en-modo-comando","title":"Conexi\u00f3n SFTP en modo comando:","text":"<p>Para conectarte por SFTP en modo comando:</p> <pre><code>sftp user2@ipserver\n</code></pre>"},{"location":"Ud5/Ch5_MIP/#conexion-sftp-en-filezilla","title":"Conexi\u00f3n SFTP en FileZilla:","text":"<p>Si prefieres usar FileZilla, configura la conexi\u00f3n como SFTP con el puerto 22. Aseg\u00farate de indicar la ubicaci\u00f3n de la clave privada para que la conexi\u00f3n funcione correctamente.</p>"},{"location":"Ud5/Ch5_MIP/#resumen-de-la-configuracion-final_1","title":"Resumen de la configuraci\u00f3n final:","text":"<ul> <li>FTPS: La conexi\u00f3n segura se establece utilizando el protocolo SSL/TLS en <code>vsftpd</code>. Los datos se cifran durante la transferencia.</li> <li>SFTP: Se utiliza el canal SSH para realizar las transferencias, y <code>vsftpd</code> no requiere configuraci\u00f3n adicional.</li> </ul>"},{"location":"Ud5/Ch5_MIP/#practica-4-dockerizar-un-servidor-ftp","title":"Pr\u00e1ctica 4: Dockerizar un servidor FTP","text":"<p>En esta pr\u00e1ctica, se configurar\u00e1 un servidor FTP utilizando Docker, bas\u00e1ndonos en la imagen <code>fauria/vsftpd</code>. El objetivo es crear un contenedor con las mismas caracter\u00edsticas que un servidor FTP b\u00e1sico.</p>"},{"location":"Ud5/Ch5_MIP/#iniciar-contenedor-ftp-basico","title":"Iniciar contenedor FTP b\u00e1sico","text":"<p>Comenzamos con un contenedor que permita el acceso FTP simple:</p> <pre><code>docker run     --rm     -p 21:21 -p 20:20     -d     --name pruebavsftpd     fauria/vsftpd\n</code></pre> <p>Recupera el usuario y contrase\u00f1a con:</p> <pre><code>docker logs pruebavsftpd\n</code></pre> <p>Luego, conecta con FileZilla utilizando el modo Activo.</p>"},{"location":"Ud5/Ch5_MIP/#montar-directorios-en-el-host","title":"Montar directorios en el host","text":"<p>Para evitar que los archivos se borren al detener el contenedor, monta el directorio de datos en el host:</p> <pre><code>mkdir datosftp\ndocker run     --rm     -p 21:21 -p 20:20     -d     --name pruebavsftpd     -v /home/admin/datosftp:/home/vsftpd     fauria/vsftpd\n</code></pre> <p>Con\u00e9ctate nuevamente con FileZilla y verifica que los archivos se guardan en <code>/home/admin/datosftp/</code>.</p>"},{"location":"Ud5/Ch5_MIP/#configuracion-con-usuario-ftp-y-modo-pasivo","title":"Configuraci\u00f3n con usuario FTP y modo pasivo","text":"<p>A continuaci\u00f3n, creamos un usuario <code>userftp</code> y activamos el modo pasivo:</p> <pre><code>docker run     --rm     -e FTP_USER=userftp     -e FTP_PASS=ieselcaminas     -e PASV_MIN_PORT=21100     -e PASV_MAX_PORT=21110     -p 21:21 -p 21100-21110:21100-21110     -d     --name pruebavsftpd     -v /home/admin/datosftp:/home/vsftpd     fauria/vsftpd\n</code></pre> <p>Con\u00e9ctate con FileZilla usando el modo Pasivo.</p>"},{"location":"Ud5/Ch5_MIP/#configuracion-de-permisos-de-archivos","title":"Configuraci\u00f3n de permisos de archivos","text":"<p>Para ajustar los permisos de los archivos subidos, establecemos la variable <code>LOCAL_UMASK</code>:</p> <pre><code>docker run     -e FTP_USER=userftp     -e FTP_PASS=ieselcaminas     -e PASV_MIN_PORT=21100     -e PASV_MAX_PORT=21110     -e LOCAL_UMASK=022     -p 21:21 -p 21100-21110:21100-21110     -d     --name vsftpdsincifrado     -v /home/admin/datosftp:/home/vsftpd     fauria/vsftpd\n</code></pre> <p>Verifica que los archivos subidos tengan los permisos correctos.</p>"},{"location":"Ud5/Ch5_MIP/#dockerizar-vsftpd-con-cifrado-ftps","title":"Dockerizar vsftpd con CIFRADO (FTPS)","text":"<p>Para habilitar FTPS, creamos una imagen personalizada copiando los archivos de configuraci\u00f3n y certificado:</p> <ol> <li> <p>Genera un certificado SSL:    <pre><code>openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout vsftpd.pem -out vsftpd.pem\n</code></pre></p> </li> <li> <p>Copia el archivo <code>vsftpd.conf</code> desde un contenedor ya configurado sin cifrado:</p> </li> </ol> <pre><code>docker cp vsftpdsincifrado:/etc/vsftpd/vsftpd.conf .\n</code></pre> <p>Modifica <code>vsftpd.conf</code> para habilitar FTPS.</p> <ol> <li>Crea un <code>Dockerfile</code> para generar una imagen personalizada:</li> </ol> <pre><code>FROM fauria/vsftpd\nCOPY vsftpd.conf /etc/vsftpd/vsftpd.conf\nCOPY --chown=root:root vsftpd.pem /etc/vsftpd/vsftpd.pem\n</code></pre> <ol> <li>Construye y corre la imagen:</li> </ol> <pre><code>docker build -t mivsftpd .\ndocker run        -e FTP_USER=userftp        -e FTP_PASS=ieselcaminas        -e PASV_MIN_PORT=21100        -e PASV_MAX_PORT=21110        -e LOCAL_UMASK=022        -p 21:21 -p 21100-21110:21100-21110        -d        --name vsftpdconcifrado        -v /home/admin/datosftp:/home/vsftpd        mivsftpd\n</code></pre> <p>Con\u00e9ctate usando FTP expl\u00edcito sobre TLS y modo pasivo.</p>"},{"location":"Ud5/Ch5_MIP/#conclusion","title":"Conclusi\u00f3n","text":"<p>Hemos dockerizado un servidor FTP con configuraciones de seguridad b\u00e1sicas y avanzadas (modo pasivo y FTPS).</p>"},{"location":"Ud5/Ch5_MMC/","title":"CheatSheet FTP","text":""},{"location":"Ud5/Ch5_MMC/#comandos-basicos-ftp","title":"Comandos B\u00e1sicos FTP \ud83d\udd0d","text":"ftp Entrar en el servidor ftp open ftp.rediris.es Conexi\u00f3n a una red get  Descargar archivos quit Salir del servidor ftp"},{"location":"Ud5/Ch5_MMC/#vsftpd-sin-cifrado","title":"vsFTPd sin cifrado \u2601\ufe0f","text":"sudo apt-get install vsftpd Instalaci\u00f3n vsFTPd /etc/bind/named.conf Archivo de configuraci\u00f3n de Bind write_enable=YES L\u00ednea, en /etc/vsftpd.conf, necesaria para poder cargar archivos. chroot_local_user=YES L\u00ednea, en /etc/vsftpd.conf, para habilitar las restricciones a usuarios locales. userlist_enable=YES # userlist_file=/etc/vsftpd.userlist # userlist_deny=NO # Permiso que solo ciertos usuarios puedan iniciar sesi\u00f3n en el servidor FTP. Luego hay que agregar los nombre de usuarios a /etc/vsftpd.userlist."},{"location":"Ud5/Ch5_MMC/#vsftpd-con-cifrado-ftps","title":"vsFTPd con cifrado (FTPS) \u26c8\ufe0f","text":"sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem Creaci\u00f3n de certificado SSL con OpenSSL. Abrimos /etc/vsftpd.conf y eliminamos las siguientes l\u00edneas: <p>rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key ssl_enable=NO | Las cambiamos por estas l\u00edneas:</p> <p>rsa_cert_file=/etc/ssl/private/vsftpd.pem rsa_private_key_file=/etc/ssl/private/vsftpd.pem ssl_enable=YES</p> <p>allow_anon_ssl=NO force_local_data_ssl=YES force_local_logins_ssl=YES ssl_tlsv1=YES ssl_sslv2=NO ssl_sslv3=NO require_ssl_reuse=NO ssl_ciphers=HIGH | | pasv_enable=YES pasv_min_port=1027  # Puerto m\u00ednimo de conexi\u00f3n pasiva (reemplaza XXXX con un n\u00famero) pasv_max_port=1030  # Puerto m\u00e1ximo de conexi\u00f3n pasiva (reemplaza XXXX con un n\u00famero) pasv_address=X.X.X.X  # Direcci\u00f3n IP p\u00fablica o accesible desde el cliente (reemplaza X.X.X.X con la direcci\u00f3n IP) | A\u00f1adimos estas l\u00edneas en /etc/vsftpd.conf para habilitar el modo pasivo |</p>"},{"location":"Ud5/Ch5_PPE/","title":"\ud83d\udcc4 Cheatsheet UD5 - Servicios de red FTP","text":"<p>Este documento resume los comandos y ficheros de configuraci\u00f3n para la creaci\u00f3n y gesti\u00f3n de servicios de red FTP en sistemas Ubuntu, correspondientes a la Unidad 5 del curso de Despliegue de Aplicaciones.</p>"},{"location":"Ud5/Ch5_PPE/#comandos-basicos-ftp","title":"\ud83d\udee0\ufe0f Comandos B\u00e1sicos FTP","text":""},{"location":"Ud5/Ch5_PPE/#conexion-al-servidor-ftp","title":"\ud83c\udf10 Conexi\u00f3n al Servidor FTP","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>ftp</code> \ud83c\udf1f Establece una conexi\u00f3n con un servidor FTP. <code>open [hostname]</code> \ud83d\udd17 Establece una conexi\u00f3n con un servidor FTP. <code>user [nombre de usuario] [contrase\u00f1a]</code> \ud83d\udc64 Inicia sesi\u00f3n con el usuario y contrase\u00f1a proporcionados."},{"location":"Ud5/Ch5_PPE/#operaciones-de-archivos-y-directorios","title":"\ud83d\udcc2 Operaciones de Archivos y Directorios","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>delete [archivo]</code> \ud83d\uddd1\ufe0f Elimina un archivo en el servidor FTP. <code>rmd [directorio]</code> \ud83d\uddc2\ufe0f Elimina un directorio en el servidor FTP. <code>rename [nombre original] [nuevo nombre]</code> \u270f\ufe0f Renombra un archivo o directorio en el servidor FTP."},{"location":"Ud5/Ch5_PPE/#transferencia-de-archivos","title":"\ud83d\udce4 Transferencia de Archivos","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>get [archivo remoto] [archivo local]</code> \u2b07\ufe0f Descarga un archivo desde el servidor FTP al equipo local. <code>put [archivo local] [archivo remoto]</code> \u2b06\ufe0f Sube un archivo desde el equipo local al servidor FTP."},{"location":"Ud5/Ch5_PPE/#modo-activo-y-pasivo","title":"\ud83d\udd04 Modo Activo y Pasivo","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>PASV</code> \ud83d\udd12 Activa el modo pasivo en el servidor FTP. <code>PORT</code> \ud83d\udd13 Activa el modo activo en el servidor FTP."},{"location":"Ud5/Ch5_PPE/#utilidades","title":"\ud83d\udd0d Utilidades","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>help</code> \u2754 Muestra la lista de comandos disponibles en FTP. <code>quit</code> \ud83d\udeaa Cierra la conexi\u00f3n con el servidor FTP."},{"location":"Ud5/Ch5_PPE/#configuracion-del-servidor-vsftpd","title":"\ud83d\udda5\ufe0f Configuraci\u00f3n del servidor vsFTPd","text":""},{"location":"Ud5/Ch5_PPE/#instalacion","title":"\ud83d\udd27 Instalaci\u00f3n","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo apt-get install vsftpd</code> \ud83d\udee0\ufe0f Instala el servidor FTP vsFTPd en el sistema Ubuntu."},{"location":"Ud5/Ch5_PPE/#fichero-de-configuracion","title":"\u2699\ufe0f Fichero de configuraci\u00f3n","text":"<pre><code># \u274c No permitimos acceso an\u00f3nimo\nanonymous_enable=NO\nlocal_enable=YES\n\n# \u270d\ufe0f Permitir escritura\nwrite_enable=YES\n\n# \ud83c\udf1f Configuraci\u00f3n de permisos\nlocal_umask=022\n\n# \ud83d\udee1\ufe0f Chroot para usuarios locales\nchroot_local_user=YES\nallow_writeable_chroot=YES\n\n# \ud83d\uddc2\ufe0f Directorio ra\u00edz personalizado\nuser_sub_token=userftp\nlocal_root=/home/userftp/ftp\n\n# \ud83d\uddc2\ufe0f Otra configuraci\u00f3n de directorio ra\u00edz\nuser_sub_token=$USER\nlocal_root=/home/$USER/ftp\n\n# \ud83d\udc65 Configuraci\u00f3n de lista de usuarios\nuserlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n</code></pre>"},{"location":"Ud5/Ch5_PPE/#comandos-utiles","title":"\ud83e\uddf0 Comandos \u00fatiles","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo usermod --home /var/www userftp</code> \ud83c\udfe1 Cambia el directorio home del usuario userftp al directorio <code>/var/www</code>. <code>sudo adduser userftp www-data</code> \ud83d\udc65 A\u00f1ade el usuario userftp al grupo www-data para asignar permisos de grupo. <code>echo \"userftp\" | sudo tee -a /etc/vsftpd.userlist</code> \u2795 A\u00f1ade el usuario userftp a la lista de usuarios permitidos en vsFTPd."},{"location":"Ud5/Ch5_PPE/#configuracion-con-cifrado","title":"\ud83d\udd10 Configuraci\u00f3n con Cifrado","text":""},{"location":"Ud5/Ch5_PPE/#conexion-ftps","title":"\ud83d\udd11 Conexi\u00f3n FTPS","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem</code> \ud83d\udd12 Genera un certificado SSL para habilitar la conexi\u00f3n FTPS. <pre><code># \ud83d\udcc2 Configuraci\u00f3n de certificados SSL predeterminados\nrsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nssl_enable=NO\n\n# \ud83d\udee1\ufe0f Activar FTPS con un certificado personalizado\nrsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n\nallow_anon_ssl=NO                  # \u274c No permitir acceso an\u00f3nimo con SSL\nforce_local_data_ssl=YES           # \ud83d\udd12 Requerir cifrado de datos locales\nforce_local_logins_ssl=YES         # \ud83d\udd10 Requerir cifrado para inicios de sesi\u00f3n\nssl_tlsv1=YES                      # \u2705 Habilitar protocolo TLSv1\nssl_sslv2=NO                       # \u274c Deshabilitar SSLv2\nssl_sslv3=NO                       # \u274c Deshabilitar SSLv3\nrequire_ssl_reuse=NO               # \ud83d\udd04 No requerir reutilizaci\u00f3n de sesi\u00f3n SSL\nssl_ciphers=HIGH                   # \ud83d\udd10 Usar cifrados fuertes\n</code></pre> <pre><code># \ud83d\udd04 Configuraci\u00f3n de modo pasivo\npasv_enable=YES                    # Habilitar modo pasivo\npasv_min_port=1027                 # Puerto m\u00ednimo para conexiones pasivas\npasv_max_port=1030                 # Puerto m\u00e1ximo para conexiones pasivas\npasv_address=X.X.X.X               # Direcci\u00f3n IP p\u00fablica del servidor\n</code></pre>"},{"location":"Ud5/Ch5_PPE/#conexion-sftp","title":"\ud83d\udd10 Conexi\u00f3n SFTP","text":"\ud83d\udd27 Fichero de configuraci\u00f3n \ud83d\udcdd Funcionalidad <code>sftp -i clave user2@ipserver</code> \ud83d\udd11 Conecta mediante SFTP utilizando una clave privada para autenticar al usuario user2 en el servidor."},{"location":"Ud5/Ch5_RPE/","title":"\ud83d\udcc4 Cheatsheet de Servicios de Red FTP","text":""},{"location":"Ud5/Ch5_RPE/#comandos-basicos-ftp","title":"\ud83d\udd27 Comandos b\u00e1sicos FTP","text":"Comando Descripci\u00f3n <code>ftp</code> Entrar en el cliente FTP. <code>open ftp://&lt;IP&gt;</code> Conectarse a un servidor FTP. <code>get &lt;archivo&gt;</code> Descargar un archivo desde un servidor FTP. <code>quit</code> Salir del cliente FTP."},{"location":"Ud5/Ch5_RPE/#instalacion-de-un-servidor-vsftpd","title":"\u2699\ufe0f Instalaci\u00f3n de un servidor vsFTPd","text":"<ol> <li>Actualizar el sistema e instalar vsFTPd:</li> </ol> <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install vsftpd\n</code></pre>"},{"location":"Ud5/Ch5_RPE/#archivos-de-configuracion","title":"\ud83d\udee0\ufe0f Archivos de configuraci\u00f3n","text":"<p>Editar el archivo <code>/etc/vsftpd.conf</code> y a\u00f1adir las siguientes l\u00edneas:</p> <pre><code>anonymous_enable=NO\nlocal_enable=YES\nwrite_enable=YES\nlocal_umask=022\nchroot_local_user=YES\nallow_writeable_chroot=YES\nuser_sub_token=&lt;usuario&gt;\nlocal_root=&lt;directorio&gt;\n</code></pre>"},{"location":"Ud5/Ch5_RPE/#restriccion-de-usuarios-ftp","title":"\ud83d\udeab Restricci\u00f3n de usuarios FTP","text":"<p>Para restringir el acceso a FTP, agrega estos par\u00e1metros al archivo <code>/etc/vsftpd.conf</code>:</p> <pre><code>userlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n</code></pre>"},{"location":"Ud5/Ch5_RPE/#configuracion-de-ftp-con-cifrado","title":"\ud83d\udd10 Configuraci\u00f3n de FTP con cifrado","text":""},{"location":"Ud5/Ch5_RPE/#crear-un-certificado-ssl","title":"\ud83d\udee1\ufe0f Crear un certificado SSL","text":"<p>Generar un certificado SSL con el siguiente comando:</p> <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre>"},{"location":"Ud5/Ch5_RPE/#habilitar-el-cifrado","title":"\u26a1 Habilitar el cifrado","text":"<p>Reemplazar las siguientes l\u00edneas en <code>/etc/vsftpd.conf</code>:</p> <p>De:</p> <pre><code>rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nssl_enable=NO\n</code></pre> <p>Por:</p> <pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\n\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre>"},{"location":"Ud5/Ch5_RPE/#habilitar-modo-pasivo","title":"\ud83d\udce1 Habilitar modo pasivo","text":"<p>A\u00f1adir las siguientes l\u00edneas en <code>/etc/vsftpd.conf</code>:</p> <pre><code>pasv_enable=YES\npasv_min_port=1027  # Puerto m\u00ednimo de conexi\u00f3n pasiva.\npasv_max_port=1030  # Puerto m\u00e1ximo de conexi\u00f3n pasiva.\npasv_address=X.X.X.X  # Direcci\u00f3n IP p\u00fablica del servidor.\n</code></pre>"},{"location":"Ud5/Ch5_RPE/#configuracion-de-sftp","title":"\ud83c\udf10 Configuraci\u00f3n de SFTP","text":"<p>Generar un par de claves SSH y conectarse con el siguiente comando:</p> <pre><code>ssh -i clave user2@ipserver\n</code></pre>"},{"location":"Ud5/Ch5_RRL/","title":"SERVICIOS DE RED FTP","text":""},{"location":"Ud5/Ch5_RRL/#comandos-basicos","title":"COM\u00c1NDOS B\u00c1SICOS","text":""},{"location":"Ud5/Ch5_RRL/#ftp","title":"FTP","text":"<pre><code>ftp\n</code></pre> <p>Entra en el modo FTP.</p>"},{"location":"Ud5/Ch5_RRL/#open","title":"OPEN","text":"<pre><code>open 'servidor_FTP'\n</code></pre> <p>Se conecta a un servidor FTP.</p>"},{"location":"Ud5/Ch5_RRL/#get","title":"GET","text":"<pre><code>get 'archivo'\n</code></pre> <p>Descarga un archivo del servidor.</p>"},{"location":"Ud5/Ch5_RRL/#put","title":"PUT","text":"<pre><code>put 'archivo'\n</code></pre>"},{"location":"Ud5/Ch5_RRL/#quit","title":"QUIT","text":"<p>Sube un archivo al servidor.</p> <pre><code>quit\n</code></pre> <p>Salir del modo FTP.</p>"},{"location":"Ud5/Ch5_RRL/#instalacion-del-servidor-ftp","title":"INSTALACI\u00d3N DEL SERVIDOR FTP","text":"<pre><code>sudo apt install vsftpd\n</code></pre> <p>Descarga el servidor vsftpd.</p> <pre><code>sudo systemctl start vsftpd.service\n</code></pre> <p>Arranca el servicio vsftpd.</p> <pre><code>sudo systemctl restart vsftpd.service\n</code></pre> <p>Reinicia el servicio vsftpd.</p> <pre><code>sudo systemctl stop vsftpd.service\n</code></pre> <p>Para el servicio vsftpd.</p> <pre><code>sudo systemctl enable vsftpd.service\n</code></pre> <p>Habilita el arranque autom\u00e1tico del servidor vsftpd.</p>"},{"location":"Ud5/Ch5_RRL/#configuracion-del-servidor-ftp","title":"Configuraci\u00f3n del servidor FTP","text":"<pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <p>Modficar el archivo de configuraci\u00f3n.</p> <pre><code>anonymous_enable=NO\nlocal_enable=YES\n</code></pre> <p>Acceso a usuarios locales y no permite el al acceso an\u00f3nimo.</p> <pre><code>write_enable=YES\n</code></pre> <p>Permitir escritura.</p> <pre><code>local_umask=022\n</code></pre> <p>Configuraci\u00f3n de permisos.</p> <pre><code>chroot_local_user=YES\n</code></pre> <p>Restringe el usuario local a su directorio de inicio.</p> <pre><code>allow_writeable_chroot=YES\n</code></pre> <p>Permitir que el directorio ra\u00edz al que nos conectamos s\u00ed pueda ser escribible.</p> <pre><code>user_sub_token=userftp\nlocal_root=/home/userftp/ftp\n</code></pre> <p>Directorio ra\u00edz personalizado.</p> <pre><code>sudo nano /etc/vsftpd.userlist\n</code></pre> <pre><code>userlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n</code></pre> <p>Acceso de usuarios.</p> <pre><code>pasv_enable=YES\npasv_min_port=1027\npasv_max_port=1030\npasv_address='server IP'\n</code></pre> <p>Activar el modo pasivo.</p>"},{"location":"Ud5/Ch5_RRL/#sftp","title":"SFTP","text":"<pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre> <p>Crea el certificado SSL.</p>"},{"location":"Ud5/Ch5_RRL/#vsftpd-seguro","title":"VSFTPD SEGURO","text":"<pre><code>rsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\nssl_enable=YES\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre>"},{"location":"Ud5/Ch5_RSN/","title":"CH5 - RSN","text":""},{"location":"Ud5/Ch5_RSN/#acceso-ftp-publico","title":"Acceso FTP publico \u25b6\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>open ftp</code> Conectarse a una red p\u00fablica como an\u00f3nimo <code>get constitution.txt</code> Obtener archivo de la red <code>quit</code> Salir de la red"},{"location":"Ud5/Ch5_RSN/#instalar-y-configurar-el-servidor-vsftpd-sin-cifrado","title":"Instalar y configurar el servidor vsFTPd sin cifrado \ud83d\udd13","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo apt-get install vsftpd</code> Obtener servidor FTPd <code>sudo adduser userftp</code> Creaci\u00f3n de usuario FTP <code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.backup</code> Copia de seguridad de vsftpd.conf <code>sudo adduser userftp www-data</code> A\u00f1adir el usuario para subir archivos web"},{"location":"Ud5/Ch5_RSN/#configuracion-de-un-servidor-ftp-con-cifrado","title":"Configuraci\u00f3n de un servidor FTP con cifrado \ud83d\udd12","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem</code> Generar  certificado"},{"location":"Ud5/Ch5_RSN/#servidor-ftp-dockerizado-sin-cifrado","title":"Servidor FTP dockerizado sin cifrado \ud83d\udce6\ud83d\udd13","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>docker run  rm  e FTP_USER=userftp  e FTP_PASS=ieselcaminas  e PASV_MIN_PORT=21100  e PASV_MAX_PORT=21110  p 21:21 p 21100-21110:21100-21110  d  name pruebavsftpd  v /home/admin/datosftp:/home/vsftpd fauria/vsftpd</code> Dockerizaci\u00f3n con modo pasivo y craeci\u00f3n de usuario"},{"location":"Ud5/Ch5_RSN/#servidor-ftp-dockerizado-con-cifrado","title":"Servidor FTP dockerizado con cifrado \ud83d\udce6\ud83d\udd12","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>docker run -e FTP_USER=userftp -e FTP_PASS=ieselcaminas -e PASV_MIN_PORT=21100 -e PASV_MAX_PORT=21110 -e LOCAL_UMASK=022 -p 21:21 -p 21100-21110:21100-21110 -d --name vsftpdconcifrado -v /home/admin/datosftp:/home/vsftpd mivsftpd</code> Dockerizaci\u00f3n con cifrado"},{"location":"Ud5/Ch5_RSN/#configuraciones-de-archivos","title":"Configuraciones de archivos \ud83d\udcdc","text":"<pre><code>&gt; Archivo configuraci\u00f3n vsftpd.conf (P1)\n\n    //Habilitar usuarios locales\n    //Deshabilitar usuarios an\u00f3nimos\n    //Habilitar escritura\n    anonymous_enable=NO\n    local_enable=YES\n    allow_writeable_chroot=YES\n\n    //Crear lista de usuarios para que puedan entrar\n    userlist_enable=YES #\n    userlist_file=/etc/vsftpd.userlist #\n    userlist_deny=NO #\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n vsftpd.conf (P1)\n\n    //Habilitar certificado\n\n    rsa_cert_file=/etc/ssl/private/vsftpd.pem\n    rsa_private_key_file=/etc/ssl/private/vsftpd.pem\n    ssl_enable=YES\n\n    allow_anon_ssl=NO\n    force_local_data_ssl=YES\n    force_local_logins_ssl=YES\n    ssl_tlsv1=YES\n    ssl_sslv2=NO\n    ssl_sslv3=NO\n    require_ssl_reuse=NO\n    ssl_ciphers=HIGH\n\n    //Habilitar modo pasivo\n    pasv_enable=YES\n    pasv_min_port=1027  # Puerto m\u00ednimo de conexi\u00f3n pasiva (reemplaza XXXX con un n\u00famero)\n    pasv_max_port=1030  # Puerto m\u00e1ximo de conexi\u00f3n pasiva (reemplaza XXXX con un n\u00famero)\n    pasv_address=X.X.X.X  # Direcci\u00f3n IP p\u00fablica o accesible desde el cliente (reemplaza X.X.X.X con la direcci\u00f3n IP)\n</code></pre>"},{"location":"Ud5/Ch5_VATC/","title":"\ud83c\udf1f Servicios de Red FTP","text":"<p>\u270d\ufe0f Victor Alexandru Teleanu Covaci</p>"},{"location":"Ud5/Ch5_VATC/#1-comandos-basicos-ftp","title":"\ud83d\udee0\ufe0f 1. Comandos B\u00e1sicos FTP","text":""},{"location":"Ud5/Ch5_VATC/#conexion-al-servidor-ftp","title":"\ud83c\udf10 Conexi\u00f3n al Servidor FTP","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>open</code> o <code>open [hostname]</code> \ud83d\udd17 Establece una conexi\u00f3n con un servidor FTP. <code>user [nombre de usuario] [contrase\u00f1a]</code> \ud83d\udc64 Inicia sesi\u00f3n en el servidor FTP. <code>ftp &lt;DIRECCI\u00d3N_IP&gt;</code> \ud83d\udd17 Conecta al servidor FTP mediante la direcci\u00f3n IP proporcionada. <code>sftp sftpuser@&lt;DIRECCI\u00d3N_IP&gt;</code> \ud83d\udd11 Establece una conexi\u00f3n SFTP con el servidor."},{"location":"Ud5/Ch5_VATC/#transferencia-de-archivos","title":"\ud83d\udce4 Transferencia de Archivos","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>get [archivo remoto] [archivo local]</code> \u2b07\ufe0f Descarga un archivo desde el servidor FTP al equipo local. <code>put [archivo local] [archivo remoto]</code> \u2b06\ufe0f Sube un archivo desde el equipo local al servidor FTP."},{"location":"Ud5/Ch5_VATC/#modo-activo-y-pasivo","title":"\ud83d\udd04 Modo Activo y Pasivo","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>PASV</code> \ud83d\udd12 El cliente solicita al servidor FTP cambiar a modo pasivo y abrir un puerto para datos. <code>PORT</code> \ud83d\udd13 En modo activo, el cliente usa PORT para indicar el puerto de la conexi\u00f3n de datos."},{"location":"Ud5/Ch5_VATC/#ayuda-y-salida","title":"\ud83d\udd0d Ayuda y salida","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>help</code> \u2754 Muestra la lista de comandos FTP disponibles. <code>quit</code> \ud83d\udeaa Cierra la sesi\u00f3n FTP y sale del cliente."},{"location":"Ud5/Ch5_VATC/#2-instalacion-y-configuracion-de-vsftpd","title":"\u2728 2. Instalaci\u00f3n y Configuraci\u00f3n de vsFTPd","text":""},{"location":"Ud5/Ch5_VATC/#instalacion-en-debian","title":"\u2705 Instalaci\u00f3n en Debian","text":"<ol> <li>Actualiza los repositorios e instala vsFTPd:</li> </ol> <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install vsftpd\n</code></pre> <ol> <li><code>systemctl status vsftpd</code> verifica que el servicio est\u00e1 activo.</li> </ol>"},{"location":"Ud5/Ch5_VATC/#crear-un-usuario-para-ftp","title":"\ud83d\udc64 Crear un usuario para FTP","text":"<pre><code>sudo adduser ftpuser\n</code></pre>"},{"location":"Ud5/Ch5_VATC/#configuracion-de-vsftpd","title":"\u2699\ufe0f Configuraci\u00f3n de vsFTPD","text":"<ol> <li> <p>Crea un copia de seguridad del archivo de configuraci\u00f3n con <code>sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.backup</code>.</p> </li> <li> <p>Modifica el archivo con <code>sudo nano /etc/vsftpd.conf</code>.</p> </li> <li> <p>Fichero de configuraci\u00f3n: <pre><code># \ud83d\udeab Deshabilitar el acceso an\u00f3nimo\nanonymous_enable=NO\n\n# \ud83d\udc65 Habilitar el acceso local\nlocal_enable=YES\n\n# \u270f\ufe0f Permitir escritura\nwrite_enable=YES\n\n# \ud83d\udd12 Configuraci\u00f3n de chroot para usuarios locales\nchroot_local_user=YES\nallow_writeable_chroot=YES\n\n# \ud83d\uddc2\ufe0f Establecer la ruta local para el usuario\nuser_sub_token=userftp\nlocal_root=/home/userftp/ftp\n\n# \ud83c\udf0d Configuraci\u00f3n din\u00e1mica para el usuario actual\nuser_sub_token=$USER\nlocal_root=/home/$USER/ftp\n\n# \ud83d\udcdd Habilitar lista de usuarios\nuserlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n</code></pre></p> </li> <li> <p>Reinicia el servicio con <code>sudo systemctl restart vsftpd</code>.</p> </li> </ol>"},{"location":"Ud5/Ch5_VATC/#3-configuracion-de-ftps-ftp-seguro-con-ssltls","title":"\ud83d\udd11 3. Configuraci\u00f3n de FTPS (FTP Seguro con SSL/TLS)","text":"<ol> <li> <p>Genera un certificado SSL: <pre><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n-keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem\n</code></pre></p> </li> <li> <p>Configurar vsftpd para FTPS con <code>sudo nano /etc/vsftpd.conf</code>.</p> </li> <li> <p>Agregar o modificar las siguientes lineas: <pre><code># \ud83d\udd12 Certificados SSL para la conexi\u00f3n segura\nrsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem\n\n# \u2699\ufe0f Habilitar SSL\nssl_enable=YES\n\n# \ud83d\udeab Deshabilitar acceso an\u00f3nimo en SSL\nallow_anon_ssl=NO\n\n# \ud83d\udd10 Forzar el uso de SSL para la transferencia de datos y el inicio de sesi\u00f3n\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\n\n# \ud83d\udd04 Especificar protocolos SSL/TLS permitidos\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\n\n# \ud83d\udeab Requerir reutilizaci\u00f3n de sesiones SSL\nrequire_ssl_reuse=NO\n\n# \ud83d\udc8e Establecer cifrados SSL/TLS\nssl_ciphers=HIGH\n\n# \ud83c\udf10 Habilitar modo pasivo y configuraci\u00f3n de puertos\npasv_enable=YES\npasv_min_port=1027\npasv_max_port=1030\n\n# \ud83d\udda5\ufe0f Direcci\u00f3n IP para conexiones pasivas\npasv_address=&lt;DIRECCI\u00d3N_IP&gt;\ndress=&lt;DIRECCI\u00d3N_IP&gt;\n</code></pre></p> </li> <li> <p>Reinicia el servicio con <code>sudo systemctl restart vsftpd</code>.</p> </li> </ol>"},{"location":"Ud5/Ch5_VATC/#4-conexion-sftps","title":"\ud83d\udd17 4. Conexi\u00f3n SFTPS","text":"<pre><code>ssh -i clave user2@ipserver\n</code></pre>"},{"location":"Ud6/Ch6_ABM/","title":"\ud83c\udf9b\ufe0f Cheatsheet: Servidores de Aplicaciones","text":""},{"location":"Ud6/Ch6_ABM/#apache-tomcat","title":"\ud83d\udc31 Apache Tomcat","text":""},{"location":"Ud6/Ch6_ABM/#instalacion-en-linux-ubuntudebian","title":"\ud83d\udd27 Instalaci\u00f3n en Linux (Ubuntu/Debian)","text":"<ol> <li>Actualizar repositorios: <pre><code>sudo apt update\n</code></pre></li> <li>Instalar Tomcat: <pre><code>sudo apt install tomcat10 tomcat10-admin\n</code></pre></li> <li>Verificar estado del servicio: <pre><code>sudo systemctl status tomcat10\n</code></pre></li> <li>Iniciar el servicio: <pre><code>sudo systemctl start tomcat10\n</code></pre></li> <li>Habilitar en el arranque: <pre><code>sudo systemctl enable tomcat10\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ABM/#despliegue-de-aplicaciones-en-tomcat","title":"\ud83d\ude80 Despliegue de Aplicaciones en Tomcat","text":"<ol> <li>Copiar archivos <code>.war</code> en el directorio de despliegue: <pre><code>sudo cp &lt;app&gt;.war /var/lib/tomcat10/webapps/\n</code></pre></li> <li>Verificar despliegue: </li> <li> <p>URL: <code>http://localhost:8080/&lt;app&gt;</code> </p> </li> <li> <p>Reiniciar Tomcat tras cambios: <pre><code>sudo systemctl restart tomcat10\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_ABM/#despliegue-en-tomcat-con-maven","title":"\ud83d\udee0\ufe0f Despliegue en Tomcat con Maven","text":"<ol> <li>Agregar el plugin de Tomcat en <code>pom.xml</code>: <pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n    &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.2&lt;/version&gt;\n&lt;/plugin&gt;\n</code></pre></li> <li>Desplegar la aplicaci\u00f3n: <pre><code>mvn tomcat7:deploy\n</code></pre></li> <li>Acceder a la aplicaci\u00f3n: </li> <li>URL: <code>http://localhost:8080/&lt;artifactId&gt;</code></li> </ol>"},{"location":"Ud6/Ch6_ABM/#nodejs-y-express","title":"\ud83c\udf10 Node.js y Express","text":""},{"location":"Ud6/Ch6_ABM/#despliegue-basico","title":"\ud83d\ude80 Despliegue B\u00e1sico","text":"<ol> <li>Crear un proyecto Express: <pre><code>mkdir myapp &amp;&amp; cd myapp\nnpm init -y\nnpm install express\n</code></pre></li> <li>C\u00f3digo b\u00e1sico (<code>app.js</code>): <pre><code>const express = require('express');\nconst app = express();\n\napp.get('/', (req, res) =&gt; {\n    res.send('\u00a1Hola Mundo!');\n});\n\napp.listen(3000, () =&gt; {\n    console.log('Servidor en http://localhost:3000');\n});\n</code></pre></li> <li>Ejecutar la aplicaci\u00f3n: <pre><code>node app.js\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ABM/#despliegue-clusterizado-con-node-express","title":"\ud83d\udd04 Despliegue Clusterizado con Node Express","text":"<ol> <li>Instalar cl\u00faster: <pre><code>npm install cluster\n</code></pre></li> <li>C\u00f3digo de cl\u00faster (<code>app-cluster.js</code>): <pre><code>const cluster = require('cluster');\nconst os = require('os');\nconst express = require('express');\n\nif (cluster.isMaster) {\n    const numCPUs = os.cpus().length;\n    for (let i = 0; i &lt; numCPUs; i++) {\n        cluster.fork();\n    }\n} else {\n    const app = express();\n    app.get('/', (req, res) =&gt; {\n        res.send(`\u00a1Hola desde el cl\u00faster! PID: ${process.pid}`);\n    });\n\n    app.listen(3000);\n}\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ABM/#netlify-paas","title":"\u2601\ufe0f Netlify (PaaS)","text":""},{"location":"Ud6/Ch6_ABM/#despliegue-en-netlify","title":"\ud83d\udee0\ufe0f Despliegue en Netlify","text":"<ol> <li>Instalar CLI: <pre><code>npm install -g netlify-cli\n</code></pre></li> <li>Iniciar sesi\u00f3n: <pre><code>netlify login\n</code></pre></li> <li>Desplegar proyecto: <pre><code>netlify deploy\n</code></pre></li> <li>Despliegue en producci\u00f3n: <pre><code>netlify deploy --prod\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ACF/","title":"\ud83c\udf10 Servidores de aplicaciones","text":""},{"location":"Ud6/Ch6_ACF/#1-comandos-de-instalacion-y-comprobacion","title":"1. \u2699\ufe0f Comandos de instalaci\u00f3n y comprobaci\u00f3n","text":"Comando Explicaci\u00f3n <code>sudo apt-get install default-jdk</code> \u2615 Instala Java JDK <code>sudo apt-get install default-jre</code> \u2615 Instala Java JRE <code>java --version</code> \ud83d\udd0d Verifica la versi\u00f3n de Java instalada <code>sudo apt-get install -y tomcat10 tomcat10-admin</code> \ud83c\udfd7\ufe0f Instala Tomcat <code>sudo apt-get install maven</code> \u2692\ufe0f Instala Maven <code>mvn --version</code> \ud83d\udd0d Verifica la versi\u00f3n instalada de Maven <code>sudo apt-get install -y ca-certificates curl gnupg</code> \ud83d\udd11 Descarga la clave GPG de NodeSource <code>sudo apt-get install nodejs -y</code> \ud83d\udfe2 Instala Node.js <code>node --version</code> \ud83d\udd0d Verifica la versi\u00f3n instalada de Node.js <code>sudo npm install -g express</code> \ud83d\ude80 Instala Express globalmente <code>sudo npm install -g npm@10.1.0</code> \ud83d\udce6 Actualiza npm <code>sudo npm install -g loadtest</code> \ud83d\udcca Instala Loadtest para pruebas de carga <code>sudo npm install pm2 -g</code> \ud83d\udd04 Instala PM2 para gestionar procesos Node.js <code>sudo npm install netlify-cli -g</code> \u2601\ufe0f Instala Netlify CLI <code>sudo apt-get install python3-pip</code> \ud83d\udc0d Instala pip para Python <code>sudo apt-get install pipenv</code> \ud83d\udce6 Instala pipenv para entornos virtuales <code>pipenv --version</code> \ud83d\udd0d Verifica la versi\u00f3n instalada de pipenv"},{"location":"Ud6/Ch6_ACF/#2-comandos-de-configuracion-y-despliegue-maven","title":"2. \ud83d\ude80 Comandos de configuraci\u00f3n y despliegue Maven","text":"Comando Explicaci\u00f3n <code>mvn tomcat7:deploy</code> \ud83d\ude80 Despliega la aplicaci\u00f3n en Tomcat <code>mvn tomcat7:redeploy</code> \ud83d\udd04 Redespliega la aplicaci\u00f3n en Tomcat <code>mvn tomcat7:undeploy</code> \ud83d\uded1 Retira la aplicaci\u00f3n de Tomcat <code>mvn archetype:generate -DgroupId=IESElCaminas -DartifactId=miapp -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false</code> \ud83c\udfd7\ufe0f Crea una aplicaci\u00f3n Java de prueba desde cero <code>sudo dpkg-reconfigure slapd</code> \u2699\ufe0f Configura el directorio LDAP <p>\ud83d\udccc Ejemplo para activar la interfaz gr\u00e1fica del manager de Tomcat: <pre><code>  &lt;role rolename=\"manager-gui\"/&gt;\n  &lt;role rolename=\"admin-gui\"/&gt;\n  &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre></p>"},{"location":"Ud6/Ch6_ACF/#3-comandos-de-configuracion-y-despliegue-nodejs","title":"3. \ud83d\udfe2 Comandos de configuraci\u00f3n y despliegue Node.js","text":"Comando Explicaci\u00f3n <code>npm init -y</code> \ud83d\udcc2 Inicializa un nuevo proyecto Node.js <code>npm install express</code> \u26a1 Instala Express de manera local <code>node app.js</code> \u25b6\ufe0f Ejecuta el proyecto <code>npm install</code> \ud83d\udce6 Instala las librer\u00edas necesarias <code>npm run start:dev</code> \ud83d\ude80 Inicia la aplicaci\u00f3n en modo desarrollo"},{"location":"Ud6/Ch6_ACF/#4-comandos-de-configuracion-y-despliegue-netlify","title":"4. \u2601\ufe0f Comandos de configuraci\u00f3n y despliegue Netlify","text":"Comando Explicaci\u00f3n <code>netlify login</code> \ud83d\udd11 Inicia sesi\u00f3n en Netlify <code>npm install</code> \ud83d\udce6 Instala las librer\u00edas necesarias <code>npm run start</code> \u25b6\ufe0f Inicia la aplicaci\u00f3n <code>npm run build</code> \ud83c\udfd7\ufe0f Genera un build para producci\u00f3n <code>netlify deploy</code> \ud83d\ude80 Despliega la aplicaci\u00f3n en Netlify"},{"location":"Ud6/Ch6_ACF/#5-comandos-de-configuracion-y-despliegue-flask","title":"5. \ud83d\udc0d Comandos de configuraci\u00f3n y despliegue Flask","text":"Comando Explicaci\u00f3n <code>pipenv shell</code> \ud83d\udcc2 Inicia el entorno virtual <code>pipenv install flask gunicorn</code> \ud83d\udd27 Instala Flask y Gunicorn <code>gunicorn --workers 2 --bind 0.0.0.0:5000 wsgi:app</code> \ud83d\ude80 Comprueba que Gunicorn funciona correctamente"},{"location":"Ud6/Ch6_AEM/","title":"\ud83d\udccb Cheat Sheet: Servidores de Aplicaciones","text":""},{"location":"Ud6/Ch6_AEM/#1-instalacion-de-tomcat","title":"\ud83d\ude80 1. Instalaci\u00f3n de Tomcat","text":""},{"location":"Ud6/Ch6_AEM/#comandos-basicos","title":"Comandos B\u00e1sicos","text":"Acci\u00f3n Comando Descripci\u00f3n Descargar Tomcat <code>wget https://downloads.apache.org/tomcat/...</code> Descarga la \u00faltima versi\u00f3n de Tomcat. Extraer archivo <code>tar -xvzf apache-tomcat-*.tar.gz</code> Extrae el archivo comprimido. Mover carpeta <code>sudo mv apache-tomcat-* /opt/tomcat</code> Mueve Tomcat a la carpeta deseada. Dar permisos de ejecuci\u00f3n <code>chmod +x /opt/tomcat/bin/*.sh</code> Asigna permisos de ejecuci\u00f3n a los scripts. Iniciar Tomcat <code>/opt/tomcat/bin/startup.sh</code> Inicia el servidor Tomcat. Detener Tomcat <code>/opt/tomcat/bin/shutdown.sh</code> Detiene el servidor Tomcat."},{"location":"Ud6/Ch6_AEM/#archivos-de-configuracion","title":"Archivos de Configuraci\u00f3n","text":"<ul> <li><code>conf/server.xml</code>: Configuraci\u00f3n de puertos y servicios.</li> <li><code>conf/tomcat-users.xml</code>: Gesti\u00f3n de usuarios y roles.</li> </ul>"},{"location":"Ud6/Ch6_AEM/#2-despliegue-en-tomcat","title":"\ud83d\udce6 2. Despliegue en Tomcat","text":"Acci\u00f3n Comando/Proceso Descripci\u00f3n Copiar archivo WAR <code>cp app.war /opt/tomcat/webapps/</code> Despliega una aplicaci\u00f3n WAR. Ver logs de Tomcat <code>tail -f /opt/tomcat/logs/catalina.out</code> Muestra los logs en tiempo real. Reiniciar Tomcat <code>/opt/tomcat/bin/shutdown.sh &amp;&amp; /opt/tomcat/bin/startup.sh</code> Reinicia el servidor para aplicar cambios."},{"location":"Ud6/Ch6_AEM/#3-uso-de-maven-con-tomcat","title":"\ud83d\udee0\ufe0f 3. Uso de Maven con Tomcat","text":"Acci\u00f3n Comando Descripci\u00f3n Compilar proyecto <code>mvn clean install</code> Compila el proyecto y genera el archivo WAR. Desplegar con Tomcat Plugin <code>mvn tomcat7:deploy</code> Despliega la aplicaci\u00f3n directamente desde Maven."},{"location":"Ud6/Ch6_AEM/#pomxml-ejemplo-de-configuracion-para-tomcat","title":"<code>pom.xml</code> (Ejemplo de configuraci\u00f3n para Tomcat)","text":"<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n    &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.2&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt;\n        &lt;server&gt;TomcatServer&lt;/server&gt;\n        &lt;path&gt;/miapp&lt;/path&gt;\n    &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>"},{"location":"Ud6/Ch6_AEM/#4-nodejs-y-express","title":"\ud83c\udf10 4. Node.js y Express","text":""},{"location":"Ud6/Ch6_AEM/#comandos-basicos_1","title":"Comandos B\u00e1sicos","text":"Acci\u00f3n Comando Descripci\u00f3n Inicializar proyecto <code>npm init -y</code> Crea un <code>package.json</code> predeterminado. Instalar Express <code>npm install express</code> Instala Express.js. Ejecutar servidor <code>node app.js</code> Inicia la aplicaci\u00f3n Node.js."},{"location":"Ud6/Ch6_AEM/#ejemplo-de-servidor-express","title":"Ejemplo de Servidor Express","text":"<pre><code>const express = require('express');\nconst app = express();\n\napp.get('/', (req, res) =&gt; {\n    res.send('\u00a1Hola Mundo!');\n});\n\napp.listen(3000, () =&gt; {\n    console.log('Servidor escuchando en http://localhost:3000');\n});\n</code></pre>"},{"location":"Ud6/Ch6_AEM/#6-configuracion-de-cluster-pm2","title":"\u26a1 6. Configuraci\u00f3n de Cluster (PM2)","text":""},{"location":"Ud6/Ch6_AEM/#comandos-pm2","title":"Comandos PM2","text":"Acci\u00f3n Comando Descripci\u00f3n Instalar PM2 <code>npm install pm2 -g</code> Instala PM2 globalmente. Iniciar app con PM2 <code>pm2 start app.js</code> Ejecuta la app en modo cl\u00faster. Ver procesos <code>pm2 list</code> Muestra los procesos gestionados por PM2. Detener proceso <code>pm2 stop app</code> Detiene una aplicaci\u00f3n espec\u00edfica. Reiniciar app <code>pm2 restart app</code> Reinicia la aplicaci\u00f3n."},{"location":"Ud6/Ch6_AEM/#7-despliegue-en-netlify","title":"\ud83c\udf0d 7. Despliegue en Netlify","text":""},{"location":"Ud6/Ch6_AEM/#comandos-basicos_2","title":"Comandos B\u00e1sicos","text":"Acci\u00f3n Comando Descripci\u00f3n Instalar Netlify CLI <code>npm install -g netlify-cli</code> Instala la CLI de Netlify. Login en Netlify <code>netlify login</code> Inicia sesi\u00f3n en tu cuenta de Netlify. Desplegar sitio <code>netlify deploy --prod</code> Despliega el sitio en producci\u00f3n. Ver estado del sitio <code>netlify status</code> Muestra el estado actual del despliegue."},{"location":"Ud6/Ch6_AEM/#8-flask-python","title":"\ud83d\udc0d 8. Flask (Python)","text":""},{"location":"Ud6/Ch6_AEM/#comandos-basicos_3","title":"Comandos B\u00e1sicos","text":"Acci\u00f3n Comando Descripci\u00f3n Instalar Flask <code>pip install flask</code> Instala el framework Flask. Ejecutar aplicaci\u00f3n <code>flask run</code> Inicia el servidor Flask. Definir variable de entorno <code>export FLASK_APP=app.py</code> Define el archivo principal de la app."},{"location":"Ud6/Ch6_AEM/#ejemplo-de-app-flask","title":"Ejemplo de App Flask","text":"<pre><code>from flask import Flask\n\napp = Flask(__name__)\n\n@app.route('/')\ndef hello():\n    return \"\u00a1Hola desde Flask!\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n</code></pre>"},{"location":"Ud6/Ch6_AEM/#consejos-finales","title":"\u2705 Consejos Finales","text":"<ul> <li>Revisar Logs siempre que haya errores.</li> <li>Reiniciar Servicios despu\u00e9s de cambios importantes.</li> <li>Documentar cualquier configuraci\u00f3n personalizada.</li> </ul> <p>\u00a1Este Cheat Sheet te ayudar\u00e1 a recordar los comandos m\u00e1s importantes durante tus pr\u00e1cticas! \ud83d\ude80</p>"},{"location":"Ud6/Ch6_ALS/","title":"\ud83c\udf9b\ufe0f Servidores de Aplicaciones","text":""},{"location":"Ud6/Ch6_ALS/#apache-tomcat","title":"\ud83d\udc31 Apache Tomcat","text":""},{"location":"Ud6/Ch6_ALS/#instalacion-en-linux-ubuntudebian","title":"\ud83d\udd27 Instalaci\u00f3n en Linux (Ubuntu/Debian)","text":"<ol> <li>Actualizar repositorios: <pre><code>sudo apt update &amp;&amp; sudo apt upgrade\n</code></pre></li> <li>Instalar Java: <pre><code>sudo apt install default-jdk default-jre\n</code></pre></li> <li>Instalar Tomcat: <pre><code>sudo apt install -y tomcat10 tomcat10-admin\n</code></pre></li> <li>Verificar estado del servicio: <pre><code>systemctl status tomcat10\n</code></pre></li> <li>Iniciar y habilitar el servicio: <pre><code>sudo systemctl start tomcat10\nsudo systemctl enable tomcat10\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ALS/#configuracion-de-usuario-en-tomcat","title":"\ud83d\udee0\ufe0f Configuraci\u00f3n de Usuario en Tomcat","text":"<ol> <li>Editar el archivo <code>tomcat-users.xml</code>: <pre><code>sudo nano /etc/tomcat10/tomcat-users.xml\n</code></pre></li> <li>A\u00f1adir las siguientes l\u00edneas: <pre><code>&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"admin-gui\"/&gt;\n&lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre></li> <li>Reiniciar Tomcat: <pre><code>sudo systemctl restart tomcat10\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ALS/#despliegue-de-aplicaciones-en-tomcat","title":"\ud83d\ude80 Despliegue de Aplicaciones en Tomcat","text":"<ol> <li>Copiar archivos <code>.war</code> en el directorio de despliegue: <pre><code>sudo cp &lt;app&gt;.war /var/lib/tomcat10/webapps/\n</code></pre></li> <li>Verificar despliegue: </li> <li>URL: <code>http://localhost:8080/&lt;app&gt;</code> </li> <li>Reiniciar Tomcat tras cambios: <pre><code>sudo systemctl restart tomcat10\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ALS/#despliegue-en-tomcat-con-maven","title":"\ud83d\udee0\ufe0f Despliegue en Tomcat con Maven","text":"<ol> <li>Instalar Maven: <pre><code>sudo apt install maven\n</code></pre></li> <li>A\u00f1adir el plugin de Tomcat en <code>pom.xml</code>: <pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n    &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.2&lt;/version&gt;\n&lt;/plugin&gt;\n</code></pre></li> <li>Desplegar la aplicaci\u00f3n: <pre><code>mvn tomcat7:deploy\n</code></pre></li> <li>Acceder a la aplicaci\u00f3n: </li> <li>URL: <code>http://localhost:8080/&lt;artifactId&gt;</code> </li> </ol>"},{"location":"Ud6/Ch6_ALS/#nodejs-y-express","title":"\ud83c\udf10 Node.js y Express","text":""},{"location":"Ud6/Ch6_ALS/#despliegue-basico","title":"\ud83d\ude80 Despliegue B\u00e1sico","text":"<ol> <li>Instalar Node.js: <pre><code>sudo apt install nodejs npm\n</code></pre></li> <li>Crear un proyecto Express: <pre><code>mkdir myapp &amp;&amp; cd myapp\nnpm init -y\nnpm install express\n</code></pre></li> <li>C\u00f3digo b\u00e1sico (<code>app.js</code>): <pre><code>const express = require('express');\nconst app = express();\n\napp.get('/', (req, res) =&gt; {\n    res.send('\u00a1Hola Mundo!');\n});\n\napp.listen(3000, () =&gt; {\n    console.log('Servidor en http://localhost:3000');\n});\n</code></pre></li> <li>Ejecutar la aplicaci\u00f3n: <pre><code>node app.js\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ALS/#despliegue-clusterizado-con-node-express","title":"\ud83d\udd04 Despliegue Clusterizado con Node Express","text":"<ol> <li>Instalar cl\u00faster: <pre><code>npm install cluster\n</code></pre></li> <li>C\u00f3digo de cl\u00faster (<code>app-cluster.js</code>): <pre><code>const cluster = require('cluster');\nconst os = require('os');\nconst express = require('express');\n\nif (cluster.isMaster) {\n    const numCPUs = os.cpus().length;\n    for (let i = 0; i &lt; numCPUs; i++) {\n        cluster.fork();\n    }\n} else {\n    const app = express();\n    app.get('/', (req, res) =&gt; {\n        res.send(`\u00a1Hola desde el cl\u00faster! PID: ${process.pid}`);\n    });\n    app.listen(3000);\n}\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ALS/#netlify-paas","title":"\u2601\ufe0f Netlify (PaaS)","text":""},{"location":"Ud6/Ch6_ALS/#despliegue-en-netlify","title":"\ud83d\udee0\ufe0f Despliegue en Netlify","text":"<ol> <li>Instalar CLI: <pre><code>npm install -g netlify-cli\n</code></pre></li> <li>Iniciar sesi\u00f3n: <pre><code>netlify login\n</code></pre></li> <li>Desplegar proyecto: <pre><code>netlify deploy\n</code></pre></li> <li>Despliegue en producci\u00f3n: <pre><code>netlify deploy --prod\n</code></pre></li> </ol>"},{"location":"Ud6/Ch6_ALS/#despliegue-mediante-conexion-con-github","title":"\ud83d\udcc2 Despliegue mediante conexi\u00f3n con GitHub","text":"<ol> <li>Crear repositorio en GitHub y subir el c\u00f3digo: <pre><code>git init\ngit add .\ngit commit -m \"Subiendo el c\u00f3digo...\"\ngit branch -M main\ngit remote add origin https://github.com/username/proyecto.git\ngit push -u origin main\n</code></pre></li> <li>Importar proyecto en Netlify desde GitHub y desplegarlo. </li> </ol> <p>Este cheatsheet proporciona una referencia r\u00e1pida y estructurada para la instalaci\u00f3n, configuraci\u00f3n y despliegue de aplicaciones en Tomcat, Node.js con Express, y Netlify. \ud83d\ude80</p>"},{"location":"Ud6/Ch6_BSO/","title":"T6: Servidores de aplicaciones","text":""},{"location":"Ud6/Ch6_BSO/#apache-tomcat-para-desplegar-aplicaciones-java","title":"Apache Tomcat para desplegar Aplicaciones Java","text":""},{"location":"Ud6/Ch6_BSO/#instalacion-de-tomcat","title":"Instalaci\u00f3n de Tomcat","text":"<p><code>sudo apt-get update &amp;&amp; apt-get upgrade</code>:  Actualizar antes <code>java --version</code>: Comprobar si java est\u00e1 instalado</p> <p>Si no est\u00e1 instalado java, lo instalaremos usando:</p> <pre><code>sudo apt-get install default-jre\nsudo apt-get install default-jre\n</code></pre> <p>Instalar Tomcat</p> <pre><code>sudo apt-get install -y tomcat10 tomcat10-admin #Instalaci\u00f3n de Tomcat\nsudo systemctl status tomcat10 #Comprobamos si est\u00e1 instalado\n</code></pre> <p>Tips para habilitar tomcat o cualquier servicio</p> <pre><code>sudo systemctl start tomcat10 #Iniciamos tomcat\nsudo systemctl enable tomcat10 #Conseguimos que el servicio se inicie\n                               #siempre al encender el PC\n</code></pre> <p>Comprobar acceso a tomcat desde un navegador</p> <p><code>http://IP_SERVIDOR:8080</code>: Acceder desde una navegador</p> <p></p>"},{"location":"Ud6/Ch6_BSO/#configuracion-de-tomcat","title":"Configuraci\u00f3n de Tomcat","text":""},{"location":"Ud6/Ch6_BSO/#gestion-de-usuarios-y-roles","title":"Gesti\u00f3n de Usuarios y roles","text":"<pre><code>sudo nano /etc/tomcat10/tomcat-users.xml #Modificamos este fichero\n</code></pre> <ul> <li>\"Gestor de Aplicaciones Web de Tomcat\" deberemos activar el rol \"manager-gui\".</li> <li>\"Gestor de M\u00e1quina Virtual de Tomcat\" necesitaremos activar el rol \"admin-gui\".</li> </ul> <pre><code>  &lt;!--A\u00f1adimos estas l\u00edneas antes del cierre--&gt;\n  &lt;role rolename=\"manager-gui\"/&gt;\n  &lt;role rolename=\"admin-gui\"/&gt;\n  &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre> <p>Si reiniciamos tomcat con <code>sudo systemctl restart tomcat10</code>, e ingresamos a <code>http://IP_SERVIDOR:8080/manager</code>, podemos acceder al manager, donde nos prodremos logear.</p> <p></p>"},{"location":"Ud6/Ch6_BSO/#despliegue-de-aplicaciones-web-de-tomcat","title":"Despliegue de Aplicaciones Web de Tomcat","text":""},{"location":"Ud6/Ch6_BSO/#mediante-un-archivo-war","title":"Mediante un archivo .war","text":"<ol> <li>Descargamos el archivo .war</li> <li>Dentro del manager, buscamos donde poder seleccionar el archivo y desplegar el .war</li> <li>Acceder a la aplicaci\u00f3n mediante <code>http://IP_SERVIDOR:8080/aplicacion</code></li> </ol>"},{"location":"Ud6/Ch6_BSO/#mediante-maven","title":"Mediante Maven","text":"<ol> <li><code>sudo apt-get install maven</code>: Instalaci\u00f3n de maven</li> <li><code>mvn --v</code>: Comprobar si est\u00e1 correctamente instalada</li> <li>Indicar a Maven el servidor que vamos a desplegar(Tomcat)<ol> <li><code>/etc/tomcat10/tomcat-users.xml</code> <pre><code>&lt;role rolename=\"admin-gui\"/&gt;\n&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"manager-script\"/&gt;\n&lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n&lt;user username=\"despliegues\" password=\"ieselcaminas\" roles=\"manager-script\"/&gt;\n</code></pre></li> <li><code>sudo systemctl restart tomcat10.service</code>: Reiniciar tomcat</li> <li><code>/etc/maven/settings.xml</code> <pre><code>&lt;server&gt;\n    &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n    &lt;username&gt;despliegues&lt;/username&gt;\n    &lt;password&gt;ieselcaminas&lt;/password&gt;\n&lt;/server&gt;\n</code></pre></li> </ol> </li> <li><code>pom.xml</code>: Este archivo est\u00e1 en el proyecto que queremos desplegar     <pre><code>&lt;build&gt;\n    &lt;finalName&gt;roshambo&lt;/finalName&gt; #\n+    &lt;plugins&gt; \n+        &lt;plugin&gt;\n+            &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n+            &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n+            &lt;version&gt;2.2&lt;/version&gt;\n+            &lt;configuration&gt;\n+                &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt; #\n+                &lt;server&gt;DesplieguesTomcat&lt;/server&gt; #\n+                &lt;path&gt;/rps&lt;/path&gt; #\n+            &lt;/configuration&gt;\n+        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre></li> <li><code>mvn tomcat7:deploy</code>: Desplegar proyecto</li> </ol>"},{"location":"Ud6/Ch6_BSO/#nodejs-y-express-para-desplegar-aplicaciones-javascript","title":"Node.js y Express para desplegar aplicaciones JavasCript","text":""},{"location":"Ud6/Ch6_BSO/#instalacion-de-nodejs","title":"Instalaci\u00f3n de Node.js","text":"<pre><code>#A\u00f1adir repositorio de Node en Debian\nsudo apt-get update\nsudo apt-get install -y ca-certificates curl gnupg\nsudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg\n\n#Indicamos que versi\u00f3n de Node instalar\nNODE_MAJOR=20\necho \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" | sudo tee /etc/apt/sour\nces.list.d/nodesource.list\n\n#Instalaci\u00f3n de Node\nsudo apt-get update\nsudo apt-get install nodejs -y\n</code></pre>"},{"location":"Ud6/Ch6_BSO/#instalacion-de-express","title":"Instalaci\u00f3n de Express","text":"<pre><code>sudo npm install -g express #Instalaci\u00f3n de express de manera global\nnode app.js #Ejecutar Aplicaci\u00f3n con Node\n</code></pre>"},{"location":"Ud6/Ch6_BSO/#despliegue-de-un-proyecto-con-express","title":"Despliegue de un proyecto con Express","text":"<ol> <li>Consigues el proyecto que quieres desplegar, ya sea mediante git o uno que ya tengas en tu PC.</li> <li><code>cd proyecto</code>: Entras a la carpeta del proyecto.</li> <li><code>npm install</code>: Instalas las dependencias necesarias.</li> <li><code>package.json</code>: Consultas c\u00f3mo desplegar aplicaci\u00f3n.     <pre><code>\"scripts\": {\n\"start:watch\": \"nodemon ./bin/www --ignore public/\",\n\"start:dev\": \"node ./bin/www\",\n\"debug\": \"node debug ./bin/www\",\n\"start\": \"NODE_ENV=production node ./bin/www\",\n},\n</code></pre></li> <li><code>npm run start</code>: Inicias la aplicaci\u00f3n.</li> <li>Acceder a la ruta que te da, <code>http://IP_PUBLICA:3000</code></li> </ol>"},{"location":"Ud6/Ch6_BSO/#clusterizar-una-aplicacion-mediante-js-con-node-y-express","title":"Clusterizar una aplicaci\u00f3n mediante JS con Node y Express","text":"<pre><code>npm install cluster #Instalamos cluster\n</code></pre> <p>Clusterizamos la aplicaci\u00f3n mediante JS con Node y Express</p> <pre><code>const express = require(\"express\");\nconst port = 3000;\nconst cluster = require(\"cluster\");\nconst totalCPUs = require(\"os\").cpus().length;\n\nif (cluster.isMaster) {\n console.log(`Number of CPUs is ${totalCPUs}`);\n console.log(`Master ${process.pid} is running`);\n\n // Fork workers.\n for (let i = 0; i &lt; totalCPUs; i++) {\n cluster.fork();\n }\n\n cluster.on(\"exit\", (worker, code, signal) =&gt; {\n console.log(`worker ${worker.process.pid} died`);\n console.log(\"Let's fork another worker!\");\n cluster.fork();\n });\n}\n</code></pre>"},{"location":"Ud6/Ch6_BSO/#clusterizar-una-aplicacion-mediante-pm2-sin-modificar-el-programa","title":"Clusterizar una aplicaci\u00f3n mediante PM2 sin modificar el programa","text":"<pre><code>sudo npm install pm2 -g #Instalamos pm2 de forma global\n</code></pre> <p>Ejecutamos el programa sin clusters programados.</p> <pre><code>pm2 start nombre_aplicacion_sin_cluster.js -i 0\n</code></pre> <ul> <li><code>-i</code>: Indicar\u00e1 a PM2 que inicie la aplicaci\u00f3n en cluster_mode.</li> </ul>"},{"location":"Ud6/Ch6_BSO/#desplegar-aplicacion-mediante-netlify","title":"Desplegar aplicaci\u00f3n mediante Netlify","text":"<ol> <li><code>sudo npm install netlify-cli -g</code>: Instalar globalmente Netlify.</li> <li><code>netlify login</code>: Iniciar sesi\u00f3n en Netlify.</li> <li><code>netlify deploy</code>: Desplegamos el proyecto, nos preguntar\u00e1.<ol> <li>ruta: por ejemplo dist o el directorio necesario dependiendo del proyecto.</li> </ol> </li> <li><code>netlify deploy --prod</code>: Desplegar\u00e1 el proyecto en producci\u00f3n.</li> </ol>"},{"location":"Ud6/Ch6_BSO/#desplegar-aplicacion-mediante-python-y-flask","title":"Desplegar aplicaci\u00f3n mediante Python y Flask","text":""},{"location":"Ud6/Ch6_BSO/#instalacion","title":"Instalaci\u00f3n","text":"<pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install python3-pip #Instalamos python y pip(gestor de paquetes)\n\n#Instalamos pipenv para gestionar los entornos virtuales\nsudo apt-get install pipenv\npipenv --version #Versi\u00f3n instalada\n</code></pre>"},{"location":"Ud6/Ch6_BSO/#creacion-y-despligue-de-aplicacion-flask","title":"Creaci\u00f3n y despligue de aplicaci\u00f3n Flask","text":"<ol> <li>Accedemos al proyecto de python</li> <li><code>touch .env</code>: Contendr\u00e1 las variables de entorno necesarias<ol> <li>Editamos el archivo <pre><code>FLASK_APP=wsgi.py\nFLASK_ENV=production\n</code></pre></li> </ol> </li> <li><code>pipenv shell</code>: Iniciamos el entorno virtual para cargar las variables de entorno</li> <li><code>pipenv install flask gunicorn</code>: instalamos dependencias</li> <li><code>touch application.py wsgi.py</code>: Creamos archivos para aplicaci\u00f3n de Flask<ol> <li><code>application.py</code> <pre><code>from flask import Flask\napp=Flask(__name__)\n@app.route('/')\ndef index():\n        '''Index page route'''\n        return '&lt;h1&gt;Aplicacion desplegada&lt;h1&gt;'\n</code></pre></li> <li><code>wsgy.py</code> <pre><code>from application import app\n    if __name__=='__main__':\n    app.run(debug=false)\n</code></pre></li> </ol> </li> <li><code>flask run --host '0.0.0.0'</code>: Ejecutamos la aplicaci\u00f3n<ol> <li><code>http://IP-maq-virtual:5000</code>: Accedemos al servidor</li> </ol> </li> </ol>"},{"location":"Ud6/Ch6_BSO/#desplegar-aplicacion-usando-nginx","title":"Desplegar aplicaci\u00f3n usando NGINX","text":""},{"location":"Ud6/Ch6_BSO/#instalacion-de-nginx","title":"Instalaci\u00f3n de NGINX","text":"<pre><code>sudo apt-get install nginx #Instalar nginx\n</code></pre> <p>Iniciar servicio de nginx</p> <pre><code>sudo systemctl start nginx\nsudo systemctl status nginx\nsudo systemctl enable nginx #Ejecutar siempre al iniciar PC\n</code></pre>"},{"location":"Ud6/Ch6_BSO/#crear-servicio-para-la-aplicacion","title":"Crear servicio para la aplicaci\u00f3n","text":"<p>Crear archivo <code>/etc/systemd/system/flask_app.service</code> para correr Gunicorn</p> <pre><code>[Unit]\nDescription=flask_app.service\nAfter=network.target\n\n[Service]\nUser=admin\nGroup=www-data\nEnvironment=\"PATH=/home/admin/.local/share/virtualenvs/practica_flask-gV07D8Rz/bin:$PATH\"\nWorkingDirectory=/var/www/practica_flask/\nExecStart=/home/admin/.local/share/virtualenvs/practica_flask-gV07D8Rz/bin/gunicorn --workers 2 --bind unix:/var/www/practica_flask/flask_app.sock -m 007 wsgi:app\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p>Iniciar y habilitar servicio</p> <pre><code>systemctl enable flask_app\nsystemctl start flask_app\n</code></pre>"},{"location":"Ud6/Ch6_BSO/#configurar-nginx-para-correr-el-servicio","title":"Configurar Nginx para correr el servicio","text":"<p>Creamos el archivo <code>/etc/nginx/sites-available/practica_flask</code> <pre><code>server {\n    listen 80;\n    server_name practica_flask www.practica_flask; #\n\n    access_log /var/log/nginx/practica_flask.access.log; #\n    error_log /var/log/nginx/practica_flask.error.log;\n\n    location / { \n            include proxy_params;\n            proxy_pass http://unix:/var/www/practica_flask/flask_app.sock; #\n    }\n}\n</code></pre></p> <p>Creamos enlace simb\u00f3lico</p> <p><code>sudo ln -s /etc/nginx/sites-available/practica_flask /etc/nginx/sites-enabled/</code></p> <p>Desplegar aplicaci\u00f3n mediante Nginx</p> <pre><code>sudo nginx -t\nsudo systemctl restart nginx\nsudo systemctl status nginx\n</code></pre>"},{"location":"Ud6/Ch6_DGD/","title":"CHEATSHEET UNIDAD 6 DESPLIEGUE DE APLICACIONES WEB -  DARIUS GABRIEL DOBRE","text":""},{"location":"Ud6/Ch6_DGD/#tomcat","title":"\ud83d\ude40 TOMCAT","text":"<ul> <li>Primero necesitaremos instalar java</li> </ul> <pre><code>sudo apt install default-jdk\nsudo apt install default-jre\n</code></pre> <ul> <li>Instalaci\u00f3n de Tomcat</li> </ul> <pre><code>sudo apt install tomcat10 tomcat10-admin\n</code></pre> <ul> <li>Comprobar acceso al servidor:</li> </ul> <p>Tomcat se ejecuta en el puerto 8080</p> <pre><code>http://IP_SERVIDOR:8080\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#fichero-de-usuarios-tomcat","title":"\ud83d\udccb\ud83d\ude4d FICHERO DE USUARIOS TOMCAT","text":"<p>El fichero para manejar los usuarios se encuentra en: /etc/tomcat10/tomcat-user.xml</p> <p>Se a\u00f1aden usuarios y roles con la siguiente estructura:</p> <pre><code>&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"admin-gui\"/&gt;\n&lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#instalacion-de-maven","title":"\u2b07\ufe0f INSTALACI\u00d3N DE MAVEN","text":"<pre><code>sudo apt install maven\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#anadir-server-a-maven","title":"\ud83d\udcbb A\u00d1ADIR SERVER A MAVEN","text":"<p>Tenemos que a\u00f1adir una configuraci\u00f3n en /etc/maven/settings.xml para indicarle el servidor que queremos desplegar:</p> <pre><code>&lt;server&gt;\n    &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n    &lt;username&gt;despliegues&lt;/username&gt;\n    &lt;password&gt;ieselcaminas&lt;/password&gt;\n&lt;/server&gt;\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#plugins-para-desplegar-en-maven","title":"PLUGINS PARA DESPLEGAR EN MAVEN","text":"<p>En el archivo pom.xml de nuestro proyecto maven a\u00f1adimos los siguientes plugins:</p> <pre><code>&lt;plugins&gt; \n    &lt;plugin&gt;\n    &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n    &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.2&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt; #\n        &lt;server&gt;DesplieguesTomcat&lt;/server&gt; #\n        &lt;path&gt;/rps&lt;/path&gt; #\n    &lt;/configuration&gt;\n    &lt;/plugin&gt;\n&lt;/plugins&gt;\n</code></pre> <p>Para desplegar usamos:</p> <pre><code>mvn tomcat7:deploy\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#archivos-y-carpetas","title":"\ud83d\udcc1\ud83d\udccb ARCHIVOS Y CARPETAS","text":"ARCHIVO / CARPETA Descripci\u00f3n /var/lib/tomcat10/webapps Lugar donde tomcat guarda las aplicaciones que desplegamos webapps/app/WEB-INF/web.xml Contiene elementos de seguridad, e indica donde se encuentra el servlet para mapearlo /etc/maven/settings.xml Esta toda la configuraci\u00f3n de maven, podemos a\u00f1adirle un identificador para el servidor que despleguemos"},{"location":"Ud6/Ch6_DGD/#node","title":"\ud83d\udfe9 NODE","text":""},{"location":"Ud6/Ch6_DGD/#instalacion-de-node","title":"INSTALACI\u00d3N DE NODE","text":"<pre><code>sudo apt-get update\nsudo apt-get install -y ca-certificates curl gnupg\nsudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg\n</code></pre> <pre><code>NODE_MAJOR=20\necho \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" | sudo tee /etc/apt/sour\nces.list.d/nodesource.list\n</code></pre> <p>NODE_MAJOR es la version de node que queremos</p> <pre><code>sudo apt-get update\nsudo apt-get install nodejs -y\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#instalacion-de-express","title":"INSTALACI\u00d3N DE EXPRESS","text":"<p>Pra instalar express de forma global:</p> <pre><code>sudo npm install -g express\n</code></pre> <p>Para ejecutar una aplicacion en node:</p> <pre><code>node app.js\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#clusterizar-una-aplicacion","title":"CLUSTERIZAR UNA APLICACI\u00d3N","text":"<p>Para clusterizar una aplicacion podemos hacerlo de varias formas:</p> <ul> <li>Con js:</li> </ul> <pre><code>npm install cluster\n</code></pre> <pre><code>const cluster = require(\"cluster\");\nconst totalCPUs = require(\"os\").cpus().length;\n\nif (cluster.isMaster) {\n console.log(`Number of CPUs is ${totalCPUs}`);\n console.log(`Master ${process.pid} is running`);\n\n // Fork workers.\n for (let i = 0; i &lt; totalCPUs; i++) {\n cluster.fork();\n }\n\n cluster.on(\"exit\", (worker, code, signal) =&gt; {\n console.log(`worker ${worker.process.pid} died`);\n console.log(\"Let's fork another worker!\");\n cluster.fork();\n });\n</code></pre> <ul> <li>Con PM2:</li> </ul> <p>Instalamos pm2:</p> <pre><code>sudo npm install pm2 -g\n</code></pre> <p>Ejecutamos app con pm2:</p> <pre><code>pm2 start nombre_aplicacion_sin_cluster.js -i 0\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#netlify","title":"\u2601 NETLIFY","text":"<p>Para desplegar una aplicaci\u00f3n en netlify:</p> <ul> <li>Instalamos el cli:</li> </ul> <pre><code>sudo npm install netlify-cli -g\n</code></pre> <ul> <li>Hacemos Login</li> </ul> <pre><code>netlify login\n</code></pre> <ul> <li>Deploy:</li> </ul> <pre><code>netlify deploy\n</code></pre> <ul> <li>Deploy a producci\u00f3n:</li> </ul> <pre><code>netlify deploy --prod\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#python-con-flask","title":"\ud83d\udc0d PYTHON CON FLASK","text":"<p>Instalamos python:</p> <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install python3-pip\n</code></pre> <p>Pipenv para gestionar entornos virtuales <pre><code>sudo apt-get install pipenv\n</code></pre></p> <p>Creamos .env</p> <pre><code>FLASK_APP=wsgi.py\nFLASK_ENV=production\n</code></pre>"},{"location":"Ud6/Ch6_DGD/#iniciar-entorno-virtual","title":"\ud83d\udda5\ufe0f Iniciar entorno virtual","text":"<pre><code>pienv shell\n</code></pre> <p>Instalacion flask y gunicorn</p> <pre><code>pipenv install flask gunicorn\n</code></pre> <p>Servidor web integrado de flask:</p> <pre><code>flask run --host '0.0.0.0' \n</code></pre>"},{"location":"Ud6/Ch6_DGD/#servir-app-con-nginx","title":"\ud83d\ude80 SERVIR APP CON NGINX","text":""},{"location":"Ud6/Ch6_DGD/#crear-servicio-en-systemd","title":"\ud83c\udf73 CREAR SERVICIO EN SYSTEMD","text":"<p>Creamos un servicio en /etc/systemd/system/flask_app.service</p> <pre><code>[Unit]\nDescription=flask_app.service\nAfter=network.target\n\n[Service]\nUser=admin\nGroup=www-data\nEnvironment=\"PATH=/home/admin/.local/share/virtualenvs/practica_flask-gV07D8Rz/bin:$PATH\"\nWorkingDirectory=/var/www/practica_flask/\nExecStart=/home/admin/.local/share/virtualenvs/practica_flask-gV07D8Rz/bin/gunicorn --workers 2 --bind unix:/var/www/practica_flask/flask_app.sock -m 007 wsgi:app\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p>Habilitamos e iniciamos servicio:</p> <pre><code>systemctl enable flask_app\nsystemctl start flask_app\n</code></pre> <p>Configurar Nginx:</p> <pre><code>server {\n    listen 80;\n    server_name practica_flask www.practica_flask;\n\n    access_log /var/log/nginx/practica_flask.access.log;\n    error_log /var/log/nginx/practica_flask.error.log;\n\n    location / { \n            include proxy_params;\n            proxy_pass http://unix:/var/www/practica_flask/flask_app.sock;\n    }\n}\n</code></pre>"},{"location":"Ud6/Ch6_DMP/","title":"\ud83d\udcdd UD5 - Despliegue de aplicaciones web - Cheatsheet","text":"<p>David Maratrat Pons</p>"},{"location":"Ud6/Ch6_DMP/#tomcat","title":"\ud83d\udc31 Tomcat","text":"Comando Descripci\u00f3n <code>sudo apt install default-jdk default-jre</code> <code>Instalamos el jdk y el jre de java</code> <code>sudo apt install tomcat10 tomcat10-admin</code> <code>Instalamos tomcat</code> <code>http://IPSERVER:8080</code> <code>Accedemos al servidor por la web</code>"},{"location":"Ud6/Ch6_DMP/#configuracion-de-usuarios","title":"\ud83d\ude4d Configuraci\u00f3n de usuarios","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo nano /etc/tomcat10/tomcat-user.xml</code> <code>Modifica los usuarios en este archivo</code>"},{"location":"Ud6/Ch6_DMP/#tomcat-userxml","title":"\ud83d\udcc4 tomcat-user.xml:","text":"<pre><code>&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"admin-gui\"/&gt;\n&lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre>"},{"location":"Ud6/Ch6_DMP/#maven","title":"\ud83d\udc31 Maven","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo apt install maven</code> <code>Instala maven</code> <code>sudo nano /etc/maven/settings.xml</code> <code>Modifica la configuraci\u00f3n de maven</code> <code>sudo nano /etc/maven/pom.xml</code> <code>Modifica los plugins de maven</code> <code>mvn tomcat7:deploy</code> <code>Despliega la aplicaci\u00f3n de maven</code>"},{"location":"Ud6/Ch6_DMP/#settingsxml","title":"\ud83d\udcc4 settings.xml:","text":"<p>A\u00f1ade un servidor: <pre><code>&lt;server&gt;\n    &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n    &lt;username&gt;despliegues&lt;/username&gt;\n    &lt;password&gt;ieselcaminas&lt;/password&gt;\n&lt;/server&gt;\n</code></pre></p>"},{"location":"Ud6/Ch6_DMP/#pomxml","title":"\ud83d\udcc4 pom.xml:","text":"<p>Plugins para maven: <pre><code>&lt;plugins&gt; \n    &lt;plugin&gt;\n    &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n    &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.2&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt; #\n        &lt;server&gt;DesplieguesTomcat&lt;/server&gt; #\n        &lt;path&gt;/rps&lt;/path&gt; #\n    &lt;/configuration&gt;\n    &lt;/plugin&gt;\n&lt;/plugins&gt;\n</code></pre></p>"},{"location":"Ud6/Ch6_DMP/#nodejs","title":"\u2b22 Node.js","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo apt-get install -y ca-certificates curl gnupg</code> <code>Instala las herramientas necesarias para instalar Node.js</code> <code>sudo mkdir -p /etc/apt/keyrings</code> <code>Crea la carpeta de keyrings</code> <code>curl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key  \\|  sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg</code> <code>Obtiene la clave de Node.js</code> <code>NODE_MAJOR=20 echo \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" \\| sudo tee /etc/apt/sources.list.d/nodesource.list</code> <code>Escoge la versi\u00f3n de Node.js a instalar</code> <code>sudo apt-get install nodejs -y</code> <code>Instala Node.js</code>"},{"location":"Ud6/Ch6_DMP/#express","title":"\ud83d\ude80 Express","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo npm install -g express</code> <code>Instala express de forma global con node</code> <code>npm app.js</code> <code>Ejecuta una aplicaci\u00f3n</code>"},{"location":"Ud6/Ch6_DMP/#clusterizacion","title":"\ud83d\udda5\ufe0f\ud83d\udda5\ufe0f\ud83d\udda5\ufe0f Clusterizaci\u00f3n","text":""},{"location":"Ud6/Ch6_DMP/#1-forma-1","title":"1\ufe0f\u20e3 Forma 1","text":"Configuraci\u00f3n Explicaci\u00f3n <code>npm install cluster</code> <code>Instala cluster en el directorio de la aplicaci\u00f3n</code> <pre><code>const cluster = require(\"cluster\");\nconst totalCPUs = require(\"os\").cpus().length;\n\nif (cluster.isMaster) {\n console.log(`Number of CPUs is ${totalCPUs}`);\n console.log(`Master ${process.pid} is running`);\n\n // Fork workers.\n for (let i = 0; i &lt; totalCPUs; i++) {\n cluster.fork();\n }\n\n cluster.on(\"exit\", (worker, code, signal) =&gt; {\n console.log(`worker ${worker.process.pid} died`); \n console.log(\"Let's fork another worker!\");\n cluster.fork();\n });\n</code></pre>"},{"location":"Ud6/Ch6_DMP/#2-forma-2","title":"2\ufe0f\u20e3 Forma 2","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo npm install -g pm2</code> <code>Instala pm2 de forma global con node</code> <code>pm2 start app.js -i 0</code> <code>Ejecutamos una app con pm2</code>"},{"location":"Ud6/Ch6_DMP/#netlify","title":"\ud83c\udf0d NETLIFY","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo npm install -g netlify-cli</code> <code>Instala el cli de netlify de manera global</code> <code>netlify login</code> <code>Iniciamos sesi\u00f3n en netlify</code> <code>netlify deploy</code> <code>Despliega la aplicaci\u00f3n en netlify</code> <code>netlify deploy --prod</code> <code>Despliega la aplicaci\u00f3n en netlify en modo producci\u00f3n</code>"},{"location":"Ud6/Ch6_DMP/#python-flask-nginx","title":"\ud83d\udc09 Python &amp; Flask &amp; Nginx","text":"Configuraci\u00f3n Explicaci\u00f3n <code>sudo apt-get install python3-pip</code> <code>Instala python</code> <code>sudo apt-get install pipenv</code> <code>Instala pipenv para manejar entornos virtuales</code> <code>sudo apt-get install python3-pip</code> <code>Instala el cli de netlify de manera global</code> <code>pipenv shell</code> <code>Inicia el entorno virtual</code> <code>pipenv install flask gunicorn</code> <code>Instala flask y gunicorn</code> <code>flask run --host '0.0.0.0'</code> <code>Inicia el servidor web de flask</code> <code>systemctl enable flask_app</code> <code>Habilitamos el servicio de la aplicaci\u00f3n</code> <code>systemctl start flask_app</code> <code>Iniciamos el servicio de la aplicaci\u00f3n</code>"},{"location":"Ud6/Ch6_DMP/#env","title":".env","text":"<pre><code>FLASK_APP=wsgi.py\nFLASK_ENV=production\n</code></pre>"},{"location":"Ud6/Ch6_DMP/#flask_appservice","title":"flask_app.service","text":"<p>Creamos el servicio para la aplicaci\u00f3n <pre><code>[Unit]\nDescription=flask_app.service\nAfter=network.target\n\n[Service]\nUser=admin\nGroup=www-data\nEnvironment=\"PATH=/home/admin/.local/share/virtualenvs/practica_flask-gV07D8Rz/bin:$PATH\"\nWorkingDirectory=/var/www/practica_flask/\nExecStart=/home/admin/.local/share/virtualenvs/practica_flask-gV07D8Rz/bin/gunicorn --workers 2 --bind unix:/var/www/practica_flask/flask_app.sock -m 007 wsgi:app\n\n[Install]\nWantedBy=multi-user.target\n</code></pre></p>"},{"location":"Ud6/Ch6_DMP/#practica_flask","title":"practica_flask","text":"<p>Modificamos el fichero de configuraci\u00f3n de nginx para la aplicaci\u00f3n <pre><code>server {\n    listen 80;\n    server_name practica_flask www.practica_flask;\n\n    access_log /var/log/nginx/practica_flask.access.log;\n    error_log /var/log/nginx/practica_flask.error.log;\n\n    location / { \n            include proxy_params;\n            proxy_pass http://unix:/var/www/practica_flask/flask_app.sock;\n    }\n}\n</code></pre></p>"},{"location":"Ud6/Ch6_EGM/","title":"\ud83d\udcc4 Cheatsheet UD6 - Servidores de aplicaciones","text":""},{"location":"Ud6/Ch6_EGM/#servidor-tomcat","title":"\ud83d\ude80 Servidor TOMCAT","text":""},{"location":"Ud6/Ch6_EGM/#instalacion-de-tomcat","title":"\ud83d\udee0 Instalaci\u00f3n de Tomcat","text":"<p>\ud83d\udd27 Instalar y configurar Tomcat <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade # Actualiza los paquetes del sistema.\nsudo apt-get install default-jdk # Instala Java Development Kit (JDK).\nsudo apt-get install default-jre # Instala Java Runtime Environment (JRE).\nsudo apt-get install -y tomcat10 tomcat10-admin # Instala Tomcat 10 y su m\u00f3dulo de administraci\u00f3n.\nsudo systemctl restart tomcat10 # Reinicia el servicio de Tomcat tras la instalaci\u00f3n.\nsystemctl status tomcat10 # Verifica que el servicio de Tomcat est\u00e1 activo.\n</code></pre></p>"},{"location":"Ud6/Ch6_EGM/#creacion-de-usuarios-en-tomcat","title":"\ud83d\udd11 Creaci\u00f3n de Usuarios en Tomcat","text":"<p>\ud83d\udccc Modificar el archivo de configuraci\u00f3n: <pre><code>sudo nano /etc/tomcat10/tomcat-users.xml\n</code></pre></p> <p>\ud83d\udcc4 Ejemplo de configuraci\u00f3n: <pre><code>&lt;tomcat-users&gt;\n    &lt;role rolename=\"manager-gui\"/&gt;\n    &lt;role rolename=\"manager-script\"/&gt;\n    &lt;role rolename=\"manager-status\"/&gt;\n    &lt;role rolename=\"admin-gui\"/&gt;\n    &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"manager-gui,manager-script,manager-status,admin-gui\"/&gt;\n&lt;/tomcat-users&gt;\n</code></pre> \u2705 Acceder a Tomcat Manager desde: \ud83d\udd17 <code>http://IP_SERVIDOR:8080/manager</code></p>"},{"location":"Ud6/Ch6_EGM/#despliegue-de-aplicaciones-java-en-tomcat","title":"\ud83d\udce6 Despliegue de Aplicaciones Java en Tomcat","text":""},{"location":"Ud6/Ch6_EGM/#preparacion-del-entorno","title":"\ud83c\udfd7 Preparaci\u00f3n del entorno","text":"<p>\ud83d\udd27 Configuraci\u00f3n inicial <pre><code>sudo passwd tomcat # Asigna una contrase\u00f1a al usuario tomcat.\nsu tomcat # Inicia sesi\u00f3n como usuario tomcat para trabajar con sus archivos.\nmkdir -p /var/lib/tomcat10/webapps/prueba/WEB-INF/classes # Crea la estructura de directorios para la aplicaci\u00f3n nueva.\n</code></pre></p>"},{"location":"Ud6/Ch6_EGM/#ejemplo-de-servlet-hola1java","title":"\u270d Ejemplo de Servlet - hola1.java","text":"<pre><code>import jakarta.servlet.*;\nimport jakarta.servlet.http.*;\nimport java.io.*;\npublic class hola1 extends HttpServlet {\n    public void init(ServletConfig conf) throws ServletException {\n        super.init(conf);\n    }\n\n    public void service(HttpServletRequest req, HttpServletResponse res)\n        throws ServletException, IOException {\n        res.setContentType(\"text/html\");\n        PrintWriter out = res.getWriter();\n        out.println(\"&lt;html&gt;\");\n        out.println(\"&lt;body&gt;\");\n        out.println(\"&lt;h1&gt;servlet hola 1&lt;/h1&gt;\");\n        out.println(\"&lt;/body&gt;\");\n        out.println(\"&lt;/html&gt;\");\n    }\n}\n</code></pre> <p>\ud83d\udd27 Compilar el servlet: <pre><code>javac -classpath /usr/share/tomcat10/lib/servlet-api.jar hola1.java # Compila el servlet.\n    \u26a0\ufe0f Si hay errores, revisa la versi\u00f3n de Java y actualiza javax a jakarta en Java 11+.\n</code></pre></p> <p>\ud83d\udd27 Mover el archivo compilado: <pre><code>mv hola1.class ./WEB-INF/classes # Mueve el archivo compilado a la carpeta correspondiente.\n</code></pre></p>"},{"location":"Ud6/Ch6_EGM/#configuracion-del-servlet-en-webxml","title":"\u2699 Configuraci\u00f3n del servlet en web.xml","text":"<p>\ud83d\udcc4 Archivo: WEB-INF/web.xml</p> <p><pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;!DOCTYPE web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\" \"http://java.sun.com/dtd/web-app_2_3.dtd\"&gt;\n&lt;web-app&gt;\n    &lt;display-name&gt;Ejemplos tutorial&lt;/display-name&gt;\n    &lt;description&gt;Servlets de ejemplos del tutorial de Servlets y JDBC.&lt;/description&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;hola1&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/hola1&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre> \ud83c\udfaf Acceso al servlet desde el navegador: \ud83d\udd17 <code>http://IP_SERVIDOR:8080/prueba/hola1</code></p>"},{"location":"Ud6/Ch6_EGM/#creacion-de-pagina-html-de-prueba","title":"\ud83c\udf10 Creaci\u00f3n de P\u00e1gina HTML de Prueba","text":"<p>\ud83d\udcc4 Archivo: prueba/index.html</p> <pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Actividad de prueba con Tomcat&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body bgcolor=white&gt;\n        &lt;div style=\"width:100% text-align:center\"&gt;\n            &lt;img width=\"200\" src=\"tomcat.gif\"&gt;\n            &lt;br&gt;\n            &lt;h1&gt;Actividad con Tomcat&lt;/h1&gt;\n            &lt;p&gt;Despliegue de aplicaciones web&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div style=\"background:#ffc; margin-top:30px; padding:30px; text-align:center\"&gt;\n            Ir a &lt;a href=\"hola1.jsp\"&gt;JSP page&lt;/a&gt;\n            &lt;br&gt;\n            Ir al &lt;a href=\"hola1\"&gt;servlet&lt;/a&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#pagina-jsp-de-ejemplo","title":"\ud83d\udda5 P\u00e1gina JSP de Ejemplo","text":"<p>\ud83d\udcc4 Archivo: prueba/hola1.jsp</p> <pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Ejemplo p\u00e1gina JSP&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body bgcolor=white&gt;\n        &lt;div style=\"width:100%; text-align:center\"&gt;\n            &lt;img width=\"150\" src=\"tomcat.gif\"&gt;\n            &lt;br&gt;\n            &lt;h1&gt;Ejemplo JSP hola1&lt;/h1&gt;\n            &lt;br&gt;\n            &lt;%= new String(\"Hola 1\") %&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\ud83d\udccc Ahora puedes desplegar y probar tu aplicaci\u00f3n en Tomcat \ud83c\udfaf</p>"},{"location":"Ud6/Ch6_EGM/#despliegue-de-aplicaciones-con-maven","title":"\u26a1 Despliegue de Aplicaciones con Maven","text":""},{"location":"Ud6/Ch6_EGM/#instalacion-de-maven","title":"\ud83d\udd27 Instalaci\u00f3n de Maven","text":"<pre><code>sudo apt-get install maven # Instalar Apache Maven en el sistema.\nmvn --version # Verificar la versi\u00f3n instalada de Maven.\nsudo systemctl restart tomcat10.service # Reiniciar Tomcat tras cambiar las configuraciones.\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#configuracion-de-maven-para-despliegue-en-tomcat","title":"\ud83d\udd11 Configuraci\u00f3n de Maven para despliegue en Tomcat","text":""},{"location":"Ud6/Ch6_EGM/#editar-etcmavensettingsxml","title":"\ud83d\udcc4 Editar <code>/etc/maven/settings.xml</code>","text":"<pre><code>&lt;server&gt;\n  &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n  &lt;username&gt;despliegues&lt;/username&gt;\n  &lt;password&gt;ieselcaminas&lt;/password&gt;\n&lt;/server&gt;\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#agregar-usuario-en-tomcat-usersxml","title":"\ud83d\udcc4 Agregar usuario en <code>tomcat-users.xml</code>","text":"<pre><code>&lt;tomcat-users&gt;\n    &lt;role rolename=\"manager-script\"/&gt;\n    &lt;user username=\"despliegues\" password=\"ieselcaminas\" roles=\"manager-script\"/&gt;\n&lt;/tomcat-users&gt;\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#despliegue-con-maven-desde-cero","title":"\ud83d\ude80 Despliegue con Maven desde cero","text":""},{"location":"Ud6/Ch6_EGM/#1-crear-una-nueva-aplicacion-maven","title":"\ud83d\udccc 1. Crear una nueva aplicaci\u00f3n Maven","text":"<pre><code>mvn archetype:generate -DgroupId=IESElCaminas -DartifactId=miapp -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false # Generar una aplicaci\u00f3n web Maven.\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#2-configurar-pomxml-para-tomcat","title":"\ud83d\udccc 2. Configurar <code>pom.xml</code> para Tomcat","text":"<pre><code>&lt;build&gt;\n  &lt;finalName&gt;miapp&lt;/finalName&gt;\n  &lt;plugins&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n      &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n      &lt;version&gt;3.4.0&lt;/version&gt;\n    &lt;/plugin&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n      &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n      &lt;version&gt;2.2&lt;/version&gt;\n      &lt;configuration&gt;\n        &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt;\n        &lt;server&gt;DesplieguesTomcat&lt;/server&gt;\n        &lt;path&gt;/miapp&lt;/path&gt;\n      &lt;/configuration&gt;\n    &lt;/plugin&gt;\n  &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#3-comandos-para-gestionar-el-despliegue","title":"\ud83d\udccc 3. Comandos para gestionar el despliegue","text":"<pre><code>mvn package # Empaquetar la aplicaci\u00f3n en un archivo WAR.\nmvn tomcat7:deploy # Desplegar la aplicaci\u00f3n en Tomcat.\nmvn tomcat7:redeploy # Volver a desplegar la aplicaci\u00f3n tras cambios.\nmvn tomcat7:undeploy # Eliminar la aplicaci\u00f3n del servidor.\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#despliegue-de-un-proyecto-existente","title":"\ud83d\udd04 Despliegue de un Proyecto Existente","text":""},{"location":"Ud6/Ch6_EGM/#1-clonar-el-proyecto-desde-github","title":"\ud83d\udccc 1. Clonar el Proyecto desde GitHub","text":"<pre><code>git clone https://github.com/cameronmcnz/rock-paper-scissors.git # Clonar el repositorio desde GitHub.\ncd rock-paper-scissors # Moverse al directorio del proyecto.\ngit checkout patch-1 # Cambiar a la rama espec\u00edfica.\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#2-modificar-pomxml","title":"\ud83d\udccc 2. Modificar <code>pom.xml</code>","text":"<p>Agregar lo siguiente dentro del bloque <code>&lt;plugins&gt;</code>:</p> <pre><code>&lt;plugin&gt;\n  &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n  &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n  &lt;version&gt;2.2&lt;/version&gt;\n  &lt;configuration&gt;\n    &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt;\n    &lt;server&gt;DesplieguesTomcat&lt;/server&gt;\n    &lt;path&gt;/rps&lt;/path&gt;\n  &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre> <p>\ud83c\udfaf Ahora puedes desplegar y administrar aplicaciones Java en Tomcat usando Maven de manera eficiente.</p>"},{"location":"Ud6/Ch6_EGM/#servidor-node-express","title":"\ud83d\ude80 Servidor Node EXPRESS","text":""},{"location":"Ud6/Ch6_EGM/#instalacion-de-paquetes","title":"\ud83d\udee0 Instalaci\u00f3n de paquetes","text":""},{"location":"Ud6/Ch6_EGM/#1-instalar-nodejs","title":"\ud83d\udccc 1. Instalar Node.js","text":"<pre><code>sudo apt-get install -y ca-certificates curl gnupg # Instala dependencias necesarias.\nsudo mkdir -p /etc/apt/keyrings # Crea el directorio para las claves GPG.\ncurl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg # Importa la clave GPG de NodeSource.\nNODE_MAJOR=20 # Define la versi\u00f3n de Node.js.\necho \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" | sudo tee /etc/apt/sources.list.d/nodesource.list # Agrega el repositorio de Node.js.\nsudo apt-get update # Actualiza la lista de paquetes.\nsudo apt-get install -y nodejs npm # Instala Node.js y npm.\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#2-instalar-expressjs","title":"\ud83d\udccc 2. Instalar Express.js","text":"<pre><code>sudo npm install -g express # Instala Express.js de forma global.\nsudo npm install -g npm@latest # Actualiza npm a la \u00faltima versi\u00f3n.\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#ejecucion-de-un-proyecto-nodejs-con-express","title":"\ud83d\ude80 Ejecuci\u00f3n de un Proyecto Node.js con Express","text":"<pre><code>npm init -y # Inicializa un proyecto Node.js.\nnpm install express # Instala Express.js en el proyecto.\nnode app.js # Inicia el servidor en el puerto por defecto (3000).\n</code></pre> <p>\ud83c\udf10 Accede en el navegador:</p> <p>\ud83d\udd17 <code>http://IP_PUBLICA:3000</code></p>"},{"location":"Ud6/Ch6_EGM/#ejecucion-de-un-proyecto-nodejs-con-pm2","title":"\u26a1 Ejecuci\u00f3n de un Proyecto Node.js con PM2","text":"<pre><code>sudo npm install pm2 -g # Instala PM2 globalmente.\npm2 start app.js -i 0 # Inicia la aplicaci\u00f3n en modo cl\u00faster con PM2.\npm2 stop app.js # Detiene la aplicaci\u00f3n.\npm2 ls # Lista las aplicaciones en ejecuci\u00f3n.\npm2 logs # Muestra los logs en tiempo real.\npm2 monit # Muestra m\u00e9tricas de rendimiento.\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#configuracion-con-ecosystemconfigjs","title":"\ud83d\udcc4 Configuraci\u00f3n con ecosystem.config.js","text":""},{"location":"Ud6/Ch6_EGM/#1-generar-y-modificar-el-archivo","title":"\ud83d\udccc 1. Generar y Modificar el Archivo","text":"<pre><code>pm2 init simple # Crea un archivo ecosystem.config.js.\n</code></pre> <p>\ud83d\udcc4 Modifica <code>ecosystem.config.js</code> </p> <pre><code>module.exports = {\n  apps: [\n    {\n      name: \"app\",\n      script: \"app.js\",\n      instances: 0,  // Usar\u00e1 todas las CPU disponibles\n      exec_mode: \"cluster\",\n    },\n  ],\n};\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#2-ejecutar-con-pm2-y-ecosystem","title":"\ud83d\udccc 2. Ejecutar con PM2 y Ecosystem","text":"<pre><code>pm2 start ecosystem.config.js # Inicia la aplicaci\u00f3n con configuraci\u00f3n PM2.\npm2 restart ecosystem.config.js # Reinicia la aplicaci\u00f3n.\npm2 reload ecosystem.config.js # Recarga sin tiempo de inactividad.\npm2 stop ecosystem.config.js # Detiene la aplicaci\u00f3n.\npm2 delete ecosystem.config.js # Elimina la aplicaci\u00f3n.\n</code></pre> <p>\ud83c\udfaf Ahora puedes desplegar y administrar aplicaciones Node.js con Express de manera eficiente.</p>"},{"location":"Ud6/Ch6_EGM/#despliegue-en-netlify","title":"\ud83d\ude80 Despliegue en Netlify","text":""},{"location":"Ud6/Ch6_EGM/#instalacion-y-autenticacion","title":"\ud83d\udee0 Instalaci\u00f3n y Autenticaci\u00f3n","text":"<p>Reg\u00edstrate en Netlify y luego instala la CLI globalmente:</p> <pre><code>sudo npm install -g netlify-cli\nnetlify login\n</code></pre>"},{"location":"Ud6/Ch6_EGM/#despliegue-manual","title":"\ud83d\ude80 Despliegue Manual","text":"<p><pre><code>netlify deploy --prod\n</code></pre> \ud83d\udd17 Tu aplicaci\u00f3n estar\u00e1 disponible en <code>https://APP.netlify.app</code></p>"},{"location":"Ud6/Ch6_EGM/#despliegue-automatico-desde-github","title":"\ud83d\udd17 Despliegue Autom\u00e1tico desde GitHub","text":"<ol> <li>Crear y subir un repositorio:    <pre><code>git init\ngit add .\ngit commit -m \"Subiendo el c\u00f3digo...\"\ngit branch -M main\ngit remote add origin https://github.com/username/repo.git\ngit push -u origin main\n</code></pre></li> <li>Importar desde Netlify:</li> <li>Accede a Netlify</li> <li>Selecciona \"New Site from Git\"</li> <li>Con\u00e9ctalo con tu cuenta de GitHub</li> <li>Selecciona el repositorio y rama (<code>main</code>)</li> <li>Configura el comando de build y carpeta de publicaci\u00f3n</li> <li>Pulsa \"Deploy Site\"</li> </ol> <p>\ud83d\udccc Cada <code>git push</code> en <code>main</code> generar\u00e1 un nuevo despliegue autom\u00e1ticamente. \ud83c\udf89</p>"},{"location":"Ud6/Ch6_EGM/#despliegue-de-aplicaciones-angular","title":"\u26a1 Despliegue de Aplicaciones Angular","text":"<p><pre><code>sudo npm install -g @angular/cli\nng serve -o --host=IPPRIVADA\n</code></pre> \ud83d\udd17 Accede en <code>http://IPPUBLICA:4200</code></p>"},{"location":"Ud6/Ch6_MCG/","title":"unidad 6 - servidores de aplicaci\u00f3n","text":""},{"location":"Ud6/Ch6_MCG/#tomcat","title":"Tomcat","text":""},{"location":"Ud6/Ch6_MCG/#actualizar-el-sistema","title":"Actualizar el sistema","text":"<pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\n</code></pre> <p>Instalar Java</p> <pre><code>sudo apt-get install default-jdk\nsudo apt-get install default-jre\n</code></pre> <p>Instalar Tomcat 10 y Maven <pre><code>sudo apt-get install -y tomcat10 tomcat10-admin\nsudo apt-get install maven\n</code></pre> Configuraci\u00f3n en tomcat-users.xml (para acceso administrativo)</p> <pre><code>&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"admin-gui\"/&gt;\n&lt;user username=\"admin\" password=\"s3cret\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre> <p>Crear un proyecto web con Maven</p> <pre><code>mvn archetype:generate -DgroupId=$nombre -DartifactId=$nombreProyecto -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false\n</code></pre> <p>Comandos para desplegar, redeplegar y desinstalar en Tomcat</p> <pre><code>mvn tomcat7:deploy\nmvn tomcat7:redeploy\nmvn tomcat7:undeploy\n</code></pre>"},{"location":"Ud6/Ch6_MCG/#nodejs","title":"Node.js","text":"<p>Actualizar el sistema <pre><code>sudo apt-get update\n</code></pre> Instalar dependencias necesarias <pre><code>sudo apt-get install -y ca-certificates curl gnupg\nsudo mkdir -p /etc/apt/keyrings\n</code></pre> Agregar el repositorio de Node.js <pre><code>curl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg\nNODE_MAJOR=20\necho \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" | sudo tee /etc/apt/sources.list.d/nodesource.list\n</code></pre></p> <p>Instalar Node.js</p> <pre><code>sudo apt-get update\nsudo apt-get install nodejs -y\n</code></pre> <p>Instalar Express.js</p> <p><pre><code>sudo npm install -g express\n</code></pre> Crear un proyecto Node.js e instalar dependencias</p> <pre><code>npm init -y\nnpm install express\nnpm run start:dev\n</code></pre> <p>Instalar Netlify CLI y realizar despliegue</p> <pre><code>sudo npm install netlify-cli -g\nnetlify login\nnetlify deploy\n</code></pre>"},{"location":"Ud6/Ch6_MCG/#flask","title":"Flask","text":"<p>Instalar PIP y Pipenv</p> <pre><code>sudo apt-get install python3-pip\nsudo apt-get install pipenv\n</code></pre> <p>Instalar Flask y Gunicorn</p> <pre><code>pipenv install flask gunicorn\n</code></pre> <p>Iniciar la aplicaci\u00f3n Flask</p> <pre><code>systemctl start flask_app\n</code></pre>"},{"location":"Ud6/Ch6_MIP/","title":"CH5 - MIP","text":""},{"location":"Ud6/Ch6_MIP/#servidores-de-aplicaciones-y-despliegue-de-aplicaciones-web","title":"\ud83d\udccc Servidores de Aplicaciones y Despliegue de Aplicaciones Web","text":""},{"location":"Ud6/Ch6_MIP/#servidores-de-aplicaciones","title":"\ud83d\udd39 Servidores de Aplicaciones","text":"<p>Los servidores de aplicaciones son plataformas que ejecutan aplicaciones web y gestionan la l\u00f3gica de negocio. Funcionan como intermediarios entre el servidor web y la base de datos, facilitando procesos como la autenticaci\u00f3n, seguridad, manejo de sesiones y conexiones.</p>"},{"location":"Ud6/Ch6_MIP/#funciones-principales","title":"Funciones principales:","text":"<ul> <li>\u2705 Procesar solicitudes din\u00e1micas.</li> <li>\u2705 Manejar transacciones y comunicaci\u00f3n entre servicios.</li> <li>\u2705 Mejorar la escalabilidad y seguridad de las aplicaciones.</li> </ul>"},{"location":"Ud6/Ch6_MIP/#diferencias-entre-servidor-web-y-servidor-de-aplicaciones","title":"Diferencias entre Servidor Web y Servidor de Aplicaciones","text":"Caracter\u00edstica Servidor de Aplicaciones Servidor Web Prop\u00f3sito Manejo de l\u00f3gica de negocio y datos. Entrega de contenido est\u00e1tico. Uso de recursos Mayor consumo de CPU y memoria. Ligero y r\u00e1pido. Ejemplos Tomcat, JBoss, WebLogic. Apache, Nginx."},{"location":"Ud6/Ch6_MIP/#despliegue-de-aplicaciones-web","title":"\ud83d\udd39 Despliegue de Aplicaciones Web","text":"<p>El despliegue es el proceso de mover una aplicaci\u00f3n desde el entorno de desarrollo hasta su ejecuci\u00f3n en producci\u00f3n.</p>"},{"location":"Ud6/Ch6_MIP/#fases-del-despliegue","title":"Fases del despliegue:","text":"<ol> <li>Desarrollo \u2192 Creaci\u00f3n y pruebas iniciales en local.</li> <li>Pruebas \u2192 Validaci\u00f3n en un entorno de testeo.</li> <li>Preproducci\u00f3n \u2192 \u00daltima verificaci\u00f3n antes de la salida a producci\u00f3n.</li> <li>Producci\u00f3n \u2192 Implementaci\u00f3n final accesible para los usuarios.</li> <li>Monitoreo \u2192 Supervisi\u00f3n para detectar errores y optimizar rendimiento.</li> </ol>"},{"location":"Ud6/Ch6_MIP/#tipos-de-despliegue","title":"Tipos de despliegue:","text":"<ul> <li>C\u00f3digo: Archivos y scripts (Java, JavaScript, CSS, etc.).</li> <li>Contenido: Im\u00e1genes, textos y configuraciones.</li> </ul>"},{"location":"Ud6/Ch6_MIP/#mejores-practicas","title":"Mejores pr\u00e1cticas:","text":"<ul> <li>\u2714 Uso de Git: Control de versiones para evitar errores.</li> <li>\u2714 Entornos separados: Desarrollo, pruebas y producci\u00f3n.</li> <li>\u2714 Automatizaci\u00f3n: Uso de scripts y herramientas como Jenkins o Docker.</li> <li>\u2714 Supervisi\u00f3n post-despliegue: Para detectar problemas r\u00e1pidamente.</li> </ul>"},{"location":"Ud6/Ch6_MIP/#despliegue-de-aplicaciones-java","title":"\ud83d\udd39 Despliegue de Aplicaciones Java","text":"<p>Las aplicaciones Java suelen desplegarse en servidores de aplicaciones como Tomcat o JBoss, utilizando archivos .jar o .war.</p>"},{"location":"Ud6/Ch6_MIP/#herramientas-clave","title":"Herramientas clave:","text":"<ul> <li>Maven: Manejo de dependencias y automatizaci\u00f3n del build.</li> <li>WAR (Web Application Archive): Paquete que contiene HTML, servlets y configuraci\u00f3n.</li> </ul>"},{"location":"Ud6/Ch6_MIP/#ejemplo-de-comandos-maven","title":"Ejemplo de comandos Maven:","text":"<pre><code>mvn compile       # Compila el c\u00f3digo fuente  \nmvn package       # Empaqueta en .jar o .war  \nmvn deploy        # Despliega la aplicaci\u00f3n  \n</code></pre>"},{"location":"Ud6/Ch6_MIP/#despliegue-de-aplicaciones-javascript-y-nodejs","title":"\ud83d\udd39 Despliegue de Aplicaciones JavaScript y Node.js","text":"<p>Las aplicaciones JavaScript pueden ejecutarse tanto en el cliente (frontend) como en el servidor con Node.js.</p>"},{"location":"Ud6/Ch6_MIP/#frontend","title":"Frontend:","text":"<p>Se sirve a trav\u00e9s de Apache, Nginx, Vercel o Netlify.</p>"},{"location":"Ud6/Ch6_MIP/#backend","title":"Backend:","text":"<p>Se ejecuta en servidores con Node.js + Express.</p>"},{"location":"Ud6/Ch6_MIP/#que-es-nodejs","title":"\u00bfQu\u00e9 es Node.js?","text":"<p>Es un entorno de ejecuci\u00f3n de JavaScript en el servidor. No es un lenguaje ni un framework, sino una plataforma para ejecutar c\u00f3digo JS fuera del navegador.</p>"},{"location":"Ud6/Ch6_MIP/#que-es-expressjs","title":"\u00bfQu\u00e9 es Express.js?","text":"<p>Es un framework de Node.js que facilita la creaci\u00f3n de APIs y aplicaciones web, gestionando rutas, peticiones y middleware.</p>"},{"location":"Ud6/Ch6_MIP/#que-es-npm","title":"\u00bfQu\u00e9 es npm?","text":"<p>npm (Node Package Manager) es el gestor de paquetes de JavaScript que permite instalar librer\u00edas y gestionar dependencias.</p>"},{"location":"Ud6/Ch6_MIP/#archivo-packagejson","title":"Archivo <code>package.json</code>:","text":"<p>Contiene la configuraci\u00f3n de un proyecto Node.js, incluyendo nombre, versi\u00f3n y scripts automatizados.</p>"},{"location":"Ud6/Ch6_MIP/#ejemplo-de-npm-scripts-en-packagejson","title":"Ejemplo de NPM scripts en <code>package.json</code>:","text":"<pre><code>{\n  \"scripts\": {\n    \"start\": \"node app.js\",\n    \"test\": \"jest\",\n    \"build\": \"webpack\"\n  }\n}\n</code></pre>"},{"location":"Ud6/Ch6_MIP/#practicas-de-despliegue","title":"\ud83d\udd39 Pr\u00e1cticas de Despliegue","text":""},{"location":"Ud6/Ch6_MIP/#practica-1-instalacion-de-tomcat","title":"Pr\u00e1ctica 1: Instalaci\u00f3n de Tomcat","text":"<ol> <li> <p>Crear m\u00e1quina virtual EC2 (Debian):</p> <ul> <li>Nombre: PTomcat.</li> <li>Puerto 8080: Permitir acceso HTTP/HTTPS.</li> </ul> </li> <li> <p>Instalar Java: <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install default-jdk default-jre\n</code></pre></p> </li> <li> <p>Instalar Tomcat: <pre><code>sudo apt-get install -y tomcat10 tomcat10-admin\nsystemctl status tomcat10\n</code></pre></p> </li> <li> <p>Crear usuario de administraci\u00f3n: <pre><code>sudo nano /etc/tomcat10/tomcat-users.xml\n</code></pre>    A\u00f1adir:    <pre><code>&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"admin-gui\"/&gt;\n&lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre>    Reiniciar Tomcat:    <pre><code>sudo systemctl restart tomcat10\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_MIP/#practica-2-despliegue-de-aplicaciones-con-tomcat","title":"Pr\u00e1ctica 2: Despliegue de aplicaciones con Tomcat","text":"<ol> <li> <p>Despliegue manual de una aplicaci\u00f3n WAR:</p> <ul> <li>Acceder al Gestor de Aplicaciones Web en <code>http://IP_SERVIDOR:8080/manager</code>.</li> <li>Subir y desplegar el archivo <code>.war</code>.</li> </ul> </li> <li> <p>Desplegar una aplicaci\u00f3n nueva paso a paso:</p> <ul> <li>Crear estructura de carpetas en <code>/var/lib/tomcat10/webapps/prueba/WEB-INF/classes</code>.</li> <li>Compilar archivos Java:   <pre><code>javac -classpath /usr/share/tomcat10/lib/servlet-api.jar hola1.java\n</code></pre></li> <li>Configurar <code>web.xml</code>:   <pre><code>&lt;servlet&gt;\n    &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;hola1&lt;/servlet-class&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/hola1&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n</code></pre></li> </ul> </li> </ol>"},{"location":"Ud6/Ch6_MIP/#practica-3-despliegue-en-tomcat-con-maven","title":"Pr\u00e1ctica 3: Despliegue en Tomcat con Maven","text":"<ol> <li> <p>Instalar Maven: <pre><code>sudo apt-get install maven\n</code></pre></p> </li> <li> <p>Configurar Maven y Tomcat:</p> <ul> <li>Crear usuario en <code>tomcat-users.xml</code>.</li> <li>Configurar servidor en <code>settings.xml</code>.</li> </ul> </li> <li> <p>Desplegar proyecto con Maven: <pre><code>mvn tomcat7:deploy\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_MIP/#practica-4-despliegue-de-aplicaciones-con-node-express","title":"Pr\u00e1ctica 4: Despliegue de aplicaciones con Node Express","text":"<ol> <li> <p>Instalar Node.js y Express: <pre><code>sudo npm install -g express\n</code></pre></p> </li> <li> <p>Crear proyecto con Express: <pre><code>npm init -y\nnpm install express\n</code></pre></p> </li> <li> <p>Desplegar aplicaci\u00f3n: <pre><code>node app.js\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_MIP/#practica-5-dockerizacion-del-despliegue-de-una-aplicacion-nodejs","title":"Pr\u00e1ctica 5: Dockerizaci\u00f3n del despliegue de una aplicaci\u00f3n Node.js","text":"<ol> <li> <p>Crear Dockerfile: <pre><code>FROM node\nWORKDIR /app\nCOPY . /app\nRUN npm install\nEXPOSE 3000\nCMD [\"node\", \"app.js\"]\n</code></pre></p> </li> <li> <p>Construir y ejecutar contenedor: <pre><code>docker build -t my-node-app .\ndocker run -p 3000:3000 -d my-node-app\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_MIP/#practica-6-despliegue-de-una-aplicacion-clusterizada-con-node-express","title":"Pr\u00e1ctica 6: Despliegue de una aplicaci\u00f3n \"clusterizada\" con Node Express","text":"<ol> <li> <p>Usar m\u00f3dulo Cluster: <pre><code>const cluster = require('cluster');\nif (cluster.isMaster) {\n  for (let i = 0; i &lt; totalCPUs; i++) {\n    cluster.fork();\n  }\n} else {\n  // C\u00f3digo de la aplicaci\u00f3n\n}\n</code></pre></p> </li> <li> <p>Usar PM2 para gesti\u00f3n del cl\u00faster: <pre><code>pm2 start app.js -i 0\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_MIP/#practica-7-despliegue-de-una-aplicacion-en-netlify-paas","title":"Pr\u00e1ctica 7: Despliegue de una aplicaci\u00f3n en Netlify (PaaS)","text":"<ol> <li> <p>Instalar Netlify CLI: <pre><code>sudo npm install netlify-cli -g\n</code></pre></p> </li> <li> <p>Desplegar aplicaci\u00f3n: <pre><code>netlify deploy --prod\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_MIP/#practica-8-despliegue-de-una-aplicacion-flask-python","title":"Pr\u00e1ctica 8: Despliegue de una aplicaci\u00f3n Flask (Python)","text":"<ol> <li> <p>Instalar Flask y Gunicorn: <pre><code>pipenv install flask gunicorn\n</code></pre></p> </li> <li> <p>Configurar servicio Gunicorn: <pre><code>systemctl enable flask_app\nsystemctl start flask_app\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_MIP/#practica-9-aplicacion-python-con-flask-en-docker","title":"Pr\u00e1ctica 9: Aplicaci\u00f3n Python con Flask en Docker","text":"<ol> <li> <p>Crear Dockerfile: <pre><code>FROM python:3.8-slim\nWORKDIR /app\nCOPY . /app\nRUN pip install -r requirements.txt\nEXPOSE 80\nCMD [\"gunicorn\", \"--bind\", \"0.0.0.0:80\", \"wsgi:app\"]\n</code></pre></p> </li> <li> <p>Construir y ejecutar contenedor: <pre><code>docker build -t my-flask-app .\ndocker run -p 4000:80 -d my-flask-app\n</code></pre></p> </li> </ol>"},{"location":"Ud6/Ch6_MMC/","title":"CheatSheet Servidores de Aplicaciones","text":""},{"location":"Ud6/Ch6_MMC/#instalaciones","title":"Instalaciones \ud83d\udd0d","text":"<p>| sudo apt-get install default-jdk sudo apt-get install default-jre | Instalar Java | | --- | --- | | sudo apt-get install -y tomcat10 tomcat10-admin | Instalaci\u00f3n Apache Tomcat  | | sudo apt-get install maven |  Instalar Maven | | sudo apt-get install -y ca-certificates curl gnupg sudo mkdir -p /etc/apt/keyrings curl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg | Instalar GPG de Nodesource | | sudo apt-get install nodejs -y | Instalar Node.js | | sudo npm install -g express | Instalar Express | | sudo npm install -g loadtest | Instalar loadtest, para medir el rendimiento | | sudo npm install netlify-cli -g | Instalar Netlify CLI | | sudo npm install -g @angular/cli | Instalar Angular CLI | | sudo apt-get install python3-pip | Instalar Python | | sudo apt-get install pipenv | Instalar el gestor de entornos virtuales de Python |</p>"},{"location":"Ud6/Ch6_MMC/#configuracion-tomcat","title":"Configuraci\u00f3n Tomcat \u2601\ufe0f","text":"<p>|     | Creaci\u00f3n de un usuario dentro de \u201ctomcat-users.xml\u201d | | --- | --- | | javac -classpath /usr/share/tomcat10/lib/servlet-api.jar hola1.java | Compilar aplicaci\u00f3n java | | &lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;</p> <p> Ejemplos tutorial Servlets de ejemplos del tutorial de Servlets y JDBC. hola1 hola1 hola1 /hola1  | Configuraci\u00f3n del fichero \u201cweb.xml\u201d |</p>"},{"location":"Ud6/Ch6_MMC/#configuracion-tomcat-con-maven","title":"Configuraci\u00f3n Tomcat con Maven \u26c8\ufe0f","text":"<p>|   | Modificaci\u00f3n \u201ctomcat-users.xml\u201d | | --- | --- | |      DesplieguesTomcat despliegues ieselcaminas  | Modificaci\u00f3n \u201csettings.xml\u201d | |  roshambo #    org.apache.tomcat.maven tomcat7-maven-plugin 2.2 http://localhost:8080/manager/text #      DesplieguesTomcat #      /rps #       | Modificaci\u00f3n \u201cpom\u201d | | mvn tomcat7:deploy | Desplegar en Maven | | mvn tomcat7:redeploy | Volver a desplegar en Maven | | mvn tomcat7:undeploy | Replegar en Maven | |     mvn archetype:generate -DgroupId=IESElCaminas -DartifactId=miapp -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false | Creaci\u00f3n de un proyecto nuevo desde Maven |</p>"},{"location":"Ud6/Ch6_MMC/#despliegue-con-node-express","title":"Despliegue con Node Express \ud83d\ude84","text":"npm init -y Inicializar proyecto npm install express Instalar Express en el proyecto node app.js Ejecutar el proyecto npm install Instalar librer\u00edas necesarias npm run start:dev Iniciar la aplicaci\u00f3n"},{"location":"Ud6/Ch6_MMC/#despliegue-con-netlify","title":"Despliegue con Netlify \ud83d\udcda","text":"netlify login Autentificaci\u00f3n npm install Instalar dependencias npm run start Ejecutar el script \u201cstart\u201d npm run build Buildear la aplicaci\u00f3n netlify deploy Prepara la aplicaci\u00f3n para subirla ng serve -o --host=IPPRIVADA Poner en funcionamiento la aplicaci\u00f3n si es de ANGULAR"},{"location":"Ud6/Ch6_MMC/#despliegue-con-flask-python","title":"Despliegue con Flask (Python) \ud83d\udc33","text":"pipenv shell Iniciar entorno virtual pipenv install flask gunicorn Instalar dependencias flask run \u2014host \u20180.0.0.0\u2019 Ejecutar aplicaci\u00f3n gunicorn --workers 2 --bind 0.0.0.0:5000 wsgi:app Comprobar si funciona la app which gunicorn Mostrar ruta donde se ejecuta Gunicorn deactivate Salir del entorno virtual"},{"location":"Ud6/Ch6_PPE/","title":"\ud83d\udcc4 Cheatsheet UD6 - Servidores de aplicaciones","text":"<p>Este documento resume los comandos y ficheros de configuraci\u00f3n para la creaci\u00f3n y gesti\u00f3n en diferentes servidores de aplicaciones como Tomcat en sistemas Ubuntu, correspondientes a la Unidad 6 del curso de Despliegue de Aplicaciones.</p>"},{"location":"Ud6/Ch6_PPE/#servidor-tomcat","title":"\ud83d\ude80 Servidor TOMCAT","text":""},{"location":"Ud6/Ch6_PPE/#instalacion-de-tomcat","title":"\ud83d\udee0 Instalaci\u00f3n de Tomcat","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo apt-get install default-jdk</code> Instalar Java Development Kit (JDK). <code>sudo apt-get install -y tomcat10 tomcat10-admin</code> Instalar Tomcat 10 y su m\u00f3dulo de administraci\u00f3n. <code>sudo systemctl restart tomcat10</code> Reiniciar el servicio de Tomcat tras la instalaci\u00f3n."},{"location":"Ud6/Ch6_PPE/#configuracion-de-usuarios-en-tomcat","title":"Configuraci\u00f3n de Usuarios en Tomcat","text":"<p>\ud83d\udccc Ejemplo de configuraci\u00f3n en tomcat-users.xml <pre><code>&lt;tomcat-users&gt;\n    &lt;role rolename=\"manager-gui\"/&gt;\n    &lt;role rolename=\"manager-script\"/&gt;\n    &lt;role rolename=\"manager-status\"/&gt;\n    &lt;role rolename=\"admin-gui\"/&gt;\n    &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"manager-gui,manager-script,manager-status,admin-gui\"/&gt;\n&lt;/tomcat-users&gt;\n</code></pre> \u2705 Una vez configurado, accede a Tomcat Manager desde:</p> <p>\ud83d\udd17 <code>http://IP_SERVIDOR:8080/manager</code></p>"},{"location":"Ud6/Ch6_PPE/#despliegue-de-aplicaciones-java-en-tomcat","title":"\ud83d\udce6 Despliegue de Aplicaciones Java en Tomcat","text":""},{"location":"Ud6/Ch6_PPE/#preparacion-del-entorno","title":"\ud83c\udfd7 Preparaci\u00f3n del entorno","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo passwd tomcat</code> Asignar contrase\u00f1a al usuario tomcat. <code>su tomcat</code> Iniciar sesi\u00f3n como usuario tomcat para poder trabajar con sus ficheros. <code>mkdir -p /var/lib/tomcat10/webapps/prueba/WEB-INF/classes</code> Crear estructura de directorios para la aplicaci\u00f3n nueva."},{"location":"Ud6/Ch6_PPE/#ejemplo-de-servlet-hola1java","title":"\u270d Ejemplo de Servlet - hola1.java","text":"<pre><code>import jakarta.servlet.*;\nimport jakarta.servlet.http.*;\nimport java.io.*;\npublic class hola1 extends HttpServlet {\n    public void init(ServletConfig conf) throws ServletException {\n        super.init(conf);\n    }\n\n    public void service(HttpServletRequest req, HttpServletResponse res)\n        throws ServletException, IOException {\n        res.setContentType(\"text/html\");\n        PrintWriter out = res.getWriter();\n        out.println(\"&lt;html&gt;\");\n        out.println(\"&lt;body&gt;\");\n        out.println(\"&lt;h1&gt;servlet hola 1&lt;/h1&gt;\");\n        out.println(\"&lt;/body&gt;\");\n        out.println(\"&lt;/html&gt;\");\n    }\n}\n</code></pre>"},{"location":"Ud6/Ch6_PPE/#compilar-el-servlet","title":"\ud83d\udee0 Compilar el servlet:","text":"<p><pre><code>javac -classpath /usr/share/tomcat10/lib/servlet-api.jar hola1.java\n</code></pre> \u26a0\ufe0f Si hay errores, revisa la versi\u00f3n de Java y actualiza javax a jakarta en Java 11+</p>"},{"location":"Ud6/Ch6_PPE/#mover-el-archivo-compilado","title":"\ud83d\udd00 Mover el archivo compilado:","text":"<pre><code>mv hola1.class ./WEB-INF/classes\n</code></pre>"},{"location":"Ud6/Ch6_PPE/#configuracion-del-servlet-en-webxml","title":"\u2699 Configuraci\u00f3n del servlet en web.xml","text":"<p>\ud83d\udcc4 Archivo: WEB-INF/web.xml</p> <p><pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;!DOCTYPE web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\" \"http://java.sun.com/dtd/web-app_2_3.dtd\"&gt;\n&lt;web-app&gt;\n    &lt;display-name&gt;Ejemplos tutorial&lt;/display-name&gt;\n    &lt;description&gt;Servlets de ejemplos del tutorial de Servlets y JDBC.&lt;/description&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;hola1&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/hola1&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre> \ud83c\udfaf Acceso al servlet desde el navegador:</p> <p>\ud83d\udd17 <code>http://IP_SERVIDOR:8080/prueba/hola1</code></p>"},{"location":"Ud6/Ch6_PPE/#despliegue-de-aplicaciones-con-maven","title":"\u26a1 Despliegue de Aplicaciones con Maven","text":""},{"location":"Ud6/Ch6_PPE/#instalacion-de-maven","title":"\ud83d\udd27 Instalaci\u00f3n de Maven","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo apt-get install maven</code> Instalar Apache Maven en el sistema. <code>mvn --version</code> Verificar la versi\u00f3n instalada de Maven. <code>sudo systemctl restart tomcat10.service</code> Reiniciar Tomcat tras cambiar las configuraciones."},{"location":"Ud6/Ch6_PPE/#configuracion-de-maven-para-despliegue-en-tomcat","title":"\ud83d\udd11 Configuraci\u00f3n de Maven para despliegue en Tomcat","text":""},{"location":"Ud6/Ch6_PPE/#editar-etcmavensettingsxml","title":"\ud83d\udcc4 Editar /etc/maven/settings.xml","text":"<pre><code>&lt;server&gt;\n  &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n  &lt;username&gt;despliegues&lt;/username&gt;\n  &lt;password&gt;ieselcaminas&lt;/password&gt;\n&lt;/server&gt;\n</code></pre>"},{"location":"Ud6/Ch6_PPE/#agregar-usuario-en-tomcat-usersxml","title":"\ud83d\udcc4 Agregar usuario en tomcat-users.xml","text":"<pre><code>&lt;tomcat-users&gt;\n    &lt;!-- ... --&gt;\n    &lt;role rolename=\"manager-script\"/&gt;\n    &lt;user username=\"despliegues\" password=\"ieselcaminas\" roles=\"manager-script\"/&gt;\n&lt;/tomcat-users&gt;\n</code></pre>"},{"location":"Ud6/Ch6_PPE/#despliegue-con-maven-desde-cero","title":"\ud83d\ude80 Despliegue con Maven desde cero","text":""},{"location":"Ud6/Ch6_PPE/#1-crear-una-nueva-aplicacion-maven","title":"\ud83d\udccc 1. Crear una nueva aplicaci\u00f3n Maven","text":"<pre><code>mvn archetype:generate -DgroupId=IESElCaminas -DartifactId=miapp -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false\n</code></pre>"},{"location":"Ud6/Ch6_PPE/#2-configurar-pomxml-para-tomcat","title":"\ud83d\udccc 2. Configurar pom.xml para Tomcat","text":"<pre><code>&lt;build&gt;\n  &lt;finalName&gt;miapp&lt;/finalName&gt;\n  &lt;plugins&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n      &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n      &lt;version&gt;3.4.0&lt;/version&gt;\n    &lt;/plugin&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n      &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n      &lt;version&gt;2.2&lt;/version&gt;\n      &lt;configuration&gt;\n        &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt;\n        &lt;server&gt;DesplieguesTomcat&lt;/server&gt;\n        &lt;path&gt;/miapp&lt;/path&gt;\n      &lt;/configuration&gt;\n    &lt;/plugin&gt;\n  &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre>"},{"location":"Ud6/Ch6_PPE/#3-comandos-para-gestionar-el-despliegue","title":"\ud83d\udccc 3. Comandos para gestionar el despliegue","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>mvn package</code> Empaquetar la aplicaci\u00f3n en un archivo WAR. <code>mvn tomcat7:deploy</code> Desplegar la aplicaci\u00f3n en Tomcat. <code>mvn tomcat7:redeploy</code> Volver a desplegar la aplicaci\u00f3n tras cambios. <code>mvn tomcat7:undeploy</code> Eliminar la aplicaci\u00f3n del servidor."},{"location":"Ud6/Ch6_PPE/#servidor-node-express","title":"\ud83d\ude80 Servidor Node EXPRESS","text":""},{"location":"Ud6/Ch6_PPE/#instalacion-de-paquetes","title":"\ud83d\udee0 Instalaci\u00f3n de paquetes","text":""},{"location":"Ud6/Ch6_PPE/#1-instalar-nodejs","title":"\ud83d\udccc 1. Instalar Node.js","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo apt-get install -y ca-certificates curl gnupg</code> Instala dependencias necesarias. <code>sudo mkdir -p /etc/apt/keyrings</code> Crea el directorio para las claves GPG. <code>curl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key \\| sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg</code> Importa la clave GPG de NodeSource para verificar la autenticidad del repositorio. <code>NODE_MAJOR=20</code> Define la versi\u00f3n de Node.js. <code>echo \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" \\| sudo tee /etc/apt/sources.list.d/nodesource.list</code> Agrega el repositorio de Node.js a la lista de fuentes de APT para su instalaci\u00f3n. <code>sudo apt-get update</code> Actualiza la lista de paquetes tras a\u00f1adir el repositorio. <code>sudo apt-get install -y nodejs npm</code> Instala Node.js y npm."},{"location":"Ud6/Ch6_PPE/#2-instalar-expressjs","title":"\ud83d\udccc 2. Instalar Express.js","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo npm install -g express</code> Instala Express.js de forma global. <code>sudo npm install -g npm@latest</code> Actualiza npm a la \u00faltima versi\u00f3n."},{"location":"Ud6/Ch6_PPE/#ejecucion-de-un-proyecto-nodejs-con-express","title":"\ud83d\ude80 Ejecuci\u00f3n de un Proyecto Node.js con Express","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>npm init -y</code> Inicializa un proyecto Node.js. <code>npm install express</code> Instala Express.js en el proyecto. <code>node app.js</code> Inicia el servidor en el puerto por defecto (3000). <p>\ud83c\udf10 Accede en el navegador:</p> <p>\ud83d\udd17 <code>http://IP_PUBLICA:3000</code></p>"},{"location":"Ud6/Ch6_PPE/#ejecucion-de-un-proyecto-nodejs-con-pm2","title":"\u26a1 Ejecuci\u00f3n de un Proyecto Node.js con PM2","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo npm install pm2 -g</code> Instala PM2 globalmente. <code>pm2 start app.js -i 0</code> Inicia la aplicaci\u00f3n en modo cl\u00faster con PM2. <code>pm2 stop pruebacluster.js</code> Detiene la aplicaci\u00f3n. <code>pm2 ls</code> Lista las aplicaciones en ejecuci\u00f3n. <code>pm2 logs</code> Muestra los logs en tiempo real. <code>pm2 monit</code> Muestra m\u00e9tricas de rendimiento."},{"location":"Ud6/Ch6_PPE/#configuracion-con-ecosystemconfigjs","title":"\ud83d\udcc4 Configuraci\u00f3n con ecosystem.config.js","text":""},{"location":"Ud6/Ch6_PPE/#1-generar-y-modificar-el-archivo","title":"\ud83d\udccc 1. Generar y Modificar el Archivo","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>pm2 init simple</code> Crea un archivo <code>ecosystem.config.js</code>. <p>\ud83d\udcc4 Modifica <code>ecosystem.config.js</code> </p> <pre><code>module.exports = {\n  apps: [\n    {\n      name: \"app\",\n      script: \"app.js\",\n      instances: 0,  // Usar\u00e1 todas las CPU disponibles\n      exec_mode: \"cluster\",\n    },\n  ],\n};\n</code></pre>"},{"location":"Ud6/Ch6_PPE/#2-ejecutar-con-pm2-y-ecosystem","title":"\ud83d\udccc 2. Ejecutar con PM2 y Ecosystem","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>pm2 start ecosystem.config.js</code> Inicia la aplicaci\u00f3n con configuraci\u00f3n PM2. <code>pm2 restart ecosystem.config.js</code> Reinicia la aplicaci\u00f3n. <code>pm2 reload ecosystem.config.js</code> Recarga sin tiempo de inactividad. <code>pm2 stop ecosystem.config.js</code> Detiene la aplicaci\u00f3n. <code>pm2 delete ecosystem.config.js</code> Elimina la aplicaci\u00f3n."},{"location":"Ud6/Ch6_PPE/#servidor-netlify-paas","title":"\ud83d\ude80 Servidor Netlify (PaaS)","text":""},{"location":"Ud6/Ch6_PPE/#despliegue-con-netlify-cli","title":"\ud83d\udee0 Despliegue con Netlify CLI","text":"<p>Debemos estar registrados en Netlify para poder continuar.</p> \ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo npm install netlify-cli -g</code> Instala Netlify CLI globalmente. <code>netlify login</code> Inicia sesi\u00f3n en Netlify. (Si SSH no permite navegador, usar token de acceso). <code>export NETLIFY_AUTH_TOKEN=[TOKEN]</code> Exportamos el token para poder acceder por SSH. <code>netlify deploy --prod</code> Despliega la aplicaci\u00f3n en producci\u00f3n. <p>\ud83d\udccc Accede a tu aplicaci\u00f3n en:</p> <p>\ud83d\udd17 <code>https://APP.netlify.app</code></p> <p>\ud83d\udca1 Tip: Una vez lo tenemos configurado, podemos vincular nuestro repositorio de GitHub y de esta forma cada <code>git push</code> generar\u00e1 un nuevo despliegue en Netlify autom\u00e1ticamente.</p>"},{"location":"Ud6/Ch6_PPE/#despliegue-de-aplicaciones-angular","title":"\u26a1 Despliegue de Aplicaciones Angular","text":"\ud83d\udd27 Comando \ud83d\udcdd Funcionalidad <code>sudo npm install -g @angular/cli</code> Instala Angular CLI globalmente. <code>ng serve -o --host=IPPRIVADA</code> Inicia el servidor en la IP privada del equipo. <p>\ud83d\udccc Accede en el navegador con la IP p\u00fablica:</p> <p>\ud83d\udd17 <code>http://IPPUBLICA:4200</code></p>"},{"location":"Ud6/Ch6_RPE/","title":"\ud83d\udcc4 Cheatsheet UD6 - Servidores de aplicaciones","text":""},{"location":"Ud6/Ch6_RPE/#tomcat","title":"\ud83c\udfd7\ufe0f Tomcat","text":""},{"location":"Ud6/Ch6_RPE/#instalacion-de-tomcat","title":"\ud83d\udee0 Instalaci\u00f3n de Tomcat","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt-get install default-jdk</code> Instala el kit necesario para desarrollar aplicaciones en Java. <code>sudo apt-get install default-jre</code> Descarga e instala el entorno requerido para ejecutar programas en Java. <code>sudo apt-get install -y tomcat10 tomcat10-admin</code> Instala el servidor Tomcat 10 junto con su panel de administraci\u00f3n. <code>sudo systemctl restart tomcat10</code> Vuelve a iniciar el servicio de Tomcat para aplicar los cambios. <code>sudo systemctl status tomcat10</code> Comprueba el estado del servicio de Tomcat."},{"location":"Ud6/Ch6_RPE/#configuracion-de-usuarios-en-tomcat","title":"\ud83d\udd11 Configuraci\u00f3n de Usuarios en Tomcat","text":"<p>Edita el archivo de configuraci\u00f3n de usuarios de Tomcat:</p> <pre><code>sudo nano /etc/tomcat10/tomcat-users.xml\n</code></pre> <p>Inserta el siguiente contenido:</p> <pre><code>    &lt;role rolename=\"manager-status\"/&gt;\n    &lt;role rolename=\"admin-gui\"/&gt;\n    &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"manager-gui,manager-script,manager-status,admin-gui\"/&gt;\n</code></pre> <p>Una vez terminado, reinicia el servicio de Tomcat:</p> <pre><code>sudo systemctl restart tomcat10\n</code></pre> <p>Y ya podras acceder a la interfaz de administraci\u00f3n de Tomcat en <code>http://{IP-del-servidor}:8080/manager</code></p>"},{"location":"Ud6/Ch6_RPE/#despliegue-de-aplicaciones-con-tomcat","title":"\ud83d\ude80 Despliegue de aplicaciones con Tomcat","text":""},{"location":"Ud6/Ch6_RPE/#usuario-tomcat","title":"\ud83d\udc64 Usuario Tomcat","text":"<p>Aqu\u00ed tienes la informaci\u00f3n en formato de tabla:  </p> \ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo passwd tomcat</code> Asigna una nueva contrase\u00f1a al usuario <code>tomcat</code>. <code>su tomcat</code> Cambia al usuario <code>tomcat10</code> usando la contrase\u00f1a creada. <p>Si necesitas m\u00e1s cambios, dime.</p>"},{"location":"Ud6/Ch6_RPE/#creacion-de-una-aplicacion-nueva","title":"\ud83d\udcc2 Creaci\u00f3n de una aplicaci\u00f3n nueva","text":"<p>Crar la estructura de las carpetas:</p> <pre><code>mkdir -p /var/lib/tomcat10/webapps/prueba/WEB-INF/classes\n</code></pre> <p>Ejemplo de aplicaci\u00f3n:</p> <p>Crear hola1.java:</p> <pre><code>import javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.io.*;\npublic class hola1 extends HttpServlet {\n public void init(ServletConfig conf)\n    throws ServletException {\n    super.init(conf);\n }\n\npublic void service(HttpServletRequest req, HttpServletResponse res)\n throws ServletException, IOException {\n    res.setContentType(\"text/html\");\n    PrintWriter out = res.getWriter();\n    out.println(\"&lt;html&gt;\");\n    out.println(\"&lt;body&gt;\");\n    out.println(\"&lt;h1&gt;servlet hola 1&lt;/h1&gt;\");\n    out.println(\"&lt;/body&gt;\");\n    out.println(\"&lt;/html&gt;\");\n    }\n}\n</code></pre> <p>Compilar la aplicaci\u00f3n:</p> <pre><code>javac -classpath /usr/share/tomcat10/lib/servlet-api.jar hola1.java\n</code></pre> <p>Moveremos la aplicacion a la carpeta de aplicaciones:</p> <pre><code>mv hola1.class ./WEB-INF/classes\n</code></pre>"},{"location":"Ud6/Ch6_RPE/#configuracion-del-servidor-de-aplicaciones","title":"\u2699\ufe0f Configuraci\u00f3n del servidor de aplicaciones","text":"<p>Crear el archivo web.xml en la carpeta WEB-INF/:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;!DOCTYPE web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\" \"http://java.sun.com/dtd/web-app_2_3.dtd\"&gt;\n&lt;web-app&gt;\n    &lt;display-name&gt;Ejemplos tutorial&lt;/display-name&gt;\n    &lt;description&gt;Servlets de ejemplos del tutorial de Servlets y JDBC.&lt;/description&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;hola1&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/hola1&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre> <p>Ya se podr\u00e1 acceder a la aplicaci\u00f3n en <code>http://{IP-del-servidor}:8080/prueba/hola1</code></p>"},{"location":"Ud6/Ch6_RPE/#despliegue-de-aplicaciones-con-maven","title":"\ud83d\ude80 Despliegue de aplicaciones con Maven","text":""},{"location":"Ud6/Ch6_RPE/#instalacion-de-maven","title":"\ud83d\udee0 Instalaci\u00f3n de Maven","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt-get install maven</code> Descargar e instalar Apache Maven en el equipo. <code>mvn --version</code> Comprobar la versi\u00f3n actual de Maven. <code>sudo systemctl restart tomcat10.service</code> Volver a iniciar Tomcat despu\u00e9s de modificar su configuraci\u00f3n."},{"location":"Ud6/Ch6_RPE/#configuracion-de-maven","title":"\u2699\ufe0f Configuraci\u00f3n de Maven","text":""},{"location":"Ud6/Ch6_RPE/#modificar-archivo-etctomcat10tomcat-usersxml","title":"\ud83d\udcdd Modificar archivo <code>/etc/tomcat10/tomcat-users.xml</code>","text":"<pre><code>     &lt;role rolename=\"admin-gui\"/&gt;\n     &lt;role rolename=\"manager-gui\"/&gt;\n     &lt;role rolename=\"manager-script\"/&gt;\n     &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n     &lt;user username=\"despliegues\" password=\"ieselcaminas\" roles=\"manager-script\"/&gt;\n</code></pre>"},{"location":"Ud6/Ch6_RPE/#editar-el-archivo-de-configuracion-etcmavensettingsxml","title":"\ud83d\udcdd Editar el archivo de configuraci\u00f3n <code>/etc/maven/settings.xml</code>","text":"<pre><code>    &lt;server&gt;\n      &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n      &lt;username&gt;despliegues&lt;/username&gt;\n      &lt;password&gt;ieselcaminas&lt;/password&gt;\n    &lt;/server&gt;\n</code></pre>"},{"location":"Ud6/Ch6_RPE/#despliegue-de-un-proyecto-con-maven","title":"\ud83d\udce6 Despliegue de un proyecto con Maven","text":""},{"location":"Ud6/Ch6_RPE/#crear-una-aplicacion-con-maven","title":"\ud83c\udfd7\ufe0f Crear una aplicaci\u00f3n con Maven","text":"<pre><code>    mvn archetype:generate -DgroupId=IESElCaminas -DartifactId=miapp -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false\n</code></pre>"},{"location":"Ud6/Ch6_RPE/#configurar-pomxml","title":"\u2699\ufe0f Configurar <code>pom.xml</code>","text":"<pre><code>&lt;build&gt;\n    &lt;finalName&gt;miapp&lt;/finalName&gt;\n    &lt;plugins&gt;  \n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.4.0&lt;/version&gt;\n        &lt;/plugin&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n            &lt;version&gt;2.2&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt;\n                &lt;server&gt;DesplieguesTomcat&lt;/server&gt;\n                &lt;path&gt;/miapp&lt;/path&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre>"},{"location":"Ud6/Ch6_RPE/#desplegar-la-aplicacion","title":"\ud83d\ude80 Desplegar la aplicaci\u00f3n","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>mvn tomcat7:deploy</code> Publica la aplicaci\u00f3n en el servidor Tomcat. <code>mvn tomcat7:redeploy</code> Realiza un nuevo despliegue tras aplicar modificaciones. <code>mvn tomcat7:undeploy</code> Retira la aplicaci\u00f3n del entorno de ejecuci\u00f3n."},{"location":"Ud6/Ch6_RPE/#node-express","title":"\ud83d\udda5\ufe0f Node Express","text":""},{"location":"Ud6/Ch6_RPE/#instalacion-de-node-express","title":"\ud83d\udee0 Instalaci\u00f3n de Node Express","text":""},{"location":"Ud6/Ch6_RPE/#instalacion-de-node","title":"\ud83d\udee0 Instalaci\u00f3n de Node","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo apt-get install -y ca-certificates curl gnupg</code> Descarga e instala los paquetes esenciales para el proceso. <code>sudo mkdir -p /etc/apt/keyrings</code> Genera el directorio necesario para almacenar claves GPG. <code>curl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key \\| sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg</code> Obtiene y convierte la clave GPG de NodeSource para validar la fuente del repositorio. <code>NODE_MAJOR=20</code> Especifica la versi\u00f3n principal de Node.js a utilizar. <code>echo \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" \\| sudo tee /etc/apt/sources.list.d/nodesource.list</code> Integra el repositorio oficial de Node.js en el sistema de gesti\u00f3n de paquetes. <code>sudo apt-get update</code> Recarga la base de datos de paquetes para reflejar los cambios recientes. <code>sudo apt-get install -y nodejs npm</code> Descarga e instala Node.js junto con su gestor de paquetes npm."},{"location":"Ud6/Ch6_RPE/#instalacion-de-express","title":"\ud83d\ude80 Instalaci\u00f3n de Express","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo npm install -g express</code> Realiza una instalaci\u00f3n global de Express.js. <code>sudo npm install -g npm@latest</code> Descarga e instala la versi\u00f3n m\u00e1s reciente de npm a nivel global."},{"location":"Ud6/Ch6_RPE/#creacion-de-un-proyecto","title":"\ud83c\udfd7\ufe0f Creaci\u00f3n de un proyecto","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>mkdir proyecto</code> Crea una carpeta para el nuevo proyecto. <code>npm init -y</code> Crea un nuevo proyecto de Node.js con una configuraci\u00f3n predeterminada. <code>npm install express</code> Agrega Express.js como dependencia en el proyecto. <code>node app.js</code> Ejecuta el servidor, que por defecto escucha en el puerto 3000. <p>Ya puedes acceder a la aplicaci\u00f3n en <code>http://{IP-del-servidor}:3000</code></p>"},{"location":"Ud6/Ch6_RPE/#despliegue-de-una-aplicacion-clusterizada-con-pm2","title":"\ud83d\ude80 Despliegue de una aplicaci\u00f3n clusterizada con PM2","text":""},{"location":"Ud6/Ch6_RPE/#instalacion-de-pm2","title":"\ud83d\udee0 Instalaci\u00f3n de PM2","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo npm install -g pm2</code> Descarga e instala PM2 en el sistema."},{"location":"Ud6/Ch6_RPE/#control-de-una-aplicacion-con-pm2","title":"\ud83c\udf9b\ufe0f Control de una aplicaci\u00f3n con PM2","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>pm2 start app.js -i 0</code> Ejecuta la aplicaci\u00f3n en m\u00faltiples instancias con PM2. <code>pm2 stop app.js</code> Finaliza la ejecuci\u00f3n de la aplicaci\u00f3n. <code>pm2 ls</code> Muestra un listado de las aplicaciones activas. <code>pm2 logs</code> Visualiza los registros en tiempo real. <code>pm2 monit</code> Presenta estad\u00edsticas de uso y rendimiento."},{"location":"Ud6/Ch6_RPE/#configuracion-de-una-aplicacion-clusterizada-con-pm2","title":"\u2699\ufe0f Configuraci\u00f3n de una aplicaci\u00f3n clusterizada con PM2","text":"<p>Crear un archivo de configuraci\u00f3n de PM2:</p> <pre><code>touch ecosystem.config.js\n</code></pre> <p>Insertar el siguiente contenido:</p> <pre><code>module.exports = {\n apps: [\n {\n name: \"nombre_aplicacion\",\n script: \"nombre_aplicacion_sin_cluster.js\",\n instances: 0,\n exec_mode: \"cluster\",\n },\n ],\n};\n</code></pre>"},{"location":"Ud6/Ch6_RPE/#despliegue-de-una-aplicacion-clusterizada-con-pm2_1","title":"\ud83d\ude80 Despliegue de una aplicaci\u00f3n clusterizada con PM2","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>pm2 start ecosystem.config.js</code> Ejecuta la aplicaci\u00f3n utilizando la configuraci\u00f3n de PM2. <code>pm2 restart ecosystem.config.js</code> Vuelve a iniciar la aplicaci\u00f3n. <code>pm2 reload ecosystem.config.js</code> Recarga la aplicaci\u00f3n sin causar interrupciones. <code>pm2 stop ecosystem.config.js</code> Finaliza la ejecuci\u00f3n de la aplicaci\u00f3n. <code>pm2 delete ecosystem.config.js</code> Borra la aplicaci\u00f3n del administrador de procesos."},{"location":"Ud6/Ch6_RPE/#netlify-paas","title":"\u2601\ufe0f Netlify (PaaS)","text":""},{"location":"Ud6/Ch6_RPE/#instalacion-de-netlify","title":"\ud83d\udee0 Instalaci\u00f3n de Netlify","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo npm install netlify-cli -g</code> Descarga e instala Netlify CLI a nivel global. <code>netlify login</code> Autentica el usuario en Netlify. (Si el navegador no abre por SSH, usar un token). <code>export NETLIFY_AUTH_TOKEN=[TOKEN]</code> Configura el token de autenticaci\u00f3n para acceso v\u00eda SSH. <code>netlify deploy --prod</code> Publica la aplicaci\u00f3n en el entorno de producci\u00f3n. <p>Y ya podremos acceder a la aplicaci\u00f3n en <code>https://{nombre-de-la-aplicacion}.netlify.app</code></p>"},{"location":"Ud6/Ch6_RRL/","title":"SERVIDORES DE APLICACIONES","text":""},{"location":"Ud6/Ch6_RRL/#tomcat","title":"TOMCAT","text":""},{"location":"Ud6/Ch6_RRL/#instalacion-tomcat","title":"INSTALACI\u00d3N TOMCAT","text":"<p>Instalamos primero el JDK y JRE:</p> <pre><code>sudo apt install default-jdk\n\nsudo apt-get install default-jre\n</code></pre> <p>Instalamos Tomcat y su m\u00f3dulo de administraci\u00f3n:</p> <pre><code>sudo apt-get install -y tomcat10 tomcat10-admin\n</code></pre> <p>Reiniciamos el servicio de Tomcat despu\u00e9s de instalarlo:</p> <pre><code>sudo apt-get install -y tomcat10 tomcat10-admin\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#creacion-de-usuario-en-tomcat","title":"CREACI\u00d3N DE USUARIO EN TOMCAT","text":"<p>Para crear un usuario modificamos el archivo <code>/etc/tomcat10/tomcat-users.xml</code></p> <pre><code>sudo nano /etc/tomcat10/tomcat-users.xml\n</code></pre> <p>Ejemplo de archivo de configuraci\u00f3n:</p> <pre><code>&lt;role rolename=\"admin-gui\"/&gt;\n&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"manager-script\"/&gt;\n&lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n&lt;user username=\"despliegues\" password=\"ieselcaminas\" roles=\"manager-script\"/&gt;\n</code></pre> <p>Con la configuraci\u00f3n anterior podemos accerder a Tomcar manager a trav\u00e9s de <code>http://IP_SERVIDOR:8080/manager</code> y ya disponemos de un usuario para realizar los deploys con Maven.</p>"},{"location":"Ud6/Ch6_RRL/#despliegue-de-aplicaciones","title":"DESPLIEGUE DE APLICACIONES","text":""},{"location":"Ud6/Ch6_RRL/#preparativos-para-su-despliegue","title":"PREPARATIVOS PARA SU DESPLIEGUE","text":"<p>Asignamos una contrase\u00f1a al usuario Tomcat:</p> <pre><code>sudo passwd tomcat\n</code></pre> <p>Entramos con ese usuario:</p> <pre><code>su tomcat\n</code></pre> <p>Creamos la estructura de directorios para nuestra aplicaci\u00f3n:</p> <pre><code>mkdir -p /var/lib/tomcat10/webapps/prueba/WEB-INF/classes\n</code></pre> <p>Archivo de ejemplo <code>hola1.java</code>:</p> <pre><code>import javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.io.*;\npublic class hola1 extends HttpServlet {\n public void init(ServletConfig conf)\n    throws ServletException {\n    super.init(conf);\n }\n\npublic void service(HttpServletRequest req, HttpServletResponse res)\n throws ServletException, IOException {\n    res.setContentType(\"text/html\");\n    PrintWriter out = res.getWriter();\n    out.println(\"&lt;html&gt;\");\n    out.println(\"&lt;body&gt;\");\n    out.println(\"&lt;h1&gt;servlet hola 1&lt;/h1&gt;\");\n    out.println(\"&lt;/body&gt;\");\n    out.println(\"&lt;/html&gt;\");\n    }\n}\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#compilacion-de-la-aplicacion","title":"COMPILACI\u00d3N DE LA APLICACI\u00d3N","text":"<pre><code>javac -classpath /usr/share/tomcat10/lib/servlet-api.jar hola1.java\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#mover-el-archivo-compilado","title":"MOVER EL ARCHIVO COMPILADO","text":"<pre><code>mv hola1.class ./WEB-INF/classes\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#configurar-el-servidor-de-aplicaciones","title":"CONFIGURAR EL SERVIDOR DE APLICACIONES","text":"<p>Primero creamos el archivo <code>web.xml</code> en el directorio WEB-INF</p> <p>Ejemplo de la configuraci\u00f3n:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;!DOCTYPE web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\" \"http://java.sun.com/dtd/web-app_2_3.dtd\"&gt;\n&lt;web-app&gt;\n    &lt;display-name&gt;Ejemplos tutorial&lt;/display-name&gt;\n    &lt;description&gt;Servlets de ejemplos del tutorial de Servlets y JDBC.&lt;/description&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;hola1&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/hola1&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre> <p>Ahora podemos acceder a nuestra aplicaci\u00f3n a trev\u00e9s de <code>http://IPSERVIDOR:8080/prueba/hola1</code></p>"},{"location":"Ud6/Ch6_RRL/#despliegue-de-aplicaciones-con-maven","title":"DESPLIEGUE DE APLICACIONES CON MAVEN","text":""},{"location":"Ud6/Ch6_RRL/#instalacion-de-maven","title":"INSTALACI\u00d3N DE MAVEN","text":"<p>Para realizar la instalaci\u00f3n usamos el siguente comando:</p> <pre><code>sudo apt install maven\n</code></pre> <p>Para verificar la versi\u00f3n usamos el siguiente comando:</p> <pre><code>mvn --version\n</code></pre> <p>Para reiniciar el servicio tras las configuraciones usamos el siguiente comando:</p> <pre><code>sudo systemctl restart tomcat10.service\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#configuracion-de-maven","title":"CONFIGURACI\u00d3N DE MAVEN","text":"<p>Primero agregamos un usuario para realizar los deploys en el archivo <code>/etc/tomcat10/tomcat-users.xml</code>:</p> <pre><code>&lt;tomcat-users&gt;\n    &lt;role rolename=\"manager-script\"/&gt;\n    &lt;user username=\"despliegues\" password=\"ieselcaminas\" roles=\"manager-script\"/&gt;\n&lt;/tomcat-users&gt;\n</code></pre> <p>Ahora editamos el archivo <code>/etc/maven/settings.xml</code></p> <pre><code>&lt;server&gt;\n  &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n  &lt;username&gt;despliegues&lt;/username&gt;\n  &lt;password&gt;ieselcaminas&lt;/password&gt;\n&lt;/server&gt;\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#despliegue-con-maven","title":"DESPLIEGUE CON MAVEN","text":"<p>Primero creamos una aplicaci\u00f3n con Maven:</p> <pre><code>mvn archetype:generate -DgroupId=IESElCaminas -DartifactId=miapp -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false\n</code></pre> <p>Ahora configuramos el archivo <code>pom.xml</code></p> <pre><code>&lt;build&gt;\n  &lt;finalName&gt;miapp&lt;/finalName&gt;\n  &lt;plugins&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n      &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n      &lt;version&gt;3.4.0&lt;/version&gt;\n    &lt;/plugin&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n      &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n      &lt;version&gt;2.2&lt;/version&gt;\n      &lt;configuration&gt;\n        &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt;\n        &lt;server&gt;DesplieguesTomcat&lt;/server&gt;\n        &lt;path&gt;/miapp&lt;/path&gt;\n      &lt;/configuration&gt;\n    &lt;/plugin&gt;\n  &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre> <p>Para desplegar la aplicaci\u00f3n usamos el siguiente comando:</p> <pre><code>mvn tomcat7:deploy\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#comandos-utiles","title":"COMANDOS \u00daTILES","text":"<p>Otros comandos de utilidad son los siguientes:</p> <ul> <li>Para empaquetar la aplicaci\u00f3n en un archivo war -&gt; <code>mvn package</code></li> <li>Para volver a desplegar una aplicaci\u00f3n tras un cambio -&gt; <code>mvn tomcat7:redeploy</code></li> <li>Eliminar la aplicaci\u00f3n -&gt; <code>mvn tomcat7:undeploy</code></li> </ul>"},{"location":"Ud6/Ch6_RRL/#node-express","title":"NODE EXPRESS","text":""},{"location":"Ud6/Ch6_RRL/#node","title":"NODE","text":""},{"location":"Ud6/Ch6_RRL/#instalacion-de-node","title":"INSTALACI\u00d3N DE NODE","text":"<p>Descargamos e importamos la clave GPG de Nodesource:</p> <pre><code>sudo apt-get update\nsudo apt-get install -y ca-certificates curl gnupg\nsudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg\n</code></pre> <p>Creamos el repositorio deb:</p> <pre><code>NODE_MAJOR=20\necho \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" | sudo tee /etc/apt/sources.list.d/nodesource.list\n</code></pre> <p>Ejecutamos la actualizaci\u00f3n e instalaci\u00f3n:</p> <pre><code>sudo apt-get update\nsudo apt-get install nodejs -y\n</code></pre> <p>Comprobamos que Node.js est\u00e1 correctamente instalado:</p> <pre><code>node --version\nnpm --version\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#node-con-pm2","title":"NODE CON PM2","text":"<p>Primero instalamos PM2 globalmente:</p> <pre><code>sudo npm install pm2 -g\n</code></pre> <p>Para ejecutar la aplicaci\u00f3n en modo cl\u00faster con PM2 usamos el siguiente comando:</p> <pre><code>pm2 start app.js -i 0\n</code></pre> <p>Para detener la aplicaci\u00f3n usamos el siguiente comando:</p> <pre><code>pm2 stop app.js\n</code></pre> <p>Para reiniciar la aplicaci\u00f3n usamos el siguiente comando:</p> <pre><code>pm2 restart app.js\n</code></pre> <p>Para recargar la aplicaci\u00f3n usamos el siguiente comando:</p> <pre><code>pm2 reload app.js\n</code></pre> <p>Para eliminar la aplicaci\u00f3n usamos el siguiente comando:</p> <pre><code>pm2 delete app.js\n</code></pre> <p>Para listar las aplicaciones en ejecuci\u00f3n usamos el siguiente comando:</p> <pre><code>pm2 ls\n</code></pre> <p>Para mostrar los logs de la aplicaci\u00f3n usamos el siguiente comando:</p> <pre><code>pm2 logs\n</code></pre> <p>Para mostrar las m\u00e9tricas de rendimiento usamos el siguiente comando:</p> <pre><code>pm2 monit\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#pm2-con-ecosystem","title":"PM2 CON ECOSYSTEM","text":"<p>Para crear el archivo Ecosystem usamos el siguiente comando:</p> <pre><code>pm2 ecosystem\n</code></pre> <p>Ejemplo del archivo generado <code>ecosystem.config.js</code>:</p> <pre><code>module.exports = {\n apps: [\n {\n name: \"nombre_aplicacion\",\n script: \"nombre_aplicacion_sin_cluster.js\",\n instances: 0,\n exec_mode: \"cluster\",\n },\n ],\n};\n</code></pre> <p>Podemos usar los comandos de PM2 para gestionar nuestro archivo <code>ecosystem.config.js</code>:</p> <pre><code>pm2 [start|restart|reload|stop|delete] ecosystem.config.js\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#express","title":"EXPRESS","text":""},{"location":"Ud6/Ch6_RRL/#instalacion-de-express","title":"INSTALACI\u00d3N DE EXPRESS","text":"<p>Para instalar EXPRESS usamos el siguiente comando:</p> <pre><code>sudo npm install -g express\n</code></pre> <p>Para actualizar NPM a una versi\u00f3n m\u00e1s actual usamos el siguiente comando:</p> <pre><code>sudo npm install -g npm@10.1.0\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#crear-un-y-despliegue-del-proyecto","title":"CREAR UN Y DESPLIEGUE DEL PROYECTO","text":"<p>Primero inicilizamos el proyecto NPM:</p> <pre><code>npm init -y\n</code></pre> <p>Luego instalamos EXPRESS en el proyecto:</p> <pre><code>npm install express\n</code></pre> <p>Para iniciar el servidor usamos el siguiente comando:</p> <pre><code>node app.js\n</code></pre> <p>Por defecto lo mapea en el puerto 3000, podemos acceder al servidor a trav\u00e9s de <code>http://IP_PUBLICA:3000</code>.</p>"},{"location":"Ud6/Ch6_RRL/#netlify","title":"NETLIFY","text":""},{"location":"Ud6/Ch6_RRL/#instalacion","title":"INSTALACI\u00d3N","text":"<p>Para instalar netlify globalmente usamos el siguiente comando:</p> <pre><code>sudo npm install netlify-cli -g\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#auntentificacion","title":"AUNTENTIFICACI\u00d3N","text":"<p>Para autentificarnos en netlify usamos el siguiente comando:</p> <pre><code>netlify login\n</code></pre>"},{"location":"Ud6/Ch6_RRL/#despliegue-de-proyectos","title":"DESPLIEGUE DE PROYECTOS","text":"<p>Para desplegar nuestro proyecto en netlify usamos el siguiente comando:</p> <pre><code>netlify deploy\n</code></pre> <p>Para desplegarlo en producci\u00f3n usamos el siguiente comando:</p> <pre><code>netlify deploy --prod\n</code></pre>"},{"location":"Ud6/Ch6_RSN/","title":"CH6 - RSN","text":""},{"location":"Ud6/Ch6_RSN/#instalacion-de-tomcat","title":"Instalaci\u00f3n de Tomcat \u23ec\ud83d\udc31","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo apt-get install default-jdk</code> Instalaci\u00f3n del paquete necesario para java <code>sudo apt-get install default-jre</code> Instalaci\u00f3n de Java <code>sudo apt-get install -y tomcat10 tomcat10-admin</code> Instalaci\u00f3n de Tomcat <code>sudo nano /etc/tomcat10/tomcat-users.xml</code> Creaci\u00f3n de archivo de gesti\u00f3n de usuarios"},{"location":"Ud6/Ch6_RSN/#despliegue-de-aplicaciones-con-tomcat","title":"Despliegue de aplicaciones con Tomcat \u23eb\ud83d\udc31","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>ls -l /var/lib/tomcat10/webapps/sample</code> Comprobar estructura de directorios de tomcat <code>sudo passwd tomcat</code> Asignar contrase\u00f1a al usuario tomcat <code>mkdir -p /var/lib/tomcat10/webapps/prueba/WEB-INF/classes</code> Crear estructura de carpetas <code>javac -classpath /usr/share/tomcat10/lib/servlet-api.jar hola1.java</code> Compilaci\u00f3n de la aplicaci\u00f3n de java <code>mv hola1.class ./WEB-INF/classes</code> Mover la clase a su respectiva estructura"},{"location":"Ud6/Ch6_RSN/#despliegue-de-tomcat-con-maven","title":"Despliegue de Tomcat con Maven \ud83d\udc31\ud83e\udeb6","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo apt-get install maven</code> Instalaci\u00f3n de Maven <code>sudo nano /etc/maven/settings.xml</code> Modificaci\u00f3n del archivo de settings <code>mvn tomcat7:deploy</code> Construir la aplicaci\u00f3n <code>mvn tomcat7:redeploy</code> Volver a desplegar la aplicaci\u00f3n <code>mvn tomcat7:undeploy</code> Replegar la aplicaci\u00f3n <code>mvn archetype:generate -DgroupId=IESElCaminas -DartifactId=miapp -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false</code> Crear estructura de carpetas"},{"location":"Ud6/Ch6_RSN/#despliegue-de-aplicaciones-con-node","title":"Despliegue de aplicaciones con Node \u23eb\u267b\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo apt-get install -y ca-certificates curl gnupg</code> Importar clave GPG de Nodesource <code>sudo mkdir -p /etc/apt/keyrings</code> Creaci\u00f3n de carpeta para la \"key\" <code>curl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg</code> Importaci\u00f3n final de la clave <code>echo \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" sudo tee /etc/apt/sources.list.d/nodesource.list</code> Creaci\u00f3n del repositorio deb <code>sudo apt-get install nodejs -y</code> Instalaci\u00f3n de Node <code>sudo npm install -g express</code> Instalaci\u00f3n de Express <code>sudo npm install -g npm@10.1.0</code> Instalaci\u00f3n de Node versi\u00f3n actual (depende de la salida por consola) <code>npm init -y</code> Iniciar proyecto <code>npm install express</code> Instalar express de forma local <code>npm run start:dev</code> Iniciar aplicaci\u00f3n"},{"location":"Ud6/Ch6_RSN/#dockerizacion-del-despliegue-de-una-aplicacion-con-node","title":"Dockerizaci\u00f3n del despliegue de una aplicaci\u00f3n con Node \ud83d\udce6\u267b\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>docker build -t the-example-app.nodejs .</code> Construir proyecto <code>docker run -p 3000:3000 -d the-example-app.nodejs</code> Iniciar el contenedor"},{"location":"Ud6/Ch6_RSN/#despliegue-de-una-aplicacion-clusterizada-con-node","title":"Despliegue de una aplicaci\u00f3n \"clusterizada\" con Node \ud83d\udc22\u267b\ufe0f","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo npm install -g loadtest</code> Instalaci\u00f3n de loadtest <code>loadtest http://localhost:3000/api/500000 -n 1000 -c 100</code> Realizar la prueba de carga <code>sudo npm install pm2 -g</code> Instalaci\u00f3n de PM2 <code>pm2 start nombre_aplicacion_sin_cluster.js -i 0</code> Ejecuci\u00f3n de la aplicaci\u00f3n <code>ps -ef  grep .js</code> Comprobaci\u00f3n de que hay 2 procesos en funcionamiento <code>pm2 stop app.js</code> Detener la aplicaci\u00f3n"},{"location":"Ud6/Ch6_RSN/#despliegue-de-una-aplicacion-en-netlify","title":"Despliegue de una aplicaci\u00f3n en Netlify \ud83d\udd01\u23eb","text":"Comandos \ud83d\udee1\ufe0f Explicaci\u00f3n \ud83d\udde8\ufe0f <code>sudo npm install netlify-cli -g</code> Instalaci\u00f3n de netlify <code>netlify login</code> Loguearse con netlify <code>netlify deploy</code> Pre-deploy de Netlify <code>sudo npm install -g @angular/cli</code> Instalar cliente de angular <code>ng serve -o --host=IPPRIVADA</code> Abrir servidor"},{"location":"Ud6/Ch6_RSN/#configuraciones-de-archivos","title":"Configuraciones de archivos \ud83d\udcdc","text":"<pre><code>&gt; Archivo configuraci\u00f3n tomcat-users.xml (P1)\n\n  &lt;role rolename=\"manager-gui\"/&gt;\n  &lt;role rolename=\"admin-gui\"/&gt;\n  &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n web.xml\n\n    &lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;!DOCTYPE web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\" \"http://java.sun.com/dtd/web-app_2_3.dtd\"&gt;\n&lt;web-app&gt;\n    &lt;display-name&gt;Ejemplos tutorial&lt;/display-name&gt;\n    &lt;description&gt;Servlets de ejemplos del tutorial de Servlets y JDBC.&lt;/description&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;hola1&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/hola1&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n tomcat-users.xml\n\n     &lt;role rolename=\"admin-gui\"/&gt;\n     &lt;role rolename=\"manager-gui\"/&gt;\n     &lt;role rolename=\"manager-script\"/&gt;\n     &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n     &lt;user username=\"despliegues\" password=\"ieselcaminas\" roles=\"manager-script\"/&gt;\n</code></pre> <pre><code>&gt; Archivo configuraci\u00f3n settins.xml\n\n      &lt;server&gt;\n      &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n      &lt;username&gt;despliegues&lt;/username&gt;\n      &lt;password&gt;ieselcaminas&lt;/password&gt;\n    &lt;/server&gt;\n</code></pre> <pre><code>&gt; A\u00f1adido a pom.xml\n\n    &lt;build&gt;\n    &lt;finalName&gt;roshambo&lt;/finalName&gt; #\n    &lt;plugins&gt; \n        &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n        &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n        &lt;version&gt;2.2&lt;/version&gt;\n        &lt;configuration&gt;\n            &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt; #\n            &lt;server&gt;DesplieguesTomcat&lt;/server&gt; #\n            &lt;path&gt;/rps&lt;/path&gt; #\n        &lt;/configuration&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre> <pre><code>&gt; A\u00f1adido a pom.xml\n\n      &lt;build&gt;\n    &lt;finalName&gt;miapp&lt;/finalName&gt;\n    &lt;plugins&gt;  \n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.4.0&lt;/version&gt;\n        &lt;/plugin&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n            &lt;version&gt;2.2&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt;\n                &lt;server&gt;DesplieguesTomcat&lt;/server&gt;\n                &lt;path&gt;/miapp&lt;/path&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre>"},{"location":"Ud6/Ch6_VATC/","title":"\ud83c\udf1f Servidores de aplicaciones","text":"<p>\u270d\ufe0f Victor Alexandru Teleanu Covaci</p>"},{"location":"Ud6/Ch6_VATC/#1-despliegue-de-aplicaciones-java","title":"1. Despliegue de aplicaciones Java","text":""},{"location":"Ud6/Ch6_VATC/#tomcat","title":"\ud83d\udc31 TOMCAT","text":"<ul> <li>Instalar Java:</li> </ul> <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install default-jdk\nsudo apt-get install default-jre\n</code></pre> <ul> <li>Comprobar versi\u00f3n:</li> </ul> <pre><code>java --version\n</code></pre> <ul> <li>Instalar Tomcat:</li> </ul> <pre><code>sudo apt-get install -y tomcat10 tomcat10-admin\n</code></pre> <ul> <li>Poniendo en el navegador <code>http://IP_SERVIDOR:8080</code> comprobamos que tenemos acceso al servidor.</li> </ul>"},{"location":"Ud6/Ch6_VATC/#creacion-usuario-de-tomcat","title":"\ud83d\udd11 CREACI\u00d3N USUARIO DE TOMCAT","text":"<ul> <li>Modificamos <code>sudo nano /etc/tomcat10/tomcat-users.xml</code>:</li> </ul> <pre><code>&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"admin-gui\"/&gt;\n&lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre> <ul> <li>Para reiniciar Tomcat se utilizar\u00e1 <code>sudo systemctl restart tomcat10</code>.</li> </ul>"},{"location":"Ud6/Ch6_VATC/#tomcat-con-maven","title":"\u2699\ufe0f TOMCAT CON MAVEN","text":"<ul> <li>Instalar Maven:</li> </ul> <pre><code>sudo apt-get update\nsudo apt-get install maven\n</code></pre> <ul> <li>Comprobar versi\u00f3n:</li> </ul> <pre><code>mvn --v\n</code></pre> <ul> <li>Modificar el fichero <code>/etc/tomcat10/tomcat-users.xml</code>:</li> </ul> <pre><code>&lt;role rolename=\"admin-gui\"/&gt;\n&lt;role rolename=\"manager-gui\"/&gt;\n&lt;role rolename=\"manager-script\"/&gt;\n&lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n&lt;user username=\"despliegues\" password=\"ieselcaminas\" roles=\"manager-script\"/&gt;\n</code></pre> <ul> <li>Inidicar a Maven el servidor donde vamos a desplegar:</li> </ul> <pre><code>&lt;server&gt;\n    &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n    &lt;username&gt;despliegues&lt;/username&gt;\n    &lt;password&gt;ieselcaminas&lt;/password&gt;\n&lt;/server&gt;\n</code></pre>"},{"location":"Ud6/Ch6_VATC/#plugin-para-tomcat","title":"\ud83d\udce6 PLUGIN PARA TOMCAT","text":"<ul> <li>Se modifica el archivo <code>pom.xml</code>:</li> </ul> <pre><code>&lt;build&gt;\n    &lt;finalName&gt;roshambo&lt;/finalName&gt; #\n    &lt;plugins&gt; \n        &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n        &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n        &lt;version&gt;2.2&lt;/version&gt;\n        &lt;configuration&gt;\n            &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt; #\n            &lt;server&gt;DesplieguesTomcat&lt;/server&gt; #\n            &lt;path&gt;/rps&lt;/path&gt; #\n        &lt;/configuration&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre> <ul> <li>Con <code>mvn tomcat7:deploy</code> desplegamos nuestro proyecto.</li> </ul>"},{"location":"Ud6/Ch6_VATC/#despliegue-de-un-proyecto-nuevo-ejemplo","title":"\ud83d\udcc2 Despliegue de un proyecto nuevo (ejemplo)","text":"<ul> <li>Vamos al directorio deseado y ejecutamos:</li> </ul> <pre><code>mvn archetype:generate -DgroupId=IESElCaminas -DartifactId=miapp -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false\n</code></pre>"},{"location":"Ud6/Ch6_VATC/#2-despliegue-de-aplicaciones-javascript","title":"2. Despliegue de aplicaciones Javascript","text":""},{"location":"Ud6/Ch6_VATC/#instalacion-de-node","title":"\ud83d\udfe2 INSTALACI\u00d3N DE NODE","text":"<ul> <li>Instalar Node.js:</li> </ul> <pre><code>sudo apt-get update\nsudo apt-get install -y ca-certificates curl gnupg\nsudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg\n</code></pre> <ul> <li>Crear repositorio deb:</li> </ul> <pre><code>NODE_MAJOR=20\necho \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" | sudo tee /etc/apt/sources.list.d/nodesource.list\n</code></pre> <ul> <li>Comprobar versi\u00f3n:</li> </ul> <pre><code>node --version\nnpm --version\n</code></pre>"},{"location":"Ud6/Ch6_VATC/#instalacion-de-express","title":"\ud83d\ude80 INSTALACI\u00d3N DE EXPRESS","text":"<ul> <li>Instalar express (global):</li> </ul> <pre><code>sudo npm install -g express\n</code></pre> <ul> <li>Ejecutar el proyecto:</li> </ul> <pre><code>node app.js\n</code></pre>"},{"location":"Ud6/Ch6_VATC/#aplicacion-clusterizada","title":"\ud83d\udd04 APLICACI\u00d3N CLUSTERIZADA","text":""},{"location":"Ud6/Ch6_VATC/#ejemplo-de-aplicacion-con-cluster","title":"\ud83d\udccc Ejemplo de aplicaci\u00f3n con Cluster:","text":"<pre><code>const cluster = require('cluster');\nconst http = require('http');\nconst os = require('os');\n\nif (cluster.isMaster) {\n    const numCPUs = os.cpus().length;\n    console.log(`Master ${process.pid} is running`);\n    for (let i = 0; i &lt; numCPUs; i++) {\n        cluster.fork();\n    }\n\n    cluster.on('exit', (worker, code, signal) =&gt; {\n        console.log(`Worker ${worker.process.pid} died`);\n    });\n} else {\n    http.createServer((req, res) =&gt; {\n        res.writeHead(200);\n        res.end('Hello World!');\n    }).listen(8000);\n\n    console.log(`Worker ${process.pid} started`);\n}\n</code></pre>"},{"location":"Ud6/Ch6_VATC/#usando-pm2","title":"\ud83d\udee0\ufe0f Usando PM2:","text":"<ul> <li>Instalar PM2:</li> </ul> <pre><code>sudo npm install pm2 -g\n</code></pre> <ul> <li>Ejecutar aplicaci\u00f3n:</li> </ul> <pre><code>pm2 start nombre_aplicacion_sin_cluster.js -i 0\n</code></pre> <ul> <li>Podemos iniciar, reiniciar, recargar, detener y eliminar una aplicaci\u00f3n con:</li> </ul> <pre><code>$ pm2 start nombre_aplicacion\n$ pm2 restart nombre_aplicacion\n$ pm2 reload nombre_aplicacion\n$ pm2 stop nombre_aplicacion\n$ pm2 delete nombre_aplicacion\n</code></pre>"},{"location":"Ud6/Ch6_VATC/#3-netlify-paas","title":"3. NETLIFY (PaaS)","text":"\ud83d\udd27 Comando \ud83d\udcdd Descripci\u00f3n <code>sudo npm install netlify-cli -g</code> Instalar el CLI de Netlify <code>netlify login</code> Loguearse a Netlify <code>netlify deploy</code> Despliega proyecto <code>netlify deploy --prod</code> Despliega a producci\u00f3n"},{"location":"Ud6/Ch6_VATC/#4-despliegue-de-aplicaciones-python","title":"4. Despliegue de aplicaciones Python","text":"<ul> <li>Instalar Python:</li> </ul> <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install python3-pip\n</code></pre> <ul> <li>Instalar el paquete pipenv para gestionar entornos virtuales:</li> </ul> <pre><code>sudo apt-get install pipenv\n</code></pre> <ul> <li>Comprobar versi\u00f3n:</li> </ul> <pre><code>pipenv --version\n</code></pre> <ul> <li>Crear .env:</li> </ul> <pre><code>cd /var/www/practica_flask\ntouch .env\n</code></pre> <pre><code>FLASK_APP=wsgi.py\nFLASK_ENV=production\n</code></pre> <ul> <li>Iniciar entorno virtual:</li> </ul> <pre><code>cd /var/www/practica_flask\npipenv shell\n</code></pre> <ul> <li>Instalar dependencias necesarias:</li> </ul> <pre><code>pipenv install flask gunicorn\n</code></pre>"},{"location":"Ud6/Ch6_VATC/#crear-archivo-para-que-systemd-corra-gunicorn","title":"\u2699\ufe0f Crear archivo para que systemd corra Gunicorn","text":"<ul> <li>Crear y modificar <code>/etc/systemd/system/flask_app.service</code>:</li> </ul> <pre><code>[Unit]\nDescription=flask_app.service\nAfter=network.target\n\n[Service]\nUser=admin\nGroup=www-data\nEnvironment=\"PATH=/home/admin/.local/share/virtualenvs/practica_flask-gV07D8Rz/bin:$PATH\"\nWorkingDirectory=/var/www/practica_flask/\nExecStart=/home/admin/.local/share/virtualenvs/practica_flask-gV07D8Rz/bin/gunicorn --workers 2 --bind unix:/var/www/practica_flask/flask_app.sock -m 007 wsgi:app\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <ul> <li>Habilitamos el servicio:</li> </ul> <pre><code>systemctl enable flask_app\n\nsystemctl start flask_app\n</code></pre> <ul> <li>Modificar <code>/etc/nginx/sites-available/practica_flask</code>:</li> </ul> <pre><code>server {\n    listen 80;\n    server_name practica_flask www.practica_flask;\n\n    access_log /var/log/nginx/practica_flask.access.log;\n    error_log /var/log/nginx/practica_flask.error.log;\n\n    location / { \n            include proxy_params;\n            proxy_pass http://unix:/var/www/practica_flask/flask_app.sock;\n    }\n}\n</code></pre>"},{"location":"Ud6/Ud6_EV/","title":"CH6 - EV","text":""},{"location":"Ud6/Ud6_EV/#servidores-de-aplicaciones","title":"Servidores de aplicaciones","text":""},{"location":"Ud6/Ud6_EV/#instalacion-de-tomcat","title":"Instalaci\u00f3n de Tomcat","text":"<ul> <li>Instalar Java <pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade\nsudo apt-get install default-jdk\nsudo apt-get install default-jre\n</code></pre></li> <li>Instalar Apache Tomcat : <code>sudo apt-get install -y tomcat10 tomcat10-admin</code></li> <li>Comprobar instalaci\u00f3n : <code>systemctl status tomcat10</code></li> </ul>"},{"location":"Ud6/Ud6_EV/#creacion-de-un-usuario","title":"Creaci\u00f3n de un usuario","text":"<ul> <li>Editar fichero <code>tomcat-users.xml</code> : <code>sudo nano /etc/tomcat10/tomcat-users.xml</code></li> <li> <p>A\u00f1adir las siguientes l\u00edneas <pre><code>  &lt;role rolename=\"manager-gui\"/&gt;\n  &lt;role rolename=\"admin-gui\"/&gt;\n  &lt;user username=\"admin\" password=\"ieselcaminas\" roles=\"admin-gui,manager-gui\"/&gt;\n</code></pre></p> </li> <li> <p>Reiniciar tomcat : <code>sudo systemctl restart tomcat10</code></p> </li> </ul>"},{"location":"Ud6/Ud6_EV/#despliegue-de-aplicaciones-con-tomcat","title":"Despliegue de aplicaciones con Tomcat","text":"<ul> <li>Desplegar archivo <code>.war</code>.</li> </ul>"},{"location":"Ud6/Ud6_EV/#crear-una-aplicacion-nueva","title":"Crear una aplicaci\u00f3n nueva","text":"<ul> <li>Acceder a <code>/etc/passwd</code> y cambiar la l\u00ednea <code>tomcat:x:994:994:Apache Tomcat:/var/lib/tomcat:/usr/sbin/nologin</code> por <code>tomcat:x:994:994:Apache Tomcat:/var/lib/tomcat:/bin/bash</code></li> <li>Asingarle una constrase\u00f1a : <code>sudo passwd tomcat</code></li> <li>Entrar en el sistema como usuario <code>tomcat</code> : <code>su tomcat</code></li> <li>Crear estructura de carpetas : <code>mkdir -p /var/lib/tomcat10/webapps/prueba/WEB-INF/classes</code></li> <li>Crear archivo <code>.java</code> dentro de <code>prueba</code> <pre><code>import javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.io.*;\npublic class hola1 extends HttpServlet {\n public void init(ServletConfig conf)\n    throws ServletException {\n    super.init(conf);\n }\n\npublic void service(HttpServletRequest req, HttpServletResponse res)\n throws ServletException, IOException {\n    res.setContentType(\"text/html\");\n    PrintWriter out = res.getWriter();\n    out.println(\"&lt;html&gt;\");\n    out.println(\"&lt;body&gt;\");\n    out.println(\"&lt;h1&gt;servlet hola 1&lt;/h1&gt;\");\n    out.println(\"&lt;/body&gt;\");\n    out.println(\"&lt;/html&gt;\");\n    }\n}\n</code></pre></li> <li>Compilar aplicaci\u00f3n : <code>javac -classpath /usr/share/tomcat10/lib/servlet-api.jar hola1.java</code></li> <li>Mover archivo <code>.class</code> a <code>webapps/prueba/WEB-INF/classes</code> : <code>mv hola1.class ./WEB-INF/classes</code></li> <li>En el directorio <code>WEB-INF</code> crear fichero <code>.xml</code> con el siguiente contenido <pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;!DOCTYPE web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\" \"http://java.sun.com/dtd/web-app_2_3.dtd\"&gt;\n&lt;web-app&gt;\n    &lt;display-name&gt;Ejemplos tutorial&lt;/display-name&gt;\n    &lt;description&gt;Servlets de ejemplos del tutorial de Servlets y JDBC.&lt;/description&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;hola1&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;hola1&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/hola1&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre></li> <li>Fichero <code>.html</code> dentro de <code>prueba</code> <pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Actividad de prueba con Tomcat&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body bgcolor=white&gt;\n        &lt;div style=\" width:100% text-align:center\"&gt;\n            &lt;img width=\"200\" src=\"tomcat.gif\"&gt;\n            &lt;br&gt;\n            &lt;h1&gt;Actividad con Tomcat&lt;/h1&gt;\n            &lt;p&gt;Despliegue de aplicaciones web&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div style=\"background:#ffc; margin-top:30px; padding:30px; text-align:center\"&gt;\n            Ir a &lt;a href=\"hola1.jsp\"&gt;JSP page&lt;/a&gt;\n            &lt;br&gt;\n            Ir al &lt;a href=\"hola1\"&gt;servlet&lt;/a&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></li> <li>Fichero <code>.jsp</code> dentro de <code>prueba</code> <pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Ejemplo p\u00e1gina JSP&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body bgcolor=white&gt;\n        &lt;div style=\" width:100%; text-align:center\"&gt;\n            &lt;img width=\"150\" src=\"tomcat.gif\"&gt;\n            &lt;br&gt;\n            &lt;h1&gt;Ejemplo JSP hola1&lt;/h1&gt;\n            &lt;br&gt;\n            &lt;%= new String(\"Hola 1\") %&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></li> </ul>"},{"location":"Ud6/Ud6_EV/#despliegue-en-tomcat-con-maven","title":"Despliegue en Tomcat con Maven","text":"<ul> <li>Instalar Maven : <code>sudo apt-get install maven</code></li> <li>A\u00f1adir usuario en <code>tomcat-users.xml</code></li> <li>Reiniciar Tomcat : <code>sudo systemctl restart tomcat10.service</code></li> <li>Editar <code>settings.xml</code> y a\u00f1adir <pre><code>    &lt;server&gt;\n      &lt;id&gt;DesplieguesTomcat&lt;/id&gt;\n      &lt;username&gt;despliegues&lt;/username&gt;\n      &lt;password&gt;ieselcaminas&lt;/password&gt;\n    &lt;/server&gt;\n</code></pre></li> </ul>"},{"location":"Ud6/Ud6_EV/#despliegue-de-un-proyecto-ya-preparado","title":"Despliegue de un proyecto ya preparado","text":"<ul> <li>Clonar el proyecto <pre><code>git clone https://github.com/cameronmcnz/rock-paper-scissors.git\ncd rock*\ngit checkout patch-1\n</code></pre></li> <li>Modificar el <code>POM</code> del proyecto. A\u00f1adir lo siguiente dentro del bloque <code>&lt;plugins&gt;</code> <pre><code>        &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n        &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n        &lt;version&gt;2.2&lt;/version&gt;\n        &lt;configuration&gt;\n            &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt; #\n            &lt;server&gt;DesplieguesTomcat&lt;/server&gt; #\n            &lt;path&gt;/rps&lt;/path&gt; #\n        &lt;/configuration&gt;\n        &lt;/plugin&gt;\n</code></pre></li> <li>Desplegar una aplicacion : <code>mvn tomcat7:deploy</code></li> <li>Replegar una aplicacion : <code>mvn tomcat7:undeploy</code></li> <li>Volver a desplegar una aplicacion : <code>mvn tomcat7:redeploy</code></li> </ul>"},{"location":"Ud6/Ud6_EV/#despliegue-de-aplicaciones-con-node-express","title":"Despliegue de aplicaciones con Node Express","text":""},{"location":"Ud6/Ud6_EV/#instalacion-nodejs","title":"Instalacion Node.js","text":"<ul> <li>Descargar e importar clave GPG de Nodesecure <pre><code>sudo apt-get update\nsudo apt-get install -y ca-certificates curl gnupg\nsudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg\n</code></pre></li> <li>Crear repositorio deb <pre><code>NODE_MAJOR=20\necho \"deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_$NODE_MAJOR.x nodistro main\" | sudo tee /etc/apt/sources.list.d/nodesource.list\n</code></pre></li> <li>Ejecutar la actualizaci\u00f3n e instalaci\u00f3n <pre><code>sudo apt-get update\nsudo apt-get install nodejs -y\n</code></pre></li> </ul>"},{"location":"Ud6/Ud6_EV/#instalacion-de-express","title":"Instalaci\u00f3n de Express","text":"<p><code>sudo npm install -g express</code></p>"},{"location":"Ud6/Ud6_EV/#creacion-del-primer-proyecto","title":"Creaci\u00f3n del primer proyecto","text":"<ul> <li>Inicializar proyecto : <code>npm init -y</code></li> <li>Instalar Express para el proyecto de manera local : <code>npm install express</code></li> <li>Crear archivo de muestra <code>.js</code> con el siguiente contenido <pre><code>const express = require('express')\nconst app = express()\nconst port = 3000\n\napp.get('/', (req, res) =&gt; {\n    res.send('Hello. Welcome to this blog')\n})\n\napp.listen(port, () =&gt; {\n    console.log(`Example app listening at http://localhost:${port}`)\n})\n</code></pre></li> <li>Ejecutar el proyecto : <code>node app.js</code></li> </ul>"},{"location":"Ud6/Ud6_EV/#dockerizacion-del-despliegue-de-una-aplicacion-nodejs","title":"Dockerizaci\u00f3n del despliegue de una aplicaci\u00f3n Node.js","text":"<ul> <li>Clonar repositorio : <code>git clone https://github.com/contentful/the-example-app.nodejs.git</code></li> <li>Hacer build de la imagen Docker : <code>docker build -t the-example-app.nodejs .</code></li> <li>Iniciar el contenedor : <code>docker run -p 3000:3000 -d the-example-app.nodejs</code></li> </ul>"},{"location":"Ud6/Ud6_EV/#despliegue-de-una-aplicacion-clusterizada-con-node-express","title":"Despliegue de una aplicaci\u00f3n \"clusterizada\" con Node Express","text":"<ul> <li>Instalar <code>loadtest</code> : <code>sudo npm install -g loadtest</code></li> <li>Ejecturar la aplicaci\u00f3n que queremos probar</li> <li>En otro terminal, ejecutar una prueba de carga : <code>loadtest http://localhost:3000/api/500000 -n 1000 -c 100</code></li> <li>Detener la aplicaci\u00f3n sin cl\u00fasters, ejecutar la que s\u00ed que tiene y realizar las mismas pruebas</li> </ul>"},{"location":"Ud6/Ud6_EV/#uso-de-pm2-para-administrar-un-cluster-de-nodejs","title":"Uso de PM2 para administrar un cl\u00faster de Node.js","text":"<ul> <li>Instalar PM2 : <code>sudo npm install pm2 -g</code></li> <li>Usar en la aplicaci\u00f3n no clusterizada : <code>pm2 start nombre_aplicacion_sin_cluster.js -i 0</code></li> <li>Ejecutar las mismas pruebas que anteriormente, pero con PM2</li> <li>Detener la aplicaci\u00f3n : <code>pm2 stop app.js</code></li> <li>Crear archivo <code>Ecosystem</code> : <code>pm2 ecosystem</code></li> <li>Contenido archivo <code>ecosystem.config.js</code> <pre><code>module.exports = {\n apps: [\n {\n name: \"nombre_aplicacion\",\n script: \"nombre_aplicacion_sin_cluster.js\",\n instances: 0,\n exec_mode: \"cluster\",\n },\n ],\n};\n</code></pre></li> <li>Ejecutar la aplicaci\u00f3n : <code>pm2 start ecosystem.config.js</code></li> <li>Se puede ejecutar, reiniciar, recargar, detener y eliminar una aplicaci\u00f3n con los siguientes comandos <pre><code>$ pm2 start nombre_aplicacion\n$ pm2 restart nombre_aplicacion\n$ pm2 reload nombre_aplicacion\n$ pm2 stop nombre_aplicacion\n$ pm2 delete nombre_aplicacion\n\n# Cuando usemos el archivo Ecosystem:\n\n$ pm2 [start|restart|reload|stop|delete] ecosystem.config.js\n</code></pre></li> </ul>"},{"location":"Ud6/Ud6_EV/#despliegue-de-una-aplicacion-en-netlify-paas","title":"Despliegue de una aplicaci\u00f3n en Netlify (PaaS)","text":"<ul> <li>Instalar el CLI de Netlify : <code>sudo npm install netlify-cli -g</code></li> <li>Autenticarse : <code>netlify login</code></li> <li>Instalar dependencias indicadas en <code>package.json</code> : <code>npm install</code></li> <li>Probar el script <code>start</code> : <code>npm run start</code></li> <li>Hacer un pre-deploy : <code>netlify deploy</code></li> <li>Pasar aplicaci\u00f3n a producci\u00f3n : <code>netlify deploy --prod</code></li> </ul>"},{"location":"Ud6/Ud6_EV/#despliegue-mediante-conexion-con-github","title":"Despliegue mediante conexi\u00f3n con GitHub","text":"<ul> <li>Crear un repositorio desde cero en GitHub</li> <li>Ejecutar los siguientes comandos <pre><code>$ git init\n$ git add .\n$ git commit -m \"Subiendo el c\u00f3digo...\"\n$ git branch -M main\n</code></pre></li> <li>Referenciar la carpeta y hacer un push <pre><code>$ git remote add origin https://github.com/username/practicaTresSeis.git\n$ git push -u origin main\n</code></pre></li> <li>Importar proyecto de Git en Netlify en modo gr\u00e1fico y desplegar la aplicaci\u00f3n</li> </ul>"}]}